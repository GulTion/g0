<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::73091</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>030</td><td>GCC</td><td>240427T223541Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/272862#272862">l3akwire</a></td></tr>
<tr d-ix="1"><td>082</td><td>Go</td><td>240422T042848Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/272716#272716">bigyihsu</a></td></tr>
<tr d-ix="2"><td>051</td><td>PowerShell Core</td><td>240421T213709Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/272711#272711">Julian</a></td></tr>
<tr d-ix="3"><td>016</td><td>Uiua</td><td>240421T155750Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/272707#272707">Joao-3</a></td></tr>
<tr d-ix="4"><td>nan</td><td>C</td><td>160219T115106Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73576#73576">Toby Spe</a></td></tr>
<tr d-ix="5"><td>084</td><td>Google Sheets</td><td>240421T124405Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/272703#272703">Patric</a></td></tr>
<tr d-ix="6"><td>013</td><td>Husk</td><td>201031T045006Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/214474#214474">Razetime</a></td></tr>
<tr d-ix="7"><td>050</td><td>PHP</td><td>161102T111200Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/98284#98284">Titus</a></td></tr>
<tr d-ix="8"><td>360</td><td>BrainFlak</td><td>160805T135849Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/88880#88880">Wheat Wi</a></td></tr>
<tr d-ix="9"><td>104</td><td>C#</td><td>160805T152418Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/88890#88890">TheLetha</a></td></tr>
<tr d-ix="10"><td>133</td><td>Java</td><td>160805T130131Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/88870#88870">Justin</a></td></tr>
<tr d-ix="11"><td>043</td><td>R</td><td>160219T104801Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73574#73574">slamball</a></td></tr>
<tr d-ix="12"><td>015</td><td>GNU dc</td><td>160215T123329Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73163#73163">Toby Spe</a></td></tr>
<tr d-ix="13"><td>nan</td><td>Haskell</td><td>160215T144821Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73173#73173">sourtin</a></td></tr>
<tr d-ix="14"><td>022</td><td>Golfscript</td><td>160214T220130Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73107#73107">Dica</a></td></tr>
<tr d-ix="15"><td>142</td><td>JavaScript ES6</td><td>160215T042525Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73142#73142">Patrick </a></td></tr>
<tr d-ix="16"><td>108</td><td>ES6</td><td>160215T135346Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73171#73171">Neil</a></td></tr>
<tr d-ix="17"><td>116</td><td>Oracle SQL 11.2</td><td>160215T124520Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73165#73165">Jeto</a></td></tr>
<tr d-ix="18"><td>019</td><td>CJam</td><td>160215T100554Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73157#73157">CJ Denni</a></td></tr>
<tr d-ix="19"><td>046</td><td>Perl 5</td><td>160215T082858Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73152#73152">Sake</a></td></tr>
<tr d-ix="20"><td>017</td><td>Pyth</td><td>160214T205722Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73096#73096">Denker</a></td></tr>
<tr d-ix="21"><td>026</td><td>Julia</td><td>160215T001211Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73117#73117">Alex A.</a></td></tr>
<tr d-ix="22"><td>011</td><td>Jelly</td><td>160215T024242Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73127#73127">Dennis</a></td></tr>
<tr d-ix="23"><td>044</td><td>Mathematica</td><td>160215T015515Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73124#73124">LegionMa</a></td></tr>
<tr d-ix="24"><td>033</td><td>Mathematica</td><td>160215T023752Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73126#73126">njpipeor</a></td></tr>
<tr d-ix="25"><td>035</td><td>Haskell</td><td>160214T231812Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73114#73114">nimi</a></td></tr>
<tr d-ix="26"><td>013</td><td>Pyth</td><td>160214T213200Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73101#73101">Jakube</a></td></tr>
<tr d-ix="27"><td>038</td><td>Python 2</td><td>160214T201120Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73093#73093">Denker</a></td></tr>
<tr d-ix="28"><td>038</td><td>JavaScript ES6</td><td>160214T201650Z</td><td><a href="https://codegolf.stackexchange.com/questions/73091/implement-the-divisibility-by-7-rule/73094#73094">Andreas </a></td></tr>
</table>
<div id="pu0" class="pu"><h1>GCC, x86, No optimization, 30 bytes</h1>
<pre><code>f(i){i=i&lt;70?i:f(i/10-i%10*2);}
</code></pre>
<p><a href="https://tio.run/##S9ZNT07@/z9NI1OzOtM208bcwD7TCsjTNzTQzVQ1NNAy0rSu/Z@ZV6KQm5iZp6GpUM2loFBQBBRI01BSzVTSSdMwNjI3M9fUtOaq/Q8A" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<h3>Written to Read</h3>
<pre><code>apply_seven_division(int i){
    if(i &lt; 70) return i; 
    return apply_seven_division( (i / 10) - (2 * (i % 10)) );
}
</code></pre>
<p>I know using the first parameter as a return is a total hack and is undefined behavior but so is assuming <code>NULL</code> is 0. This is also why I specified GCC, x86, No optimization.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://go.dev" rel="nofollow noreferrer">Go</a>, 82 bytes</h1>
<pre class="lang-go prettyprint-override"><code>func f(n int)int{if n&lt;71{return n}
c:=n/10-n%10*2
if c&gt;70||c%7&gt;0{c=f(c)}
return c}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=TVDRSsMwFMXXfMW1UGjlbjbtXLdhBoK-isy-qUjJmlF0WclSULJ-iS9j4Ef4Kfo1JukQH5JzuDm559z7cVht9l9NyV_KVQXrspakXjcbpYeBWOvgs9ViMPleiFZyEJGEWurYHlMLkJc5NarSrZIgO8JnTJ7TZCBDmpylxAr4PE92Ox7m88RwJiIed-So513f-eck1-9NBQVstWq57SsbrN4a59MR7-oyRTEYorcwY_DwVBhiKNIOLSRIk578sQxp5sgoxVHqSJrQMfq3KU49THFwJI56NU2z0QV6mqX5OMd0YnlHyJ2yUV5lFDDG7ourRWExiInYKHhG7RKpUtrV2XSGlNxXRKSHdpDYLcGVThnooZvKgG8noiBcApuDvaNwGT_KAMF_QafHXh1DZwP894eb22vo_Y_72-97_AU" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/PowerShell/PowerShell" rel="nofollow noreferrer">PowerShell Core</a>, 51 bytes</h1>

<pre class="lang-powershell prettyprint-override"><code>param($a)for(;$a-gt9){$a=($a-($r=$a%10))/10-$r*2}$a
</code></pre>
<p><a href="https://tio.run/##bY9dS8MwGIXv@ytyEaWVFvPVJkEKw6HgleK8G0OyLvuQbh39UGH2t8@361w7WSDQ87wn57zdZl82L5Y2TYMky@0ez@Pdfmtys3ax8eZZ7t5hEyxK7e2wiYEFLs5jbK4o8bxbSgKc37Aam33tOAPXcRAcHw1c6iPqdYqAJP/QBcZBwg3Cjgnmo@aSDjFCozOgfaR7CmRwpg@E93oYF6GPeoQzGUkfMQVGKjouCXQpJQRj8EcS1pXd0B3frxZPm3LCI6W5UIoKKaimhDPOPMhnTdoFP@M0VIJKBf4IzJrAF4WnTZ3kMlQ0lCQKudaR5pwyReESqTQNYR0Cr1nEQs2kVrJpUp7joR/0mOUPJlkGz9MPm5Rod2jGnyatrI@w/d4CtTMUI/zejnJbVGkJ4BrPj8aGH4bjl9GwKsps3aZNBm1cc0ZVktiiaIKOCcFq0xWcfG@2KIemsGAcz7JqmtpJW3JyvP4tcAw6DR56y57l1k69/wU" rel="nofollow noreferrer" title="PowerShell Core – Try It Online">Try it online!</a></p>
<p>There is a chance it can claim the bonuses but I'm not entirely sure of how these work so I'll keep my 52 bytes score.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://uiua.org" rel="nofollow noreferrer">Uiua</a>, 16 bytes</h1>
<pre><code>⍢(⌊-×2⊃◿÷10|&gt;70)
</code></pre>
<p><a href="https://uiua.org/pad?src=0_11_0-dev_1__RiDihpAg4o2iKOKMii3DlzLiioPil7_DtzEwfD43MCkK4oi1RiAxXzEwXzEwMF8xM180Ml8yMDE2XzlfOTlfOTk5OV8xMjM0NV8zMjc2Nwo=" rel="nofollow noreferrer">Try it in the pad!</a></p>
<h2>Explanation</h2>
<pre><code>⍢(         |   ) While
            &gt;70  greater than 70:
      ⊃◿÷10      separate last digit
   -×2           multiply by 2 and subtract
  ⌊              floor because ÷ returns decimals
</code></pre>
</div>
<div id="pu4" class="pu"><h1>C, 56 bytes - 75% = 14</h1>
<p>Although this doesn't give the exact same numbers as the test cases, it satisfies the spirit of the question (and arguably more).  It correctly identifies exact multiples of 7, and gives the exact remainder for other numbers (since it doesn't ever use negative numbers).</p>
<pre class="lang-c prettyprint-override"><code>n;f(char*c){for(n=0;*c;)n-=n&gt;6?7:'0'-n-n-*c++;return n;}
</code></pre>
<p>There is no multiplication or division in the algorithm, only addition and subtraction, and digits are processed in a single pass from left to right.  It works as follows, starting with 0 in the accumulator:</p>
<ol>
<li>Subtract 7 if necessary, and again if still necessary</li>
<li>Multiply the running total by three, and add the next digit</li>
</ol>
<p>The &quot;multiply by three&quot; step is written as <code>n-=-n-n</code> to save a byte and to avoid the multiply operator.</p>
<p>When we hit the end, we don't subtract sevens, so the result will be in the range 0-24; if you want a strict modulus (0-6), substitute <code>*c</code> with <code>*c||n&gt;6</code> in the <code>for</code> loop condition.</p>
<p>It qualifies for the enhanced bonus, because it</p>
<ul>
<li>supports arbitrary-precision integers</li>
<li>performs only one pass on the input, in left-to-right order</li>
<li>has space complexity O(1)</li>
<li>has time complexity O(n).</li>
</ul>
<h2>Test program and results</h2>
<pre class="lang-c prettyprint-override"><code>#include &lt;stdio.h&gt;
int main(int argc, char **argv) {
    while (*++argv)
        printf(&quot;%s -&gt; %d\n&quot;, *argv, f(*argv));
    return 0;
}
</code></pre>
<pre class="lang-none prettyprint-override"><code>540 -&gt; 15
541 -&gt; 16
542 -&gt; 17
543 -&gt; 18
544 -&gt; 19
545 -&gt; 20
546 -&gt; 21
547 -&gt; 22
548 -&gt; 23
549 -&gt; 24
550 -&gt; 18
99 -&gt; 15
999 -&gt; 12
12345 -&gt; 11
32767 -&gt; 7
700168844221 -&gt; 7
36893488147419103232 -&gt; 11
231584178474632390847141970017375815706539969331281128078915168015826259279872 -&gt; 11
</code></pre>
<h2>Alternative version</h2>
<p>Here's one that recurses (you'll want to enable compiler optimizations to do tail-call transformation or you may overflow your stack; I used <code>gcc -std=c89 -O3</code>):</p>
<pre class="lang-c prettyprint-override"><code>f(c,n)char*c;{return n&gt;6?f(c,n-7):*c?f(c+1,n+n+n+*c-'0'):n;}
</code></pre>
<p>Call it with <code>0</code> as the second argument.</p>
<p>Both versions calculate the remainder-modulo-seven of a 60,000 digit number in under 50 milliseconds on my machine.</p>
</div>
<div id="pu5" class="pu"><h1>Google Sheets, 84 bytes</h1>
<pre><code>=LET(n,A1,f,LAMBDA(self,n,IF(n&lt;71,n,self(self,INT(n/10)-(n-INT(n/10)*10)*2))),f(f,n)
</code></pre>
<p>This implements the division-by-7-rule recursively until the output is 70 or less.</p>
<p><strong>Instructions:</strong>  paste the input values into A-column and the formula into B-column</p>
<p>thanks to @doubleunary for the nice <a href="https://stackoverflow.com/questions/75789097/how-to-implement-recursion-in-a-google-sheets-formula">SO post on recursion</a> in Google Sheets</p>
<p>A shorter 77-bytes version <code>=LET(n,A1,f,LAMBDA(self,n,IF(n&lt;71,n,self(self,INT(n/10)-mod(n,10)*2))),f(f,n)</code> works for all values except the two last ones:</p>
<blockquote>
<p><strong>Error</strong> Parameters in MOD caused an out of range error. Namely, the
error occurs when the following is true: (divisor * 1125900000000) is
less than or equal to dividend.</p>
</blockquote>
<h4>The result:</h4>
<p>(Interestingly, the three largest values are smoothly treated in Google Sheets the same way as the smaller ones!)</p>
<p><a href="https://i.stack.imgur.com/V5QfW.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/V5QfW.png" alt="enter image description here" /></a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="nofollow noreferrer">Husk</a>, 13 bytes</h1>
<pre><code>Ω≤70§-ȯD→d÷10
</code></pre>
<p><a href="https://tio.run/##ASIA3f9odXNr///OqeKJpDcwwqctyK9E4oaSZMO3MTD///8yMDE2" rel="nofollow noreferrer" title="Husk – Try It Online">Try it online!</a></p>
<p>Tied with Pyth, using a modified method.</p>
<h2>Explanation</h2>
<pre><code>Ω≤70§-ȯD→d÷10
Ω≤70          until the number is ≤ 70,
    §-        subtract
        →d    the last digit
      ȯD      doubled
          ÷10 from the number floor divided by 10
</code></pre>
</div>
<div id="pu7" class="pu"><h1>PHP, 50 bytes</h1>
<pre><code>for($n=$argv[1];$n&gt;9;)$n=$n/10|0-2*($n%10);echo$n;
</code></pre>
<p>uses alternative output; works up to <code>PHP_INT_MAX</code></p>
<hr />
<p>string version, works for any (positive) number (64 bytes):</p>
<pre><code>for($n=$argv[1];$n&gt;9;)$n=substr($n,0,-1)-2*substr($n,-1);echo$n;
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/DJMcMayhem/Brain-Flak" rel="nofollow">Brain-Flak</a>, <s>368</s> 360 bytes</h1>

<p><a href="http://brain-flak.tryitonline.net/#code=KFsoWyh7fSldPCgoKSk-KV0oPD4pKXsoe30oKSk8Pn17fTw-e317fTw-KCh7fSkpe3t9e308Pig8KCgpKT4pfXt9KHt9PD4pe3t9KCh7fSkpKDwoKCgpKCkoKSgpKCkpe308Pik-KTw-eyh7fVsoKV0pPD4oKHt9KClbKHt9KV0pKXt7fSg8KHt9KHt9KSk-KX17fTw-fXt9PD4oWyhbKFsoKHt9PHt9Pjw-KTwoW3t9XXt9KSg8KCgoKSgpKCkoKSgpKXt9KDw-KSk-KTw-eyh7fVsoKV0pPD4oKHt9KClbKHt9PCh7fSgpKT4pXSkpe3t9KDwoe30oe308KHt9WygpXSk-KSk-KX17fTw-fXt9PD57fXt9KHt9PD4pPil7fV17fSldPCgoKSk-KSg8PildKXsoe30oKSk8Pn17fTw-e317fTw-KCh7fSkpe3t9e308Pig8KCgpKT4pfXt9KHt9PD4pfXt9&amp;input=MjAxNg" rel="nofollow">Try it Online!</a></p>

<pre><code>([([({})]&lt;(())&gt;)](&lt;&gt;)){({}())&lt;&gt;}{}&lt;&gt;{}{}&lt;&gt;(({})){{}{}&lt;&gt;(&lt;(())&gt;)}{}({}&lt;&gt;){{}(({}))(&lt;((()()()()()){}&lt;&gt;)&gt;)&lt;&gt;{({}[()])&lt;&gt;(({}()[({})])){{}(&lt;({}({}))&gt;)}{}&lt;&gt;}{}&lt;&gt;([([([(({}&lt;{}&gt;&lt;&gt;)&lt;([{}]{})(&lt;((()()()()()){}(&lt;&gt;))&gt;)&lt;&gt;{({}[()])&lt;&gt;(({}()[({}&lt;({}())&gt;)])){{}(&lt;({}({}&lt;({}[()])&gt;))&gt;)}{}&lt;&gt;}{}&lt;&gt;{}{}({}&lt;&gt;)&gt;){}]{})]&lt;(())&gt;)(&lt;&gt;)]){({}())&lt;&gt;}{}&lt;&gt;{}{}&lt;&gt;(({})){{}{}&lt;&gt;(&lt;(())&gt;)}{}({}&lt;&gt;)}{}
</code></pre>

<h2>Explanation</h2>

<p>To start off all of the code is in a loop that runs until the top of the stack is less than zero:</p>

<pre><code>([([({})]&lt;(())&gt;)](&lt;&gt;)){({}())&lt;&gt;}{}&lt;&gt;{}{}&lt;&gt;(({})){{}{}&lt;&gt;(&lt;(())&gt;)}{}({}&lt;&gt;)
{{}
 ...
 ([([({})]&lt;(())&gt;)](&lt;&gt;)){({}())&lt;&gt;}{}&lt;&gt;{}{}&lt;&gt;(({})){{}{}&lt;&gt;(&lt;(())&gt;)}{}({}&lt;&gt;)
}{}
</code></pre>

<p>Inside of the loop we run the divisible by seven algorithm:</p>

<p>Duplicate the top of the stack</p>

<pre><code>(({}))
</code></pre>

<p>Take the mod 10 of the top of the stack (last digit)</p>

<pre><code>(&lt;((()()()()()){}&lt;&gt;)&gt;)&lt;&gt;{({}[()])&lt;&gt;(({}()[({})])){{}(&lt;({}({}))&gt;)}{}&lt;&gt;}{}&lt;&gt;({}&lt;{}&gt;&lt;&gt;)
</code></pre>

<p>This is a bit of a mess but it does the rest of the algorithm I might explain it later but I don't entirely remember how it works:</p>

<pre><code>([(({})&lt;([{}]{})(&lt;((()()()()()){}(&lt;&gt;))&gt;)&lt;&gt;{({}[()])&lt;&gt;(({}()[({}&lt;({}())&gt;)])){{}(&lt;({}({}&lt;({}[()])&gt;))&gt;)}{}&lt;&gt;}{}&lt;&gt;{}{}({}&lt;&gt;)&gt;){}]{})
</code></pre>
</div>
<div id="pu9" class="pu"><h2>C#, <s>111</s> 104 bytes</h2>

<pre><code>int d(int n){var s=""+n;return n&lt;71?n:d(int.Parse(s.Remove(s.Length-1))-int.Parse(""+s[s.Length-1])*2);}
</code></pre>
</div>
<div id="pu10" class="pu"><h2>Java, 133 bytes</h2>

<pre><code>int d(int n){String s=""+n;return n&lt;71?n:d(Integer.parseInt(s.replaceFirst(".$",""))-Integer.parseInt(""+s.charAt(s.length()-1))*2);}
</code></pre>

<p>I hate how verbose <code>Integer.parseInt</code> is. Ungolfed:</p>

<pre><code>static int div(int n) {
    if (n &lt;= 70) {
        return n;
    } else {
        String num = ("" + n);
        int last = Integer.parseInt("" + num.charAt(num.length() - 1));
        int k = Integer.parseInt(num.replaceFirst(".$", "")) - last * 2;
        return div(k);
    }
}
</code></pre>
</div>
<div id="pu11" class="pu"><h1>R, 43 bytes</h1>

<pre><code>x=scan();while(x&gt;70)x=floor(x/10)-x%%10*2;x
</code></pre>

<p>Explanation:</p>

<pre><code>x=scan()                                      # Takes input as a double
        ;                                     # Next line
         while(x&gt;70)                          # While-loop that runs as long x &gt; 70
                      floor(x/10)             # Divide x by 10 and round that down
                                 -x%%10*2     # Substract twice the last integer
                    x=                        # Update x
                                         ;    # Next line once x &lt;= 70
                                          x   # Print x
</code></pre>

<p>Sample runs:</p>

<pre><code>&gt; x=scan();while(x&gt;70)x=floor(x/10)-x%%10*2;x
1: 9999
2: 
Read 1 item
[1] -3

&gt; x=scan();while(x&gt;70)x=floor(x/10)-x%%10*2;x
1: 32767
2: 
Read 1 item
[1] 28
</code></pre>
</div>
<div id="pu12" class="pu"><h1>GNU dc, <s>20</s> 15 bytes</h1>
<pre><code>[10~2*-d70&lt;F]sF
</code></pre>
<p>This defines my first (ever) dc function, <code>F</code>.  It takes input on the top of stack, and leaves its output at top of stack.  Example usage:</p>
<pre><code>36893488147419103232
lFxp
32
</code></pre>
</div>
<div id="pu13" class="pu"><h1>Haskell, <s>157</s> <s>192</s> <s>184</s> <s>167</s> <s>159</s> <s>147</s> 138+5 bytes - 50% = 71.5 bytes</h1>

<p><strong>O(1) space, O(n) time, single-pass!</strong></p>

<pre class="lang-hs prettyprint-override"><code>h d=d%mod d 10
d%r=(quot(r-d)10,r)
p![d]=d-p*10
p![d,e]=d#(e-p)
p!(d:e:f)|(b,a)&lt;-quotRem(2*d)10,(q,r)&lt;-h$e-a-p=(b+q)!(r:f)
m#0=m
m#n=n-2*m
(0!)
</code></pre>

<p>Use as <code>0![6,1,0,2]</code> to apply the rule to 2016, i.e. pass it a number in stream form with least significant figure first. In this way, it will pass over the number digit by digit, applying the rule with O(1) space complexity.</p>

<p>The ungolfed code is here:</p>

<pre class="lang-hs prettyprint-override"><code>import Data.Char

{- sub a b = sub2 0 a b
  where
    sub2 borrow (a:as) (b:bs) = res : sub2 borrow2 as bs
      where
        (borrow2, res) = subDig borrow a b
    sub2 borrow (a:as) [] = sub2 borrow (a:as) (0:[])
    sub2 _ [] _ = [] -}

--subDig :: Int -&gt; Int -&gt; Int -&gt; (Int, Int)
subDig borrow a b = subDig2 (a - b - borrow)
  where
    subDig2 d = subDig3 d (d `mod` 10)
    subDig3 d r = ((r-d) `quot` 10, r)

seven ds = seven2 0 ds
seven2 borrow (d:e:f:gs) = seven2 (b + borrow2) (res:f:gs)
  where
    (a, b) = double d
    (borrow2, res) = subDig borrow e a
seven2 borrow (d:e:[]) = finalApp d (e-borrow)
seven2 borrow (d:[]) = d - borrow*10

double d = ((2*d) `mod` 10, (2*d) `quot` 10)

finalApp m 0 = m
finalApp m n = n - 2*m

num2stream :: Int -&gt; [Int]
num2stream = reverse . map digitToInt . show
sev = seven . num2stream
</code></pre>

<p>The gist of how this works is that it implements a <a href="https://en.wikipedia.org/wiki/Subtraction#In_America" rel="nofollow">digit-by-digit subtraction algorithm</a>, but takes advantage of the fact that each number to be subtracted is at most 2-digits, and so we can subtract an arbitrary amount of these 1-or-2 digit numbers from the main one (as well as eating the least significant digits).</p>

<p>The subtraction algorithm is O(1) and only stores the current 'borrow' value. I altered this to add in the extra digit (either 0 or 1), and we note that this borrow value is bounded (within the range [-2,2] so we need only 3 bits to store this).</p>

<p>The other values stored in memory are temporary variables representing the current 2-digit number to add, a single look-ahead in the stream, and to apply one step of the subtraction algorithm (i.e. it takes two digits and a borrow value, and returns one digit and a new borrow value).</p>

<p>Finally at the end it processes the last two digits in the stream at once to return a single-digit number rather than a list of digits.</p>

<p>N.B. The <code>sev</code> function in the ungolfed version will work on an <code>Integer</code>, converting it into the reversed stream form.</p>
</div>
<div id="pu14" class="pu"><h1>Golfscript, <s>27</s> 22 bytes</h1>

<pre><code>{.9&gt;{.10/\10%2*-f}*}:f
</code></pre>

<p>You can use it this way:</p>

<pre><code>1000f
</code></pre>

<h2>Explanation</h2>

<pre><code>{.9&gt;{.10/\10%2*-f}*}:f
{                  }:f    # Define block 'f' (similar to a function)
 .                        # Duplicate the first value of the stack
  9&gt;{            }*       # If the value on top of the stack is greater than 9 then the block is executed
     .10/\10%2*-          # Same as nb/10 - (nb%10 * 2) with some stack manipulations '.' to duplicate the top of the stack and '\' to swap the the first and second element of the stack
                f         # Execute block 'f'
</code></pre>

<p>5 bytes saved thanks to Dennis !</p>
</div>
<div id="pu15" class="pu"><h1>JavaScript ES6, <s>140</s> 142 bytes</h1>

<pre><code>f=s=&gt;s&gt;9?eval("t=s.replace(/.$/,'-$&amp;*2');for(i=-1;0&gt;(n=eval(u=t[c='slice'](i-4)))&amp;&amp;u!=t;i--);n&lt;0?n:f(t[c](0,i-4)+('0'.repeat(-i)+n)[c](i))"):s
</code></pre>

<p>This is true arbitrary-precision math, even works on the largest test-case.</p>

<p>This function recursively removes the last digit from the string, then subtracts 2 * the last digit from the remaining numerical string by iteratively incrementing the amount of digits to apply to the minuend until the difference is positive. Then it appends that difference to the end of the string with appropriately padded <code>0</code>s and calls itself recursively until its numerical value is less than or equal to <code>9</code>.</p>

<ul>
<li>Golfed 7 bytes thanks to @Neil (yes I know I gained 2 bytes but I fixed a few bugs that caused the function to freeze or return wrong output for some cases).</li>
</ul>

<p><div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>f=s=&gt;s&gt;9?eval("t=s.replace(/.$/,'-$&amp;*2');for(i=-1;0&gt;(n=eval(u=t[c='slice'](i-4)))&amp;&amp;u!=t;i--);n&lt;0?n:f(t[c](0,i-4)+('0'.repeat(-i)+n)[c](i))"):s;[['1',1],['10',1],['100',1],['13',-5],['42',0],['2016',0],['9',9],['99',-9],['9999',-3],['12345',3],['700168844221',7],['36893488147419103232',-1],['231584178474632390847141970017375815706539969331281128078915168015826259279872',8]].map(a=&gt;document.write(`&lt;pre&gt;${f(a[0])==a[1]?'PASS':'FAIL'} ${a[0]}=&gt;${a[1]}&lt;/pre&gt;`))</code></pre>
</div>
</div>
</p>
</div>
<div id="pu16" class="pu"><h2>ES6, 108 bytes</h2>

<pre><code>f=(s,n=0)=&gt;s&gt;1e9?f(s.slice(0,-1),((1+s.slice(-1)-n%10)%10*21+n-s.slice(-1))/10):s&gt;9?f(((s-=n)-s%10*21)/10):s
</code></pre>

<p>Works for 2²⁵⁷ and 1000000000000000000001, but could use further golfing.</p>
</div>
<div id="pu17" class="pu"><h1>Oracle SQL 11.2, 116 bytes</h1>
<pre><code>WITH v(i)AS(SELECT:1 FROM DUAL UNION ALL SELECT TRUNC(i/10)-(i-TRUNC(i,-1))*2 FROM v WHERE i&gt;70)SELECT MIN(i)FROM v;
</code></pre>
<p>Un-golfed</p>
<pre><code>WITH v(i) AS
(
  SELECT :1 FROM DUAL
  UNION ALL
  SELECT TRUNC(i/10)-(i-TRUNC(i,-1))*2 FROM v WHERE i&gt;70
)
SELECT MIN(i) FROM v;
</code></pre>
</div>
<div id="pu18" class="pu"><h2>CJam - 19 bytes</h2>

<p>Do-while version:</p>

<pre><code>r~A*{`)]:~~Y*-_9&gt;}g
</code></pre>

<p><a href="http://cjam.aditsu.net/#code=r~A*%7B%60)%5D%3A~~Y*-_9%3E%7Dg&amp;input=231584178474632390847141970017375815706539969331281128078915168015826259279872" rel="nofollow">Try it online</a> or While version #1:</p>

<pre><code>r~{_9&gt;}{`)]:~~Y*-}w
</code></pre>

<p><a href="http://cjam.aditsu.net/#code=r~%7B_9%3E%7D%7B%60)%5D%3A~~Y*-%7Dw&amp;input=231584178474632390847141970017375815706539969331281128078915168015826259279872" rel="nofollow">Try it online</a> or While version #2:</p>

<pre><code>r~{_9&gt;}{_A/\A%Y*-}w
</code></pre>

<p><a href="http://cjam.aditsu.net/#code=r~%7B_9%3E%7D%7B_A%2F%5CA%25Y*-%7Dw&amp;input=231584178474632390847141970017375815706539969331281128078915168015826259279872" rel="nofollow">Try it online</a>.</p>

<pre><code>r~                     | Read and convert input
  A*                   | Multiply by 10 to get around "if" rule
     `                 | Stringify
      )                | Split last character off
       ]               | Convert stack to array
        :~             | Foreach in array convert to value
          ~            | Dump array
           Y*          | Multiply by 2
             -         | Subtract
              _        | Duplicate
               9&gt;      | Greater than 9?
    {            }g    | do-while
</code></pre>
</div>
<div id="pu19" class="pu"><h2>Perl 5, <s>47</s> 46 bytes</h2>
<p>Had to use <code>bigint</code>for the last test case. (It returns 20 without)</p>
<pre><code>use bigint;$_=&lt;&gt;;while($_&gt;9){$_-=2*chop;}print
</code></pre>
<p>Not really sure it's a candidate for the bonus, so I didn't take it into account. (I think it does, but I'm not really accustomed to the concepts)</p>
<p><a href="https://ideone.com/zd6hCN" rel="nofollow noreferrer">Try it here!</a></p>
</div>
<div id="pu20" class="pu"><h1>Pyth, 17 bytes</h1>
<pre><code>L?&lt;b70by-/bT*%bT2
</code></pre>
<p><a href="http://pyth.herokuapp.com/?code=L%3F%3Cb70by-%2FbT*%25bT2yQ&amp;input=700168844221&amp;test_suite=1&amp;test_suite_input=1%0A10%0A100%0A13%0A42%0A2016%0A9%0A99%0A9999%0A12345%0A700168844221%0A36893488147419103232&amp;debug=0" rel="nofollow noreferrer">Try it here!</a></p>
<p>Same recursive approach as in my <a href="https://codegolf.stackexchange.com/a/73093/49110">python answer</a>. Defines a lambda <code>y</code> which is called like this: <code>y12345</code>.<br />
The byte counter in the online interpreter shows 19 bytes because I added the lambda call to it, so you can just try it by hitting the run-button.</p>
<h2>Explanation</h2>
<pre><code>L?&lt;b70by-/bT*%bT2

L                  # Defines the lambda y with the parameter b
 ?&lt;b70             # if b &lt; 70:
      b            # return b, else:
       -/bT*%bT2   # calculate b/10 - b%10*2 and return it
</code></pre>
</div>
<div id="pu21" class="pu"><h1>Julia, <s>27</s> 26 bytes</h1>



<pre class="lang-default prettyprint-override"><code>f(x)=x&gt;9?f(x÷10-x%10*2):x
</code></pre>

<p>This is a recursive function that accepts an integer and returns a <code>BigInt</code>. If the input is a large number like in the last example, Julia parses it as a <code>BigInt</code>, so no manual conversion is necessary.</p>

<p>The approach is just a straightforward implementation of the algorithm. It will produce the alternate outputs. Taking the modulus when dividing by 10 yields the last digit and the quotient from integer division by 10 yields everything but the last digit.</p>

<p>Saved a byte thanks to Dennis!</p>
</div>
<div id="pu22" class="pu"><h1>Jelly, 11 bytes</h1>

<pre><code>d⁵Uḅ-2µ&gt;9$¿
</code></pre>

<p><a href="http://jelly.tryitonline.net/#code=ZOKBtVXhuIUtMsK1Pjkkwr8&amp;input=&amp;args=MjMxNTg0MTc4NDc0NjMyMzkwODQ3MTQxOTcwMDE3Mzc1ODE1NzA2NTM5OTY5MzMxMjgxMTI4MDc4OTE1MTY4MDE1ODI2MjU5Mjc5ODcy">Try it online!</a></p>

<h3>How it works</h3>

<pre><code>d⁵Uḅ-2µ&gt;9$¿  Main link. Input: n

d⁵           Divmod; return [n : 10, n % 10].
  U          Upend; yield [n % 10, n : 10].
   ḅ-2       Convert from base -2 to integer, i.e., yield -2 × (n % 10) + (n : 10).

      µ      Push the previous chain as a link and begin a new, monadic chain.
          ¿  Apply the previous chain while...
       &gt;9$     its return value is greater than 9.
</code></pre>
</div>
<div id="pu23" class="pu"><h1>Mathematica, <s>47</s> 44 bytes</h1>

<pre><code>If[#&gt;70,#0[{1,-2}.{⌊#/10⌋,#~Mod~10}],#]&amp;
</code></pre>

<p>Simple recursive approach. Could probably be golfed further.</p>
</div>
<div id="pu24" class="pu"><h1>Mathematica, 33 bytes</h1>

<pre><code>#//.a_/;a&gt;70:&gt;⌊a/10⌋-2a~Mod~10&amp;
</code></pre>

<p><strong>Test case</strong></p>

<pre><code>%[9999]
(* -3 *)
</code></pre>
</div>
<div id="pu25" class="pu"><h2>Haskell, 35 bytes</h2>

<pre><code>until(&lt;71)(\n-&gt;div n 10-2*mod n 10)
</code></pre>

<p>Usage example: <code>until(&lt;71)(\n-&gt;div n 10-2*mod n 10) 36893488147419103232</code> -> <code>32</code>.</p>

<p>Nothing much to explain, it's a direct implementation of the algorithm.</p>
</div>
<div id="pu26" class="pu"><h1>Pyth, 13 bytes</h1>

<pre><code>.W&gt;H9-/ZTyeZQ
</code></pre>

<p>Try it online: <a href="http://pyth.herokuapp.com/?code=.W%3EH9-%2FZTyeZQ&amp;input=36893488147419103232&amp;test_suite_input=1%0A10%0A100%0A13%0A42%0A2016%0A9%0A99%0A9999%0A12345%0A700168844221%0A36893488147419103232&amp;debug=0">Demonstration</a> or <a href="http://pyth.herokuapp.com/?code=.W%3EH9-%2FZTyeZQ&amp;input=36893488147419103232&amp;test_suite=1&amp;test_suite_input=1%0A10%0A100%0A13%0A42%0A2016%0A9%0A99%0A9999%0A12345%0A700168844221%0A36893488147419103232&amp;debug=0">Test Suite</a></p>

<p>This will print all the alternative answers. </p>

<h3>Explanation:</h3>

<pre><code>.W&gt;H9-/ZTyeZQ   
            Q   read a number from input
.W              while
  &gt;H9              the number is greater than 9
                do the following with the number:
      /ZT          divide it by 10
     -             and subtract
         yeZ       2*(number%10)
</code></pre>
</div>
<div id="pu27" class="pu"><h1>Python 2, 38 bytes</h1>
<pre><code>f=lambda x:f(x/10-x%10*2)if x&gt;70else x
</code></pre>
<p><a href="https://repl.it/Bmip/3" rel="nofollow noreferrer">Try it here</a>!</p>
<p>Simple recursive approach. Prints x if its &lt; 70 otherwise applies the divisibility rule and calls itself with the result.</p>
</div>
<div id="pu28" class="pu"><h2><del>JavaScript ES6, 38 bytes</del></h2>

<pre><code>a=i=&gt;i&gt;70?a(Math.floor(i/10)-i%10*2):i
</code></pre>

<p>Fails with <code>36893488147419103232</code> and using <code>~~(1/10)</code> will also fail for <code>700168844221</code></p>

<p>Test:</p>

<p><div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>a=i=&gt;i&gt;70?a(Math.floor(i/10)-i%10*2):i
O.textContent = O.textContent.replace(/(-?\d+) +(-?\d+)/g, (_,i,o) =&gt;
  _+": "+(a(+i)==o?"OK":"Fail")
);</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;pre id=O&gt;1                       1
10                      10
100                     10
13                      13
42                      42
2016                    0
9                       9
99                      -9
9999                    -3
12345                   3
700168844221            70
36893488147419103232    32&lt;/pre&gt;</code></pre>
</div>
</div>
</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/73091/">73091</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




