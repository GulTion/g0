<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::6979</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>133</td><td>Python 3</td><td>240626T074210Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/273814#273814">Jitse</a></td></tr>
<tr d-ix="1"><td>nan</td><td>Python 3</td><td>240627T195242Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/273827#273827">Keegan C</a></td></tr>
<tr d-ix="2"><td>nan</td><td>Python 2</td><td>170809T015008Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/138164#138164">Solvatio</a></td></tr>
<tr d-ix="3"><td>225</td><td>Python 2</td><td>170804T093730Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/137522#137522">Keerthan</a></td></tr>
<tr d-ix="4"><td>158</td><td>JavaScript</td><td>170408T204209Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/115883#115883">Neil</a></td></tr>
<tr d-ix="5"><td>233</td><td>Python 2</td><td>170325T224658Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/113891#113891">Dead Pos</a></td></tr>
<tr d-ix="6"><td>100</td><td>Perl 5</td><td>170325T193512Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/113883#113883">Dada</a></td></tr>
<tr d-ix="7"><td>048</td><td>Mathematica</td><td>120813T214432Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/6980#6980">DavidC</a></td></tr>
<tr d-ix="8"><td>169</td><td>C</td><td>120820T145004Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/7032#7032">schnaade</a></td></tr>
<tr d-ix="9"><td>110</td><td>Ruby 1.9 134 121 113</td><td>120814T021917Z</td><td><a href="https://codegolf.stackexchange.com/questions/6979/code-golf-count-islands/6982#6982">Paul Pre</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 133 bytes</h1>

<pre class="lang-python prettyprint-override"><code>I,*g=input(),
w=i=I.find(',')
for c in I:
 q={k for k in g if{i-1,i,i+1,i+w}&amp;{*k}};i+=1
 if','&gt;c:g={*g,sum(q,(i+w,))}-q
print(len(g))
</code></pre>
<p><a href="https://tio.run/##TYzNDsIgEITvPAUnC9stSeOtBu99jmpxU6X/aQzh2REOqHOYfJmZzPTeHqM9h9AiGE122jchkR2adKt6sjdRYCFZPy6842R52zA@azfwlAwpMZx6R1WNhFRGLw9/cjB4f6FS1yy28eHaNUY7MLjuLzGjiCuU0lczmxaym3jerTBShqCyABAgI6D6KTFkhu/@jxV8AA" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>Takes a comma-separated grid on a single line as input</p>
</div>
<div id="pu1" class="pu"><h1>Python 3, <strike>257</strike> <strike>185</strike> <strike>165</strike> <strike>144 bytes</strike></h1>
<p><strong>EDIT Currently doesn't work with forked islands</strong>
Thanks to Jitse for help I learned a bunch but this binary solution seems to have a fatal flaw.</p>
<p>I looked at this and thought I could solve it close to the optimal by looking at it as a binary addition problem and using bit shifting. Yikes I was wrong. The answer I paste can prob be minimized a bit more but no where near the current python 3 record of 136. Either way I figure someone would get a kick out of this mess.</p>
<p>EDIT - Big thanks to Noodle Person and Jitse for the push to look a bit deeper at this. With some tweaks I got it down to 185! Jitse for another update which trimmed this down even more!</p>
<pre><code>import re
q=input().split(',')
q+='0'
t=0
for o,p in zip(q,q[1]):o=int(o,2);p=int(p,2);t+=len(re.findall('(1+)',bin(o&amp;~(p|p&gt;&gt;1|p&lt;&lt;1))))
print(t)
</code></pre>
<p><a href="https://tio.run/##TYvBDsIgEETvfEVPsqSkYfWmpT9iPGhsIwnCgnjQNP46tqixc5idN9mhR7p4t8nZXMnHVMWeBW0c3ROI5kbWJOCSCxZqzRVnSSs2@Fh5SZVx1dMQBBn2eBBbP80SeLkWOyqR5phqbXsHsW8G485Ha4ED1oLLk3HgVy@gkboOR2pbFJMYxXmbRM6qCBGLywXiHxWWK79vn7bgL0/lAuf1Gw" rel="nofollow noreferrer">Try it</a></p>
<p><a href="https://tio.run/##lVXbbts4EH33VwxSIJIaxaC0b0Gcp2YvwGIfFn0o0AYGbdEWW5oUSKreIG1@PXt4kS/N7gIrBDE5Gp6Zc2aGGh59b/RPLy9yNxjryYqZ1MPolXR@EVdlNXeDkr4s6qKaveFd54jTRmquyJo9mQ1xpYi548E5Hwahu/LiYv7ZSF0WrNgYS5KkJsv1VpRK6PLg/pE9VHhmg5XaH83VbDbrxIbkEljLtRnxUjW1aqubGeF5s@@5J99LR50RLtmoVO3dXVPl3Up6cr3ceEeqpQhNf/72y6/vqeysGQapt2Tltve0Mw6uhhrGWMNoJdZmJxwt4x6pHNDp9paaii6pbN@@DTxWYKia6mN781BdN9U/hPa9yLF/v//5fR32mriGkPDxBssoYZMfF2whvXhQiU3ODogZW/yFPOFJezOqLiebTCF1iC0IogV2gGIRNayyY/TLUENsgKigLjz1/KtAeW9B0gzCco@67Xu57nMoF96HtP6Df0aGlxOBZvQ3kDn2DBTkNtoLgVdmK/DahuwGa7pxHcLvuPuCUyjvXiqV8XbcI43QSJ3kWwMsByFyLxDFurEDr8u8PdknS94vWJKlIfSPGW2KmZt5CkBro7VYe2m0m2g9o5Rfhc1ljaeywtD@@i42EDvGiSVs6PI5emaKLpTcjD60BEIarR5DdR2kFtBGBdF67uj@j3f37@j@Q8YCTnyaGKOZQkDR@PygAMyBB01Ej@bnI8hBnwWdYjNGt7QX9EVjwoNEMSW0FEqGIQ6kNtK6WF2HpsJP6M6MZcXcjavSFuW8@tRcFbUtPjVFnVCWEWUZ5KgO/oPiQRUArUdrhfaEKdhL36MZHNpYobvjdE7ZTfN5TgIZr7lO8/V5xMjEWyOmq8fdCm0GtYGcKThvw4iElurBc8f1Y6bqEtd5YvQqcaiFs7nzUdtwL3zLN8@3wx1x@W8Tku@IdN9tioUSN0@vYgTv70XytCJ0TYew/0/aHOGCwHFEjZ4y0DzdpkVTVN9PGUONiymiH62m8vUBzHeOFm0LNvvhbmf12e0eGKchhVQLOt768iFZ23PrVfNwpg6O3TypZpJiMl@rFuZ2Mp@mRFeLs4@GTB@OtqrjqsUKJPLX5uRc9fKSRigOVz31GkanPtgZO1tn5/CX1unf3w" rel="nofollow noreferrer">Check out a version with comments</a></p>
</div>
<div id="pu2" class="pu"><h1>Python 2, <del>223</del> 203 Bytes</h1>

<p>Thank you to <a href="https://codegolf.stackexchange.com/users/65836/step-hen">Step Hen</a> and <a href="https://codegolf.stackexchange.com/users/72137/arnold-palmer">Arnold Palmer</a> for shaving off 20 characters of spaces and unnecessary parenthesis!</p>



<pre class="lang-python prettyprint-override"><code>s=input()
c=[(s.index(l),i)for l in s for i,v in enumerate(l)if'*'==v]
n=[set([d for d in c if-2&lt;d[0]-v[0]&lt;2and-2&lt;d[1]-v[1]&lt;2])for v in c]
f=lambda x,p=0:p if x&amp;n[p]else f(x,p+1)
print len(set(map(f,n)))
</code></pre>

<p>I thought that using list comprehensions might decrease the number of bytes, but it didn't provide any significant improvement.</p>

<p><a href="https://tio.run/##VY3NbsMgEITvfoo9hZ8SK/YxCk@COFADKhLeIEMs9@ldcJRE3cNqv9HMTvotP3cc9z3LgOlRKOsmqWjuA1q30chEYP6@QISAkKGdQawNHD5mt5jiqil4womUq@5QquwKVfaw2macIPjzeLPqos9rXbfRoD2EoQlDFfTRcbyddOdlNPO3NbCJJC/XVPOwnVAl7WJ24GnVvwbWpSVggeiQtsrZJOoFMsb2XZH@NZwTQTh/QaP@M0/iH@Lv3D/qOdF/" rel="nofollow noreferrer">Try it here.</a></p>

<p>I keep trying to trim it around the n (neighbors) list, but I haven't been successful. Maybe someone else will have some ideas for that section.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, 225 bytes</h1>



<pre class="lang-python prettyprint-override"><code>g=map(list,input())
q,w,t,r=len(g),len(g[0]),0,range
def l(i,j):
 if 0&lt;=i&lt;q and 0&lt;=j&lt;w and g[i][j]=='1':g[i][j]=0;l(i+1,j);l(i-1,j);l(i,j+1);l(i,j-1)
 return 1
print sum(l(i,j)if g[i][j]=='1'else 0 for j in r(w)for i in r(q))
</code></pre>

<p><a href="https://tio.run/##ZY3BjoMwDETv@QqLS2PVlew9dsmXIA5IDWwimkIIQvv1LIEiVVpf/Maj8Qy/6ecVvta1M89m0L2bErkwzEkjqpEWShRNb4PukPZVcY3EFJvQWfWwLfTakce7AtcCl8aVIzThkdGXy45d5erK18Zc5HI/BX9vwats0Qy3E8hf5Q03QQXRpjkGEDVEFxJM81MfhVvb51/bTxYY2lcEDy5A1Atm4Q4xIq5rVYgIs0hBxQGZ@JhM2@105b/Le7qo/wA" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h2>JavaScript, 158 bytes</h2>

<pre><code>function f(s){w=s.search('\n');t=s.replace(RegExp('([*@])([^]{'+w+','+(w+2)+'})?(?!\\1)[*@]'),'@$2@');return t!=s?f(t):/\*/.test(s)?f(s.replace('*','@'))+1:0}
</code></pre>

<p>Noncompeting ES6 answer (language postdates challenge) for 132 bytes:</p>

<pre><code>f=s=&gt;s!=(s=s.replace(RegExp(`([*@])([^]{${w=s.search`
`},${w+2}})?(?!\\1)[*@]`),`@$2@`))?f(s):/\*/.test(s)?f(s.replace(`*`,`@`))+1:0
</code></pre>

<p>Port of my answer to <a href="https://codegolf.stackexchange.com/questions/113764/how-many-holes">How Many Holes?</a> (yes I'm jumping on the bandwagon, now that I've seen two other people port their answers).</p>
</div>
<div id="pu5" class="pu"><h2>Python 2, 233 bytes</h2>

<p>Too long, compared to other answers. Port of my answer to <a href="https://codegolf.stackexchange.com/questions/113764/how-many-holes">this question</a>.<br>
<a href="https://tio.run/nexus/python2#nU9BboMwELz7FZaiymuzUFBvUB8QX8iByPIhIkS1FCzUJqrpoV@npklbUqGGctjR7MzOrrbPpbHt6QicVDImpTzUFnIVax4mZHPuBrqr97SANU8JddjJNaFmT3PVaeX0I4tYeuHS86zZtlDgm2nBK@IhUI2x4IIES35utw5cmGA8tKg6HPzO@xuOg9d9eZyT1ydzqJlgxtKXUwM5Ks1TI795ZOyuduAneFYFMskKAHMXvpdo7j36De2zsUda9Sul2IrhqDT@KPRKoZMzF0X3flPEkM4GMWo1UqpG8r/gM64mts6F4Z1f4VsXr29Ppm/9/HdaTIzPuh0tvS2W/r0EtP4A" rel="nofollow noreferrer">Try it online</a></p>

<pre><code>A=input()
c=0
X=len(A[0])-1
Y=len(A)-1
def C(T):
 x,y=T
 if A[y][x]&lt;'.':A[y][x]='.';map(C,zip([x]*3+[min(x+1,X)]*3+[max(x-1,0)]*3,[y,min(y+1,Y),max(y-1,0)]*3))
while'*'in sum(A,[]):i=sum(A,[]).index('*');c+=1;C((i%-~X,i/-~X))
print c
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>, 100 bytes</h1>

<p>98 bytes of code + 2 bytes for <code>-p0</code> flags.</p>



<pre class="lang-perl prettyprint-override"><code>/.*/;$@="@+"-1;$~="(.?.?.{$@})?";(s/X$~\*/X$1X/s||s/\*$~X/X$1X/s)&amp;&amp;redo;s/\*/X/&amp;&amp;++$\&amp;&amp;redo}{$\|=0
</code></pre>

<p><a href="https://tio.run/nexus/perl5#TYrBDoMgGIPvPsXG/hAtkV/PhMhjcOA4b0tm5Cjy6kyzsa1Nmq9Nb9dlXh@XfhkKa7AhZ4VToh8NZStaPR3eyO3dJEwb2VMOOHL0HFOKHEDZf3on5Trfn@Zc2bOUSlF4b/tGIdmhFF0FNEBFNPqnk1EZ3/8fa7wA" rel="nofollow noreferrer" title="Perl 5 – TIO Nexus">Try it online!</a></p>

<p>An adaptation (or rather a simplification) of my <a href="https://codegolf.stackexchange.com/a/113778/55508">answer</a> to the challenge <a href="https://codegolf.stackexchange.com/questions/113764/how-many-holes">How Many Holes?</a>. You can find explanations of how this code works on this other answer (it's a bit long to explain, so I prefer not to retype the entire explanations).</p>
</div>
<div id="pu7" class="pu"><h1>Mathematica <strike>188 185 170 115 130 46</strike> 48 chars</h1>
<p><strong>Explanation</strong></p>
<p>In earlier versions, I made a graph of positions having a chessboard distance of 1 from each other.  <code>GraphComponents</code> then revealed the number of islands, one per component.</p>
<p>The present version uses <code>MorphologicalComponents</code> to find and number clusters of ones in the array--regions where <code>1</code>'s are physically contiguous. Because graphing is unnecessary, this results in a huge economy of code.</p>
<hr />
<p><strong>Code</strong></p>
<pre><code>Max@MorphologicalComponents[#/.{&quot;.&quot;-&gt;0,&quot;*&quot;-&gt;1}]&amp;
</code></pre>
<hr />
<h2>Example</h2>
<pre><code>Max@MorphologicalComponents[#/.{&quot;.&quot;-&gt;0,&quot;*&quot;-&gt;1}]&amp;[{{&quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;*&quot;}, {&quot;*&quot;, &quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;*&quot;, &quot;*&quot;}, {&quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;}, {&quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;}, {&quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;.&quot;}, {&quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;}}]
</code></pre>
<p>5</p>
<hr />
<p><strong>How it works</strong></p>
<p>Data are input as an array; in Mathematica, this is a list of lists.</p>
<p>In the input array, data are converted to <code>1</code>'s and <code>0</code>'s by the replacement</p>
<pre><code>/.{&quot;.&quot;-&gt;0,&quot;*&quot;-&gt;1}
</code></pre>
<p>where <code>/.</code> is an infix form of <code>ReplaceAll</code> followed by replacement rules. This essentially converts the array into a black and white image.  All we need to do is apply the function, <code>Image</code>.</p>
<pre><code>Image[{{&quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;*&quot;}, {&quot;*&quot;, &quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;*&quot;, &quot;*&quot;}, {&quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;}, {&quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;}, {&quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;, &quot;.&quot;}, {&quot;*&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;.&quot;, &quot;*&quot;}} /. {&quot;.&quot; -&gt; 0, &quot;*&quot; -&gt; 1}]
</code></pre>
<p><a href="https://i.sstatic.net/8Gp45.png" rel="noreferrer"><img src="https://i.sstatic.net/8Gp45.png" alt="islands" /></a></p>
<p>The white squares correspond to the cells having the value, 1.</p>
<p>The picture below shows a some steps the approach uses. The input matrix contains only <code>1</code>'s and <code>0</code>'s.   The output matrix labels each morphological cluster with a number.  (I wrapped both the input and output matrices in <code>MatrixForm</code> to highlight their two dimensional structure.)</p>
<p><code>MorphologicalComponents</code> replaces <code>1</code>s with an integer corresponding to the cluster number of each cell.</p>
<p><img src="https://i.sstatic.net/nyNg4.png" alt="processing" /></p>
<p><code>Max</code> returns the largest cluster number.</p>
<hr />
<p><strong>Displaying the Islands</strong></p>
<p><code>Colorize</code> will color each island uniquely.</p>
<p><img src="https://i.sstatic.net/rRhU6.png" alt="colorize" /></p>
</div>
<div id="pu8" class="pu"><h2>C, 169 chars</h2>

<p>Reads map from stdin. Had no luck improving the recursive flood-fill function <code>r(j)</code> although it looks like it could be.</p>

<pre><code>c,g,x,w;char m[9999];r(j){if(m[j]==42)m[j]=c,r(j+1),r(j+w-1),r(j+w),r(j+w+1),c+=j==g;}main(){while((m[x++]=g=getchar())+1)w=g&lt;11*!w?x:w;for(;g++&lt;x;)r(g);printf("%i",c);}
</code></pre>
</div>
<div id="pu9" class="pu"><h2>Ruby 1.9 (<del>134</del> <del>121</del> <del>113</del> 110)</h2>

<p>Takes the map on stdin or the file name of the map as the first command-line argument, and prints the number of islands to stdout.  Using a basic recursive flood-fill.  Improvements welcome as always!</p>

<pre class="lang-ruby prettyprint-override"><code>c=0
gets$!
c+=1while(f=-&gt;i{9.times{|o|$_[i]=?.;f[o]if$_[o=i+(o/3-1)*(~/$/+1)+o%3-1]==?*&amp;&amp;o&gt;0}if i})[~/\*/]
p c
</code></pre>

<p>Similar to David's colorize, you can also get it to display the different islands by changing <code>$_[i]=?.</code> to <code>$_[i]=c.to_s</code> and <code>p c</code> to <code>puts$_</code>, which would give you something like this:</p>

<pre><code>.........00
11......000
...........
...2.......
3........4.
3.........4
</code></pre>

<p>(at least until you run out of digits!)</p>

<p>Some test cases:</p>

<pre><code>.........**
**......***
...........
...*.......
*........*.
*.........*
</code></pre>

<p>5</p>

<pre><code>......*..**....*
**...*..***....*
....*..........*
...*.*.........*
*........***....
*.....*...***...
*.....*...*....*
****..........**
*.........*.....
</code></pre>

<p>9</p>

<pre><code>*
</code></pre>

<p>1</p>

<pre><code>****
****
....
****
</code></pre>

<p>2</p>

<pre><code>**********
*........*
*.******.*
*.*....*.*
*.*.**.*.*
*.*.**.*.*
*.*....*.*
*.******.*
*........*
**********
</code></pre>

<p>3</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/6979/">6979</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




