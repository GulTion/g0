<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::210107</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>222</td><td>Setanta</td><td>200826T112706Z</td><td><a href="https://codegolf.stackexchange.com/questions/210107/stroke-count-of-a-chinese-numeral/210194#210194">bb94</a></td></tr>
<tr d-ix="1"><td>151</td><td>Python 2</td><td>200825T102651Z</td><td><a href="https://codegolf.stackexchange.com/questions/210107/stroke-count-of-a-chinese-numeral/210121#210121">Sisyphus</a></td></tr>
<tr d-ix="2"><td>139</td><td>JavaScript ES6</td><td>200825T105013Z</td><td><a href="https://codegolf.stackexchange.com/questions/210107/stroke-count-of-a-chinese-numeral/210125#210125">Arnauld</a></td></tr>
<tr d-ix="3"><td>059</td><td>05AB1E</td><td>200825T131829Z</td><td><a href="https://codegolf.stackexchange.com/questions/210107/stroke-count-of-a-chinese-numeral/210138#210138">Kevin Cr</a></td></tr>
</table>
<div id="pu0" class="pu"><h2><a href="https://try-setanta.ie/" rel="nofollow noreferrer">Setanta</a>, <s>243</s> <s>236</s> <s>235</s> <s>234</s> <s>226</s> 222 bytes</h2>
<pre><code>gniomh(n){gniomh S(n,c){gniomh Q(t){toradh t|0&amp;1}toradh(n&amp;[13,1,2,3,5,4,4,2,2,2][n%10]+[0,2,6,3][n%10&amp;c%4]+3*Q((c==4|c==8)&amp;n%10000)-13*(Q(!(n%10|c%4))+Q(n%100==0&amp;c%4&lt;3))-Q(n==1&amp;c%4==1)+S(n//10,c+1))|13*Q(!c)}toradh S(n,0)}
</code></pre>
<p><a href="https://try-setanta.ie/editor/EhEKBlNjcmlwdBCAgIDwxaCZCw" rel="nofollow noreferrer">Try it here!</a></p>
<p>Notes:</p>
<ul>
<li>This is a port of the <a href="https://codegolf.stackexchange.com/a/210121/14109">Python 2 solution</a>.</li>
<li>The correct keywords for 'function' and 'if' are <code>gníomh</code> and <code>má</code>, respectively, but Setanta allows spelling them without the accents so I did that to save some bytes.</li>
<li>I had to define the <code>Q</code> function above because <a href="https://try-setanta.ie/editor/EhEKBlNjcmlwdBCAgICgpcSCCg" rel="nofollow noreferrer">Setanta doesn't coerce booleans to integers</a>. As far as I know, there's nothing equivalent to ternary expressions in this language.</li>
<li>There are no bitwise operations as far as I know, so I had to stick to array lookups.</li>
</ul>
</div>
<div id="pu1" class="pu"><h2><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, <s>163</s> <s>162</s> <s>155</s> 151 bytes</h2>
<p><sup>-1 thanks to <a href="https://codegolf.stackexchange.com/users/58563/arnauld">Arnauld</a>, -7 thanks to <a href="https://codegolf.stackexchange.com/users/64121/ovs">ovs</a></sup></p>
<p>Hexdump:</p>
<pre><code>00000000: efbb bf65 7865 6322 789c 1dcb c10e c220  ...exec&quot;x......
00000010: 0cc6 f157 e1c2 d2c2 88b4 6359 34c2 bb20  ...W......cY4..
00000020: b893 7689 274f 3ebb 65a7 36bf 7cff 3dbf  ..v.'O&gt;.e.6.|.=.
00000030: eafb d1ab 91b9 e578 1353 a543 fc32 734a  .......x.S.C.2sJ
00000040: ebc2 d44b 114b d1a5 8956 f430 7e5d 9866  ...K.K...V.0~].f
00000050: 93bb 5a62 bba1 5fdc e067 1ace 1b97 d226  ..Zb.._..g.....&amp;
00000060: c240 ca40 67ec 75ad 2de8 b92f 7852 440c  .@.@g.u.-../xRD.
00000070: 2039 0f62 f43b c885 e21c 7e5c 728f 8fd1   9.b.;....~\r...
00000080: 343a d7fe d154 254b 222e 6465 636f 6465  4:...T%K&quot;.decode
00000090: 2827 7a69 7027 29                        ('zip')
</code></pre>
<p>Unpacked:</p>
<pre class="lang-python prettyprint-override"><code>f=lambda n,c=0:n and(0x222445321d&gt;&gt;n%10*4&amp;15)+(n%10and c%4*9%12%7)+3*(n%1e4and 272&gt;&gt;c&amp;1)-13*((1&gt;n%10+c%4)+((c%4&lt;3)&gt;n%100))-(n==c%4&lt;2)+f(n/10,-~c)or 13*0**c
</code></pre>
<p><a href="https://tio.run/##HY/BbsIwEETP5Sv2ErAT0@6u106CmvxI1UMIjYpUDAIqtUL019M1vsxq5o00Pv1eP4@J53nqvobDdjdAcmOHmwRD2hn8YWaR4Jl2fZ8KwlKWFGxl8q0EjIWUbUFc1LbyZbY/JPtcc9@PS7JrUtvQo1wprV2j8urtw0Jr1yZ1XbbYVpNJL4Ru/Tfa4xm0imU5zun7cIEO3tCBhsA@OqhRyEFApIebn4MmojTegbRCAWvNNaGWJSMBowRqHfgMC2Jw0DZ1DKLfU4AFI1IT9I7Y1BwFWaJ/X0w6RSfAPmW5bBZPp/M@Xc1qMre71WG3@@pZocNwNQo4mLJYa@d/" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
<h3>Commented version</h3>
<pre class="lang-python prettyprint-override"><code>f=lambda n,c=0:n and        # If n is not zero, sum the following:
                            # The strokes of the current digit
  (0x222445321d&gt;&gt;n%10*4&amp;15) #   [13,1,2,3,5,4,4,2,2,2][n%10] 
                            # The 10/100/1000 marker stroke count, if 
                            # the currrent digit is zero
  + (n%10and c%4*9%12%7) #   [0, 2, 6, 3][n%10 and c%4]
                            # The 10^4 / 10^8 marker stroke count
  + 3*(n%1e4and 272&gt;&gt;c&amp;1)   #   3*(n%10000 and c in [4,8]) 
  - 13*(                    # Subtract 13 because we overcounted the zeros if
                            #   It's a trailing zero in a group of four
        (1&gt;n%10+c%4)        #     (n%10 == 0 and c%4 == 0)
                            #   and/or if it's part of a group of zeros
        +((c%4&lt;3)&gt;n%100)    #     (n%100 == 0 and c%4 != 3)
    )                       # Subtract 1 if we lead a group of four with 10
  - (n==c%4&lt;2)              #   (n==1 and c%4==1)
  + f(n/10,-~c)             # Recurse on next digit
                            # Else if n=0, return 13 if we are at the first
or 13*0**c                  # digit, else 0
</code></pre>
<p>We also use the <code>exec&quot;...&quot;.decode('zip')</code> to compress our code to save a few bytes.</p>
</div>
<div id="pu2" class="pu"><h1>JavaScript (ES6), <s> 148 145 </s> 139 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(n,i=0,z=n/1e4|0)=&gt;n?f(z,3)-!(n/10^1)+(g=d=&gt;~~d?n%1e4&amp;&amp;(q=n/d%10,x=296/~~q%5^20&gt;&gt;q&amp;1,x?z=x+=3064/d&amp;7:z*q&amp;&amp;(z=0,13))+g(d/10):i)(1e3):!i*13
</code></pre>
<p><a href="https://tio.run/##bZBdS8MwFIbv9yuOsI9ky7Z8t52kQ1BBFLzwUhwrazcrI926IqNq//o8wVsDITk5z/u@h3xkn9lpU5eHZuqrvLhcto54VjrOWufnotDfnLrUL7ekZYpOrwg@8pWgE7JzuUu7Ll/6AWLDITmiIB8Izs5OJnbedceBWUmepsehYOdl684Tp7jV83wYLdrxESUt5ghF6WRHcvSli5ISUSi6uCrHQl1KfwAHr5wBuoJUlkHEtQhlWAxiy3WsGOhEC8MjBgY7IpE6IAazjEgYqABrzg2DJI6s0UoGD6m55SI2eLc8jqTVXGqr3q57dXEKuQKdJYLoKzEa5RpLg1vFYRI8UWuQMmGyBJU9HHm2req7bPNO8COhpODSHsCm8qdqX8z21Y6s@19@1lQvTV36HaGzQ5a/NFndECHpD3Qp9L@2xNN/kUCQvz44Bzjpa/kGSxg9P45gAaP7m4enu9vRD13THr38Ag" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Black magic</h3>
<ul>
<li><p>The number of strokes in the Chinese character for a single decimal digit <span class="math-container">\$1\le q\le 9\$</span> can be obtained with:</p>
<pre class="lang-javascript prettyprint-override"><code>296 / q % 5 ^ 20 &gt;&gt; q &amp; 1
</code></pre>
<p><a href="https://tio.run/##y0osSyxOLsosKNHNy09J/f8/Lb9Io1DBVsHQWqFQwcZWwRJIa2trKlRzKShUAMWNLM0U9IFSqgqmCnEKRgYKdnZAnhpQPVBBcn5ecX5Oql5OfrpGgkp1Ya2Chkq10pMdDU929TzZ0fl09uwnu6Y8bV37ZEfz09bVT3bOVYouVNBVMIyt1VSos1NQqa6oVSguKcrPTtUo1kzQtOaq/f8fAA" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>This formula returns <span class="math-container">\$0\$</span> for <span class="math-container">\$q=0\$</span>, which is actually what we want because zeros have to be processed separately anyway.</p>
</li>
<li><p>The number of strokes in the Chinese character for a multiplier <span class="math-container">\$d\in\{1,10,100,1000\}\$</span> can be obtained with:</p>
<pre class="lang-javascript prettyprint-override"><code>3064 / d &amp; 7
</code></pre>
<p><a href="https://tio.run/##JYlBCoJAGEb3nuJjkJjRSsOohdlFRFDUopJ/wpEQhgmidQfoMt0mOsY00erx3jtWl0rV/eE8zEg2rbU72XNChjgFYZMhcQxDAe0BjeuLGEEASp2OTpN4tUTkzgTrX6slKdm1807ueenrxoD7OmcUVWwK9n7cfvg8X3@7syKnwghct/D1aKCGXp5arkQpUs9Y@wU" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</li>
</ul>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>f = (                      // f is a recursive function taking:
  n,                       //   n = input
  i = 0,                   //   i = number of strokes for either 10^4 or 10^8
                           //       (0 for the first iteration, then 3)
  z = n / 1e4 | 0          //   z = next 4-digit block, also used as a flag to
) =&gt;                       //       tell whether zeros must be inserted
n ?                        // if n is not equal to 0:
  f(z, 3)                  //   do a recursive call with the next 4-digit block
  - !(n / 10 ^ 1)          //   subtract 1 if n is the range [10...19] to account
  +                        //   for a leading '10' where the '1' must be omitted
  ( g = d =&gt;               //   g is a recursive function taking a divisor d
    ~~d ?                  //     if d greater than or equal to 1:
      n % 1e4 &amp;&amp;           //       abort if the entire block is 0
      (                    //       otherwise:
        q = n / d % 10,    //         q = (n / d) mod 10
        x = 296 / ~~q % 5  //         compute the number of strokes x for this
            ^ 20 &gt;&gt; q &amp; 1, //         decimal digit (i.e. the integer part of q)
        x ?                //         if it's not a zero:
          z =              //           set z to a non-zero value
            x +=           //           add to x ...
              3064 / d &amp; 7 //           ... the number of strokes for d
        :                  //         else:
          z * q &amp;&amp;         //           if both z and q are non-zero:
            (z = 0, 13)    //             add 13 strokes and set z to 0 so that
      )                    //             other contiguous zeros are ignored
      + g(d / 10)          //       add the result of a recursive call with d / 10
    :                      //     else:
      i                    //       add i to account for either 10^4 or 10^8
  )(1e3)                   //   initial call to g with d = 1000
:                          // else:
  !i * 13                  //   stop the recursion; add 13 if the input was zero
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="noreferrer">05AB1E</a>, <s>60</s> 59 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="noreferrer">bytes</a></h1>
<pre><code>Rv•мΛ~?•ÁyèyĀiŽAΘÁNè]IR4ô¤¤sg*2Q(sεÔ0Û}©J0¢I_+13*ŽE₃Á®¦ĀOèO
</code></pre>
<p><a href="https://tio.run/##AWsAlP9vc2FiaWX//1J24oCi0LzOm34/4oCiw4F5w6h5xIBpxb1BzpjDgU7DqF1JUjTDtMKkwqRzZyoyUShzzrXDlDDDm33CqUowwqJJXysxMyrFvUXigoPDgcKuwqbEgE/DqE///zMwMDAwNDAwNQ" rel="noreferrer">Try it online</a> or <a href="https://tio.run/##FYy7SgNBFIZfJaQK8RTnzJy5bLWksLEwmFZEFCSkslgITLFhV8EHEAshXQiyNlbamWZO0i4@w77IOvtXH//tsbi7Xz3065CPR93L62ich36x7qrd32@73eQJpA7ShGO1Oh1m7bvUl9KUZViwfMd93BfLqbqaFO2PvKFsy/h5gXEXbs9IT0@H8@7pWer4FT@O1VyaeQ/9NQIhKG3BIVPiQeAtstfAGZNBBybZlClOsUHLhjLQQ48RDWTeWcNapbFitEjeEFj0TllGxVYD0XCsMLkO/c0/" rel="noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>
<p>Here a run-down of what each part of the code accomplishes, which we'll sum with <code>O</code> at the very end to get the result:</p>
<ul>
<li>Convert each digit to the amount of strokes used, except for edge case 0: <code>Rv•мΛ~?•Áyè]</code></li>
<li>Get the strokes of 10, 100, 1000 per part of four digits if the current digit is not a 0: <code>RvyĀiŽAΘÁNè]</code></li>
<li>Subtract 1 in case there is a leading <code>一十</code>→<code>十</code> conversion, by separating the number into parts of four digits, and checking if the first part starts with a <code>1</code> and contains just two digits: <code>IR4ô¤¤sg*2Q(</code></li>
<li>Add 13 for each 0, excluding those that are adjacent to other 0s, or trailing in every part of four digits: <code>IR4ôεÔ0Û}©J0¢13*</code></li>
<li>Take care of edge case <span class="math-container">\$n=0\$</span>: <code>I_+13*</code></li>
<li>Get the strokes of the <span class="math-container">\$10^4\$</span> and <span class="math-container">\$10^8\$</span>, excluding parts that consist solely of 0s: <code>ŽE₃Á®¦ĀOè</code></li>
</ul>

<pre class="lang-python prettyprint-override"><code>R                # Reverse the (implicit) input-integer
 v               # Loop over each of its digits `y`:
  •мΛ~?•         #  Push compressed integer 1235442220
        Á        #  Rotate it once to the right: 0123544222
         yè      #  Index the current digit `y` into 0123544222
  yĀi            #  If `y` is NOT 0:
     ŽAΘ         #   Push compressed integer 2630
        Á        #   Rotate it once to the right: 0263
         Nè      #   Index the loop-index `N` into 0263 (modulair 0-based)
 ]               # Close both the if-statement and loop
IR               # Push the reversed input-integer again
  4ô             # Split it into parts of size 4, where the last part might be smaller
    ¤            # Push the last part (without popping the list itself)
     ¤           # Push the last digit (without popping the number itself)
      s          # Swap so the number is at the top of the stack again
       g         # Pop and push its length
        *        # Multiply it to the digit
         2Q      # Check if length * digit is equal to 2 (1 if truthy; 0 if falsey)
           (     # Negate that
    s            # Swap so the list of parts of 4 is at the top of the stack again
     ε           # Map each part to:
      Ô          #  Connected uniquify each digit (i.e. 0030 becomes 030)
       0Û        #  Remove any leading 0s
     }©          # After the map: store this list in variable `®` (without popping)
       J         # Join it together to a single string
        0¢       # Count the amount of 0s left in the string
          I_     # Check if the input-integer is 0 (1 if 0; 0 otherwise)
            +    # Add that to the count of 0s
             13* # Multiply it by 13
ŽE₃              # Push compressed integer 3660
   Á             # Rotate it once to the right: 0366
    ®            # Push the list from variable `®`
     ¦           # Remove the first item
      Ā          # Truthify each part (&quot;&quot; becomes 0; everything else becomes 1)
       O         # Sum this list
        è        # Index it into the 0366
O                # And finally sum all values on the stack
                 # (after which this sum is output implicitly as result)
</code></pre>
<p><a href="https://codegolf.stackexchange.com/a/166851/52210">See this 05AB1E tip of mine (section <em>How to compress large integers?</em>)</a> to understand why <code>•мΛ~?•</code> is <code>1235442220</code>; <code>ŽAΘ</code> is <code>2630</code>; and <code>ŽE₃</code> is <code>3660</code>.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/210107/">210107</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




