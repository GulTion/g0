<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::269940</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>034</td><td>Haskell + hgl</td><td>240209T202548Z</td><td><a href="https://codegolf.stackexchange.com/questions/269940/compute-maximum-excluding-the-current-position/269952#269952">Wheat Wi</a></td></tr>
<tr d-ix="1"><td>044</td><td>Python + NumPy</td><td>240209T201957Z</td><td><a href="https://codegolf.stackexchange.com/questions/269940/compute-maximum-excluding-the-current-position/269951#269951">Albert.L</a></td></tr>
<tr d-ix="2"><td>093</td><td>C GCC</td><td>240209T175459Z</td><td><a href="https://codegolf.stackexchange.com/questions/269940/compute-maximum-excluding-the-current-position/269948#269948">Mukundan</a></td></tr>
<tr d-ix="3"><td>019</td><td>APLNARS</td><td>240209T173940Z</td><td><a href="https://codegolf.stackexchange.com/questions/269940/compute-maximum-excluding-the-current-position/269947#269947">Rosario</a></td></tr>
<tr d-ix="4"><td>071</td><td>JavaScript Node.js</td><td>240209T134417Z</td><td><a href="https://codegolf.stackexchange.com/questions/269940/compute-maximum-excluding-the-current-position/269942#269942">l4m2</a></td></tr>
<tr d-ix="5"><td>054</td><td>JavaScript ES6</td><td>240209T134513Z</td><td><a href="https://codegolf.stackexchange.com/questions/269940/compute-maximum-excluding-the-current-position/269943#269943">Arnauld</a></td></tr>
<tr d-ix="6"><td>075</td><td>Python 3</td><td>240209T140635Z</td><td><a href="https://codegolf.stackexchange.com/questions/269940/compute-maximum-excluding-the-current-position/269944#269944">Stef</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.haskell.org" rel="nofollow noreferrer">Haskell</a> + <a href="https://gitlab.com/wheatwizard/haskell-golfing-library" rel="nofollow noreferrer">hgl</a>, 34 bytes</h1>
<pre><code>zW ma&lt;tl&lt;g rS*^g lS
</code></pre>
<pre><code>g h=h ma~&lt;mn
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=LY2xDoIwAET3fsXppKYdAE0MKR_gYELC4EAwIaGFxhaxlMXBH3FhMX4TfyMC0-XeXe7e3ypvb0Lrflgp09ytw6PLtZJKFIit0F0hyBLEn85JdhzWMnpeYHLuNC9hk921hE5IiSqqRvzipl6ajROtaxGGSNNT7bKMzCAiQIrUozhQsIBiT-FnI6QT9CmCxbHRMn8uMe8PM0JMruppw5yxaSw45BbT8vzb97P-AA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<h2>Explanation</h2>
<p>First this calculates the minimum value of the list (linear time). Then this scans the list rightwards calculating cumulative maxima, then it scans leftwards calculating cumulative maxima (both linear time). Finally it zips the two results together (lienar time).  Since the cumulative maxima are the maxima of the prefixes / suffixes this means that when we zip them together we get the maximum of the values in the prefix before our value and the suffix after. This, naturally is the entire list other than the value in question.  Since this is just a series of linear time operations the entire algorithm is linear time.</p>
<h2>Reflection</h2>
<p>It feels wrong that <code>g</code> shorter in point-free, however I think this is mostly because in normal golf, writing things in point free saves 2 bytes automatically by removing the function declaration. However here we <em>need</em> the function declaration (inlining <code>g</code> completely is very long) so point-free has to compete on even ground.</p>
<ul>
<li><code>fid</code> should not be 3 bytes. This would make the point-free version of <code>g</code> shorter by a byte, replacing a <code>($ ma)</code> with <code>fi ma</code>, but would still be longer than the point-ful version.</li>
<li>What this really wants is a way to zip with an offset. I'm not sure how universally applicable this idea is, but if implemented it would really simplify this answer.</li>
</ul>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a> + NumPy, 44 bytes</h1>
<pre class="lang-python prettyprint-override"><code>lambda L:L[L.argpartition(-2)[(L&lt;max(L))-2]]
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=jY9LCsIwEIb3PcUsJ5AITS2I2kW7zg1qFxGpFpoHIQV7FjcF0Tu59iL2YbtVmGGYH76PmdvTtv5idHcvk8Oj8SXbvGgt1fEkQWxFLlbSna10vvKV0cg4yVHslbyiIITxovgy79IZBbpRtoVKWeM8SOdkG6SQQB5SiCmwiMKaAi92kA1pPK7xVEVgXaU9YokjiCkhSZKRlaxrJGTxcArRLOh90eD7B2U9y_h0BAtnw5gu_UM0vdp10_wA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Takes and returns NumPy arrays. <code>numpy.argpartition</code> uses the linear time introselect algorithm to find in this case the second largest element (or rather its index) and split at this value.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://gcc.gnu.org" rel="nofollow noreferrer">C (GCC)</a>, <sup><s>97</s></sup> 93 bytes</h1>
<p>-2 bytes thanks to @Arnauld</p>
<pre class="lang-c prettyprint-override"><code>f(n,a,m,M,i)int*a;{for(m=M=*a,i=n;i--;a++)M&lt;*a?m=M,M=*a:m&lt;*a?m=*a:0;while(n--)*a=*--a-M?M:m;}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=XVBBboMwEFSP8IoVVSUD6wqSVqrikLyAfiBClUWgsRScCIx6QLykl1zygf6mfU3XQKK0F-_szGhW489z_vae56eve6XzfbstYNmYrTo87lbn1pT85TsrmUaJFaaofKVNIEVXHmpWJWkSSFSJFopzIcPQT5eBXBOPVllU40YoEh87tS-Y5twPZBJwLnm6TheV6McjP3evlAyVVJr50LlOY-o2NxY5VtBiArKuN3EUZbT3YIrG5LIpmk0GyeDtnhG6GIEGnyM8Icz6Hq0wH4UZwnxiSOw4UXw2mnk8CfbtEYJLvHBdhwoDuxB07HpaXCFfaQFheFmHGk7JbmS88VIR35Yagm0zRamRoLH8m6joX-FYk6Vk3sMWvH8pG5UNQcfWNMzzLO7d6VtPp3H-Ag" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu3" class="pu"><h1>APL(NARS), 19 chars</h1>
<pre><code>⌈/¨{k[h∼⍵]}¨h←⍳≢k←⎕
</code></pre>
<p>The array has to have at last 2 elements. test:</p>
<pre><code>      ⌈/¨{k[h∼⍵]}¨h←⍳≢k←⎕
⎕:
      1 1 1 1
1 1 1 1 
      ⌈/¨{k[h∼⍵]}¨h←⍳≢k←⎕
⎕:
      1 2 3
3 3 2 
</code></pre>
<p>If n=lenght array of input, it would cancel the current element i of the array
for i in 1..n, than for each n arrays find the max and return.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 71 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>x=&gt;x.map(v=&gt;v-n?m:M(...x.filter(u=&gt;u-n||0*++n)),m=n=M(...x))
M=Math.max
</code></pre>
<p><a href="https://tio.run/##ZY3LCoMwEEX3fsUsk5rEqnVTGAvd@wXiIlhtFU3EF1n476lVKNjCzGbuOXdqOcsh76tu5Eo/CluiNRgb0cqOzBjPXN3aa0KEEEaUVTMWPZkwnrhalvPJdRWlrEWFO0Gpk2Aix9eqG5trNeimEI1@kpKkPoOIAQ8ZXBgEGaXgeQLugJBG2y3aJ3P@xYBBeDDWlvDT8svyFebB/ob7B2WLvpvZNw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>-1 byte from Arnauld</p>
<p>After first meet of n, n is increased so it's larger than max, aka no more value can equal to n</p>
</div>
<div id="pu5" class="pu"><h1>JavaScript (ES6), 54 bytes</h1>
<p><em>-2 thanks to @l4m2</em></p>

<pre class="lang-javascript prettyprint-override"><code>a=&gt;a.map(v=&gt;v-a?a:m,a.map(v=&gt;a&gt;v?m&gt;v?0:m=v:(m=a,a=v)))
</code></pre>
<p><a href="https://tio.run/##bYtBCsIwEEX3nmKWCcwUm@omMOlBxMVQW1E6TWllrh8Dghtd/M177z/FZB@2x/qiJd/GMnERTtKorM44GUkvUfELJFmvdceobNEpCwqb974MednzPDZzvrvJXVqEMwJ1CCeEcPX@8BsEhO6PoaoofM7U1qC8AQ" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Method</h3>
<p>During the first pass, we compute <span class="math-container">\$m_0=\max A_i\$</span> and <span class="math-container">\$m_1=\max_{i\neq j}A_i\$</span> where <span class="math-container">\$j\$</span> is the index of the first occurrence of <span class="math-container">\$m_0\$</span>. So we have <span class="math-container">\$m_1=m_0\$</span> if <span class="math-container">\$m_0\$</span> appears more than once and <span class="math-container">\$m_1&lt;m_0\$</span> otherwise.</p>
<p>During the second pass, we replace each value <span class="math-container">\$v\$</span> in the input array with <span class="math-container">\$m_1\$</span> if <span class="math-container">\$v=m_0\$</span> or <span class="math-container">\$m_0\$</span> otherwise.</p>
<p>In the JS implementation, we use <code>a</code> for <span class="math-container">\$m_0\$</span> and <code>m</code> for <span class="math-container">\$m_1\$</span>.</p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>a =&gt;           // a[] = input array,
               //       re-used as m0 (initially NaN'ish)
a.map(v =&gt;     // (2nd pass) for each value v in a[]:
  v - a ?      //   if v is not equal to a:
    a          //     output a
  :            //   else:
    m,         //     output m
  a.map(v =&gt;   //   (1st pass) for each value v in a[]:
    a &gt; v ?    //     if a is a number greater than v:
      m &gt; v ?  //       if m is a number greater than v:
        0      //         do nothing
      :        //       else:
        m = v  //         save v in m
    :          //     else:
      (        //
        m = a, //       save the previous maximum a in m
        a = v  //       save the new maximum v in a
      )        //
  )            //   end of map()
)              // end of map()
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3</a>, 75 bytes</h1>
<pre><code>def f(a):
 h=nlargest(2,a)
 return[h[x==h[0]]for x in a]
from heapq import*
</code></pre>
<p><a href="https://tio.run/##RY/dCsIwDIXv@xTnzk1S0M2BCPVFSi7q3OxAu1or6NPPtoKGBPLzJZz4d7Sza/c@LMt5GDFWpj4IWOWuJlyGR6waMrVAGOIzOG31SymrN8zjHPDC5GBYjGG@wQ7G3zHd/Bzieolp9aGgBZJpvSV0BNkSdoSGCborafd1ZvqDDaHNRILbDP9mMg1l8z0jtxkpnV8wCxYiCzN0ytKKiEPZ7qHKb6XwYXKxMrSS8riiE/UJVwp9vXwA" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>This is almost not golfed: compute the first and second minimum <code>h[0]</code> and <code>h[1]</code> of array <code>a</code>, then output <code>h[0]</code> or <code>h[1]</code> where appropriate.</p>
<p>Using <code>sorted</code> would take 20 fewer bytes than using <code>heapq.nlargest</code>, but would break the O(n) requirement.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/269940/">269940</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




