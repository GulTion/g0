<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::QNNN</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
  <!-- TXXX -->
<tr d-ix="0"><td>132</td><td>C#</td><td>231011T222919Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265924#265924">Igby Lar</a></td></tr>
<tr d-ix="1"><td>039</td><td>X86_64/Linux Machine Code</td><td>230928T225730Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265579#265579">Noah</a></td></tr>
<tr d-ix="2"><td>102</td><td>sed</td><td>230919T052857Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265363#265363">Philippo</a></td></tr>
<tr d-ix="3"><td>014</td><td>05AB1E</td><td>230920T144719Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265396#265396">Kevin Cr</a></td></tr>
<tr d-ix="4"><td>054</td><td>JavaScript Node.js</td><td>230920T141817Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265394#265394">l4m2</a></td></tr>
<tr d-ix="5"><td>nan</td><td></td><td>230918T164439Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265340#265340">Evargalo</a></td></tr>
<tr d-ix="6"><td>101</td><td>Python 3.8 prerelease</td><td>230920T032233Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265379#265379">STerliak</a></td></tr>
<tr d-ix="7"><td>015</td><td>Charcoal</td><td>230918T092610Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265324#265324">Neil</a></td></tr>
<tr d-ix="8"><td>020</td><td>Retina 0.8.2</td><td>230919T001903Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265357#265357">Neil</a></td></tr>
<tr d-ix="9"><td>010</td><td>Jelly</td><td>230918T235229Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265354#265354">Unrelate</a></td></tr>
<tr d-ix="10"><td>035</td><td>J</td><td>230918T230834Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265353#265353">Jonah</a></td></tr>
<tr d-ix="11"><td>126</td><td>Python3</td><td>230918T120945Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265333#265333">Ajax1234</a></td></tr>
<tr d-ix="12"><td>057</td><td>JavaScript Node.js</td><td>230918T053636Z</td><td><a href="https://codegolf.stackexchange.com/questions/265307/play-a-game-of-memory/265308#265308">tsh</a></td></tr>
</table>
<div id="pu0" class="pu"><h2>C#, 132 bytes</h2>
<p>Wanted to keep working on this but never did, so here's where I got up to 3 weeks ago. I just started with a naïve algorithm and golfed it without changing the algorithm much.</p>
<pre><code>string d=args[0],s=&quot;&quot;;int t=0,i=0;for(;i&lt;d.Length;t++)if(!s.Contains(d[i++])){if(s.Contains(d[i]))t++;s+=d[i-1];s+=d[i++];}return t;
</code></pre>
<h3>Formatted</h3>
<pre><code>string d = args[0], // deck 
s = &quot;&quot;;             // seen cards
int t = 0,          // turns taken
i = 0;              // current index
for (; i &lt; d.Length; t++)
    if (!s.Contains(d[i++]))
    {
        if (s.Contains(d[i]))
            t++;
        s += d[i - 1];
        s += d[i++];
    }
return t;
</code></pre>
</div>
<div id="pu1" class="pu"><h2>X86_64/Linux Machine Code, <strike> 41 40</strike> 39 Bytes</h2>
<p><a href="https://tio.run/##fVRNb9s4ED2Lv2KANKjTxqkbdANsgBzaTbEIUPSSpkEvNfgxkulQpEJSlpQfX3coKZKDLtYHSxTJ9@bNmxkeApbCdMtCyv3@3Ru4s9KVJdoIAo1rQOfw6fYWGh4gYKwr4BHOf56vzgDevGN04Uhhri3CzfXnj1/W6Sx9Z9lZYZzgJluHyH2kdcQ2smF1yTK6eJOYtC3AY6FDRB@Ae4Qn9G4AZ1npdiJ7dbE6hWNl2JHOiWsmYpmIwWTHqFo6gEGzIzQB@2sme/XvusQS3sJq2rRK5z018haurmCV/m5/3K49cjVw9rtKz7vfrm@@jluhC5IbwzKDJGxx7IMmaM/bk8Qg25E4kaUPvGWV4d0g9ovjCiylAOSGey5J7ohqnAqC1ZSMHXpUa25SNN2UI4@9G97VlhDqUqCHhScrvEWV3Ki8KwBbHU9GRG1lnxXNeoxFihA0ZRdEF3FZ8gpcPscRoEHY8B3CSE1Gox2xegcWzyKF6RG/c1MPRoGmnEoecQKxr2N/H@KGKCcS6DCOkHQ4ioywRsCtfcpG@euKaz9Eff//cMFBXSkinjU1Om5Ax8AyAKhc0FE7S/6/P5RCdXQKgx42G8NDoPOEpl7Y848rq1SSufYhQnS0ifIBcudBcPmw7JmiW6bFSCLLikj4QBL0ybO/g5t5ytJkNWlCCLzEA10L0aWVlXiSti1IZ6O2NY74W8wOSkVtuaTimNB7QKQr6pmlb1xuJ2tn8pmzwV6Ip353UxopJz2ctpRHbmCXPH8hUsyZJA9fxDWQDWHdDTa9CE0/1geiXwcwjooo2fVfmv8w7rBaLtmf@Rh652ME6vhU6qLOc/SnQw012hhKR8O71BE0ukhcaqZZ29zCqae3PEttzJSzOAB/pl4bTlPWoJWbwtAzNXy6o9p5UtDYI829sDMRqDLPuNGFzc7/umD9eLqkAxXFDB9Wf1@w/T4KzR9it7OtrL18MkVTbramdo/V40MRqibkWuWo/FO56ZDbdifc9pfMDS/CfmldiMpokd5oUPLaRFqNGzR2c22QVvQetaTnfnlvTpffKLCrVft@Nfz2y@tpwP4G" rel="nofollow noreferrer" title="Assembly (gcc, x64, Linux) – Try It Online">Try it online!</a></p>
<p><strong>Usage:</strong></p>
<pre><code>$&gt; gcc -DIDEAL_BSS -Wl,-Tbss=0x10000000 -s -static -nostartfiles -nodefaultlibs -nostdlib -Wl,--build-id=none memory.S -o memory
$&gt; echo -n &quot;&lt;Input&gt;&quot; | ./memory; echo $?
</code></pre>
<p>Program reads input from stdin (it is sensitive to the exact byte count of input, i.e stray spaces/new lines will change result).</p>
<p>The return value of the program is the number of rounds.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>Size is measured in machine code (i.e 39 bytes of PROGBITS; .text, .data, etc...)</li>
<li>The 39-byte size assumes the above compile command which sets the BSS address at an ideal value. With generic compile commands (no linker inputs), its 41-bytes.</li>
</ul>
<p><strong>Program:</strong></p>
<pre><code>/* Uncomment below if BSS was setup at 2^20.  */
/* #define IDEAL_BSS */

    .global _start
    .text
_start:
    /* Incoming registers are zero.  */

    movb    $60, %dl
#ifdef IDEAL_BSS
    btsl    %edx, %esi
#else
    movl    $G_mem + 0, %esi
#endif
    /* eax == 0 == SYS_read.  */
    /* edi == 0 == STDIN.  */
    syscall
    leal    (%rsi, %rax), %ecx
    movl    %esi, %eax
play:
    /* Load next character.  */
    lodsb
uncovered_already:
    /* Increment round number (returned at prog exit).  */
    incl    %edi

    /* (rax) is a byte-map of characters we have already seen.  */
    movb    (%rax), %bl
    /* Value zero indicates we haven't seen this character yet.  */
    testb   %bl, %bl
    jnz uncover_pair

    /* We haven't seen this character so update byte-map with its
       position + 1.  */
    movb    %dl, (%rax)

    /* Load assosiated character.  Compare first to check for back-
       to-back.  */
    cmpb    %al, (%rsi)
    lodsb

    /* If we uncovered the same character (by chance) then continue.  */
    je  uncovered_adjacent

    /* If the second uncover was an already uncovered character we
       reloop with it as the initial value.  */
    cmpb    %bl, (%rax)
    jne uncovered_already

    /* Update the second unique character's location then continue.  */
    movb    %dl, (%rax)
uncover_pair:
uncovered_adjacent:
    /* At end of buffer, this will always a final turn.  */
    cmpl    %esi, %ecx
    ja  play
done:
    /* Exit.  */
    xchgl   %eax, %edx
    syscall

    .section .bss
    .align  256
G_mem:  .space 4096
</code></pre>
<p><strong>Examples/Tests:</strong></p>
<pre><code>$&gt; for x in aa aabb abba ggijkikj qqwweerrtt cbxcxvbaav zyxzwyvxvw tbiaktyvnxcurczlgwmhjluoqpqkgspwsfidfedrzmhyeanxvboj; do echo -n &quot;${x}&quot; | ./memory; echo &quot;${x} -&gt; $?&quot;; done
aa -&gt; 1
aabb -&gt; 2
abba -&gt; 3
ggijkikj -&gt; 6
qqwweerrtt -&gt; 5
cbxcxvbaav -&gt; 8
zyxzwyvxvw -&gt; 9
tbiaktyvnxcurczlgwmhjluoqpqkgspwsfidfedrzmhyeanxvboj -&gt; 43
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.gnu.org/software/sed/" rel="nofollow noreferrer">sed</a>, <s> 108 </s> 102 bytes</h1>
<p><em>(97 bytes for buggy old GNU <code>sed</code> 4.2.2 by using empty label instead of <code>1</code>)</em></p>
<p>I insert an underscore <code>_</code> as marker up to where cards are known, then do backreference replacements for all possible cases. For each turn, <code>H</code> appends the pattern to the hold space, so in the end I output the number of turns as <code>+</code>:</p>
<pre><code>s/^/_/
t2
:1
H
:2
s/(.)(.*)\1_/\2_/
t1
s/_(.)\1/_/
t1
s/(.)(.*_)\1/\2/
t1
s/_(..)/\1_/
t1
x
s/.\S*/+/g
</code></pre>
<p>The <code>t2</code> at the beginning looks avoidable, but is needed to reset the <code>t</code> trigger after the first replacement.</p>
<p><a href="https://tio.run/##RYuxCoUwEAT7@xKjmCUp7R/Y2x6mUcRGhfg0@vGeCSKWMzvr@64cpr@IRwsHWi1VhmqqLHlkWmU6V2wc2KbRROmiZYMXn8YlxfZLtEK6JQ7RaG5yFBhEziOc@7GFbb/mZR3nyUv5uwE" rel="nofollow noreferrer" title="sed – Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 14 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>ηεRõ1ǝćÃ}Åγ;îO
</code></pre>
<p>Port of <a href="https://codegolf.stackexchange.com/a/265354/52210"><em>@Unrelated String</em>'s Jelly answer</a>, which is based on the explanation of <a href="https://codegolf.stackexchange.com/a/265353/52210"><em>@Jonah</em>'s J answer</a>, so make sure to upvote both of those answers as well!<br />
Will see if I can find something shorter using a similar approach, when I have a bit more time later on.</p>
<p><a href="https://tio.run/##ASYA2f9vc2FiaWX//863zrXCplLEh8ODfcOFzrM7w65P//9hZnpheHh6Zg" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##Hcw9DoIwHAXwq5jOLM4OHMHE1Tj8Cy2U8tUC/UqcjLq7ewUXQzxATdw4hBfB4vLe@y2v6QAzMisbo9X3cluh2M7Taxp3flx/7u@rPx39eXpu/GM7R/MeAXVgjKMoQgD/wHgpjBdlGSs440WYQmhNiJR9H5BgkxiFAVSAs8Zpq4zSAT1mwHurapMMMnFlpqu8KIdGtIJnXas7ylJKUumq3BKow0lToMMP" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>η        # Get all prefixes of the (implicit) input-string
 ε       # Map over each prefix:
  R      #  Reverse it
   õ1ǝ   #  Remove the second character by inserting an empty string at index 1
      ć  #  Extract head; push remainder-string and first character separately
       Ã #  Keep all occurrences of this extracted head in the remainder-string
 }Åγ     # After the map: run-length encode the list of strings,
         # pushing a list of strings and list of counts of equal adjacent values
    ;    # Halve all counts
     î   # Ceil each
      O  # Sum those together
         # (which is output implicitly as result)
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 54 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>a=&gt;a.map(c=&gt;a[i+=a[c]?i%2?i-a[c]?3:1:2:1,c]=i,i=0)|i/2
                 ^    ^   ^          ^
             seen?    |   | Flip the seen
               even-th?   |
  seen early? (abc[a] | bca[a])
</code></pre>
<p><a href="https://tio.run/##TdDLTsMwEAXQvb/CG1RbJIamgKDI7YqvCJFwXCedvJyH6zgBvj2kL9RZjY7uncVkwopOtlAbv9I7NSV8EnwjWClqIuclhHsuQhlt4S7Ygn9aV@vlOlgvPRlx8IA/0h94CCaDOf5CQuD/8f0NXs4Sx7cSoBnEraxQmkKWQ55d5QU1Td8r1bbGnOUZydhJZ2Mh7Fle0Ti4sR@ss/1Z3pCJQeRmsJWTh1aORdqX@6w46KZu8rSr@y6BXaJ27VjuByWq@ZzOTtWnFfpipoWSUNbVBRiy@KwW9PQGh/kGuyvP6Yvbo9tLi9J3ZFii2w8h94SE4GEV0WPiGx8/k5CQMQbRHMNY6qrThWKFTonCnGPjYUPRL53@AA" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu5" class="pu"><h4><em>Implementing Jonah's smart trick</em></h4>
<p><em>saved 10 bytes thanks to @DominicVanEssen</em></p>
<h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a> 4.1, 82 bytes</h1>

<pre class="lang-r prettyprint-override"><code>a=\(v,x=1,j=duplicated(v))`if`(sum(j|1)&gt;x,1+a(v,x+2-(v[x]!=v[x+1]&amp;j[x]|j[x+1])),1)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=TZFNDoIwEIXjlgu4VUxMG8qi6kIT8RBu1cQKotR_hIrGm7jRhYfS0_iA0bj44PUxM6-0t0d8vz_TJHS7r6HyxsyIzJNCe0G6X0e-SuYBM5xPo3DKjumG6avkg0xIR-WVTstlZpRN6h6ejpw0NRZXXWjOheTl5Helavquz-yLLewzyECuT7Q25JnC4xaG81qj1rPKtgT2DERAgRVI_lq31O6DFMSk84g1WFDUBiyBJj-v3YED2NN7RfVH8k6kQ8oPSM9Jx5TznX2mb-pvX4b2vyuyf7_XaVvl-Xxv4AM" rel="nofollow noreferrer">Attempt this online!</a></p>
<hr />
<h4><em>Previous solution</em></h4>
<h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a> 4.1, 141 bytes</h1>

<pre class="lang-r prettyprint-override"><code>b=\(v,x){j=duplicated(v)
ifelse(is.na(v[3]),1,ifelse(j[x],1+b(v[v!=v[x]],x-1),ifelse(j[x+1],2+b(v[v!=v[x+1]],x)-(v[x]==v[x+1]),1+b(v,x+2))))}
</code></pre>
<p><a href="https://tio.run/##TVDbboQgFHz3L@oTRGzi9rV@ycYHRW1ZrVdE3abfbg8wbiSZzJnDcAaYjqNI66WTWvUdM2Ljv4@0XIZWyVxXJTM8UHXVzhVT83uXM3P/yLhIBJqP@5aJJCqob95SQyoTW5zwy36UZOJ2cZAmD4@ZdafocD9EbNGN0/o7hs9YsjAPBYEH40WJsHDgwfTqFoD1zq77RcpCER6EBnXjNA@0c42kLFagAiZAO/BgcW6JlI0gweaV7GHIbZz7SWqH64n5O06cJ1dyr86tMUdhToP080R3yV1wO4nJLd5qE34I33hzC2@PVw7gBv4ZvRV1jfwSdYV6Qs45e8defrnX@Q89/rdgg0gsjZ4mT7Mn7WnxZDytRMfxDw" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<h4>Test:</h4>
<pre class="lang-r prettyprint-override"><code>w&lt;-c(&quot;t&quot;,&quot;b&quot;,&quot;i&quot;,&quot;a&quot;,&quot;k&quot;,&quot;t&quot;,&quot;y&quot;,&quot;v&quot;,&quot;n&quot;,&quot;x&quot;,&quot;c&quot;,&quot;u&quot;,&quot;r&quot;,&quot;c&quot;,&quot;z&quot;,&quot;l&quot;,&quot;g&quot;,&quot;w&quot;,&quot;m&quot;,&quot;h&quot;,&quot;j&quot;,&quot;l&quot;,&quot;u&quot;,&quot;o&quot;,&quot;q&quot;,&quot;p&quot;,&quot;q&quot;,&quot;k&quot;,&quot;g&quot;,&quot;s&quot;,&quot;p&quot;,&quot;w&quot;,&quot;s&quot;,&quot;f&quot;,&quot;i&quot;,&quot;d&quot;,&quot;f&quot;,&quot;e&quot;,&quot;d&quot;,&quot;r&quot;,&quot;z&quot;,&quot;m&quot;,&quot;h&quot;,&quot;y&quot;,&quot;e&quot;,&quot;a&quot;,&quot;n&quot;,&quot;x&quot;,&quot;v&quot;,&quot;b&quot;,&quot;o&quot;,&quot;j&quot;)

b(w,1)
</code></pre>
<blockquote>
<p>43</p>
</blockquote>
<h4>Brief explanation:</h4>
<p>b is a recursive function with input:</p>
<ul>
<li>v a vector of characters</li>
<li>x the position of the first unknown element of v</li>
</ul>
<p>It proceeds :</p>
<ul>
<li>If v[x] is duplicated we use one move to remove that pair, and we continue with a shorter vector and one less known element.</li>
<li>If v[x+1] is duplicated we use a second move to remove its pair (but if its twin is v[x]), and we continue with a shorter vector and as many known elements.</li>
<li>Otherwise we use one move to see two more elements.</li>
</ul>
</div>
<div id="pu6" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8 (pre-release)</a>, 101 bytes</h1>
<p>This is a golfed version of Ajax1234 <a href="https://codegolf.stackexchange.com/a/265333/110585">answer</a>:</p>

<pre class="lang-python prettyprint-override"><code>lambda a,s=set():(A:=iter(a),len([s!=(s:=s-{v})or(K:=next(A))!=v and(s:=s|{v,K})for v in A]+[*s]))[1]
</code></pre>
<p><a href="https://tio.run/##ZY7BcoMgFEX3/QoyXQQSu@h003GGhet8gnXxUFCiggIBNM23W9NVq9tzzp33hsk1Wn18DmYR9GvpoGcVIEgstdxhkuIspdJxg4EkHVc4tweKbUrt290/iDb4klLFo8MZIQfqEajqV3/ffXJ5EKEN8kgqlBXn/GQLQvL3YhmMVA4LnJ@OAMcVvvwjjO0YY7uuruW1le11y8cxBM6NcW5rShbL6BmAfxr0ukba/A3mKc5h8tGH7dQxCa2bvIrlzZRzV4e@uXY3PQ5jW9shWCErwSsz983EQa1X9O4xEDPEOIsnX34A" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>This can be 85 bytes if we can take iterator as input, 95 bytes if you can accept &quot;outputs as length of list containing weird random stuff&quot;, and 80 bytes if both are allowed:)</p>
<p>85 bytes iterator solution:</p>
<pre class="lang-python prettyprint-override"><code>lambda A,s=set():len([s!=(s:=s-{v})or(K:=next(A))!=v and(s:=s|{v,K})for v in A]+[*s])
</code></pre>
<p><a href="https://tio.run/##bc65csMgGATgPk@BK0PsVGkymqFQ7UdwXPxIIKEDEGAux8@uHGWGdr@d2TXZj1q9fxi7C/q5L7CyHlB7dtRxj0mzcIWv7kCxa6h7e4Qn0RZfGqp48rgl5EADAtX/8dcjnC9PIrRFAUmF2tvp@upuZDdWKo8Flp5bfAQ4EkJe/oeM1WLGau1hkNMs56lC2xYj59Z6X8GOpS4FBhAqWHIqMYcUYgU9kzD7HFTq7rYryxDXcVruejPbPDgTnZC94L0t65g5qJ8RXXsHokBKRfzS/g0" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>25</s> 15 bytes</h1>
<pre><code>Ｉ⁻Ｌθ№⭆θ№…θ⊖κι00
</code></pre>
<p><a href="https://tio.run/##NYtBDoMgFESv0rjCpE3cd0mXNWnSEyB@AUEQ@Kh4eUqbdBazeG@GSxa4Y6aUV1AWCWURSa9siuQJVqAkvr1eqEvVvbFORM9W4v@IZm6ASvdDD@ABFrAII9FtvalvNV3XtDX3UnBQTGPe7MFT4KcR@yJnk5xfvRZx3eOkxgnGcC4yA7PHNri53DbzAQ" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation: Port of @UnrelatedString's Jelly answer, although I'm not entirely sure why it works.</p>
<pre><code>   θ            Input string
  Ｌ             Take the length
 ⁻              Subtract
      θ         Input string
     ⭆          Map over characters and join
         θ      Input string
        …       Truncated to length
           κ    Current index
          ⊖     Decremented
       №        Count of
            ι   Current character
    №           Count of
             00 Literal string `00`
Ｉ               Cast to string
                Implicitly print
</code></pre>
<p>Previous 25-byte solution:</p>
<pre><code>ＦＬθＭ⊕×⊕﹪ⅈ²№…θ⁻ι﹪ⅈ²§θι→Ｉ⊘ⅈ
</code></pre>
<p><a href="https://tio.run/##VU27DsIwENv5io4XCRZGOqEuIFEJIQbWkFybQJpr86Ll50Ngw4NlWX4IxZ0gbnLuyFVwQtsHBRNjVUsJ4WiFwwFtQAlXPaD/c1qS0RDcgK2rLSvUULQBmkUYbBSNMK2rVtvoQRfxHy68D0crcf6mNPs5u4vuVWD16uz0d4j7AAduUvkqvYI653DX/BmWZGcRnXib/jWoh4k0jdOz9@PLd1p2KN17UAtyO6c7PfImmQ8" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>ＦＬθ
</code></pre>
<p>Loop over the indices of the input.</p>
<pre><code>Ｍ⊕×⊕﹪ⅈ²№…θ⁻ι﹪ⅈ²§θι→
</code></pre>
<p>Calculate how many cards get turned as a result of this card. This is <code>1</code> for the card itself and then a possible further <code>1</code> or <code>2</code> if this card has been seen before depending on whether an even or odd number of cards have been turned so far, except in the odd case where the previous card is the one seen before.</p>
<pre><code>Ｉ⊘ⅈ
</code></pre>
<p>Output the number of turns (which is half of the number of cards turned).</p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language/a950ad7d925ec9316e3e2fb2cf5d49fd15d23e3d" rel="nofollow noreferrer">Retina 0.8.2</a>, <s>25</s> 20 bytes</h1>
<pre><code>(.)(?&lt;!\1..+)
1
11|.
</code></pre>
<p><a href="https://tio.run/##Dcy7DsIgFADQ/f6FgwmNCQm7iaM/4eCFAgX6glJe8d@xw1lPkNGs2O/k/e2EDuT1vH0YpY8BGDD2o70jAiLncEHQ2lhnnAXvc5YyhBhB8CJK4ogJWi0t11RShsgNuljTWsQZRJt1XiY7n5vfvdPHng9lRiXH0JapSlyvYLOAqmEpTf0B" rel="nofollow noreferrer" title="Retina 0.8.2 – Try It Online">Try it online!</a> Link includes test cases. Explanation: Port of @UnrelatedString's Jelly answer, as I don't see how it works, let alone ports @Jonah's J answer.</p>
<pre><code>(.)(?&lt;!\1..+)
1
</code></pre>
<p>Replace the first character of each pair with a <code>1</code>, but also the second if it's adjacent.</p>
<pre><code>11|.
</code></pre>
<p>Subtract the number of pairs of <code>1</code>s from the length of the string.</p>
<p>Would be <code>22</code> bytes as a one-liner: <code>((.)(?&lt;!\2..+)){1,2}|.</code></p>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="noreferrer">Jelly</a>, 10 bytes</h1>
<pre><code>ṪfṖƊƤŒɠHĊS
</code></pre>
<p><a href="https://tio.run/##DcwpEsIwFABQn5PhUcifNEmzdEmaZpMYZioRaASKQWI6SKAzHKNcJCCefZJqnUpZ5ytb59MyLZf38XPevKZtWR/35@G7v@1KAUAAGKM/QJwLqYSSyJgQKLXWOURwJNFjAI9yijkkH31ADgtQLvk2ktGSrHloaqnHzvRG8aEPAxMVo5XNTZ0otP@gkwhYhhgz@wE" rel="noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p>This alternate solution kinda grew alongside the one preserved below, for what it's worth. Ultimately derived from <a href="https://codegolf.stackexchange.com/a/265353/85334">Jonah's description of his J solution</a>, but whatever the actual code does I strongly suspect it isn't this.</p>
<pre><code>   ƊƤ         For every prefix:
Ṫ             Pop the last element
 f            and filter it by membership in
  Ṗ           all but the last remaining (after the pop!) elements.
     Œɠ       Take the lengths of all runs of consecutive equal results,
       H      halve
        Ċ     and ceiling them,
         S    and sum.
</code></pre>
<h1><a href="https://github.com/DennisMitchell/jelly" rel="noreferrer">Jelly</a>, <s>16</s> <s>13</s> <s>12</s> 11 bytes</h1>
<pre><code>ṪeṖƊƤœṣØ0KL
</code></pre>
<p><a href="https://tio.run/##Dcw7DsIgGADgndN4D72A4w8FyqMPaMtrdDFxNTHuOhlHl8axsffAi6DDt36Sah1LyfOD5vmyntb755zn23LdbHclv1/L8Xt47ksBQAAYoz9AnAuphJLIGO8ptXYcEcGBBIcBHEoxJB9dcB6NWIAao2sDmSxJmvumlnrqTG8UH3o/MFExWtnU1JFC@w86iYAlCCGxHw" rel="noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p><em>-1 kinda back-porting <a href="https://codegolf.stackexchange.com/a/265357/85334">Neil's Retina solution</a> since I don't actually have a clue why Jonah's pointer starts at 2 to begin with</em></p>
<p><em>-1 doing it again</em></p>
<p>Vague port of Jonah's J algorithm.</p>
<pre><code>   ƊƤ          For each prefix:
Ṫ              Is the last element
 e             also found
Ṫ Ṗ            two or more indices earlier?
     œṣØ0      Split on all non-overlapping occurrences of the substring 0,0,
         K     join on spaces,
          L    and take the length of that result.
</code></pre>
</div>
<div id="pu10" class="pu"><h1><a href="https://www.jsoftware.com" rel="noreferrer">J</a>, 35 bytes</h1>
<pre><code>[:#(#@]&lt;.[+2-{.+./@e.~2{.}.)~^:a:&amp;2
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=Nc9Ba8IwFAfwu58irmyZuGaz28SGCcJgp512FQdJTNqmam1Nk7Qyv8gu3cGvJPhtJiQeHo_34897vN8_2Z1v4z4eLcZ9HEPYu0FQgCkGEDyAJ4AvFSLw_vX5cayVCCfnYI6D-2C2eEPzYRTu0RA9zjg6RHv0gwaHb0zwXeSjp0GPs7QAIzAFAkBCoJuj60ypl2cvlF4zYydJksk8y6XXV6dlaQznVaWU94lzRi2zmhKivcfO28a2ptFWG-8v_qCiGclVozeW1RVrV4lZp3JVF-W2zJPd1uxEthR8WbXrtOFkc9ldSOi-6zrX_wE" rel="noreferrer">Attempt This Online!</a></p>
<p>A bit chonky as far as J code goes, but imo a nice simplification of the algorithm:</p>
<ul>
<li><p>We imagine a pointer, starting at index 2, pointing into our string:</p>
<pre><code>ggijkikj
  ^
01234567
</code></pre>
</li>
<li><p>On each iteration, we increment the pointer by 2 as a default</p>
<ul>
<li>But: If the character at the pointer, or the character to the right of the pointer, exists within any of the previous characters (left of the pointer), we only increment by 1.</li>
</ul>
</li>
<li><p>We keep incrementing until the pointer exceeds the length of the string</p>
</li>
<li><p>Our answer is the number of iterations that process took</p>
</li>
</ul>
<p>This approach has the advantage of reducing the number of rules/cases down to just a single rule: increment by 2 or 1, depending on whether the next two characters have been seen.  This avoids special-casing the <code>aa</code> case, or distinguishing between &quot;1st character was already seen&quot; and &quot;2nd character was already seen&quot;.</p>
</div>
<div id="pu11" class="pu"><h1>Python3, 126 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>def f(a):
 s,c=[],0
 while a:
  if(v:=a.pop(0))in s:s={*s}-{v}
  else:s={*s,*[v,(K:=a.pop(0))]*(v!=K)}
  c+=1
 return c+len(s)
</code></pre>
<p><a href="https://tio.run/##ZY7BboQgFEX3fgVNFwPWNtN0MzHxC@YTjAtAUEYHERCQyXy71XQz1eU997y8q2bbDvLnovSy1IwDDjHKE2AyWpRVdk6Ab0XPAF4ZEBy6vMBfalDwjJCQwOSmeKTm@flwz1VgvWF/JEtLl8Hri12l0L0VV7R59KP4ToBmdtJyDT2T0KBFaSEt5LBMTxifKoSSf4SQAyPk4DWNuHWiu@35OHrPmNbW7htKAg2OYOy2Bryv0qBfhTiH6GcXnN@fWiJwZ2cnA500jX3j7@2tn4ZRjV1jlDdc1JzVOt7bmWG5fhkOwzCPOITIN778Ag" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu12" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 57 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>a=&gt;a.map(c=&gt;a[n+=!i|a[c]&amp;i!=c,i=i||a[c]?0:c,c]=1,i=n=0)|n
</code></pre>
<p><a href="https://tio.run/##TdDNcsIgEAfwO0@BlwrTyGhtO/0Y7KlPkWZGgiSSD0gIEpLaZ0@j0dY9/fc3u3vYjDnWcCMru1B6J4aEDoxuGClZhfgYQnVPZ/LIQh7dyRnlgaTyeG4/lm884BFdjaToEh/VYCGFW8AY/KvFYgNXo8TxrTyAEditrEGayiyXeXaVZ1DXbSuEMdZO8gR47Ll3MWNukhfQd75vO@ddO8krsLFkue2c8vxgeF@kbbnPioOuqzpPm6ptErlLxM705b4TTI3ndHZefVyDLbFGlgiTpiqkRfMvNcfnT3hIN9BfeZy@uDu5u2xh/A4sSbT5ZHyPUCgDKCJ8mvgGEHKtGl0IUugUCUgpTFBICJERDv4jBj94@AU" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>We uncover cards from left to right and, for every next card <code>c</code>, with previous uncovered card in this turn <code>i</code>:</p>
<ul>
<li>Count an extra turn (<code>++n</code>) whenever:
<ul>
<li>This is the first card to uncover in this turn (<code>!i</code>): as a new turn;</li>
<li>This is the second card to uncover in this turn (<code>i</code>), AND the card just uncovered in the same turn does not equals to the current one (<code>i!=c</code>), AND the card just uncovered had already seen some time before (<code>a[c]</code>): as we need an extra turn to match these two cards;</li>
</ul>
</li>
<li>Leave this card uncovered for this turn (<code>i=c</code>) whenever:
<ul>
<li>This is the first card to uncover this turn (<code>!i</code>), AND this card is not ever seen before (<code>!a[c]</code>);</li>
</ul>
</li>
<li>Remember the card as a seen card (<code>a[c]=1</code>)</li>
</ul>
</div>
