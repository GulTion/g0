<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::98129</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>173</td><td>Scala</td><td>231104T004031Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/266451#266451">138 Aspe</a></td></tr>
<tr d-ix="1"><td>018</td><td>05AB1E</td><td>231103T095956Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/266430#266430">Kevin Cr</a></td></tr>
<tr d-ix="2"><td>067</td><td>R</td><td>161101T122911Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98205#98205">rturnbul</a></td></tr>
<tr d-ix="3"><td>139</td><td>Python</td><td>161101T214523Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98241#98241">Francisc</a></td></tr>
<tr d-ix="4"><td>012</td><td>Jelly</td><td>161101T210909Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98240#98240">miles</a></td></tr>
<tr d-ix="5"><td>347</td><td>Python 3</td><td>161101T172753Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98227#98227">Yodle</a></td></tr>
<tr d-ix="6"><td>3165</td><td>Python 3  165 Bytes</td><td>161101T153814Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98214#98214">biowease</a></td></tr>
<tr d-ix="7"><td>135</td><td>PHP</td><td>161101T153816Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98215#98215">CT14.IT</a></td></tr>
<tr d-ix="8"><td>017</td><td>MATL</td><td>161031T235301Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98173#98173">Luis Men</a></td></tr>
<tr d-ix="9"><td>089</td><td>JavaScript ES6</td><td>161101T005023Z</td><td><a href="https://codegolf.stackexchange.com/questions/98129/positional-bathroom-etiquette/98177#98177">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://www.scala-lang.org/" rel="nofollow noreferrer">Scala</a>, 173 bytes</h1>
<p>Golfed version. <a href="https://tio.run/##dVDLboMwELzzFatc8AqT2L0V4kj5gJ6qnqoenBgSIx6RgTQt4tupeahKCxlbsrQ7o5lxeZSp7IpDEh0reJE6h8Zx4CpTqAPyWhmdn8RufBFEJ8WuuUpDMmrojSoU5FlRRuW61N8RZQrDuDBEb30GVQE3n6OOiSQahXCZi40SbGAk/xlJz@AuKk9ksjqvL8UnSXxN/ScMLUFtM2yM0GEmVNuG1q8@lEMqwqhBz0q9@6HxOLYdgIpiyGwrIs2pDGBvjPx6H@t8YABvua5A2MpgcbHTKs1JTVac9eArxH6x2UB5LupUjZQA7Lq/c9V0Bt1cxaf1gtvk9MBtphji/WqW8jE2cxnxsNOImdOfcDPVch1@l26pzvh3rdN2Pw" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-scala prettyprint-override"><code>a=&gt;{var(m,r,x,d)=(9d,0,a.size,0d);for(i&lt;-0 to x-1)if(a(i)=='0'){d=0;for(j&lt;-0 to x-1)if(a(j)=='1')d+=math.pow(j-i,-2);if(d&lt;m){r=i;m=d}};a.substring(0,r)+'1'+a.substring(r+1)}
</code></pre>
<p>Ungolfed version. <a href="https://tio.run/##dVHLboMwELzzFaNcYisJMb01Cod@QE9VT1UPToDEEY/ImD5U8e3Uxg4hMizI9nh3Zne99ZHnvOuqwyU9KrxyUeIvAJI0Q0P4Dm9KivJEbwfEvRv44hKFRs8hG7DU@IZy/GjEwzwtT@rcX2aVBBHYb8DQlEroEOrULD8xfKcHiAyEE0ERx1iy5T3UKV1mlO7ci@VGy0en7g6rGAVX5/BafWuhDcQamyc6CmoD/2RUE@xRPOqZtsUIm2dJPLrd7crDujnU/YMStoakWJky9Tr2SI0jU1MbuIkUejyEy1O9w4uU/PfDDuVTj@e9FGoYzlXfqrwkDVlEzFi0oNQ4tlvU56rJExuyg3ab32e5r@f5rMi5J7K5TDPZPEZf3sCZqo8xL4u12Z6seZkeivNY0@1Eo@qm2rFv1wZt1/0D" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-scala prettyprint-override"><code>object Main {
  def u(a: String): String = {
    var m = 9.0
    var r = 0
    val x = a.length
    for (i &lt;- 0 until x) {
      var d = 0.0
      if (a(i) == '0') {
        for (j &lt;- 0 until x) {
          if (a(j) == '1') {
            d += math.pow(j - i, -2)
          }
        }
        if (d &lt; m) {
          r = i
          m = d
        }
      }
    }
    a.substring(0, r) + '1' + a.substring(r + 1)
  }

  def main(args: Array[String]): Unit = {
    println(u(&quot;1000001&quot;))    // should print: 1001001
    println(u(&quot;101010101&quot;))  // should print: 111010101
    println(u(&quot;100&quot;))        // should print: 101
    println(u(&quot;00000&quot;))      // should print: 10000
    println(u(&quot;1111111&quot;))    // should print: 1111111
    println(u(&quot;0100&quot;))       // should print: 0101
    println(u(&quot;101000&quot;))     // should print: 101001
  }
}
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 18 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>$āsƶ0Kδ-znD_°+OWkǝ
</code></pre>
<p>I/O as a list.</p>
<p>Port of <a href="https://codegolf.stackexchange.com/a/98240/52210"><em>@miles</em>' Jelly answer</a>, so make sure to upvote that answer as well!<br />
Unfortunately, dividing by 0 won't result in <code>INF</code> in 05AB1E like it does in Jelly and MATL, but instead in <code>0</code>. So 4 bytes (<code>D_°+</code>) are to account for that..</p>
<p><a href="https://tio.run/##yy9OTMpM/f9f5Uhj8bFtBt7ntuhW5bnEH9qg7R@efXzu///RhjoGOig4FgA" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfaXLf8PiI43Fx7YZeJ/boluV5xJ/aIO2f3j28bn/df5HRxvqGMChYawOmI@CoWIGQBquEiyGBMFyhnAZKBvIiwUA" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>$                  # Push 1 and the input-list
 ā                 # Push a list in the range [1,length] (without popping the list)
  s                # Swap so the input-list is at the top again
   ƶ               # Multiply each value by its 1-based index
    0K             # Remove all 0s
      δ-           # Pop both lists, and create a subtraction table
        z          # Convert each inner value to 1/value
         n         # Square each inner value
          D        # Duplicate this list
           _       # Check for each inner value whether it equals 0 (1 if 0; 0 otherwise)
            °      # Take 10 to the power this (10 if 0; 1 otherwise)
             +     # Add it to each value at the same positions
              O    # Sum each inner list
               W   # Push the minimum (without popping the list)
                k  # Pop both, and push the (first) (0-based) index of this minimum
                 ǝ # Insert the 1 at this index into the (implicit) input-list
                   # (after which the result is output implicitly)
</code></pre>
</div>
<div id="pu2" class="pu"><h1>R, <s>83</s> <s>76</s> 67 bytes</h1>
<p>Just realized that I can save several bytes by not bothering to check if the candidate urinals are empty. Non-empty urinals will always return an <code>Inf</code> discomfort value, so they're excluded in the course of the calculation. Also, just using direct indexing rather than <code>replace</code>, so it's shorter but less elegant.</p>
<pre><code>x=scan()
x[which.min(rowSums(outer(seq(x),which(!!x),`-`)^-2))]=1
x
</code></pre>
<h3>Explanation</h3>
<pre><code>x=scan()
</code></pre>
<p>We read the current state from stdin and call it <code>x</code>. We assume that the input is a sequence of <code>1</code>s and <code>0</code>s separated by spaces or newlines. For the purposes of the explanation, let's say we input <code>1 0 0 0 0 0 1</code>.</p>
<pre><code>x[which.min(rowSums(outer(seq(x),which(!!x),`-`)^-2))]=1
</code></pre>
<p>We replace a value of <code>x</code> at a particular index with 1. Everything between the <code>[ ]</code> is figuring out what the best index is.</p>
<p>Since the existing urinals are immutable, we don't need to consider the distances between them. We only need to consider the distances between the occupied urinals and the possible new one. So we determine the indices of the occupied urinals. We use <code>which</code>, a function to return the indices of a logical vector which are <code>TRUE</code>. All numbers in R, when coerced to type <code>logical</code>, are <code>TRUE</code> if nonzero and <code>FALSE</code> if zero. Simply doing <code>which(x)</code> will result in a type error, <code>argument to 'which' is not logical</code>, as <code>x</code> is a numeric vector. We therefore have to coerce it to logical. <code>!</code> is R's logical negation function, which automatically coerces to logical. Applying it twice, <code>!!x</code>, yields a vector of <code>TRUE</code> and <code>FALSE</code> indicating which urinals are occupied. (Alternative byte-equivalent coercions to logical involve the logical operators <code>&amp;</code> and <code>|</code> and the builtins <code>T</code> and <code>F</code>, e.g. <code>F|x</code> or <code>T&amp;x</code> and so on. <code>!!x</code> looks more exclamatory so we'll use that.)</p>
<pre><code>                                 which(!!x)
</code></pre>
<p>This is paired with <code>seq(x)</code>, which returns the integer sequence from <code>1</code> to the length of <code>x</code>, i.e. all urinal locations (and thus all possible locations to consider).</p>
<pre><code>                          seq(x)
</code></pre>
<p>Now we have the indices of our occupied urinals: <code>1 7</code> and our empty urinals <code>1 2 3 4 5 6 7</code>. We pass <code>`-`</code>, the subtraction function, to the <code>outer</code> function to get the &quot;outer subtraction&quot;, which is the following matrix of distances between all urinals and the occupied urinals:</p>
<blockquote>
<p>[,1] [,2]</p>
<p>[1,]    0   -6</p>
<p>[2,]    1   -5</p>
<p>[3,]    2   -4</p>
<p>[4,]    3   -3</p>
<p>[5,]    4   -2</p>
<p>[6,]    5   -1</p>
<p>[7,]    6    0</p>
</blockquote>
<pre><code>                    outer(seq(x),which(!!x),`-`)
</code></pre>
<p>We raise this to the <code>-2</code>th power. (For those who are a little lost, in the OP, &quot;discomfort&quot; is defined as <code>1 / (distance(x, y) * distance(x, y))</code>, which simplifies to <code>1/d(x,y)^2</code>, i.e. <code>d(x,y)^-2</code>.)</p>
<pre><code>                    outer(seq(x),which(!!x),`-`)^-2
</code></pre>
<p>Take the sum of each row in the matrix.</p>
<pre><code>            rowSums(outer(seq(x),which(!!x),`-`)^-2)
</code></pre>
<p>Get the index of the smallest value, i.e. the optimal urinal. In the case of multiple smallest values, the first (i.e. leftmost) one is returned.</p>
<pre><code>  which.min(rowSums(outer(seq(x),which(!!x),`-`)^-2))
</code></pre>
<p>And voilà, we have the index of the optimal urinal. We replace the value at this index in <code>x</code> with <code>1</code>. In the case of <code>1111</code> as input, it doesn't matter which one we replace, we'll still have a valid output.</p>
<pre><code>x[which.min(rowSums(outer(seq(x),which(!!x),`-`)^-2))]=1
</code></pre>
<p>Return the modified input.</p>
<pre><code>x
</code></pre>
</div>
<div id="pu3" class="pu"><h1>Python, <s>165</s> <s>163</s> <s>158</s> <s>147</s> <s>141</s> <s>140</s> 139 bytes</h1>
<pre><code>def u(p):e=enumerate;a=[(sum((i-j)**-2for j,y in e(p)if&quot;0&quot;&lt;y),i)for i,x in e(p)if&quot;1&quot;&gt;x];return a and p[:min(a)[1]]+&quot;1&quot;+p[min(a)[1]+1:] or p
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="http://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>13</s> 12 bytes</h1>

<pre><code>J_þTİ²SiṂ$Ṭo
</code></pre>

<p><a href="http://jelly.tryitonline.net/#code=Sl_DvlTEsMKyU2nhuYIk4bmsbw&amp;input=&amp;args=WzEsIDAsIDEsIDAsIDEsIDAsIDEsIDAsIDFd" rel="nofollow noreferrer">Try it online!</a> or <a href="http://jelly.tryitonline.net/#code=Sl_DvlTEsMKyU2nhuYIk4bmsbwrDh-KCrA&amp;input=&amp;args=W1sxLCAwLCAwLCAwLCAwLCAwLCAxXSwgWzEsIDAsIDEsIDAsIDEsIDAsIDEsIDAsIDFdLCBbMSwgMCwgMF0sIFswLCAwLCAwLCAwLCAwXSwgWzEsIDEsIDEsIDEsIDEsIDEsIDFdXQ" rel="nofollow noreferrer">Verify all test cases.</a></p>

<h2>Explanation</h2>

<pre><code>J_þTİ²SiṂ$Ṭo  Input: boolean array A
J             Indices, returns [1, 2, ..., len(A)]
   T          Truthy indices, returns the indices which have a truthy value
 _þ           Form the subtraction (_) table (þ) between them
    İ         Inverse, find the reciprocal of each
     ²        Square each
      S       Sum the sublists column-wise
         $    Monadic chain
        Ṃ       Minimum
       i        Find the first index of that
          Ṭ   Untruth indices, returns a boolean array with 1's at those indices
           o  Logical OR between that and A, and return
</code></pre>
</div>
<div id="pu5" class="pu"><h1>Python 3, <s>574</s> <s>471</s> 347 bytes</h1>
<p>I'll probably work on this some more, considering the other Python solution is like a fifth of this one :[.</p>
<pre><code>def a(I):
 D,l,r={},len(I),range
 for i in r(l):
  if I[i]&lt;1:
   n,t,n[i]=I[:],[],1
   for j in r(l):
    if n[j]&gt;0:
     q,Q=[],0
     for k in r(l):
      if k!=j and n[k]&gt;0:q.append((k-j,j-k)[k&lt;j])
     for i in q:Q+=1/(i**2)
    t.append(Q)
   T=sum(t)
   if T not in D.keys():D[T]=i
 if len(D)&gt;0:I[D[min(D.keys())]]=1
 print(I)
</code></pre>
<p>Well that's much better now that I've learned you can use single spaces.</p>
</div>
<div id="pu6" class="pu"><h1>Python 3 <s>223</s> <s>222</s> 165 Bytes</h1>

<p>Okay, I know this isn't the prettiest answer out there, and I'm sure it can be golfed down quite a bit, but I was just messing around and seeing what I could do</p>

<p>Shout out to mbomb007 for the tips on whitespace and comparators
Also, I saw my online character counter was taking all the tabs and turning them into spaces, so the count is a lot less than I originally had</p>

<pre><code>def u(a):
 m,r,x=9,0,len(a)
 for i in range(x): 
    d=0
    if a[i]&lt;'1':
     for j in range(x):
        if a[j]&gt;'0':d+=float((j-i)**-2)
     if d&lt;m:r=i;m=d
 return a[:r]+'1'+a[r+1:]
</code></pre>

<p>Showing revised whitespace:</p>

<pre><code>def u(a):
&lt;sp&gt; m,r,x=9,0,len(a)
&lt;sp&gt; for i in range(x): 
&lt;tab&gt; d=0
&lt;tab&gt; if a[i]&lt;'1':
&lt;tab&gt;&lt;sp&gt; for j in range(x):
&lt;tab&gt;&lt;tab&gt; if a[j]&gt;'0':d+=float((j-i)**-2)
&lt;tab&gt;&lt;sp&gt; if d&lt;m:r=i;m=d
&lt;sp&gt; return a[:r]+'1'+a[r+1:]
</code></pre>

<p>Original:</p>

<pre><code>def u(a):
    m,r,x=9,0,len(a)
    for i in range(x): 
        d=0
        if a[i]!='1':
            for j in range(x):
                if a[j]=='1':d+=float(1/(j-i)**2)
            if d&lt;m:r=i;m=d
    return a[:r]+'1'+a[r+1:]
</code></pre>

<p>This expects a string passed to it of 1's and 0's like <code>"10001"</code> and returns a string <code>"10101"</code> </p>

<p>Edit: Changed <code>1/float((j-i)**2)</code> to <code>float((j-i)**-2)</code></p>
</div>
<div id="pu7" class="pu"><h2>PHP, 135  bytes</h2>

<pre><code>$a=explode(1,$argv[1]);$b=0;foreach($a as$c=&gt;$d){$l=strlen($d);if($l&gt;$b){$b=$l;$e=$c;}}if($b)$a[$e][intval($b/2)]=1;echo implode(1,$a);
</code></pre>

<p>I'm sure there's a considerably quicker way of doing it, but I've got a fuzzy head and can't think of one!</p>

<h3>Old code</h3>

<p>The code without minification:</p>

<pre><code>$a=explode(1,$argv[1]);
$b=0;
foreach($a as $c=&gt;$d){
    $l=strlen($d);
    if($l&gt;$b){
        $b=$l;
        $e=$c;
    }
}
if($b){
    $a[$e][intval($b/2)]=1;
}
echo implode(1,$a);
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="http://github.com/lmendo/MATL" rel="noreferrer">MATL</a>, <s>19</s> <s>18</s> 17 bytes</h1>
<pre><code>lyf!Gn:-H_^Xs&amp;X&lt;(
</code></pre>
<p><a href="http://matl.tryitonline.net/#code=bHlmIUduOi1IX15YcyZYPCg&amp;input=WzEgMCAwIDAgMCAwIDFd" rel="noreferrer">Try it online!</a> Or <a href="http://matl.tryitonline.net/#code=YApseVhLZiFLbjotSF9eWHMmWDwoCkRU&amp;input=WzEgMCAwIDAgMCAwIDFdClsxIDAgMSAwIDEgMCAxIDAgMV0KWzEgMCAwXQpbMCAwIDAgMCAwXQpbMSAxIDEgMSAxIDEgMV0" rel="noreferrer">verify all test cases</a> (slightly modified code).</p>
<h3>Explanation</h3>
<p>It suffices to compute the distance from each potential new position to the already occupied ones. The remaining distances are do not depend on the potential new position, and so constitute a constant term, which can be ignored.</p>
<p>Let's take input <code>[1 0 0 0 0 0 1]</code> as an example.</p>
<pre><code>l      % Push 1
       % STACK: 1
y      % Take input implicitly. Duplicate from below
       % STACK: [1 0 0 0 0 0 1], 1, [1 0 0 0 0 0 1]
f!     % Indices of nonzero elements, as a column array
       % STACK: [1 0 0 0 0 0 1], 1, [1 7]
Gn:    % Push [1 2 ... n], where n is input size (array of possible positions)
       % STACK: [1 0 0 0 0 0 1], 1, [1; 7], [1 2 3 4 5 6 7]
-      % Matrix with all pairs of differences 
       % STACK: [1 0 0 0 0 0 1], 1, [1; 7], [0 -1 -2 -3 -4 -5 -6;
                                             6  5  4  3  2  1  0]
H_^    % Raise each entry to -2
       % STACK: [1 0 0 0 0 0 1], 1, [   Inf 1.0000 0.2500 0.1111 0.0625 0.0400 0.0278;
                                     0.0278 0.0400 0.0625 0.1111 0.2500 1.0000    Inf]
Xs     % Sum of each column
       % STACK: [1 0 0 0 0 0 1], 1, [Inf 1.04 0.3125 0.2222 0.3125 1.04 Inf]
&amp;X&lt;    % Index of minimum. Takes the first if there is a tie
       % STACK: [1 0 0 0 0 0 1], 1, 4
(      % Assign: write 1 at the position of the minimizer
       % STACK: [1 0 0 1 0 0 1]
       % Implicitly display
</code></pre>
</div>
<div id="pu9" class="pu"><h2>JavaScript (ES6), 89 bytes</h2>

<pre><code>a=&gt;a[a.map((e,i)=&gt;!e&amp;&amp;(t=0,a.map((e,j)=&gt;t+=(j-=i)&amp;&amp;e/j/j),t&lt;m&amp;&amp;(m=t,k=i)),k=0,m=1/0),k]=1
</code></pre>

<p>Outputs by modifying the input array.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/98129/">98129</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




