<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::275564</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>017</td><td>Vyxal</td><td>240917T203348Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275597#275597">emanresu</a></td></tr>
<tr d-ix="1"><td>176</td><td>Python 3</td><td>240917T185309Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275594#275594">The Empt</a></td></tr>
<tr d-ix="2"><td>016</td><td>Jelly</td><td>240916T234630Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275571#275571">Unrelate</a></td></tr>
<tr d-ix="3"><td>083</td><td>Python 3</td><td>240917T000136Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275572#275572">David Ch</a></td></tr>
<tr d-ix="4"><td>069</td><td>Ruby</td><td>240917T084403Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275580#275580">G B</a></td></tr>
<tr d-ix="5"><td>125</td><td>Wolfram Language Mathematica</td><td>240917T024742Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275575#275575">138 Aspe</a></td></tr>
<tr d-ix="6"><td>nan</td><td>Scala 3</td><td>240917T021529Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275573#275573">138 Aspe</a></td></tr>
<tr d-ix="7"><td>121</td><td>Javascript Node.JS</td><td>240917T021829Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275574#275574">Jake</a></td></tr>
<tr d-ix="8"><td>173</td><td>Perl 5.10</td><td>240916T221329Z</td><td><a href="https://codegolf.stackexchange.com/questions/275564/count-squares-in-my-pi-approximation/275568#275568">Kjetil S</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-2" rel="nofollow noreferrer">Vyxal</a>, 17 bytes</h1>
<pre><code>ƛEDẊ²Ṡ√&gt;∑;¦2Nȯ4Nβ
</code></pre>
<p><a href="https://vyxal.pythonanywhere.com/?v=2&amp;c=1#WyIiLCIiLCLGm0VE4bqKwrLhuaDiiJo+4oiRO8KmMk7IrzROzrIiLCIiLCI1Il0=" rel="nofollow noreferrer">Try it Online!</a></p>
<p>Mostly a port of <a href="https://codegolf.stackexchange.com/a/275571/100664">UnrelatedString's Jelly answer</a>. There's got to be a way to save a byte on the last bit.</p>
<pre><code>ƛ        ;        # Over 1...n
        ∑         # Count the number of 
  DẊ              # Pairs
 E                # Of 1...2^m
    ²Ṡ√           # Whose squared sums, sqrt'd
       &gt;          # Are less than
 E                # 2^m
          ¦       # Take the cumulative sum
           2Nȯ    # Take the last two items
              4Nβ # And convert from base -4
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 176 bytes</h1>

<pre class="lang-python prettyprint-override"><code>x=a=0;y=1
while 1:x*=4;z=len([*filter(lambda x:x[0]**2+x[1]**2&lt;4,(lambda i:[(x*i,y*i)for x in range(1,int(2/i+1))for y in range(1,int(2/i+1))])(y))])-x;a+=z;print(a);y/=2;x+=z;
</code></pre>
<p><a href="https://tio.run/##dclBDoMgEIXhfU/BEtBGsa7EOQlxQVOsk1A0hKSDl6ehSZfdvD9535HTtodbKQQWep1BXd4besfURBJGfYJ3gRu5ok8ucm9f94dlNJHpFymHhoyqncf2ZzgZThLbLFGse2TEMLBow9Nx1WJIfOiwUeJr@Y8tgue6V9K2gVMfsaIVOncwaKpXKR8" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>Outputs the sequence infinitely.</p>
<p><code>x</code> and <code>a</code> are initialized to <span class="math-container">\$0\$</span>, and <code>y</code> is initialized to <span class="math-container">\$1\$</span>.</p>
<p>It does this next paragraph forever:</p>
<p>It multiplies x by 4. It then creates a list of the possible top-right corners of the squares with size <code>y</code>, then removes the vertices which do not satisfy the condition <span class="math-container">\$x^2+y^2&lt;4\$</span>. It sets <code>z</code> to the number of vertices which haven't been removed. minus <code>x</code> from it. <code>z</code> is added to <code>a</code>. It prints the current value of <code>a</code>, and then divides <code>y</code> by <span class="math-container">\$2\$</span>, and adds <code>z</code> to x.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 16 bytes</h1>
<pre><code>4*p`ḋ`&lt;Ɗ)§Äṫ-ḅ-4
</code></pre>
<p><a href="https://tio.run/##AScA2P9qZWxsef//NCpwYOG4i2A8xoopwqfDhOG5qy3huIUtNP/Dhyn//zU" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p>VERY slow--times out for n=6, brute forcing <span class="math-container">\$16^6 = 2^{24}\$</span> calculations.</p>
<pre><code>  p`        For every pair of numbers from
4*          [1 .. 4^n],
    ḋ`      is its dot product with itself (sum of squares)
      &lt;Ɗ    less than 4^n?
</code></pre>
<p>See below for further explanation:</p>
<h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>18</s> 17 bytes</h1>
<pre><code>4*Æ²Ƈạ$)½Ḟ§Äṫ-ḅ-4
</code></pre>
<p><a href="https://tio.run/##AS4A0f9qZWxsef//NCrDhsKyxofhuqEkKcK94biewqfDhOG5qy3huIUtNP/Dhyn//zEw" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p><i>-1 thanks to Jonathan Allan</i></p>
<p>Takes n as input and outputs the nth element, computing the sequence as the cumulative sums of A177144 (number of squares added to areas not covered by squares in the previous iteration of A156790). Just barely beats the first-n-outputting <code>4*Æ²Ƈạ$)½Ḟ§×4ạḊƲÄṖ</code> and the somewhat faster <code>R2*R²ạ²Ʋ€½Ḟ§Äṫ-ḅ-4</code>.</p>
<pre><code>       )             For each m in [1 .. n],
          §          sum
        ½            the square roots
         Ḟ           floored
4*   ạ               of 4^n minus
  Æ²Ƈ $              every perfect square less than or equal to it.
            ṫ-       Last two
           Ä         cumulative sums
              ḅ-4    converted from base -4.
</code></pre>
<p><code>4*Æ²Ƈạ$)½Ḟ§ḋṬo-3Ɗ</code> and a few variants thereof tie, borrowing a little mathematical manipulation from <a href="https://codegolf.stackexchange.com/a/275572/85334">David Chew's Python solution</a>. Likewise <code>4*ṖṚÆ²T)½Ḟ§Äṫ-ḅ-4</code>. A faster 16 sounds almost possible.</p>
<p>...Come to think of it, <code>2*R²ạ²Ʋ)½Ḟ§Äṫ-ḅ-4</code> also ties. Not sure how I missed that one, but I still like the suggested version too :P</p>
<h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 37 bytes</h1>
<pre><code>2*R²ạ²Ʋ½ḞBUz0s&quot;J’2*Ʋ$Ṛ_ṂḤŒHƲ€Ẏ+ɗ\ẎṂ€S
</code></pre>
<p><a href="https://tio.run/##y0rNyan8/99IK@jQpoe7Fh7adGzTob0Pd8xzCq0yKFbyetQw00jr2CaVhztnxT/c2fRwx5KjkzyObXrUtObhrj7tk9NjgBRQHMgP/n@4XTPy/39LAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p>Utterly hopeless, but too fun an idea to pass up :P</p>
<p>Uses the binary expansion of each row to represent greedily filling it with powers of 2, then merges or explodes said powers of 2 into appropriate squares.</p>
<h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 31 bytes</h1>
<pre><code>U»\U)
2*R²ạ²Ʋ½Rọ2Ç2*«ZgJ€ƲÇFİ²S
</code></pre>
<p><a href="https://tio.run/##AUAAv/9qZWxsef//VcK7XFUpCjIqUsKy4bqhwrLGssK9UuG7jTLDhzIqwqtaZ0rigqzGssOHRsSwwrJT/8OHKVn//zEw" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p>Hacked together to try to do it graphically. Miraculously seems to work.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>100</s> <s>93</s> 83 bytes</h1>

<pre class="lang-python prettyprint-override"><code>lambda m:sum((4**n-i*i)**.5//1*(n//m*4-3)for n in range(m+1)for i in range(1,2**n))
</code></pre>
<p>(Old: <a href="https://tio.run/##XctJCoAwDEDRq3SZBAfqsFE8TEVbAxql1oWnr3UluP28f9xh2aWO0Q6r2cbJKOnOawNoiCRnYiQq2rLUdveKFYvyRtwMOqsSQOzd91kQzN@5JguMvyPh@EuVxu7wLAFc8hgf" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a>)</p>
<p>-7 bytes thanks to emanresuA: <a href="https://tio.run/##XYrBDoIwEAXvfsUedxcrKcKFxI@pwdZN5EEqHvz60nAx8TTJzKzf7bngWkq6vcJ8nwJhBAVMFBnieq1wXpp04BR/1/szM/eqcKYmqpehbX1cMhkZKAekB/tzVweR8uc7L@OaDRsntpp3" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>-10 bytes thanks to GB and emanresuA: <a href="https://tio.run/##XcsxDoMwDEDRq2S0TSEKoQtSb8ISBARL2KAUBk4fEEulru/rb@c@r@pz/HR5CdIPwUj7PQSgIdKSiZGoelvrCNRaoab0OK3JqGE1KWgcQQr3EP/Ivep7R8z/7rHdEusOEfjOFw" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>(Old: <code>f</code> calculates A156790 and the first lambda function takes the sum of the first <code>n</code> terms of A177144.)</p>
<p>Same as old, but <code>f</code> is combined with <code>g</code> by using a double <code>for</code> loop and <code>(n//m*4-3)</code>, which in this context is <code>1</code> only for <code>n==m</code> and <code>-3</code> otherwise.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, <s>93 ...</s> 69 bytes</h1>

<pre class="lang-ruby prettyprint-override"><code>-&gt;n{-3*(1..n).sum{|x|n=(1..2**x).sum{|i|((4**x-i*i)**0.5).to_i}}+n*4}
</code></pre>
<p><a href="https://tio.run/##KypNqvyfZvtf1y6vWtdYS8NQTy9PU6@4NLe6pqImzxbEN9LSqoAKZdZoaJgAubqZWpmaWloGeqaaeiX58Zm1tdp5Wia1/wsUQBoMDTT1chMLNNTSNP8DAA" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
<p>Using the same approach as @David Chew in his Python solution, avoiding recursion makes it shorter and faster.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 125 bytes</h1>
<p>use quick <code>floorSqrt</code> from <a href="https://mathematica.stackexchange.com/a/165047/79318">this answer</a>.</p>
<hr />
<p><a href="https://tio.run/##HctPC4IwHMbxu69CPJXM9qdORSBEdRU9/pi1ZNpg/lZzQRC9djOPD9/P06tw170KplHjwWrlITlbd1P2miZyNw45Xrb7k3XOQ/X0ASodCq8bMxiHgKTUyh7fD4caA/AVYxwlFVLKqJ2f1auHARabGjNTi6UkH0M4EdPkXxl1s5lktk7/sgUzC0bmPnYxzeNSYaeBkVgwGVNaeINh/AE" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-mathematica prettyprint-override"><code>s@n_:=Floor[Sqrt[SetPrecision[n,RealExponent[1.001n]/2]]]
f@n_:=Sum[s[(4^n-i^2)],{i,1,2^n-1}]
g@n_:=f@n-3*Sum[f[i],{i,0,n-1}]
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.scala-lang.org/" rel="nofollow noreferrer">Scala 3</a>, <del>173</del> 169 bytes</h1>
<p>Saved 4 bytes thanks to @Unrelated String</p>
<hr />
<p>Golfed version. <a href="https://ato.pxeger.com/run?1=NY6xTsMwFEX3fsVT1OG5kqM0XVBFkEAsSDAhpqqDW2Jj5DwH26FCqH_BxlIGkBBf1L_BcdLFfr7v-p77-eO3wojF3yrjZHfCUbY-ftjNc70NcCc0wfsE4LGW0MQHCqf8Ei6dE2-r--A0qTVbwgPpAFVyAkjrADWccyggWCgLNi4AXoUBV_vO9G6Fmo16G4OCIfSZwqlmcTkdbNng2Mdz_90Fyc-Ov31IW11pdUMBS5a3djfp-0mkZZRYhfOIbZFYHmwU-JzljWhRVxeNCE-5NNY6TKN_cQGxxXJGjI-JOiXG4P77te02pk7jrSXFct81CaZOsEhlfDHDIjLphJLJOBT-GosfDsP9Dw" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre class="lang-scala prettyprint-override"><code>val p=BigInt(2).pow
def f(n:Int)=(1to p(n).toInt-1).map(i=&gt;math.floor(math.sqrt((p(2*n)-BigInt(i).pow(2)).toDouble)).toLong).sum
def g(n:Int)=f(n)-3*(0to n-1).map(f).sum
</code></pre>
<p>Ungolfed version. <a href="https://ato.pxeger.com/run?1=dVLBSgMxEAWP_Yqh9JAo3dbWgxR7UFQQKghSL6KQtsk2kk222aQq0i_x0ot-lF_jZDe7tIKHHDLz3rx5j_n8LuZMseF2--Wd6J7-HKzM7IXPHdwyqeGjBbDgAjL8EGbTYgTn1rL3x3tnpU6f6AimWjoYl0gAYSwQCWdd6IMzMOjT2ABYMwWWF14FdEokjfUcBzmlSdFOSUdSbHYqWLtCbFrhxT0E0SO40Q51J0anje6aWdRzKDGG_qRV62Xs7YEpz7F6IVPkkQFNcvNKBnAImgL0enC18hKxXLuw8cmzbthKZqW1faqmiTP4h5I9zXNuIzKYl4CpuSUHy3TK_2RyDF47GQfvJ7OQQqBUs3C3VpVxYboDLlbW1b4y5pZJKJAwAle7NH6meA2vQjmKOKGMsaShBychxibniN9NPP03cdzDZ3eWr6XxxTU2SD_6w4gylhNBE0RUGWBs6GmIse-SSqFNdXnxAOtD_AU" rel="nofollow noreferrer">Attempt This Online!</a></p>
<pre class="lang-scala prettyprint-override"><code>object Main {
  def main(args: Array[String]): Unit = {
    for (i &lt;- 0 to 20) {
      val result = g(i)
      println(s&quot;g($i) = $result&quot;)
    }
  }

  def f(n: Int): Long = {
    var total = 0L
    val maxValue = BigInt(2).pow(2 * n)  // Equivalent to 4^n
    val limit = BigInt(2).pow(n).toInt   // Upper limit for i in the range
    for (i &lt;- 1 until limit) {
      val diff = maxValue - BigInt(i).pow(2)
      val sqrtValue = math.sqrt(diff.toDouble)
      total += math.floor(sqrtValue).toLong
    }
    total
  }

  def g(n: Int): Long = {
    val sumPreviousF = (0 until n).map(f).sum
    f(n) - 3 * sumPreviousF
  }
}
</code></pre>
<p> 
 
 </p>
<hr />
<p> 
 
 </p>
<p>ref Python code</p>
<pre class="lang-python prettyprint-override"><code>def f(n):
    &quot;&quot;&quot;
    Computes the sum over i from 1 to (2^n - 1) of the floor of sqrt(4^n - i^2).

    This function calculates the total integer parts of the square roots of (4^n - i^2)
    for each integer i in the range from 1 to 2^n - 1.
    &quot;&quot;&quot;
    total = 0
    max_value = 2 ** (2 * n)  # This is 4^n, since 4^n = (2^n)^2
    limit = 2 ** n  # The upper limit of the range for i

    for i in range(1, limit):
        # Calculate the square root of (4^n - i^2)
        sqrt_value = (max_value - i * i) ** 0.5
        # Add the floor of the square root to the total sum
        total += int(sqrt_value // 1)
    return total

def g(n):
    &quot;&quot;&quot;
    Computes the adjusted value g(n) by subtracting three times the sum of f(i) for i from 0 to n-1 from f(n).

    This function effectively isolates the new contributions at each level of n by removing
    overlapping counts from previous levels.
    &quot;&quot;&quot;
    sum_previous_f = sum(f(i) for i in range(n))  # Sum of f(i) for all i from 0 to n-1
    return f(n) - 3 * sum_previous_f

# Compute and print g(n) for n from 0 to 20
for i in range(21):
    result = g(i)
    print(f&quot;g({i}) = {result}&quot;)
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/nodejs" rel="nofollow noreferrer">Javascript (Node.JS)</a>, 121 bytes</h1>
<p><a href="https://tio.run/##bcxNDoIwEEDh25CZ/gWiOyiJG3Z6AWPMCBVraKsFTIx69srOjev35V3pQWMb7W2SPnQmpV57XUOjna73SqlNjPSEoqocHlQ03dwaABJHYXFhNsu2NF3UeI8TrBlz0jKL7xw5iRwRPMrfxP85EF@xBiwuOp1DBNJ5SVVRlPhqgx/DYNQQeuhhN7uTWTrniPhJXw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<pre class="lang-js prettyprint-override"><code>g=n=&gt;(F=m=&gt;[...Array(1&lt;&lt;m)].reduce((a,_,i)=&gt;(i&amp;&amp;Math.sqrt(4**m-i*i)|0)+a,0))(n)-[...Array(n)].reduce((a,_,i)=&gt;a+3*F(i),0)
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>.10, 173 bytes</h1>

<pre class="lang-perl prettyprint-override"><code>@c=[0,0,2,2];while(1){@c=grep<span class="math-container">$$_[2]**2+$$</span>_[3]**2&lt;4?0*$n++:1,map{($a,$b,$c,$d)=@$_;$X=($a+$c)/2;$Y=($b+$d)/2;[$a,$b,$X,$Y],[$X,$b,$c,$Y],[$a,$Y,$X,$d],[$X,$Y,$c,$d]}@c;say$n}
</code></pre>
<p><a href="https://tio.run/##LYzLDoIwEEV/ZhZAR22rbqyN/IB7SEMIFKIkCA0YjUF@3Voeq7nnnpkxZVcfLXwlEzbUUlGkyJEn4n2v6tJj/uDaW1cagFTxJAg4mdJ@SufDhQbQEHJi@MjM4EGGkCNohMKXIaQCIulKAtrfcQGxg5w450CtuxFCnKCa5nI5k3Px7IrVxcvXZAy16LMPNKO1v9Y8q7bp7eb6Om4Z/QM" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a> outputs
1,
5,
14,
33,
71,
140,
274,
563,
1083,
2159,
4293,
8391
before it times out after one minute.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/275564/">275564</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




