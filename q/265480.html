<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::265480</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>122</td><td>JavaScript ES6</td><td>230925T135320Z</td><td><a href="https://codegolf.stackexchange.com/questions/265480/do-you-win-a-numeric-mahjong/265485#265485">Arnauld</a></td></tr>
<tr d-ix="1"><td>038</td><td>05AB1E</td><td>230925T115608Z</td><td><a href="https://codegolf.stackexchange.com/questions/265480/do-you-win-a-numeric-mahjong/265483#265483">Command </a></td></tr>
<tr d-ix="2"><td>050</td><td>Jelly</td><td>230925T195356Z</td><td><a href="https://codegolf.stackexchange.com/questions/265480/do-you-win-a-numeric-mahjong/265490#265490">Nick Ken</a></td></tr>
<tr d-ix="3"><td>122</td><td>Charcoal</td><td>230925T115524Z</td><td><a href="https://codegolf.stackexchange.com/questions/265480/do-you-win-a-numeric-mahjong/265482#265482">Neil</a></td></tr>
<tr d-ix="4"><td>121</td><td>Raku</td><td>230925T195007Z</td><td><a href="https://codegolf.stackexchange.com/questions/265480/do-you-win-a-numeric-mahjong/265489#265489">Sean</a></td></tr>
<tr d-ix="5"><td>122</td><td>JavaScript Node.js</td><td>230925T192448Z</td><td><a href="https://codegolf.stackexchange.com/questions/265480/do-you-win-a-numeric-mahjong/265488#265488">l4m2</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript (ES6), <s> 143 </s> 122 bytes</h1>
<p><em>-21 bytes thanks to <a href="https://codegolf.stackexchange.com/users/44718/tsh">@tsh</a>!</em></p>
<p>Expects an <code>Uint32Array</code>. Returns a Boolean value.</p>

<pre class="lang-javascript prettyprint-override"><code>p=&gt;(q=([v,...f],e)=&gt;5/v?[e,2,2.5].some(t=&gt;q(f.filter(i=&gt;n&gt;t|i-v-t%1*n*2||++n%1,n=1),t&lt;n?e&lt;&lt;t%2:0)):e&gt;1)(p.sort(),[1,]?1:1)
</code></pre>
<p><a href="https://tio.run/##nZDfb8IgEMff@1cQExNQZEK1/gSzh/kXuCfGQ@Po7NJRpayLif97V8vsuu1t5HMXcncc37vXuIyLvU2PbmTyZ11teXXkAp44lCUmhCQKa8TF9K7cSI0ZZmSqSJG/aei4OMGEJGnmtIUpF0a4SzoqR65PB2bALpfh0PQpNpwi7NZmo9dr12fLMUJLLSiCx7qPdRBhSbHa0CVF1T43RZ5pkuUvsCd39t0dzqqHVoEMAJBjDMYKX2@LxQKDb0dZOPHepykG7EbYhuqSWROa3pjXaQyiusuvd2HD5IavjhrqFrO2uoV1f/T4oqvmv6hABSTJ7UO8P8AYcAG6k2@h0R/gMTUuZPfWxmcYo/qsguDHfp6M3MZZ0VnQl65WXtjonnXna7X6yeYNNPIWMm/R5Gr/E1l9Ag" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>The above function is too slow to validate itself on TIO, so this is using my original answer with an additional optimization:</p>
<p><a href="https://tio.run/##Xc/NToQwEMDx@z4FbrJkCkPddt0LS9noYd/AE@FAsDVs2JaPijHh3XEwxqhzbCb9/@ZaTdVYD03nE@te9HJRi1E59AqKCTnnpkSt9kzl4n4660yGYSHxAY8lH91Ng6ddqwQ6ZbhpWq8HaFRuI5n7uUmmxO9kZOf5Lo4tw6/nMOzBoY7BZwdGk2qlBAND/w0eGFta7YOaKIEKtt1/CkGOBCk0SpT8l6KHP4CfvIioOs/U3wkkKUOfWTokI1m6X/M51bvvOhYCy7NIBdueNpva2dG1mrfuFS5g9Xvw3Fh/kI/DUH3A05sxVFup6x2n5RM" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E" rel="nofollow noreferrer">05AB1E</a>, <s>47</s> <s>47</s> <s>44</s> <s>41</s> 38 bytes</h1>
<pre><code>œʒ3ôʒ¥J&gt;}gy3ôʒ¥T&gt;SQ}g+3*Ig&gt;Q}ćQ,¥›HUyy
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f//6ORTk4wPbzk16dBSL7va9EooO8QuOLA2XdtYyzPdLrD2SHugzqGljxp2eYRWVv7/H22oo2Cko2Cso2Cio2AaCwA" rel="nofollow noreferrer">Try it online!</a>, or <a href="https://tio.run/##yy9OTMpM/V9Waa@koGunoGRfeWjl/6OTT00yPrzl1KRDS73satMroewQu@DA2nRtY61D69LtAmuPtAfqHFr6qGGXR2hl5f//0dGxOgrRhiDCQEfBAMzRUTDWUTDVUTDXUbCEChjBkDFIwNLSEigFJwyNjE0gJEI10ASgmGlsLAA" rel="nofollow noreferrer">try all test cases (this code can handle in under a minute)</a>.</p>
<p><a href="https://tio.run/##yy9OTMpM/a/0/@jkU5OMD285NenQUi@72vRKKDvELjiwNl3bWMsz3S6w9kh7oM6hpY8adnmEVlb@Vzq07cKec1uP7jvSVpxdW11Waa@koGunoGQPEqk8vEKn9j8A" rel="nofollow noreferrer">See the codepoints</a></p>
<p>Returns <code>0</code> for true and <code>[]</code> for false.</p>
<h2>Explanation</h2>
<p>The general approach is this: Test for the existence of a permutation such that if we split it to parts of length 3, and then keep all the valid ones and count them, and multiply by 3, we should get 1 plus the length of the original input.</p>
<pre><code>œ       # all permutations
ʒ       # keep those such that:
 3ô      # split to parts of length 3
 ʒ       # keep parts where:
  ¥       # their differences
  J       # joined to a string
  &gt;       # plus one
 }       # (is equal to 1)
 g       # find the length
 y       # push the input again
 3ô      # and split to parts of length 3
 ʒ       # keep parts such that:
  ¥      # their differences
  T&gt;     # 11
  S      # [1, 1]
  Q      # [1, 1] is equal to the differences
 }
 g       # take their lengths
 +       # sum the lengths of the two types of parts
 3*      # times 3
 I       # input
 g       # length
 &gt;       # plus one
 Q       # is equal to the number of valid parts times 3
}
ćQ      # test whether the array is empty, by comparing arr[0] == arr[1:]
,        # output - this suppresses implicit output, so the rest of the code doesn't matter
¥›HUyy  # filler to satisfy the self validation requirement
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 50 bytes</h1>
<pre><code>°þþ&amp;&amp;,@ƑƒWß»Ȥ
WÞW+þ@3’œ&amp;ƑƇœ-@€Ʋ€Ẏ$ƬẎŒɠ%¹Ƈɗ€3‘œ&amp;ƑƇ3
</code></pre>
<p><a href="https://tio.run/##y0rNyan8///QhsP7Du9TU9NxODbx2KTww/MP7T6xhCv88Lxw7cP7HIwfNcw8OlkNKNV@dLKuw6OmNcc2AYmHu/pUjoHIo5NOLlA9tPNY@8npQGGg6hlQ1cb/D@08PMMr89HGdUAjjnX5H5tof7j94a4dXA937ju0E8S1ftQwR0HXTuFRw1zrw@1cD3dvOTopDGjK4XYgEfn/v5KSUrSBjoJBLFe0paWljgKCMDQyNoGQQDlDHQUjGDKG8IGS5mC@KQxZAOV0FMyA@pF1GIORCQxBlJqBEVC/OUQpHBkhWwRBQBUgF2KiWC4lrAF7aBvlIavEFQ1yGcR1xmA3m8M9BncnxEsWYGRoBsHGRhBsZgLCscAABgA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
<p>The main part is a monadic link that takes a list of integers and returns an empty list for false and a list containing one or more items for truthy. To meet the challenge rules, the program includes another link above the main one which is just filler.</p>
<p>Completes all test cases including itself in about 17 seconds on TIO. Full explanation to follow. Note the footer turns the falsy and truthy outcomes to 0 and 1 for more compact printing.</p>
<p>General explanation:</p>
<ul>
<li>Remove every possible combination of runs of three (including removing none)</li>
<li>Check the remaining integers are in groups of length 0 mod 3, except for one that is of length 2 mod 3</li>
</ul>
<h2>Explanation</h2>
<pre><code>°þþ&amp;&amp;,@ƑƒWß»Ȥ | Filler to meet challenge requirements

WÞ                                   | Sort (technically with order based on that after wrapping each item in a list, but this doesn't affect sort order)
  W                                  | Wrap in a list
                   $Ƭ                | Repeat the following until no changes are made, gathering up intermediate results
                Ʋ€                   | - For each list in the lists of lists (example for e.g. [1, 2, 3, 4, 4])
   +þ@3                              |   - Outer addition using 1, 2, 3 e.g. [[[2, 3, 4], [3, 4, 5], [4, 5, 6], [5, 6, 7], [5, 6, 7]]
       ’                             |   - Decrease by 1 e.g. [[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6], [4, 5, 6]]
        œ&amp;ƑƇ                         |   - Filter, keeping only those lists that were seen in the original list e.g. [[1, 2, 3], [2, 3, 4]]
            œ-@€                     |   - Filter the original list removing each of these in turn [[4, 4], [1, 4]]
                  Ẏ                  | - Join inner lists together, leaving one list of lists
                     Ẏ               | Join all gathered intermediate results into one list of lists
                           ɗ€        | For each list within this list:
                      Œɠ             | - Run lengths
                        %    3       | - Mod 3
                         ¹Ƈ          | - Only keep those non-zero (i.e. those lists that were not a multiple of 3 in length)
                              ‘      | Increase by 1
                               œ&amp;ƑƇ3 | Only keep those that consist of a single 3
</code></pre>
<p>Some of the code above (e.g. using <code>WÞ</code> rather than <code>Ṣ</code>) would be suboptimal in normal code-golf challenges, but here improve length by reducing the amount of filler required.</p>
<p>The runtime is sufficient to complete all the test cases, but as written becomes very inefficient as the number of runs of three consecutive numbers increases. This can be greatly improved by adding a uniquify step (<a href="https://tio.run/##y0rNyan8///QBp3D@w7vU1NVdTg28dik8MPzD@0@sSQw8FjXsS6u8MPzwrUP73MwftQw8@hkNaCC9qOTdR0eNa05tglIPNzVB1IHoo9OOrlA9dDOY@0npwMlgOpnQNUb/z@08/AMr8xHG9cBDTnW5X9sov3h9oe7dnA93Lnv0E4Q1/pRwxwFXTuFRw1zrQ@3cz3cveXopDCgKYfbgUTk//9KSkrRBjoKBrFc0ZaWljoKCMLQyNgEQgLlDHUUjGDIGMIHSpqD@aYwZAGU01EwA@pH1mEMRiYwBFFqBkZA/eYQpXBkhGwRBAFVgFyIiWK5lPCF8KFt1AhiJa5okBMhzjQGO94c7kO4gyF@swAjQzMINjaCYDMTEI4FhjQA" rel="nofollow noreferrer">TIO</a>), reducing the run time for all test cases and my original code down to ~0.3 seconds total).</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>128</s> <s>125</s> 122 bytes</h1>
<pre><code>¿⁼²﹪Ｌθ³«≔⟦⟧η≔⟦⟧ζＷ⌊⁻θη«⊞ηι⊞ζ⟦ι№θι⟧»⊞υζＦυ¿⁼¹ＬΦι﹪§κ¹↔³Ｐ¹Ｆη¿⁼³ＬΦι×§λ¹›²↔⁻κ§λ⁰⊞υＥι⟦§λ⁰⁻§λ¹›²↔⁻κ§λ⁰⟧»Ｗ›ηη«⊞⊞⌊⌊№№≔Φ﹪××⁻⁻¹ＥＥＦＰＰＷ∕»
</code></pre>
<p><a href="https://tio.run/##fY/BagIxEIZfpQ/gpdrah1n2IF56KBR8AhdUXOlx697qyQjag7hgNpuAMHuP7zAvkEfY/hMrvRU@SJh8M/Nn/DqajN9Hb11HF84cnYLZB/fta6rowHnBG8Wbndd/13Nwmj9WnFlfew1p9eW1N3KcoeA2W@PFwCWL6nUuLeo6vy0wMh0W9tDON2R4UVAV3FFeFAZGq/q12hKShTRt6ARTtjZS4uwYZwe3lVXqXsvsPw2SSNJPGyS@RRfwGTBbC3nhFaK1ZVuiVcYh1jaiEDKieflJtuuS5LH30I8MIk93niPDyAtI0x8" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Uses the Charcoal code page. Outputs a Charcoal boolean, i.e. <code>-</code> for a winning hand, nothing if not. Explanation:</p>
<pre><code>¿⁼²﹪Ｌθ³«
</code></pre>
<p>Check that the length is satisfactory.</p>
<pre><code>≔⟦⟧η≔⟦⟧ζＷ⌊⁻θη«⊞ηι⊞ζ⟦ι№θι⟧»
</code></pre>
<p>Count the number of times each number appears in the array.</p>
<pre><code>⊞υζＦυ
</code></pre>
<p>Start a breadth first search with the original list of counts.</p>
<pre><code>¿⁼¹ＬΦι﹪§κ¹↔³Ｐ¹
</code></pre>
<p>If this hand is all sets of <code>3</code> identical numbers except one, then it is a winning hand. Otherwise:</p>
<pre><code>Ｆη
</code></pre>
<p>Loop over all numbers that appeared.</p>
<pre><code>¿⁼³ＬΦι×§λ¹›²↔⁻κ§λ⁰
</code></pre>
<p>Check to see whether this number might be the middle of a run of three.</p>
<pre><code>⊞υＥι⟦§λ⁰⁻§λ¹›²↔⁻κ§λ⁰⟧»
</code></pre>
<p>If so then remove that run and add the result to the list of hands to check.</p>
<pre><code>Ｗ›ηη«⊞⊞⌊⌊№№≔Φ﹪××⁻⁻¹ＥＥＦＰＰＷ∕»
</code></pre>
<p>Filler bytes to satisfy the source layout, wrapped in a <code>while</code> loop whose condition (value greater than itself) can never be true.</p>
<p>128 bytes for an optimised version that's just about fast enough to verify its own bytes:</p>
<pre><code>¿⁼²﹪Ｌθ³«≔⟦⟧η≔⟦⟧ζＷ⌊⁻θη«⊞ηι⊞ζ⟦ι№θι⟧»⊞υζＦυ¿⁼¹ＬΦι﹪§κ¹↔³Ｐ¹Ｆ⁻ＥΦη⁼³ＬΦι×§μ¹›²↔⁻κ§μ⁰Ｅι⟦§μ⁰⁻§μ¹›²↔⁻κ§μ⁰⟧υ⊞υκ»¿›ηη«⊞⊞⌊⌊№№≔﹪××⁻¹ＥＦＰＰＷＷ∕κκυυ»
</code></pre>
<p><a href="https://tio.run/##pVLBasJAEP2VfkAPWhtNvkU8bGJCD4VCTz0qaKnSo9VbPRmh7UEUjImBwnrf/MP@QD4hndkNzNjiqbA819k3b97MJLgTj8GDuK8q@a2HudyW6UeZf6mD3MlPPZnpZayXa5XQdV/miX6d6uFRHVQCpOm7SlSKP3ugwG00h5cUuPII0WKMKXExtgVSVAcW1JFrlclUP8/krsw3@BKDapmv4D1B7q7mnhZAhVQ9yOQW@Fg7w5AebpAOteL6Lzxd5oKlYmwtZfIIfgYZWLc94IGu4IzmeCYzcHhanBaoCNZW4A5cmpPgCF7eVKayYgyNHauq2208@dH1FWDf4A2icBCDADFqmnjLxF1E18T7vkGTFV6IR8LcO4hNzyj0SdNmWc2GQ5HQo0it4FPcdZmCR7UEz2K5QZsiZ502qUfRIjXbu7g1EZ@YXpvm0G8whTb1FThMzWW1WhdqCVaLufJD2oXH9K2fM36D6tbTuMCxCv@vVW/W@T3tmu@xOYdsp392bdF@FU22WZd9S/UuBEO@O4fmbzdSY4dhQN4sRsyz8Hq9Hw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Add the <code>-x</code> argument to show the hex dump which you can compare against the input.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://raku.org/" rel="nofollow noreferrer">Raku</a>, 121 bytes</h1>
<pre><code>{sub k(\u){u{*}~~[.2/.1]||?(u{*}:k).grep:{?grep {u (&gt;)$_&amp;&amp;k u (-)$_},^3+$_,[$_,$_,$_]}}(bag |$_)}###:~%')+//&gt;&gt;?\]cbbetprr
</code></pre>
<p><a href="https://tio.run/##ZY5NboMwEIX3PcUoUGo3LgSbQqAKHIRQFCrIgkRFpCwiA1en/oEkVaXv2da88ZtpyvbkT@crWBXsJn7pCqjRvsO846/DOKY2dWw36/sEyUJUY/vYlk3EE3kB755QjM3csmroAL2J50A@2drMSSqkyIYBFYcj9GaOB8MwovH5Ba8dJ46TffZVFOVP07bTB1wOV1iZud2IjRCGXQy8ApG3guq7hXRDYJMRSMMwJHA/XMo8fUrTJUAX2FwQdqAK7wtbYRLwRcKfP0zhLeheXyECgrn3Bn2cpZEtcs//SEcFzClMhQf3FW6BevhW4fpajGr5nlQ2/QI" rel="nofollow noreferrer" title="Perl 6 – Try It Online">Try it online!</a></p>
<p>The inner subroutine name <code>k</code> and its argument <code>u</code> were somewhat haphazardly chosen to try to produce more triples and runs.</p>
<ul>
<li><code>bag |$_</code> converts the argument list into a <code>Bag</code> (a set with multiplicity) which is then given to the inner recursive subroutine <code>k</code>.</li>
<li>The subroutine returns true if <code>u{*} ~~ [.2/.1]</code>, that is, if the bag contains a single element with multiplicity 2.  This is the pair that a winning mah jong hand must contain.</li>
<li>Otherwise, for the keys 𝑥 in the bag (<code>u{*}:k</code>), return true if the bag is a superset (<code>u (&gt;) $_</code>) of either the run 𝑥, 𝑥 + 1, 𝑥 + 2 (<code>^3 + $_</code>) or the triple 𝑥, 𝑥, 𝑥 (<code>[$_, $_, $_]</code>), and the bag minus those elements (<code>u (-) $_</code>) produces a true result when passed to the inner recursive function <code>k</code>.  (Normally I prefer using the Unicode characters for superset (<code>⊃</code>) and set minus (<code>∖</code>), which are the same number of bytes as the equivalent plain ASCII operators (<code>(&gt;)</code> and <code>(-)</code> respectively), but then I'd have to repeat both of them twice in the trailing comment for a substantial byte penalty.)</li>
</ul>
<p>Of course, the trailing comment <code>###:~%')+//&gt;&gt;?\]cbbetprr</code> makes the overall code snippet into a winning numerical mah jong hand.  The function takes an infeasibly long time to validate itself; I constructed the comment by visual inspection of the function's character distribution.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 122 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(A,e,k,n)=&gt;1/n&amp;&amp;!{'1,1':1,'0,0':'B\():'|1}[[e-k,k-n]]?!!0:A+A?A.some((C,j)=&gt;f(A.filter(B=&gt;j--),C,...1/n?[]:[e,k])):e==+k
</code></pre>
<p><a href="https://tio.run/##jZBRT4MwEMff@RTdHkabHZXChA3TLWxxn8C3rg9kFjdAMDBNjPrZsaMOUV9Mfndp7q53/7sseUmafX18Ojllda/aLW9TjmNQkENJ@JJdlZPJ6M1mwOyIge2Ca0f2eodJZL@zDyGUk0PulFKuRiM3iqfxKqZN9agw3kCmG6Q4pumxOKkar/kycxwCG6CU6sYrISOhB0lCIsX5NG/3VdlUhaJF9YDH4q5@Ph1e5ZjcWMJCSLiAXAnn12KxAPTtmOfPjDdpBsi74PchXRJ2oesLc50GFOguv/75HbMLpjro0C3CvrrHG040mKKz5r/onLRoWtW3yf6AE8SXaLj6FieE6K2tH/fYlWKbFM3gIF86ejl@pzMc7tNrM5vMO1hgzPeMBbOzyf9oaj8B" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>Besides tuplets: <code>&amp;&amp; ++,,-- --..// AABBCC [\] ijjkkl mno rst {|}</code></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/265480/">265480</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




