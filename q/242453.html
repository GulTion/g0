<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::242453</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>212</td><td>C gcc</td><td>220214T153924Z</td><td><a href="https://codegolf.stackexchange.com/questions/242453/retaining-water/242825#242825">veqtrus</a></td></tr>
<tr d-ix="1"><td>108</td><td>Charcoal</td><td>220213T191353Z</td><td><a href="https://codegolf.stackexchange.com/questions/242453/retaining-water/242794#242794">Neil</a></td></tr>
<tr d-ix="2"><td>230</td><td>Python 3</td><td>220207T122446Z</td><td><a href="https://codegolf.stackexchange.com/questions/242453/retaining-water/242481#242481">Parcly T</a></td></tr>
<tr d-ix="3"><td>143</td><td>JavaScript Node.js</td><td>220207T165548Z</td><td><a href="https://codegolf.stackexchange.com/questions/242453/retaining-water/242500#242500">l4m2</a></td></tr>
<tr d-ix="4"><td>267</td><td>MATLAB</td><td>220207T205335Z</td><td><a href="https://codegolf.stackexchange.com/questions/242453/retaining-water/242508#242508">robbie c</a></td></tr>
<tr d-ix="5"><td>259</td><td>Python3</td><td>220207T071749Z</td><td><a href="https://codegolf.stackexchange.com/questions/242453/retaining-water/242454#242454">DialFros</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, <s>224</s> <s>214</s> <s>213</s> 212 bytes</h1>
<p>-10 bytes by using ternaries (thanks @ceilingcat) and simplifying parameter declaration</p>
<p>-1 bytes by using <code>for</code> instead of <code>do while</code> (thanks @ceilingcat)</p>
<p>-1 bytes by initialising <code>L</code> and <code>m</code> together (thanks @ceilingcat)</p>

<pre class="lang-c prettyprint-override"><code>#define F for(m=0,j=10;j--;)for(i=10;i--;)
#define L l[j+1][i+1]
#define C(y,x)m=L&gt;h[j][i]&amp;L&gt;l[y+j][x+i]?--L:m;
f(int**h){int m,j,i,l[12][12]={};F L=m=26;for(;m;)F{C(,1)C(1,)C(1,2)C(2,1)}F m+=L-h[j][i];return m;}
</code></pre>
<p><a href="https://tio.run/##rVBdb5swFH2Of4XXaosJJsJRh7a6zpSw8IQ0LXupwnjgsxgBqQhorSJ@e3aNWMKkdurDjuTrc4@POJcbGQ9RdDpdx0kqqwQ7ON3XpBQmzQUzeW4YXFOKVJ1UHfpjdXHh5TrzPQnlrNrkmT5ppXCXmZfDm//BXRbesw78SZf@F8Nwb0uOUiKrZjbLtCPcuKQ5lbTw2MJXRxw77mBXlGJhcZXOS645R5tQptmE0b4soC5A6Bxc6sI1hjheJ01bV7jk3elaVlHRxsndoYnlfp4tUR8WyIpoRzRRjYTkzGOmrw6dBeriaBJlQY1Dj1mqifdgnqg5cgEruVN70XX1BVAfkuZAQsosqkIqjfdqvzFYmPJK8CpxMkwoQijGdDXVWW8OQBbqTXUdnMcaJkvJ1fv4Z3VFUxJo/Vdfiup@ZbJIyCx8J6bzKSjdaXcG2q0G/G96iRjz3XbAq9QZAPTrgLfQUdz9Gej@B2ALA71KFeyL116v13/R7YvqKGIcve3/fbPZvJWu/mH4fqGjiDlC39rmsW3wIdu3RYzD5BYhZpkmYuZHC93cfEafmPUb" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p>Reduce the water level of each box that has water and its level is above one of its neighbours. Repeat until there are no changes to the water level.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 108 bytes</h1>
<pre><code>⊞υＥ⁺Aθ⁰ＷＳ⊞υＥ⁺Aι⌕ακ≔ＥυＥιφθ≔⟦Ｅ³¦⁰⟧ηＦη«≔⊟ιδ≔⊟ιε≔⌈⟦⊟ι§§υδε⟧ζ¿‹ζ§§θδε«§≔§θδεζＦ²Ｆ²⊞ηＥ⟦ζεδ⟧⁺μ∧⁼κ⊖ν⊖⊗λ»»Ｉ⁻ΣＥθΣιΣＥυΣι
</code></pre>
<p><a href="https://tio.run/##dVHBbsIwDD2vXxFxsqVMmrbjTgU2CWlIFVyQEIeMBhqRptA0G2Li2zu7a4Ft4ENtPb/n57jLTJXLQtm6ToLPIEgxVltIbPDQi3tS7FCKB8Tn6DMzVgsYuW2oplVp3BoQxXWRIdGrcSkoKTbI6th7s3bAtJZtpFghssGpO2f8if0WUmSEr4pSQIbiK7prKUlBSlKl1P2L6QtsrPYmDznMu2ZcjVyq99DlwDNYs6DvgZVmJeBNew@H/@xdx8ZmmdblFqsdeNes/4iiy82xsp/nzw8NMaWXNnfLyZQO9rILynrYSDHUy1Ln2lU6BceHugSGRXi3lC02QWbH6Bgl9FcqGChfwdg4GjqlC7AZLcalQZ7TgeEM8oi6np0imk0pJnEc3yw5BmfuoN/v/yonV9ELi/r@w34D" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>⊞υＥ⁺Aθ⁰ＷＳ⊞υＥ⁺Aι⌕ακ
</code></pre>
<p>Read in the pool, but add a border of zero depth.</p>
<pre><code>≔ＥυＥιφθ
</code></pre>
<p>Try to fill the pool to a height of <code>1000</code>.</p>
<pre><code>≔⟦Ｅ³¦⁰⟧ηＦη«
</code></pre>
<p>Begin a breadth-first search of the pool starting at the top left corner.</p>
<pre><code>≔⊟ιδ≔⊟ιε
</code></pre>
<p>Get the next co-ordinates to check.</p>
<pre><code>≔⌈⟦⊟ι§§υδε⟧ζ
</code></pre>
<p>Get the height of the neighbouring water level that triggered this search, but limit it to the height of the cell.</p>
<pre><code>¿‹ζ§§θδε«
</code></pre>
<p>If this is less than the current height of the water, then:</p>
<pre><code>§≔§θδεζ
</code></pre>
<p>Update the water height.</p>
<pre><code>Ｆ²Ｆ²
</code></pre>
<p>Loop over the neighbouring cells.</p>
<pre><code>⊞ηＥ⟦ζεδ⟧⁺μ∧⁼κ⊖ν⊖⊗λ
</code></pre>
<p>Add them to the search list of cells to check.</p>
<pre><code>»»Ｉ⁻ΣＥθΣιΣＥυΣι
</code></pre>
<p>Subtract the heights of cells from the heights of the water and output the total.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://docs.python.org" rel="nofollow noreferrer">Python 3</a>, 230 bytes</h1>
<p><em>-1 from 12944qwerty</em></p>

<pre class="lang-python prettyprint-override"><code>R=range;S=(1,0,-1,0)
def m(A,r=0):
 for l in R(2,27):
  K={(i,j)for i in R(10)for j in R(10)if A[i][j]&lt;l};B={s for s in K if set(s)&amp;{0,9}}
  for _ in R(64):B|=K&amp;{(i+S[k],j+S[k-1])for(i,j)in B for k in R(4)}
  r+=len(K-B)
 return r
</code></pre>
<p><a href="https://tio.run/##5ZPBboMwDIbvfQqfqkQNEqGUQrscypVbe0RomjTYoJSiwA4T49lZErRurcSg1dgOk2wg@LP/yE7y1/L5mM3tnDfNlvGH7Clc7xiiRCeaeODJYxjBAW0IZzpeTSA6ckghzmCLDGIs5S/wWIVikmAZi9sY1dUqOa3iCDZ@HPhJcJfWa5dVhSpVSMADES3CEhV4WunEqWtRVEbv23TLxCv3jXlTITPb@fuAJPKl0UCKKGnBuSpl36aYWNbgM5aGGfI0F0@Ah@ULz4A3OY@zEh2Q7xsWgX4PCCiSdth/JQZ0LsDAGFBLFwfp5rbb3/u4ZJd9EmaH/TYxfBz6wjobhyzT60pGfFHnwu2vh2Mk7NLnQ3cnwZNdQal9/FCtgf1th2Oazm1X5axztI0sPuyPETqWzrIXuepm2NTCzTs" rel="nofollow noreferrer">Try it online!</a> Input is a list of lists of numbers from 1 to 26 inclusive.</p>
<p>For each possible water level from B (2) to Z (26) this function first fills the pool to that height, then drains off any water touching the edge. <code>K</code> is the set of tentatively filled cells and <code>B</code> that of &quot;<strong>b</strong>urned&quot; cells (since it implements a flood fill).</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, <s>144</s> 143 bytes</h1>
<p>need extra stack</p>

<pre class="lang-javascript prettyprint-override"><code>f=(x,t=[...f+f].map((_,i)=&gt;~i%16&amp;&amp;26),z=0)=&gt;t.some((v,i)=&gt;[1,-1,16,-16].some(d=&gt;v&gt;~~t[i+d],p=(x[i&gt;&gt;4]||0)[i%16]|0,z+=v-p)&amp;v&gt;p&amp;&amp;t[i]--)?f(x,t):z
</code></pre>
<p><a href="https://tio.run/##5ZJda8MgFIbv9yt6s6BEJXYldBu6HyIyQhKLW1tliowQ8tOXmYx9UMiafXQ3k/OKeB5eD@d4V4TClQ/aerw3Vd33ioFH5JkghKhUSbIrLAC3SEPGO31O8yRZ5hA1LIsXnjizqwEIY1pQhCmiedxz@ZKpGA@867zQaSWRjdZCc76SbZtBMbjJNkNNygK2MAncJklEJcbwRg1VwKumvz4rzd6ZbU22ZgMUEGKZo8VxSbQYSToR/5WY0TkJ4U@bvv5cpyWn4p1YTcRfE98dxmByVOMj8UQvD7T@@DFOhB3qYm51A/gWX6DGOn7Ja2Z/42j6J2O9juPpMXa@KO@x003NaPa6ngE" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 150 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(x,t=[...f+f].map((_,i)=&gt;~i%16&amp;&amp;26),u,z=0,r=t.map((v,i)=&gt;[1,-1,16,-16].some(d=&gt;v&gt;~~t[i+d],p=(x[i&gt;&gt;4]||0)[i%16]|0,z+=v-p)&amp;v&gt;p?u=[v-1]:v))=&gt;u?f(x,r):z
</code></pre>
<p><a href="https://tio.run/##5ZJda8MgFIbv9yt6s6DkRGJXpOvQ/hCREZqkONoq@ZARQv56ZjLYRiFr9tHdDN5XhPPwejjHp8Ql5a7QtopOJs36PufoGSouCSF5mCtyTCxCj6AxF52@pSwIlgxDDQ2PoeDVa92NdUkhokCZP5kipTlmKOXCia6rpA5TBdZnSy3ESrVtjOUQp9oYmpC7yOLACbutuXQRVRuHfWC9zX0zBd40/cPNzpxKc8jIwexRjqRcMlhctoLFSNIJ/VdixuQUxj8d@vpzX5ec0juxmtBfE99dxhBy0eMj/kbvz7z@@DGuhJ37bm53A/imL1BjH7@UNXO@fjX9Cw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p><code>t[16*y+x]</code> stores water level</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.gnu.org/software/octave/" rel="nofollow noreferrer">MATLAB</a>, 267 bytes</h1>

<pre class="lang-matlab prettyprint-override"><code>function d=p(A)
d=0;I=true(10);I(2:9,2:9)=0;for i=2:26
B=int8(A&gt;=i);while any(~B(~I))
[j,k]=find(B==0,1);f(j,k);end
if any(B(I)==2)break
end
d=d+sum(sum(B==2));end
function f(x,y)
if (x&lt;11&amp;y&lt;11&amp;x&gt;0&amp;y&gt;0)&amp;~B(x,y)
B(x,y)=2;f(x-1,y);f(x+1,y);f(x,y+1);f(x,y-1);end
end
end
</code></pre>
<p>tried using the flood-fill algorithm to determine what squares on each layer should be filled. If the flood-fill ever reaches the outer edge, that's where the summation stops. I had a much shorter version, but it failed on test case 3 because the lowest outer wall is technically blocked off entirely, raising the effective maximum water level.</p>
<p><a href="https://tio.run/##bVA9b4MwEN35FUxwJ4yEGao29JDsTKzpUinKQGKjuEkhItDCkr9O7Xx2yJOe/fTune/kZtOVP3qaqr7edKapfUUHEOgpSrKCurbXwBPMCkhnb8wSrV81rW8onaUvniRTd68gcjKY/W7NXvtlPcJJwqlA9JZfbLeiytQKJFHCOGYVWA8zXSvPVOewhAKJUly3utx5rqBIRcf@GxylK13y9x0rGNiIrh@Gd86D0R1DngRjnmBgh5/Ll4tSO3KIuZVORDfBxohfRcwv7185Ta0@bsuDBtX0672G8POBD4uFEOK5cpjfc3Mp5T@1eOI9EGJ8GydCtGsuV8z9/B8" rel="nofollow noreferrer" title="Octave – Try It Online">Try it online!</a></p>
</div>
<div id="pu5" class="pu"><h1>Python3, 259 bytes</h1>
<pre class="lang-py prettyprint-override"><code>import numpy as np
r=range
l=np.array([[ord(j)-65for j in input()]for i in r(10)])
p=l.copy()
p[1:-1,1:-1]=25
for _ in r(11):
 for i in r(1,9):
  for j in r(1,9):p[i][j]=max(min([p[i+a][j+b]for a,b in[(-1,0),(0,1),(0,-1),(1,0)]]),l[i][j])
print(sum(sum(p-l)))
</code></pre>
<p><a href="https://tio.run/##jY7BagMhEIbvPoXHGeKGtSWFBjzksA/QHCNSTNKmLqsOZheyT7/VTUhyKh3GmZ@PX39p7H9ieJ0m5ymmnofB08jtmQdiSSUbTl@sU4GWNiU7gtYxHaHF6m31HRNvuQu5aegBTQGugASyRoOMVLc8RBohSy3XlRRlGPWyYsX7efNKXDP@fFm8F8LvATdE2hndGuXtBbwLoDNY2IwW@znbin12a8g5NQqohZxnVVZBxqDorm/kDyUXejgPfj5UdYg4Tbt7se0m165pmv/KzR@Gj4d8RPwC" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<!-- TYYY -->

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/242453/">242453</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




