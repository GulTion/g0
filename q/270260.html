<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::270260</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>055</td><td>J</td><td>240303T042217Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/271492#271492">Jonah</a></td></tr>
<tr d-ix="1"><td>106</td><td>APL+WIN</td><td>240223T213622Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270284#270284">Graham</a></td></tr>
<tr d-ix="2"><td>019</td><td>MATL</td><td>240223T110016Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270269#270269">Luis Men</a></td></tr>
<tr d-ix="3"><td>047</td><td>Uiua SBCS</td><td>240223T211226Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270283#270283">chunes</a></td></tr>
<tr d-ix="4"><td>423</td><td>Google Sheets</td><td>240223T203713Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270282#270282">z..</a></td></tr>
<tr d-ix="5"><td>116</td><td>R</td><td>240223T192735Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270279#270279">pajonk</a></td></tr>
<tr d-ix="6"><td>6062</td><td>Charcoal</td><td>240223T065953Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270262#270262">Neil</a></td></tr>
<tr d-ix="7"><td>174</td><td>JavaScript ES6</td><td>240223T115042Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270271#270271">Arnauld</a></td></tr>
<tr d-ix="8"><td>3132</td><td>05AB1E</td><td>240223T080952Z</td><td><a href="https://codegolf.stackexchange.com/questions/270260/sum-up-snail-number-neighbours/270264#270264">Kevin Cr</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://jsoftware.com/" rel="nofollow noreferrer">J</a>, 55 bytes</h1>
<pre><code>([-~1#.]#&amp;,~[:+/(&gt;,{;~i:1)|.=)+:@&lt;:(]#\,#+|:@|.)^:[,.@1
</code></pre>
<p><a href="https://tio.run/##dc1Ba4MwFAfwez/FY4GaYPpMjDp4bYpssNPooVdrh4hl66WF9Kb41Z3RjXnZ4UH45f3/7zo8YXABSxCABAU0zgbh9fj@NvBi02uGJVvLvqAw4nvZbvsv0qJDK0LKd8RLdpIs7CjvUJypkJjrQawOLwhctaotmW@woiAZGTA8jCLsU8tOIpdb/DD/lqya@vMG@hkukM7v4NG4B9SVaxxwDRbulXMimD@zZASdjNvJT1JNssjraSdOF6JjLz6V/d7LRjHqT2KlvMQLMb7HGC/DNw" rel="nofollow noreferrer" title="J – Try It Online">Try it online!</a></p>
<p>Uses <a href="https://codegolf.stackexchange.com/a/241837/15469">Bubbler's clever APL/Jelly method from an old problem</a> for constructing the involute itself.</p>
<p>Consider input <code>17 f 5</code>:</p>
<ul>
<li><p><code>+:@&lt;:(]#\,#+|:@|.)^:[,.@1</code> Construct the involute iteratively using Bubbler's method (see link above for explanation):</p>
<pre><code>1  2  3  4 5
16 17 18 19 6
15 24 25 20 7
14 23 22 21 8
13 12 11 10 9
</code></pre>
</li>
<li><p><code>=</code> Where does the left input equal that?</p>
<pre><code>0 0 0 0 0
0 1 0 0 0
0 0 0 0 0
0 0 0 0 0
0 0 0 0 0
</code></pre>
</li>
<li><p><code>[:+/(&gt;,{;~i:1)|.</code> Rotate that in the 8 neighbor directions, and sum the planes:</p>
<pre><code>1 1 1 0 0
1 1 1 0 0
1 1 1 0 0
0 0 0 0 0
0 0 0 0 0
</code></pre>
</li>
<li><p><code>1#.]#&amp;,~</code> Filter using that mask and sum:</p>
<pre><code>121
</code></pre>
</li>
<li><p><code>[-~</code> Subtract the left input (17):
104</p>
</li>
</ul>
</div>
<div id="pu1" class="pu"><h1>APL+WIN, 106 bytes</h1>
<p>Prompts for n followed by m:</p>
<pre><code>a←1 1⍴1⋄i←1⋄⍎∊(¯1+n←⎕)⍴⊂'a←(⍳i+1)⍪⌽⍉(i+1)+(⍳i)⍪⌽⍉a+i⋄i←i+1⋄'⋄+/((,a)[(k-n),(k+n),(k←((,a)⍳m)+¯1 0 1)])~m←⎕
</code></pre>
<p><a href="https://tio.run/##RY47CsJAEIb7OUW67LIGs3noGQTFA4jFEomEPBRS2ViIaIwm2HgJGwttbTzKXCTOJoLFzvfPv/NS68RabFSyWlpBovI8Chqsb5MxHq4ukBpNSUnA4hg2SktDYvWSeN5HOiNiVWNRss9Diows6uFUgeXO1PUMq2ckJFl3vLyxOjGdidb@m0pEv4n0S8qkJ/qM9RSfsdjKeI/Foo16pLapP@WClhq2Ifmcb9Nud0OXQhOCB9IzIAQf5LCF4xMG4HgtXLuD08H9Ag" rel="nofollow noreferrer" title="APL (Dyalog Classic) – Try It Online">Try it online! Thanks to Dyalog Classic</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, 19 bytes</h1>
<pre><code>UQG1YL-t3Y6Z+wi=*Xz
</code></pre>
<p>Try it <a href="https://matl.io/?code=UQG1YL-t3Y6Z%2Bwi%3D%2aXz&amp;inputs=6%0A24&amp;version=22.8.0" rel="nofollow noreferrer">at MATL online</a>!</p>
<h3>How it works</h3>
<pre><code>UQ     % Implicit input: n. Square, add 1
G      % Push n again
1YL    % Generate spiral with side length n, from 1 to to n^2 outwards
-      % Subtract, element-wise. The spiral is now from 1 to n^2 inwards
t      % Duplicate
3Y6    % Push predefined literal: [1 1 1; 1 0 1; 1 1 1]
Z+     % 2D convolution, preserving size. This computes the sums
w      % Swap. This moves the spiral to the top of the stack
i=     % Input: m. Compare for equality, element-wise
*      % Multiply, element-wise. This keeps the wanted sum, and makes the rest 0
Xz     % Nonzeros. This keeps the only non-zero value. Implicit display
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://uiua.org" rel="nofollow noreferrer">Uiua</a> <sup><a href="http://tinyurl.com/Uiua-SBCS-Feb-17" rel="nofollow noreferrer">SBCS</a></sup>, 47 bytes</h1>
<pre><code>-:/+♭⍜↻(↙3_3)-1♭⊚⌕⊙.:+1⍥(⊂⇡⟜(≡⇌⍉+)⧻.):¤[]-1+.⊙.
</code></pre>
<p><a href="https://uiua.org/pad?src=0_9_0__ZiDihpAgLTovK-KZreKNnOKGuyjihpkzXzMpLTHima3iiprijJXiipkuOisx4o2lKOKKguKHoeKfnCjiiaHih4zijYkrKeKnuy4pOsKkW10tMSsu4oqZLgoKZiA0IDE0CmYgNSAxNwpmIDUgMjUKZiA2IDI0CmYgNiAzMApmIDYgMzIKZiA2IDMzCg==" rel="nofollow noreferrer">Try it!</a></p>
</div>
<div id="pu4" class="pu"><h1>Google Sheets, 423 bytes</h1>
<p>Assuming <span class="math-container">\$n\$</span> is in A1 and <span class="math-container">\$m\$</span> is in A2.</p>
<pre class="lang-cpp prettyprint-override"><code>=SUMPRODUCT(LET(n,A1,s,SEQUENCE(n,n),t,TOCOL(SPLIT(REDUCE(s,s,LAMBDA(x,_,LET(r,INDEX(x,1),a,FILTER(x,r),HSTACK(JOIN(&quot;,&quot;,r),SORT(TRANSPOSE(QUERY(a,&quot;offset 1&quot;)),SEQUENCE(COLUMNS(a)),))))),&quot;,&quot;),3),p,XLOOKUP(s,{t;INDEX(t,n*n-1)+IF(ISODD(n),1,-1)},TOCOL(s)),x,TEXTJOIN(,,IF(p=A2,SEQUENCE(n)&amp;&quot;,&quot;&amp;SEQUENCE(1,n),)),i,SPLIT(x,&quot;,&quot;),r,INDEX(i,1),k,INDEX(i,2),p*MAKEARRAY(n,n,LAMBDA(i,j,ISBETWEEN(i,r-1,r+1)*ISBETWEEN(j,k-1,k+1)))))-A2
</code></pre>
<p>Ungolfed</p>
<pre class="lang-cpp prettyprint-override"><code>// Create the spiral

=LET(n,A1,s,SEQUENCE(n,n),
     t,TOCOL(
         SPLIT(REDUCE(s,s,LAMBDA(x,_, 
           LET(r,INDEX(x,1),a,FILTER(x,r),
               HSTACK(JOIN(&quot;,&quot;,r),
               SORT(TRANSPOSE(QUERY(a,&quot;offset 1&quot;)),SEQUENCE(COLUMNS(a)),))))),
           &quot;,&quot;),3),
     p,XLOOKUP(s,{t;INDEX(t,n*n-1)+IF(ISODD(n),1,-1)},TOCOL(s)),

// Find the coordinates of m 

     x,TEXTJOIN(,,IF(p=A2,SEQUENCE(n)&amp;&quot;,&quot;&amp;SEQUENCE(1,n),)),

// Assign them to (r,k)  

     i,SPLIT(x,&quot;,&quot;),r,INDEX(i,1),k,INDEX(i,2),
 
// Create a nxn array composed of 1s in the 3x3 array around (r,k) and 0s everywhere else and multiply it by the spiral

     p*MAKEARRAY(n,n,LAMBDA(i,j,ISBETWEEN(i,r-1,r+1)*ISBETWEEN(j,k-1,k+1))))


// Array enabling sum on the above result to which we subtract m

SUMPRODUCT(all_of_the_above)-A2
<span class="math-container">```</span>
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 116 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(n,k){m=t(1)
while(F&lt;n)m=rbind(1:n,(F=nrow(m))+t(m[F:1,]))
sum(m[t(t(expand.grid(-1:1,-1:1))+c(which(m==k,T)))])-k}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=Nc1LDoIwEADQPacgcTMTW8MUREOsS07gTlmogBJsNViCifEkbtDEQ3kbkc9mJvPm93wV9TuVn9KkfP41G9Asx7uSBgit6pidEggXGpUsdpmOgQLNIJS6OFegEMcG1DoMiEWI1rVUTWXAQHK7bHU8ORRZDJya9j8003toLu6PoKTM2QoRI-T5o_9dpuAx8nBkc760fc9KYcpo1tckqAUxHaCd8JkYNohEC64zwMzvQPQgHKcDdwDX657XdZd_" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Uses some code from the <a href="https://codegolf.stackexchange.com/a/241886/55372">spiral challenge</a>.</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 60/62 bytes</h1>
<pre><code>Ｆ⊗Ｎ≔⁺⟦Ｅυ⊕λ⟧Ｅ∧υ⌊υ⁺ＬυＥ⮌υ§μλυＮθ≔⊟Φυ№ιθηＩΣＥΦυ‹↔⁻κ⌕υη²ΣΦι‹↔⁻μ⌕ηθ²
</code></pre>
<p><a href="https://tio.run/##bY49awMxDIb3/AqPMrhDAyVDpiMlcJCUkI6lw32osYk/LrYV@u@vspPQDl0Ekt5HegbdxSF0dp6/QhTwGqi3OELrJ8pv5HqMIKUUTUrm5OFgKcHHvpuAlGj9ENGhz5y3Un4qURaNH8tyb7xx5ICkVKJiO/SnrHlwyx3xijFh7Zvc@hG/wSnBh2RBSK4XfyUu3D8kwgRbYzNP@dEmkM9glLhUTnPuEA2PNl3K8M4K5dtvfocpQdOnYCkjsCarnZXYmpu3rleWpRT2zpn/OXfn9OP7strL9Ty/LJ5X89PV/gA" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>Ｆ⊗Ｎ≔⁺⟦Ｅυ⊕λ⟧Ｅ∧υ⌊υ⁺ＬυＥ⮌υ§μλυ
</code></pre>
<p>Input <code>n</code> and generate the spiral using the method from my answer to <a href="https://codegolf.stackexchange.com/q/241803/">Print a NxN integer involute</a> except 1-indexed.</p>
<pre><code>Ｎθ≔⊟Φυ№ιθη
</code></pre>
<p>Input <code>m</code> and find the row containing <code>m</code> in the spiral.</p>
<pre><code>ＩΣＥΦυ‹↔⁻κ⌕υη²ΣΦι‹↔⁻μ⌕ηθ²
</code></pre>
<p>Extract the neighbours of <code>m</code> and output the sum.</p>
<p>Note that the <code>5, 17</code> test case includes the <code>17</code> itself in the total; if this is not wanted then it can be subtracted at a cost of 2 bytes:</p>
<pre><code>Ｆ⊗Ｎ≔⁺⟦Ｅυ⊕λ⟧Ｅ∧υ⌊υ⁺ＬυＥ⮌υ§μλυＮθ≔⊟Φυ№ιθηＩ⁻ΣＥΦυ‹↔⁻κ⌕υη²ΣΦι‹↔⁻μ⌕ηθ²θ
</code></pre>
<p><a href="https://tio.run/##bY49awMxDIb3/AqPMrhDA6VDpiMlcJCU0I6lw32osYk/LrYV@u@vsnOhHboI6dX7SO@guziEzs7zV4gCXgL1Fkdo/UT5lVyPEaSUoknJnDwcLSX4OHQTkBKtHyI69Jn9VspPJcqi8WNZHow3jhyQlEpUbI/@lDULN98bXjEmrHOTWz/iNzgl@JAsCMnN6m@IC8/3EGGCnbGZVX60DeQzGCUuldPsO0bD0rZLGTgGv37nIOXnL7XHlKDpU7CUcXGdldiZW3pdb61LKezCmf85t3D6nmFda@k38/y0enyeH672Bw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code.</p>
</div>
<div id="pu7" class="pu"><h1>JavaScript (ES6), 174 bytes</h1>
<p>Derived from <a href="https://codegolf.stackexchange.com/a/241832/58563">this answer by tsh</a> to <a href="https://codegolf.stackexchange.com/q/241803/58563">this other challenge</a>.</p>
<p>Expects <code>(n)(m)</code>.</p>

<pre class="lang-javascript prettyprint-override"><code>n=&gt;m=&gt;(g=(s,[l]=t=s[0])=&gt;l&gt;1?g([0,...t].map((_,i)=&gt;s.map((r,x)=&gt;(v=r[i-1]||--l)-m?v:(X=x,Y=i,v)).reverse())):s)([[n*n]]).map((r,y)=&gt;r.map(v=&gt;m-=v*=--x*x+y*y&lt;3,x=n-X,y-=Y))|-m
</code></pre>
<p><a href="https://tio.run/##bc7RaoQwEIXh@z7JjM0EXd0Wlo77GruEUGSbFUuMSyIhgu9uQ0svSr38v4HDfHaxCzc/PGZy04fZ7rw5bkduoWcIQlnNMwdVauTWttW5B1UKKeWs5dg9AN7FkC/hJ7xIOSCyVwNVel2JLNJ4jie4cBJXHkRElN5E44MBRDwFBKVc4bTG340lb/jviPkT4lgwUSrS81Isb7VI7OgiFuIr4krjdptcmKyRdurhDg1C1SA@/dVj1tc9PRz/6UvWZk/rclcPu1ojbl8" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 31/32<sup><em>†</em></sup> <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>¯I·FāUøí¬g+Xš}2Fø€ü3}€`ʒ˜4èQ}˜O
</code></pre>
<p>Inputs in the order <span class="math-container">\$n,m\$</span>.</p>
<p>31 bytes - sum including <span class="math-container">\$m\$</span>: <a href="https://tio.run/##AT4Awf9vc2FiaWX//8KvScK3RsSBVcO4w63CrGcrWMWhfTJGw7jigqzDvDN94oKsYMqSy5w0w6hRfcucT///NQoxNw" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfWVC2P9D64sPbXc70hh6eMfhtYfWpGtHHF1Ya@R2eMejpjWH9xjXAqmEU5NOzzE5vCIysPb0HP//Ov@jo010DE1idaJNdQzNwZSRKZAy0zEyAVPGBhDKCEIZx8YCAA" rel="nofollow noreferrer">verify all test cases</a>.<br />
32 bytes - sum excluding <span class="math-container">\$m\$</span>: <a href="https://tio.run/##AUAAv/9vc2FiaWX//8KvScK3RsSBVcO4w63CrGcrWMWhfTJGw7jigqzDvDN94oKsYMqSy5w0w6hRfcucT86x//81CjE3" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfWXC4QlhRf8PrS8@tN3tSGPo4R2H1x5ak64dcXRhrZHb4R2PmtYc3mNcC6QSTk06Pcfk8IrIwNrTc/zPbfyv8z862kTH0CRWJ9pUx9AcTBmZAikzHSMTMGVsAKGMIJRxbCwA" rel="nofollow noreferrer">verify all test cases</a>. (Contains an additional trailing <code>α</code>.)</p>
<p><strong>Explanation:</strong></p>

<p>Step 1: Create the spiral matrix for the given <span class="math-container">\$n\$</span>, taken from <a href="https://codegolf.stackexchange.com/a/241860/52210">this answer of mine</a>:</p>
<pre class="lang-python prettyprint-override"><code>¯             # Start with an empty list []
 I·           # Push the first input n and double it
   F          # Pop and loop that many times:
    ā         #  Push a list in the range [1,length] (without popping the matrix)
     U        #  Pop and store this list in variable `X`
      øí      #  Rotate the matrix 90 degrees clockwise:
      ø       #   Zip/transpose; swapping rows/columns
       í      #   Reverse each row
        ¬     #  Push the first row (without popping the matrix)
         g    #  Pop and push its length
          +   #  Add that to each value in the matrix
           Xš #  Prepend list `X` as first row
   }          # Close the loop
</code></pre>
<p>Step 2: Create overlapping 3x3 blocks of this matrix:</p>
<pre class="lang-python prettyprint-override"><code>2F            # Loop 2 times:
  ø           #  Zip/transpose; swapping rows/columns
   €          #  Map over each inner list:
    ü3        #   Create overlapping triplets
 }            # Close the loop
</code></pre>
<p>Step 3: Only keep the 3x3 block with <span class="math-container">\$m\$</span> in the center:</p>
<pre class="lang-python prettyprint-override"><code>€`            # Flatten the matrix of 3x3 blocks one level down to a list of 3x3 blocks
  ʒ           # Filter this list by:
   ˜          #  Flatten the 3x3 block to a list of 9 values
    4è        #  Pop and leave the 0-based 4th item (the center)
      Q       #  Check whether it equals the second (implicit) input m
  }           # Close the filter
</code></pre>
<p>Step 4: Sum the found 3x3 block, and output the result:</p>
<pre class="lang-python prettyprint-override"><code>˜             # Flatten the single wrapped 3x3 block to a list
 O            # Sum it together
  α           # (optionally) Take the absolute difference with the second (implicit)
              # input m to subtract m from this sum
              # (after which this is output implicitly as result)
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/270260/">270260</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




