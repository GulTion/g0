<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="g.js"></script>
    <title>cg::49461</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>022</td><td>Perl 6</td><td>170612T212845Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/126059#126059">Sean</a></td></tr>
<tr d-ix="1"><td>475</td><td>Vyxal s</td><td>230726T123224Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/263361#263361">lyxal</a></td></tr>
<tr d-ix="2"><td>006</td><td>Thunno 2 S</td><td>230726T113302Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/263356#263356">The Thon</a></td></tr>
<tr d-ix="3"><td>021</td><td>R</td><td>150430T025356Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49464#49464">MickyT</a></td></tr>
<tr d-ix="4"><td>017</td><td>Ti84 Basic</td><td>150430T112544Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49477#49477">SuperJed</a></td></tr>
<tr d-ix="5"><td>040</td><td>VBA</td><td>150430T200203Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49502#49502">SeanC</a></td></tr>
<tr d-ix="6"><td>041</td><td>Javascript</td><td>150502T183429Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49559#49559">Ralph Ma</a></td></tr>
<tr d-ix="7"><td>067</td><td>Python 2</td><td>160422T144214Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/78267#78267">DoctorHe</a></td></tr>
<tr d-ix="8"><td>154</td><td>C++</td><td>160421T224346Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/78218#78218">Michelfr</a></td></tr>
<tr d-ix="9"><td>025</td><td>PARI/GP</td><td>150430T170227Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49490#49490">Charles</a></td></tr>
<tr d-ix="10"><td>091</td><td>C#</td><td>150710T133610Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/52922#52922">Brandon</a></td></tr>
<tr d-ix="11"><td>052</td><td>Java Java 8</td><td>150710T123336Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/52919#52919">Rob Aude</a></td></tr>
<tr d-ix="12"><td>064</td><td>Swift</td><td>150430T132219Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49481#49481">GoatInTh</a></td></tr>
<tr d-ix="13"><td>069</td><td>Swift</td><td>150709T161027Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/52855#52855">David Sk</a></td></tr>
<tr d-ix="14"><td>047</td><td>Ruby</td><td>150707T040823Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/52710#52710">clapp</a></td></tr>
<tr d-ix="15"><td>102</td><td>Scratch</td><td>150615T203904Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/51750#51750">SuperJed</a></td></tr>
<tr d-ix="16"><td>007</td><td>Microscript</td><td>150513T065707Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/50095#50095">SuperJed</a></td></tr>
<tr d-ix="17"><td>013</td><td>K</td><td>150511T160904Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/50005#50005">JohnE</a></td></tr>
<tr d-ix="18"><td>037</td><td>PowerShell</td><td>150501T043615Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49512#49512">Nacht</a></td></tr>
<tr d-ix="19"><td>032</td><td>Ruby</td><td>150430T153317Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49488#49488">Haegin</a></td></tr>
<tr d-ix="20"><td>027</td><td>Mathematica</td><td>150502T012452Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49538#49538">LegionMa</a></td></tr>
<tr d-ix="21"><td>054</td><td>JavaScript ES6</td><td>150430T202526Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49504#49504">edc65</a></td></tr>
<tr d-ix="22"><td>037</td><td>Commodore Basic</td><td>150430T232448Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49507#49507">Mark</a></td></tr>
<tr d-ix="23"><td>067</td><td>Javascript + ActionScript2</td><td>150502T154639Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49556#49556">Ismael M</a></td></tr>
<tr d-ix="24"><td>059</td><td>PostgreSQL</td><td>150502T151644Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49554#49554">Andrew</a></td></tr>
<tr d-ix="25"><td>nan</td><td>PHP</td><td>150430T193354Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49500#49500">Ismael M</a></td></tr>
<tr d-ix="26"><td>105</td><td>C#</td><td>150501T212904Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49534#49534">Andrew</a></td></tr>
<tr d-ix="27"><td>051</td><td>Lua 5.1</td><td>150501T184256Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49530#49530">JuSTMOnI</a></td></tr>
<tr d-ix="28"><td>034</td><td>Perl</td><td>150430T021544Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49463#49463">ASCIIThe</a></td></tr>
<tr d-ix="29"><td>148</td><td>C#</td><td>150501T095420Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49516#49516">Ewan</a></td></tr>
<tr d-ix="30"><td>075</td><td>Actionscript 3</td><td>150430T193430Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49501#49501">Brian</a></td></tr>
<tr d-ix="31"><td>011</td><td>CJam</td><td>150430T084813Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49472#49472">Optimize</a></td></tr>
<tr d-ix="32"><td>098</td><td>J 12 bytes</td><td>150430T083059Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49471#49471">ɐɔıʇǝɥʇu</a></td></tr>
<tr d-ix="33"><td>057</td><td>C</td><td>150430T162649Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49489#49489">Functino</a></td></tr>
<tr d-ix="34"><td>073</td><td>Haskell</td><td>150430T200740Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49503#49503">Zeta</a></td></tr>
<tr d-ix="35"><td>008</td><td>Pyth</td><td>150430T021005Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49462#49462">Maltysen</a></td></tr>
<tr d-ix="36"><td>029</td><td>Perl</td><td>150430T191607Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49499#49499">nutki</a></td></tr>
<tr d-ix="37"><td>010</td><td>APL</td><td>150430T034705Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49468#49468">Alex A.</a></td></tr>
<tr d-ix="38"><td>024</td><td>Matlab</td><td>150430T134444Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49482#49482">Oebele</a></td></tr>
<tr d-ix="39"><td>065</td><td>Java</td><td>150430T131219Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49480#49480">Geobits</a></td></tr>
<tr d-ix="40"><td>087</td><td>Go</td><td>150430T104229Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49475#49475">Kristoff</a></td></tr>
<tr d-ix="41"><td>078</td><td>Go</td><td>150430T105949Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49476#49476">Kristoff</a></td></tr>
<tr d-ix="42"><td>010</td><td>Pyth</td><td>150430T095525Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49474#49474">Jakube</a></td></tr>
<tr d-ix="43"><td>012</td><td>Clip 10</td><td>150430T032219Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49467#49467">Ypnypn</a></td></tr>
<tr d-ix="44"><td>058</td><td>Python 2</td><td>150430T025824Z</td><td><a href="https://codegolf.stackexchange.com/questions/49461/death-by-shock-probe-thats-a-lot-of-dice/49465#49465">Logic Kn</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://perl6.org/" rel="nofollow noreferrer">Perl 6</a>, <s>26</s> 22 bytes</h1>
<p><s>{sum (1..4).pick xx 1+&lt;20}</s></p>
<pre><code>{sum roll 1..4: 1+&lt;20}
</code></pre>
<p><s>It's not fast...takes about nine seconds on my system.</s></p>
<p><a href="https://tio.run/##K0gtyjH7n1upoJamYPu/urg0V6EoPydHwVBPz8RKwVDbxsig9n9xYqVCmkJafpFCnKHBfwA" rel="nofollow noreferrer" title="Perl 6 – Try It Online">Try it online!</a></p>
<p>Six years ago, I apparently didn't know about the <code>roll</code> method.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal" rel="nofollow noreferrer">Vyxal</a> <code>s</code>, 38 <a href="https://github.com/Vyxal/Vyncode/blob/main/README.md" rel="nofollow noreferrer">bits<sup>v2</a></sup>, 4.75 bytes</h1>
<pre><code>k₂ƛ4℅
</code></pre>
<p><a href="https://vyxal.pythonanywhere.com/?v=2#WyJzPSIsIiIsImvigoLGmzTihIUiLCIiLCIiXQ==" rel="nofollow noreferrer">Try it Online!</a></p>
<h2>Explained</h2>
<pre><code>k₂ƛ4℅­⁡​‎‎⁪⁡⁪⁠⁪⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁪‏‏​⁡⁠⁡‌⁢​‎‎⁪⁡⁪⁠⁪⁤⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁡⁪‏‏​⁡⁠⁡‌⁣​‎‏​⁢⁠⁡‌­
k₂ƛ    # ‎⁡For each number in the range [1, 2**20]:
   4℅  # ‎⁢  Choose a random number between 1 and 4
# ‎⁣s flag sums
💎
</code></pre>
<p>Created with the help of <a href="https://vyxal.github.io/Luminespire" rel="nofollow noreferrer">Luminespire</a>.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/Thunno/Thunno2" rel="nofollow noreferrer">Thunno 2</a> <code>S</code>, 6 <a href="https://github.com/Thunno/Thunno2/blob/main/docs/codepage.md" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>T4@ı4ɼ
</code></pre>
<p><a href="https://Not-Thonnu.github.io/run#aGVhZGVyPSZjb2RlPVQ0JTQwJUM0JUIxNCVDOSVCQyZmb290ZXI9JmlucHV0PSZmbGFncz1T" rel="nofollow noreferrer">Try it online!</a></p>
<h4>Explanation</h4>
<pre class="lang-python prettyprint-override"><code>T4@ı4ɼ  # Implicit input
T4@     # Push 4 ** 10
   ı    # Map over the range:
    4ɼ  #  Random number from [1..4]
        # Implicit output of sum
</code></pre>
</div>
<div id="pu3" class="pu"><h1>R, <s>32</s> <s>24</s> <s>23</s> 21 bytes</h1>

<p>Edit: Got rid of the <code>as.integer</code> and used integer division <code>%/%</code>.  Speed it up slightly.</p>
<p>Thanks to Alex A for the sample tip ... and Giuseppe for removing the <code>r=</code></p>
<pre class="lang-r prettyprint-override"><code>sum(sample(4,2^20,T))
</code></pre>
<p>Tested with</p>
<pre class="lang-r prettyprint-override"><code>i = s = 0
repeat {
i = i + 1
print(sum(sample(4,2^20,r=T)))
s = s + system.time(sum(sample(4,2^20,r=T)))[3]
if (i == 10) break
}
print (s/10)
</code></pre>
<p>Outputs</p>
<pre class="lang-r prettyprint-override"><code>[1] 2621936
[1] 2620047
[1] 2621004
[1] 2621783
[1] 2621149
[1] 2619777
[1] 2620428
[1] 2621840
[1] 2621458
[1] 2620680
elapsed 
   0.029 
</code></pre>
<p>For pure speed the following completes in microseconds.  However I'm not sure I've got my logic correct for it.  The results appear consistent with the random method.  Shame it's a longer length.</p>
<pre class="lang-r prettyprint-override"><code>sum(rmultinom(1,2^20,rep(1,4))*1:4)
</code></pre>
<p>Here's a timing run I did on my machine</p>
<pre class="lang-r prettyprint-override"><code>system.time(for(i in 1:1000000)sum(rmultinom(1,2^20,rep(1,4))*1:4))
                   user                  system                 elapsed 
7.330000000000040927262 0.000000000000000000000 7.370000000000345607987 
</code></pre>
</div>
<div id="pu4" class="pu"><h1>Ti-84 Basic, 17 bytes</h1>

<p>Total footprint - Size of program header = 17 bytes</p>

<p>Run Time: Unknown, estimated at 5-6 <em>hours</em> based on performance for smaller numbers of rolls (so, basically, not very good)</p>

<pre>Σ(randInt(1,4),A,1,2^20</pre>
</div>
<div id="pu5" class="pu"><h1>VBA, 40 Bytes</h1>
 
<pre class="lang-vba prettyprint-override"><code>for i=1 to 2^20:q=q+int(rnd*4)+1:next:?q
</code></pre>
</div>
<div id="pu6" class="pu"><h1>Javascript, <s>55</s> <s>53</s> <s>50</s> <s>47</s> 41 bytes</h1>



<pre class="lang-js prettyprint-override"><code>for(a=i=1&lt;&lt;20;i--;)a+=(Math.random()*4)|0
</code></pre>

<p>I didn't realize that non-random numbers were a known irritant, so I figure that I ought to post a real solution. Meant no disrespect.</p>

<p>Commentary: as noted by others above you can skip the +1 to each roll by starting off with the number of rolls in your answer, and by not having to write a=0,i=1&lt;&lt;20 you save two bytes, and another 2 because you don't add +1 to each roll. The parseInt function does the same thing as Math.floor but is 2 characters shorter.</p>
</div>
<div id="pu7" class="pu"><h2>Python 2, <s>69</s> 67 Bytes</h2>



<pre class="lang-python prettyprint-override"><code>import random
print sum([random.randint(1,4)for _ in range(4**10)])
</code></pre>

<p><s>11</s> 9 bytes more that the existing Python 2 answer :( I'm sure I can find some places to shave off a few bytes though.</p>
</div>
<div id="pu8" class="pu"><h2>C++, 154 bytes</h2>

<p></p>

<h3>Golfed:</h3>

<pre class="lang-cpp prettyprint-override"><code>#include&lt;iostream&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;
int main(){int c=0;srand(time(NULL));for(int x=0;x&lt;=1048576;x++){c=c+(rand()%4+1);}std::cout&lt;&lt;c;}
</code></pre>

<h3>Ungolfed:</h3>

<pre class="lang-cpp prettyprint-override"><code>#include&lt;iostream&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;

int main(){
    int c = 0;
    srand (time(NULL));
    for(int x = 0; x &lt;= 1048576; x++){
        c = c + (rand() % 4 + 1);
    }

    std::cout&lt;&lt;c;
}
</code></pre>
</div>
<div id="pu9" class="pu"><h2>PARI/GP, 25 bytes</h2>

<p>Really, no need for golfing here -- this is the straightforward way of doing the calculation in GP. It runs in 90 milliseconds on my machine. Hoisting the <code>+1</code> saves about 20 milliseconds.</p>

<pre><code>sum(i=1,2^20,random(4)+1)
</code></pre>

<p>Just for fun: if one were optimizing for <em>performance</em> in PARI,</p>

<pre class="lang-c prettyprint-override"><code>inline long sum32d4(void) {
  long n = rand64();
  // Note: __builtin_popcountll could replace hamming_word if using gcc
  return hamming_word(n) + hamming_word(n &amp; 0xAAAAAAAAAAAAAAAALL);
}

long sum1048576d4(void) {
  long total = 0;
  int i;
  for(i=0; i&lt;32768; i++) total += sum32d4();
  return total;
}
</code></pre>

<p>has a very small total operation count -- if <a href="https://maths-people.anu.edu.au/~brent/random.html" rel="nofollow">xorgens</a> needs ~27 cycles per 64-bit word (can anyone verify this?), then a processor with POPCNT should take only about 0.5 cycle/bit, or a few hundred microseconds for the final number.</p>

<p>This should have close-to-optimal worst-case performance among methods using random numbers of similar or higher quality. It should be possible to greatly increase average speed by combining cases -- maybe a million rolls at a time -- and selecting with (essentially) <a href="https://en.wikipedia.org/wiki/Arithmetic_coding" rel="nofollow">arithmetic coding</a>.</p>
</div>
<div id="pu10" class="pu"><h1>C# - 91</h1>
<p>I went the function route for this</p>
<pre><code>Func&lt;int,int&gt;G=s=&gt;{int e=s=0;var r=new Random();for(;s&lt;1&lt;&lt;20;s++)e+=r.Next(1,5);return e;};
</code></pre>
</div>
<div id="pu11" class="pu"><h1>Java (Java 8) - 52</h1>

<pre><code>int f(){return new Random().ints(1&lt;&lt;20,1,5).sum();}
</code></pre>
</div>
<div id="pu12" class="pu"><h1>Swift, 64 bytes</h1>

<p>Nothing clever, golfing in Swift is hard...</p>

<pre><code>func r()-&gt;Int{var x=0;for _ in 0..&lt;(2&lt;&lt;19) {x+=Int(arc4random()%4)+1;};return x;}
</code></pre>

<p>Version 2 (too late)</p>

<pre><code>var x=0;for _ in 0..&lt;(2&lt;&lt;19){x+=Int(arc4random()%4)+1;};print(x)
</code></pre>
</div>
<div id="pu13" class="pu"><h2>Swift, 69 bytes</h2>
<pre><code>var b={return[UInt32](0..&lt;8&lt;&lt;17).reduce(0){$1*0+$0+arc4random()%4+1}}
</code></pre>
<p><code>$1*0</code> is required for the compiler to infer the type of the closure.</p>
</div>
<div id="pu14" class="pu"><h2>Ruby, <s>51</s> 47 chars</h2>

<pre><code>x=[];(2**20).times{x&lt;&lt;rand(4)+1};p x.inject(:+)
</code></pre>

<p>I looked at all of the answers before I did this, and the <code>sum(2**20 times {randInt(4)})</code> strategy really stuck out, so I used that.</p>

<h2>>&lt;>, 76 chars</h2>

<pre><code>012a*&amp;&gt;2*&amp;1v
|.!33&amp;^?&amp;:-&lt;
3.v &lt; &gt;-:v &gt;
   vxv1v^&lt;;3
  1234    n+
  &gt;&gt;&gt;&gt; &gt;?!^^
</code></pre>

<p>I'm not sure if this one works, because my browser crashed when I tried to test it, but <a href="http://fishlanguage.com/playground/L8bSSCWp9R3Wo9pG8" rel="nofollow">here</a>'s the online interpreter.</p>
</div>
<div id="pu15" class="pu"><h1>Scratch, 102 bytes</h1>

<p>The consensus seems to be to convert it to the plaintext form used by the scratchblocks code on the scratch forums, so here we go.</p>

<pre><code>when green flag clicked
set [a v] to [0]
repeat (1048576)
change [a v] by (pick random (1) to (4))
end
</code></pre>

<p>Result will be stored in the variable <code>a</code>.</p>
</div>
<div id="pu16" class="pu"><h1><a href="https://esolangs.org/wiki/Microscript" rel="nofollow">Microscript</a>, 7 bytes</h1>

<p>First, a disclaimer: This is not actually a competing entry for this challenge, as this language is significantly too new.</p>

<p>Now, here's the program:
<code>20ec1r4</code></p>
</div>
<div id="pu17" class="pu"><h1>K, 13 bytes</h1>

<pre><code>+/1+(_2^20)?4
</code></pre>

<p>Take the sum (<code>+/</code>) of one plus a vector of 2^20 (<code>_2^20</code>) numbers from [0,4) (<code>?4</code>).</p>

<p>The floor <code>_</code> is necessary because <code>^</code> returns a float, which is slightly inconvenient for this problem.</p>

<p>Tested with <a href="https://github.com/kevinlawler/kona" rel="nofollow">Kona</a>. On my machine, this runs in roughly 24 milliseconds.</p>

<h2>edit:</h2>

<p>To test timing, you can prefix the program with <code>\t</code> and get the runtime in milliseconds.</p>

<pre><code>  \t +/1+(_2^20)?4
25
</code></pre>
</div>
<div id="pu18" class="pu"><h2>PowerShell, <strike>41</strike> 37 bytes</h2>

<pre><code>1..1mb|%{(get-random)%4+1}|measure -s
</code></pre>

<p>Took my machine 2 minutes 40 seconds</p>
</div>
<div id="pu19" class="pu"><h1>Ruby, 32 bytes</h1>

<pre class="lang-ruby prettyprint-override"><code>(1..2**20).inject{|x|x-~rand(4)}
</code></pre>

<p>In a more readable form:</p>

<pre class="lang-ruby prettyprint-override"><code>(1..2**20).inject(0) do |x|
  x + rand(4) + 1
end
</code></pre>

<p>It creates a range from 1 to 1048576 and then iterates over the block that many times. Each time the block is executed the value from the previous iteration is passed in as <code>x</code> (initially 0, the default for <code>inject</code>). Each iteration it calculates a random number between 0 and 3 (inclusive), adds one so it simulates rolling a d4 and adds that to the total.</p>

<p>On my machine it's pretty fast to run (<code>0.25 real, 0.22 user, 0.02 sys</code>).</p>

<p>If you've got Ruby installed you can run it with <code>ruby -e 'p (1..2**20).inject{|x|x+rand(4)+1}'</code> (the <code>p</code> is necessary to see the output when run in this manner, omit it if you don't care for that or just run it inside IRB where the result is printed to the screen for you). I've tested it on Ruby 2.1.6.</p>

<p>Thanks to histocrat for the bit twiddling hack that replaces <code>x + rand(4) + 1</code> with <code>x-~rand(4)</code>.</p>
</div>
<div id="pu20" class="pu"><h1>Mathematica, <s>30</s> 27 bytes</h1>
<pre><code>Tr[RandomInteger[3,2^20]+1]
</code></pre>
<p>Mathematica has quite long function names...</p>
</div>
<div id="pu21" class="pu"><h1>JavaScript (ES6), 54 bytes</h1>

<p>Average time &lt; 100 msec. Run snippet to test (in Firefox)</p>

<p><div class="snippet" data-lang="js" data-hide="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>// This is the answer
f=t=&gt;(i=&gt;{for(t=i;i--;)t+=Math.random()*4|0})(1&lt;&lt;20)|t

// This is the test
test();

function test(){
  var time = ~new Date;
  var tot = f();
  time -= ~new Date;
  
  Out.innerHTML = "Tot: " + tot + " in msec: " + time + "\n" + Out.innerHTML;
}</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;button onclick="test()"&gt;Repeat test&lt;/button&gt;&lt;br&gt;
&lt;pre id=Out&gt;&lt;/pre&gt;</code></pre>
</div>
</div>
</p>

<p><strong>Explanation</strong></p>

<p>With no statistical package built-in, in Javascript the shortest way to obtain the sum of 1 million random number is to call random() for a million times. So simply</p>



<pre class="lang-js prettyprint-override"><code>f=()=&gt;{
   var t = 0, r, i
   for (i=1&lt;&lt;20; i--; ) 
   {
      r = Math.random()*4 // random number between 0 and 3.9999999
      r = r + 1 // range 1 ... 4.999999
      r = r | 0 // truncate to int, so range 1 ... 4
      t = t+r
   }
   return t
}
</code></pre>

<p>Now, adding 1 for a million times is exactly the same than adding 1 million, or even better, start the sum with 1 million and then add the rest:</p>

<pre class="lang-js prettyprint-override"><code>f=()=&gt;{
   var t, r, i
   for (t = i = 1&lt;&lt;20; i--; ) 
   {
      r = Math.random()*4 // random number between 0 and 3.9999999
      r = r | 0 // truncate to int, so range 0 ... 3
      t = t+r
   }
   return t
}
</code></pre>

<p>Then golf, drop the temp variable r and drop the declaration of local variables. <code>t</code> is a parameter, as one is needed to shorten the declaration of <code>f</code>. <code>i</code> is global (bad thing) </p>

<pre class="lang-js prettyprint-override"><code>f=t=&gt;{
   for(t=i=1&lt;&lt;20;i--;) 
      t+=Math.random()*4|0
   return t
}
</code></pre>

<p>Then find a way to avoid 'return' using a nameless inner function. As a side effect, we gain another parameter so no globals used </p>

<pre class="lang-js prettyprint-override"><code>f=t=&gt;(
  (i=&gt;{ // start inner function body
     for(t=i;i--;)t=t+Math.random()*4|0 // assign t without returning it
   })(1&lt;&lt;20) // value assigned to parameter i
  | t // the inner function returns 'undefined', binary ored with t gives t again
) // and these open/close bracket can be removed too
</code></pre>
</div>
<div id="pu22" class="pu"><h2>Commodore Basic, 37 bytes</h2>

<pre><code>1F┌I=1TO2↑20:C=C+INT(R/(1)*4+1):N─:?C
</code></pre>

<p>PETSCII substitutions: <code>─</code> = <code>SHIFT+E</code>, <code>/</code> = <code>SHIFT+N</code>, <code>┌</code> = <code>SHIFT+O</code></p>

<p>Estimated runtime based on runs with lower dice counts: 4.25 hours.</p>

<p>It's tempting to try to golf off two bytes by making <code>C</code> an integer, getting implicit rounding of the random numbers.  However, the range on integers in Commodore Basic is -32678 to 32767 -- not enough, when the median answer is 2621440.</p>
</div>
<div id="pu23" class="pu"><h1>Javascript + ActionScript2, 67 bytes</h1>
<p>According to the ActionScript3 <a href="http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f9d.html" rel="nofollow noreferrer">documentation</a>, it is only required to use the keyword <code>var</code> when setting a type.</p>
<p>Other than that, it pretty much looks like Javascript.<br>
Since I'm a fan of polyglots, I did this one.</p>
<p>The code:</p>
<pre><code>function r(){i=a=0;while(i++&lt;1&lt;&lt;20)a+=1+Math.random()*4&amp;7;return a}
</code></pre>
<p>The <code>&amp;7</code> has a function to convert the number to an integer value. I could use other methods, but the gain in size would be null.</p>
<p>Test it here:</p>
<p><div class="snippet" data-lang="js" data-hide="true" data-console="false" data-babel="false">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-js lang-js prettyprint-override"><code>function r(){i=a=0;while(i++&lt;1&lt;&lt;20)a+=1+Math.random()*4&amp;7;return a}

document.write(r());</code></pre>
</div>
</div>
</p>
<p>This answer is based on <a href="https://codegolf.stackexchange.com/a/49501/14732">Brian's answer</a> in ActionScript3, based in a comment I left with a solution for him.</p>
</div>
<div id="pu24" class="pu"><h1>PostgreSQL, 59 bytes</h1>

<pre><code>select sum(ceil(random()*4)) from generate_series(1,1&lt;&lt;20);
</code></pre>

<p>I'll admit to the slight problem that <code>random()</code> could, in theory, produce exactly zero, in which case the die roll would be zero.</p>
</div>
<div id="pu25" class="pu"><h1>PHP, <del>38</del> 37 bytes</h1>

<p>This uses a very simple idea: sum them all!</p>

<p>Also, I've noticed that <code>1048576</code> is <code>10000000000000000000</code> in binary, equivalent to <code>1&lt;&lt;20</code>.</p>

<p>Here's the code:</p>

<pre><code>while($i++&lt;1&lt;&lt;20)$v+=rand(1,4);echo$v
</code></pre>

<hr>

<p>Test in your browser (with <strong>VERY LITTLE</strong> changes):</p>

<pre><code>$i=$v=0;while($i++&lt;1&lt;&lt;20)$v+=rand(1,4);printf($v);
</code></pre>

<p><div class="snippet" data-lang="js" data-hide="true">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-js lang-js prettyprint-override"><code>//'patch' to make a TRUE polyglot, to work in JS

if('\0'=="\0")//this will be false in PHP, true in JS
{
  //rand function, takes 2 parameters
  function rand($m,$n){
    return ((Math.random()*($n-$m+1))+$m)&gt;&gt;0;
    
    /*
     *returns an integer number between $m and $n
     *example run, with rand(4,9):
     *(Math.random()*(9-4+1))+4
     *
     *if you run Math.random()*(9-4+1),
     *it will returns numbers between 0 and 5 (9-4+1=6, but Math.random() never returns 1)
     *but the minimum is 4, so, we add it in the end
     *this results in numbers between 0+4 and 4+5
     *
     */
    
  }
  
  //for this purpose, this is enough
  function printf($s){
    document.write($s);
  }
}


/*
 *Changes:
 *
 *- instead of echo, use printf
 *    printf outputs a formatted string in php
 *    if I used echo instead, PHP would complain
 *- set an initial value on $i and $v
 *    this avoids errors in Javascript
 *
 */


$i=$v=0;while($i++&lt;1&lt;&lt;20)$v+=rand(1,4);printf($v);</code></pre>
</div>
</div>
</p>

<p>All the changes in the code are explained in comments.</p>
</div>
<div id="pu26" class="pu"><p><strong>C#: 105 bytes</strong></p>

<pre><code>using System.Linq;class C{int D(){var a=new System.Random();return new int[1&lt;&lt;20].Sum(i=&gt;a.Next(1,5));}}
</code></pre>
</div>
<div id="pu27" class="pu"><h1>Lua 5.1, 51 bytes :)</h1>

<p><code>a=0 for _=1,2^20 do a=a+math.random(4) end print(a)</code></p>

<p><code>math.random(n)</code> already returns a number between 1 and <code>n</code>, so I didn't use @edc65's optimization (clever though it is).  Another 26 bytes is required to properly seed the RNG, however....</p>
</div>
<div id="pu28" class="pu"><h1>Perl - <s>48</s> <s>44</s> <s>37</s> <s>39</s> 34 bytes</h1>

<pre><code>$-+=rand(4)+1for(1..2**20);print$-
</code></pre>

<p>Prints the sum without a trailing newline.<br>
Saved 4 bytes by substituting for <code>2**20</code> (thanks Maltysen) and removing quotes around print.<br>
Saved another 7 bytes by rearranging the code (thanks Thaylon!)<br>
Lost 2 bytes because my old code generated 0-4 (it should be 1-4).<br>
Once again, saved 5 bytes thanks to Caek and nutki.</p>

<p>Ungolfed, properly written code:</p>

<pre><code>my $s = 0
$s += int( rand(4) + 1 ) for (1 .. 2**20);
print "$s";
</code></pre>
</div>
<div id="pu29" class="pu"><p><strong>C#, 148</strong> (console app)</p>

<pre class="lang-c# prettyprint-override"><code>using R=System.Random;using C=System.Console;class P{static void Main(){int o=0;R r=new R();for(int i=0;i&lt;1048576;i++){o+=r.Next(1,4);}C.Write(o);}}
</code></pre>
</div>
<div id="pu30" class="pu"><h2>Actionscript 3, <s>81</s> <s>77</s> 75 bytes:</h2>

<pre><code>function r(){var a=0,i=1&lt;&lt;20;while(i--){a+=int(Math.random()*4+1)}return a}
</code></pre>
</div>
<div id="pu31" class="pu"><h1>CJam, <s>12</s> 11 bytes</h1>
<pre><code>YK#_{4mr+}*
</code></pre>
<p>This is pretty straight foward:</p>
<pre><code>YK                  e# Y is 2, K is 20
  #                 e# 2 to the power 20
   _                e# Copy this 2 to the power 20. The first one acts as a base value
    {    }*         e# Run this code block 2 to the power 20 times
     4mr            e# Get a random int from 0 to 3. 0 to 3 works because we already have
                    e# 2 to the power 20 as base value for summation.
        +           e# Add it to the current sum (initially 2 to the power 20)
</code></pre>
<p>But the beauty of this is that its really fast too! On my machine (and using the <a href="https://sourceforge.net/p/cjam/wiki/Home/" rel="nofollow noreferrer">Java compiler</a>) it takes on an average of 70 milliseconds.</p>
<p>The <a href="http://cjam.aditsu.net/#code=esYK%23_%7B4mr%2B%7D*es%40-p" rel="nofollow noreferrer">online version</a> takes around 1.7 seconds on my machine.</p>
<p><em>Update</em>: 1 byte saved thanks to DocMax</p>
</div>
<div id="pu32" class="pu"><h1><a href="http://jsoftware.com/" rel="nofollow">J</a> (12 bytes, about 9.8 milliseconds)</h1>

<pre><code>+/&gt;:?4$~2^20
</code></pre>

<p>I suspect this is mostly memory bandwith-limited: I can't even get it to max out a single core...</p>

<p>You can test this with the following code:</p>

<pre><code>   timeit =: 13 : '(1000 * &gt;./ ($/x) 6!:2"0 1 y)'
   4 20 timeit '+/&gt;:?4$~2^20'
9.90059
</code></pre>

<p>This runs it in 4 groups of 20 trails, and returns the number of milliseconds of the avarage time in the quickest group. An interpreter can be found <a href="http://www.jsoftware.com/download/j803/install/" rel="nofollow">here</a>.</p>
</div>
<div id="pu33" class="pu"><h1>C, 57 bytes</h1>

<pre><code>main(a,b){for(b=a=1&lt;&lt;20;a--;b+=rand()%4);printf("%d",b);}
</code></pre>

<p>This code works... once. If you ever need to roll those dice again, you'll need to put <code>srand(time(0))</code> in there, adding 14 bytes.</p>
</div>
<div id="pu34" class="pu"><h2>Haskell, 73 bytes</h2>

<pre><code>import System.Random
f=fmap sum.(sequence.replicate(2^20))$randomRIO(1,4)
</code></pre>

<p>Usage:</p>

<pre><code>$ ghci sourcefile.hs
ghci&gt; f
2622130
</code></pre>
</div>
<div id="pu35" class="pu"><h1>Pyth - <strike>9</strike> 8 bytes</h1>
<p>Uses obvious simple method of summation of randint. Took me minute to realize <code>1048576</code> was <code>2^20</code>, now I feel really stupid. Thanks to @Jakube for saving me a byte by pointing out <code>2^20 = 4^10</code>.</p>
<pre><code>smhO4^4T
</code></pre>
<p>The runtime is horrible, it has yet to finish on my computer, so there is no point running it online so here is the <code>2^10</code> one: <a href="http://pyth.herokuapp.com/?code=smhO4%5E2T&amp;debug=0" rel="noreferrer">Try it online here</a>.</p>
<pre><code>s        Summation
 m       Map
  h      Incr (accounts for 0-indexed randint)
   O4    Randint 4
  ^4T    Four raised to ten
</code></pre>
</div>
<div id="pu36" class="pu"><h1>Perl, 29</h1>

<p>Generates a table of the required length.</p>

<pre><code>print~~map{0..rand 4}1..2**20
</code></pre>
</div>
<div id="pu37" class="pu"><h1>APL, <s>11</s> 10 bytes</h1>

<pre><code>+/?4⍴⍨2*20
</code></pre>

<p>This just takes the sum of an array of 2<sup>20</sup> = 1048576 random integers between 1 and 4.</p>

<pre><code>+/           ⍝ Reduce by summing a
  ?          ⍝ random integer
   4⍴⍨       ⍝ array with values between 1 and 4
      2*20   ⍝ of length 2^20
</code></pre>

<p>You can <a href="http://tryapl.org/?a=%u2395ts%u22C4+/%3F4%u2374%u23682*20%u22C4%u2395ts&amp;run" rel="nofollow">benchmark this on TryAPL</a> by printing the timestamp before and after. It takes about 0.02 seconds.</p>

<p>Saved a byte thanks to marinus and FUZxxl!</p>
</div>
<div id="pu38" class="pu"><h1>Matlab, 24</h1>
<p>First submission ever! </p>
<pre><code>sum(randi([1,4],1,2^20))
</code></pre>
<p>I had hoped to make use of randi([1,4],1024), which gives a matrix of 1048576 elements, but then I needed a double sum, which takes more characters than this.</p>
<p>Regarding the running speed mentioned in the question, <code>timeit</code> tells me the runtime is about 0.031 seconds. So, pretty much instant.</p>
</div>
<div id="pu39" class="pu"><h1>Java, 65</h1>
<p>Since we have scores listed by language, why not throw Java into the mix? There's not much to golf here, just a simple loop, but I was able to squeeze a couple out of my initial attempt:</p>
<pre class="lang-java prettyprint-override"><code>int f(){int i=1&lt;&lt;20,s=i;while(i--&gt;0)s+=Math.random()*4;return s;}
</code></pre>
</div>
<div id="pu40" class="pu"><h1>Go, 87 bytes</h1>

<h2>Naive solution</h2>

<pre><code>import"math/rand";func r(){o,n:=0,2&lt;&lt;19;for i:=0;i&lt;n;i++{o+=rand.Intn(4)};println(o+n)}
</code></pre>

<p>Run online here: <a href="http://play.golang.org/p/gwP5Os7_Sq" rel="nofollow">http://play.golang.org/p/gwP5Os7_Sq</a></p>

<p>Due to the way the Go playground works you have to manually change the seed (time is always the same)</p>
</div>
<div id="pu41" class="pu"><h1>Go, 78 bytes</h1>

<h2>Golfed</h2>

<pre><code>import."math/rand";func r()(o int){for i:=2&lt;&lt;19;i&gt;=0;i--{o+=Intn(4)+1};return}
</code></pre>

<p>Still working on it</p>

<p>Run online here <a href="http://play.golang.org/p/pCliUpu9Eq" rel="nofollow">http://play.golang.org/p/pCliUpu9Eq</a></p>
</div>
<div id="pu42" class="pu"><h1>Pyth, 10 bytes</h1>

<pre><code>u+GhO4^4TZ
</code></pre>

<p>This has slightly more bytes than @Maltysen's Pyth solution. But it runs in 8.5 seconds on my laptop, while @Maltysen's solution produced no solution in 20 minutes running time. </p>

<p>But still a little bit too slow for the online compiler. </p>

<h3>Explanation</h3>

<pre><code>u     ^4TZ   start with G = 0, for H in 0, ... 4^10-1:
                G = 
 +GhO4              G + (rand_int(4) + 1)
             result is printed implicitly 
</code></pre>
</div>
<div id="pu43" class="pu"><h2><a href="https://esolangs.org/wiki/Clip" rel="nofollow">Clip 10</a>, 12 bytes</h2>

<pre><code>r+`m[)r4}#WT

         #4T    .- 4^10 = 1048576             -.
   m[   }       .- that many...               -.
     )r4        .-          ...random numbers -.
r+`             .- sum                        -.
</code></pre>

<p>It takes approximately 0.6 seconds to run on my machine.</p>
</div>
<div id="pu44" class="pu"><h1>Python 2, 58 bytes</h1>

<p>We get 1048576 random characters from the operating system, take 2 bits of each, and add them up. Using the <code>os</code> library seems to save a few characters over using the <code>random</code> library.</p>

<pre><code>import os
print sum(1+ord(c)%4 for c in os.urandom(1&lt;&lt;20))
</code></pre>

<p>This takes about 0.2 seconds on my PC.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../index.html">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/49461/">49461</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




