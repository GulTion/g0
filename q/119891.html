<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::119891</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>255</td><td>Python 3.8 prerelease</td><td>240128T134827Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/269590#269590">movatica</a></td></tr>
<tr d-ix="1"><td>347</td><td>Go</td><td>230131T145542Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/257252#257252">bigyihsu</a></td></tr>
<tr d-ix="2"><td>151</td><td>JavaScript</td><td>230131T171043Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/257256#257256">Shaggy</a></td></tr>
<tr d-ix="3"><td>263</td><td>C clang</td><td>170512T121638Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/120237#120237">jdt</a></td></tr>
<tr d-ix="4"><td>374</td><td>C#</td><td>170512T140625Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/120253#120253">TheLetha</a></td></tr>
<tr d-ix="5"><td>294</td><td>JavaScript ES6</td><td>170510T144843Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119931#119931">Hankreco</a></td></tr>
<tr d-ix="6"><td>195</td><td>Perl 6</td><td>170510T180815Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119959#119959">Sean</a></td></tr>
<tr d-ix="7"><td>324</td><td>Clojure</td><td>170510T155235Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119938#119938">NikoNyrh</a></td></tr>
<tr d-ix="8"><td>369</td><td>C</td><td>170510T183108Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119968#119968">user5898</a></td></tr>
<tr d-ix="9"><td>176</td><td>JavaScript</td><td>170511T071034Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/120019#120019">Bumpy</a></td></tr>
<tr d-ix="10"><td>079</td><td>Pyth</td><td>170510T133223Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119918#119918">Leaky Nu</a></td></tr>
<tr d-ix="11"><td>232</td><td>Mathematica 232 Bytes</td><td>170510T183506Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119969#119969">Kelly Lo</a></td></tr>
<tr d-ix="12"><td>340</td><td>Python 3.6</td><td>170510T150711Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119932#119932">Display </a></td></tr>
<tr d-ix="13"><td>074</td><td>Jelly</td><td>170510T115335Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119902#119902">Jonathan</a></td></tr>
<tr d-ix="14"><td>278</td><td>PHP</td><td>170510T123012Z</td><td><a href="https://codegolf.stackexchange.com/questions/119891/scramble-words-while-preserving-their-outlines/119905#119905">J&#246;r</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8 (pre-release)</a>, <s>298</s> <s>281</s> <s>261</s> 255 bytes</h1>

<pre class="lang-python prettyprint-override"><code>from random import*
import re
g=lambda c:sum(((p:=&quot;jitgpqybdfhkl&quot;.find(c))&lt;0,p&lt;1,p&lt;3,p&lt;7))
def f(m,C=[[],[],[],[],[]]):
 t,*u,v=m[0]
 for c in u:l=C[g(c)];l+=[c];shuffle(l)
 return t+''.join(C[g(c)].pop()for c in u)+v
h=lambda s:re.sub('[A-Za-z]{4,}',f,s)
</code></pre>
<p><a href="https://tio.run/##TZFNb9wgEIbv/hUjXxayxEqVSq2c@BDlUPXS055q@YAx2OxiIHx4s6n627djt2krgQbEzLzPO/hLmpy9/@zD9aqCmyFwO2DQs3ch3RS/IwRZjI3hcz9wEHXMMyHE10151Gn0L5d@UNPJlJXSdiCC0sc75h8/4L7H/YnSYpAKFJnZc9O2HftvdbQuILGbzJZmbu@6ApQLIEBbyLVpntsR@3UPZt@0onuIU1bKSGJogUgpBwtpv9tVR6ct@ZNbeecJ/deF7pdiemePdZBVzD3ZtU@33/ntW/fjI/u5Y4pFek0ypggNtOXXBDrCWRoDJ@vOqDLxBBySfE0guIWYNL71Ein4AOdJG4k5EgUtD0MEp0Bjr7NbLxNfJOZKLBMBOYwcGPAIxtlxjVioAygdImrYAQzHg5EpyRDBm/ye4RYZOMq6nIy2MqL4zNGicDYmblNVMii/6AWFOPigbeKoBU9RaL3/Js9r0WaB/QUBycW0YQIXAoNGpORWwYjmspGxXrse0NtL1uIEfVjnodwrHPPs4wa1WTf87QKDG6uyK4p1/Id1/NtM8Ys3HDKRA6XXXw" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://go.dev" rel="nofollow noreferrer">Go</a>, <s>364</s> <s>357</s> 347 bytes</h1>
<pre class="lang-go prettyprint-override"><code>import(.&quot;math/rand&quot;;.&quot;regexp&quot;)
func f(s string)string{return MustCompile(`(\w)(\w+)(\w)`).ReplaceAllStringFunc(s,func(S string)string{k:=S[1:len(S)-1]
for i:=range k{for _,l:=range[]string{&quot;acemnorsuvwxz&quot;,&quot;bdfhkl&quot;,&quot;gpqy&quot;,&quot;it&quot;,&quot;j&quot;}{if o,_:=MatchString(&quot;[&quot;+l+&quot;]&quot;,k[i:i+1]);o{q:=Intn(len(l));k=k[:i]+l[q:q+1]+k[i+1:]}}}
return S[:1]+k+S[len(S)-1:]})}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=jVPBitswEKX0lp_oICi1sZuSW_HiwrLQsoctpW5PTtgo9jjWWpYSSV4nG_IlvSyFfkR_pV_TkZ1dltLDQmwpmtGb996Mf_xc6_vfG140fI3QcqEmot1o46asah371bnq7fs_L_LxMJiylrv6neGqZGdTZnCNuw0LJ1WnCqgCC9YZodbhuBwMus4ouOqsu9DtRkgMlsG8D-mJ_CtchtOvuJG8wHMps-HSR4IKbOwRg-wfvCZJs3yWSFRBFr6dLSaVNiCSlPgQ--bg_17H8nSQL07XGOG3Shvb3fa7OxazVVnVjaTNerPd0yIcvW7Y8SAq0PF1kl5xV9Qjn4DlLJIRW7C4yUUiotkiPNOHbZJeKqcCz0WG4VmTNnkiFpHMt8mWciJKjmbJ4ng8Tk42ZHniz6MsfxBA4fB48vjlq8FE34IghMMkS1LmaoRtJ4oGVkb3Ciq9g5uu3WAJ-hYN-Ljkd3so9ZpNvhBdVwXstZ2r9MNc-XWuWAxZTL3JwnCSpey8KLQpSRc4DRwMWuSmqAmMO7jg7cqIkrz8rgQVsMLtYxCO8NGqN47YOUepQkFfUz4hPbBAH7A-wqGnc-AG4yGkldzDOD9cOTryxYWlDXdDQiWMdUAjRVpoM0LBCuEUN2JdOximZArf_AFSWsHVkEM6HJfQorUDxl53Q8w6ISWl8tIL6IWrdUcoRq8kth6HKNBvhQXvLA6F6q6li60gFC8YlHYjAJIX-0dipMZZlBWsupHgqNd65bWWOH1eK5aXzhPokWg2yrd3cIQE4c49kbDCkURf0_cz1BNKcVNa0JVnMpS3UPNbpFyka4WhPkosY09KarKbe7tRmP97bcnc7iHDDxansuSWFIpcMOhnEgqtrG_gFD7RaPg2b7xIToXg3BZCRJ-x9zcG_vEjC0Be1CeLns4eVSPbTSfRJstnGHb6Tu7vx_Uv" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Uses an adaptation of my <a href="https://codegolf.stackexchange.com/a/257251/77309">&quot;Cambridge Transposition&quot;</a> solution.</p>
<ul>
<li>-7 bytes from some reorganization</li>
<li>-10 bytes from using string slices and general cleanup</li>
</ul>
</div>
<div id="pu2" class="pu"><h1>JavaScript, 151 bytes</h1>
<p>Revisiting and expanding on my suggested improvements to <a href="https://codegolf.stackexchange.com/a/120019/58974">Bumpy's solution</a> all these years later.</p>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;s.replace(/\B[a-z]+\B/g,m=&gt;[/[^bdf-jklpqty]/g,/[bdfhkl]/g,/[gpqy]/g,/i|t/g].map(r=&gt;m=m.replace(r,c=&gt;d.sort(_=&gt;new Date%3-1).pop(),d=m.match(r)))&amp;&amp;m)
</code></pre>
<p><a href="https://tio.run/##dVLNbhMxEL7vU8yFalfdOCoFCSFtpFZICAnBASQk0kCn3smuW6/t2rPZtuLAs/BovEgYJ0p64uTxePz92be4waSjCTzbvNmum21qFklFChY1lfOryyXOnlanV5fzrh6axXK@/HHTrme3dzbc8@NKuvOlNPo7u6@7cL/vml8871ZqwFDGZjE0wxE01rpZtCr5yOXPZuFognfI9OJ8dlap4ENZ1a2MD8i6L2NVVScnQ7XV3iVvSVnfleuyuP7AYBJMZC3cOT854B4ZEJgeGDQ6SGzk7IYgErYw9caSzBAY5zC2CfwaDAuCz5seNySzJNd0xOHGUlsDJrDedXmViybC2sQkHK4Fi1JYYqaYINjxMOE3FFFo/cjWOEpCPqBxkNUzOlbw3myEBSFE4xiFCC6SNub0E035xk5/fVQBhLrfaQTUWhYjethntiTORkvpbXGm4Mt@Pp8Oo0gT22VINLa@giiC/aCKlwou9lASHEKi@5GcphxEzuUjchbaY0SdbdUyzX30Y9fDd1WcK/js7KPEZ9igPZqfcsoktjPnGAJFjYlU8UrBV0H9T2Q7kZLII4yO/ah7alXxWsG3/vkJxEwNPnM@c3EvGr07il57a/2UbXeiNAiwQNKDuHAdwe6/SUAA8Pf3H0mQBudjGjfTw9Ohuf@8h13@vofa8KG6hTJrTWJ@j1ldF1W1/Qc" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="http://clang.llvm.org/" rel="nofollow noreferrer">C (clang)</a>, <s>282</s> 263 bytes</h1>

<p>-19 bytes thanks to the man (or cat) ceilingcat!!</p>
<pre class="lang-c prettyprint-override"><code>c,o,d,e,g;l(*f){for(char*s[5]={&quot;aneusvrowxmcz&quot;,&quot;bhkfdl&quot;,&quot;gqpy&quot;,&quot;it&quot;},**h,*i=f,*t;*i;){if(isalpha(*i)){for(t=i;isalpha(*i);)i++;e=i-t-2;for(h=s;*h&amp;&amp;e;*h++)for(c=999;--c;)if(o=1+rand(d=1+rand()%e)%e,index(*h,t[d])&amp;&amp;index(*h,t[o]))g=t[d],t[d]=t[o],t[o]=g;}else++i;}}
</code></pre>
<p><a href="https://tio.run/##dVNPb9MwFD93n@KpElWcpB0b7DBCDpwQEhIHkJDoenCdl9jMtVPbadpV/eqU51Rry4Eoiu3n59@/JGIqNDfN8Shym1c55k2hk7Rm@9q6REjuUj9/WJT7MTfY@Y2z/XYlXsb5eCmf60rTpFm3OxpUGB/yNJV5qso6T0ORqoLtVZ0oz3UreZIqdkINpSquigVTWVZgqaZhel/EBln6IpWTCdIzy9igpHx8fCymU0HddWLLu8xxUyXV64S9QbpzZSrcJiQizKsFm0yu1nbBWFPG@rBZxspQLpvigNpjlqnicDiuuDIJ28M/180oRgFhvoCSFqPxlwDKQ49aw7OxvYEgeQAOAbcBBDfgg6K9JYJDXkEvlUbqQVDGcFd5sDWoQAg2LiTfIPWigXEE98Lx1VJjlQP3oK1p4kinlYNaOU9EpgLNaaIxBHQeWt29dtgNOk7ctgtaGfSkIHo6QQtrfOAmzOCz2hDfSXEOr5SAXMhBFXAhaFBEHmyE9uSl0@g/PJknM4DdzeD76VzsWnWkhwwnrceusgzii7Gr2bn9fgafTtAUHQeP6w6NwBhFTOYrD6Qy5sxF9JRTd5DOdo2EXxeUdzP4ZvSOglRBcX1OoI95I3mPGrq2RSe4x8u59zP4QSz/yW8QT8nsoDPBdkJidTn6MIOfksLyZ7M52Kjhwh0kabfmbKa2Wts@xtKQg5YICBq35M40SG@LiyHIAT5@YBQllVbGOt9t@u3L1RbFtqxq@ayvahRC0653VxWyp8LVmjT/hiQ68hTViZHRfnEz8sMfE9QKk7eMFXB7Cx/B2EAfyrpTDqubkU4Co862C36YHY5/RK1544/T/i8" rel="nofollow noreferrer" title="C (clang) – Try It Online">Try it online!</a></p>
<p>Ungolfed:</p>
<pre class="lang-c prettyprint-override"><code>int func(char*p) 
{
    char *groups[] = {&quot;aneusvrowxmcz&quot;,&quot;bhkfdl&quot;,&quot;gqpy&quot;,&quot;it&quot;,0}, **g, *s, *t;
    int n,r,i,l,o;

    for (s = p; *s;)
    {
        if (isalpha(*s))
        {
            t = s;
            while (*s &amp;&amp; isalpha(*s))
                s++;
            // start scrambling
            l = s - t - 2;
            for(g=groups; *g &amp;&amp; l; *g++)
            {
                for(n=999;--n;)
                {
                    i = 1 + rand() % l;
                    r = 1 + rand() % l;
                    if (strchr(*g, t[i]) &amp;&amp; strchr(*g, t[r]))
                    {
                        o=t[i];
                        t[i]=t[r];
                        t[r]=o;
                    }
                }
            }
            // end scrambling
        }
        else 
            s++;
    }
}
</code></pre>
</div>
<div id="pu4" class="pu"><h2>C#, <s>438</s> <s>394</s> <s>380</s> 374 bytes</h2>



<pre class="lang-c# prettyprint-override"><code>namespace System.Text.RegularExpressions{using Linq;s=&gt;Regex.Replace(s,@"\p{L}(([gpqy])|(i|t)|(j)|([bdf-l])|([a-z]))*?[a-z]?\b",m=&gt;{var a=m.Value.ToArray();for(int i=1,j;++i&lt;7;){var c=m.Groups[i].Captures;var n=c.Cast&lt;Capture&gt;().Select(p=&gt;p.Index-m.Index).ToList();foreach(Capture p in c){a[j=n[new Random().Next(n.Count)]]=p.Value[0];n.Remove(j);}}return new string(a);});}
</code></pre>

<p><em>Save 10 bytes thanks to @MartinEnder♦.</em></p>

<p>Annoyingly, <a href="https://stackoverflow.com/questions/19035527/why-can-i-not-call-select-from-a-capturecollection-object"><code>CaptureCollection</code> doesn't implement <code>IEnumerable&lt;T&gt;</code></a> and that's why the <code>.Cast&lt;Capture&gt;()</code> is needed. Hopefully, I can combine the Linq query and the <code>foreach</code> loop though.</p>

<p>I'm sure there's a lot that can be golfed but it took me long enough just to get it working...</p>

<p><a href="https://tio.run/nexus/cs-mono#fVNNb9swDL37VxA5SWtibJddnKYrgm0Y0A1DUmxAXR8Um4mV2ZIryYnTLr89o@1kazO7vJjmx3uPknhQIkdbiBhhvrMOc@/JA7LSSrWCW6ycP8NVmQnzsSoMWiu1ssGzkhupHgKvCcSZsBa@N36LUpt1wskYNlom8FVIxfjf1L@i2j6VKh5bZwh1CO13Aku4BAuXkxeVtZEqrEhbkZF2ZofwYRBej@7E6DFiLKRYrrSx5ah6jPhvFi6SZfora9xV8bBrHOkizt9chXXP1f1iMIS8i@npv0htG2FAkLjc/yGyEv1bPU2FuTZG7Bg/Hsi5LbUBJpUDSY3vhrAO4OJCwhjeB7yzoZv6RB839J@NLgsbysifisKVdEc97Kc2RW0xFVs3PnZMGPfnmGHsWEEnAIX/RSVYwYjgG4/TeDfSunqyPujeBE2NIk7ZkQwKkApi3lvfP3RtIlyTfhUq3MJMqETnJP4bvVOm/KkuleNRRAVFey3h2yh4FU7RE8r1Btn6ldH2Xne0M2yQplRQ62sfMRMd0Puz2IufKe2YztD/aaRDWjBkSzaYx0bkiwxhq01iYZtK8uuVRLOpF9GlKA3o0mXUYAf8jOCEOUORNJDP8u18e29/OPwB" rel="nofollow noreferrer" title="C# (Mono) – TIO Nexus">Try it online!</a></p>

<p>Formatted/Full version:</p>

<pre class="lang-c# prettyprint-override"><code>namespace System.Text.RegularExpressions
{
    using Linq;

    class P
    {
        static void Main()
        {
            Func&lt;string, string&gt; f = s =&gt;
                Regex.Replace(s, @"\p{L}(([gpqy])|(i|t)|(j)|([bdf-l])|([a-z]))*?[a-z]?\b", m =&gt;
                {
                    var a = m.Value.ToArray();

                    for (int i = 1, j; ++i &lt; 7;)
                    {
                        var c = m.Groups[i].Captures;

                        var n = c.Cast&lt;Capture&gt;().Select(p =&gt; p.Index - m.Index).ToList();

                        foreach(Capture p in c)
                        {
                            a[j = n[new Random().Next(n.Count)]] = p.Value[0];
                            n.Remove(j);
                        }
                    }

                    return new string(a);
                });

            Console.WriteLine(f("Scramble words while preserving their outlines"));
            Console.ReadLine();
        }
    }
}
</code></pre>
</div>
<div id="pu5" class="pu"><h1>JavaScript (ES6), <s>380</s> <s>327</s> <s>311</s> 294 Bytes</h1>

<p>(<s>298</s> <s>282</s> 265 Bytes excluding the rules)</p>

<p>Thanks to @Shaggy for the useful tips!</p>

<pre><code>((b,d)=&gt;b.replace(/\B[a-z]+\B/gi,f=&gt;(g=&gt;(g.map(j=&gt;(h=d.slice(0,~(rind=d.indexOf(j))?rind:-1),~rind?h.split`,`.length-1:-1)).map((j,k,l,m=[])=&gt;{l.map((n,o)=&gt;n==j?m.push(o):0),sub=m[new Date%(m.length-1)]||k,tmp=g[sub],g[sub]=g[k],g[k]=tmp}),g.join``))([...f])))(s,"aneusvrowxmcz,bhkfdl,gqpy,it");
</code></pre>

<p><div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>var f = ((b,d)=&gt;b.replace(/\B[a-z]+\B/gi,f=&gt;(g=&gt;(g.map(j=&gt;(h=d.slice(0,~(rind=d.indexOf(j))?rind:-1),~rind?h.split`,`.length-1:-1)).map((j,k,l,m=[])=&gt;{l.map((n,o)=&gt;n==j?m.push(o):0),sub=m[new Date%(m.length-1)]||k,tmp=g[sub],g[sub]=g[k],g[k]=tmp}),g.join``))([...f])))

var s="Let there be scrambling";
console.log(s);
console.log(f(s,"aneusvrowxmcz,bhkfdl,gqpy,it"))

s="It is well known that a text can still be read while the innards of its words have been scrambled, as long as their first and last letters plus their overall outlines remain constant. Given a printable Ascii+Newline text, scramble each word according to these rules";
console.log(s);
console.log(f(s,"aneusvrowxmcz,bhkfdl,gqpy,it"))</code></pre>
</div>
</div>
</p>

<p>Function <em>f</em> takes in a string of any kind (single word, multiple words, multiple words with signs in it - which it interprets as word-breaking) and <s>an array</s> a string of "rules" of any length separated by commas.</p>

<p>That array of rules, in the case of your question, would be <s><code>["aneusvrowxmcz", "bhkfdl", "gqpy", "it"]</code></s> <code>"aneusvrowxmcz,bhkfdl,gqpy,it"</code></p>

<p>Some letters don't get mixed even though they could, since you stated in your question that letters "may exchange spaces". If I misinterpreted it, I can change the code to always scramble letters that match the rules.</p>

<p>I know this is an enormous amount of bytes and it won't be able to compete with golfing languages, but I wanted to try anyway, hope you like it :)</p>

<p>Human-readable non-uglified code:</p>

<pre><code>((txt,rules)=&gt;txt.replace(/\B[a-z]+\B/gi,wo=&gt;((w=&gt;(w.map(c=&gt;(h=rules.slice(0, ~(rind=rules.indexOf(c))?rind:-1),~rind?(h.split`,`.length-1):-1)).map((e,i,arr,a=[])=&gt;{
    arr.map((x,i)=&gt;(x==e)?a.push(i):0),
    sub=a[new Date%(a.length-1)]||i,
    tmp=w[sub],
    w[sub]=w[i],
    w[i]=tmp
}),w.join``))([...wo]))))(str, "aneusvrowxmcz,bhkfdl,gqpy,it")
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="http://perl6.org/" rel="nofollow noreferrer">Perl 6</a>, <s>241</s> 195 bytes</h1>

<p>Includes +1 byte for <code>-p</code> command-line switch.</p>

<pre><code>s:g/(&lt;:L&gt;)(&lt;:L&gt;+)(&lt;:L&gt;)/{$0}{[~]
$1.comb.pairs.classify({first
.value~~*,:k,/&lt;[bdfhkl]&gt;/,/&lt;[gpqy]&gt;/,/&lt;[it]&gt;/,/j/,!0}).values.map({$_».key
»=&gt;«$_».value.pick(*)})».List.flat.sort».value}$2/;
</code></pre>

<p>Ungolfed:</p>

<pre><code>s:g/(&lt;:L&gt;)(&lt;:L&gt;+)(&lt;:L&gt;)/{$0}{
    [~]
    $1.comb
    .pairs
    .classify({
        first .value ~~ *, :k,
            /&lt;[bdfhkl]&gt;/,
            /&lt;[gpqy]&gt;/,
            /&lt;[it]&gt;/,
            /j/,
            !0
    })
    .values
    .map({ $_».key »=&gt;« $_».value.pick(*) })
    ».List
    .flat
    .sort
    ».value
}$2/;
</code></pre>
</div>
<div id="pu7" class="pu"><h2>Clojure, <s>326</s> <s>322</s> 324 bytes</h2>

<p>Update 1: replaced <code>(map(fn[[k v]]...)...)</code> with <code>(for[[k v]...]...)</code></p>

<p>Update 2: fixed regex, using <code>\pL</code> instead of <code>\w</code> etc.</p>

<pre><code>#(let[G(zipmap"bdfhklgpqyitj""0000001111223")](apply str(flatten(interleave(for[v(re-seq #"\pL+"%)w[(rest(butlast v))]W[(into{}(for[[k v](group-by G w)][k(shuffle v)]))]R[(rest(reductions(fn[r i](merge-with + r{(G i)1})){}w))]][(first v)(map(fn[c r](nth(W(G c))(-(r(G c))1)))w R)(if(second v)(last v))])(re-seq #"\PL+"%)))))
</code></pre>

<p>I'm looking forward to seeing something shorter. Earlier ungolfed version with a few example runs:</p>

<pre><code>(def f #(let[G(zipmap"bdfhklgpqyitj""0000001111223")] ; Create groups, the longest "acemnorsuvwxz" goes to an implicit group nil
          (apply str(flatten(interleave
                              (for[v (re-seq #"\w+"%)                                          ; Iterate over words
                                   w [(rest(butlast v))]                                       ; This holds the middle part
                                   W [(into{}(map(fn[[k v]][k(shuffle v)])(group-by G w)))]    ; Create shuffled groups
                                   R [(rest(reductions(fn[r i](merge-with + r{(G i)1})){}w))]] ; Calculate cumulative sum of group items, used to look-up nth value from shuffled values
                               [(first v)                                     ; First character
                                (map(fn[g r](nth(W g)(-(r g)1)))(map G w)R)   ; Shuffled middle part
                                (if(&gt;(count v)1)(last v))])                   ; Last character, unless the word is just a single character
                              (re-seq #"\W+"%)))))) ; Interleave with spaces, commas, newline etc.

(f "It is well known that a text can still be read while the innards of its words have been scrambled, as long as their first and last letters plus their overall outlines remain constant.\n")
;  "It is well known that a txet can sitll be read wlihe the irnands of its wrods hvae been seacmlbrd, as lnog as their fisrt and lsat letters plus their oavrell ontlieus rmaein cnontast.\n"
;  "It is well kwonn that a text can sitll be raed wlihe the innards of its wrods hvae been seramlbcd, as long as their fisrt and lsat lettres plus their oravell ouiltnes rmeain cnsatont.\n"
;  "It is well konwn that a text can still be read while the iarnnds of its words have been sraemlbcd, as lnog as their first and lsat lrttees plus their oaevrll ontlieus remain canntsot.\n"
</code></pre>
</div>
<div id="pu8" class="pu"><h1>C, <s>453, 356</s> 369 bytes</h1>

<pre><code>#define F for
#define M rand()%s+1+q
char a[256],*b=" acemnorsuvwxz\1bdfhkl\1gpqy\1it\1j";g(c,t)char*c,*t;{static int i,j,k,w,v,n,q,s,r;r=-1;if(c&amp;&amp;t){strcpy(c,t);if(!k)F(j=i=k=1;b[i];++i)b[i]-1?(a[b[i]]=j):++j;F(r=i=0;c[i];){F(;isspace(c[i]);++i);F(q=i;!isspace(c[i])&amp;&amp;c[i];++i);F(s=v=i-q-2;--v&gt;0;)if(a[c[j=M]]==a[c[w=M]]&amp;&amp;a[c[j]])n=c[j],c[j]=c[w],c[w]=n;}}return r;}
</code></pre>

<p>ungolf with comments</p>

<pre><code>// Input in the arg "t" result in the arg "c"
// NB the memory pointed from c has to be &gt;= memory pointed from t
//    the char is 8 bit
#define F for
#define M rand()%s+1+q
char a[256], *b=" acemnorsuvwxz\1bdfhkl\1gpqy\1it\1j";
   g(c,t)char*c,*t;
   {static int i,j,k,w,v,n,q,s,r;
    r=-1;
    if(c&amp;&amp;t)
      {strcpy(c,t);                         // copy the string in the result space
       if(!k)
         F(j=i=k=1;b[i];++i)
             b[i]-1?(a[b[i]]=j):++j;        // ini [possible because at start k=0]
       F(r=i=0;c[i];)
         {F(;isspace(c[i]);++i);            //skip spaces
                                            // the start q the end+1 i
          F(q=i;!isspace(c[i])&amp;&amp;c[i];++i);  //skip word
          F(s=v=i-q-2;--v&gt;0;)               //loop for swap letters of the same set
            if(a[c[j=M]]==a[c[w=M]]&amp;&amp;a[c[j]])
                n=c[j],c[j]=c[w],c[w]=n;
         }
      }
   return r;
  }


#include &lt;stdio.h&gt;
#define G(x,y) if(x)goto y
main()
{char a[256],r[256];
l1:
 gets(a);// i would know the string lenght&lt;256
 g(r,a);
 printf("%s\n",r);
 G(*a,l1);
}
</code></pre>
</div>
<div id="pu9" class="pu"><h1>JavaScript 176 bytes</h1>
<pre><code>t.replace(/\B(\w+)\B/g,b=&gt;{return[/[acemnorsuvwxz]/g,/[bdfhkl]/g,/[gpqy]/g,/[it]/g].forEach(d=&gt;{g=b.match(d),b=b.replace(d,c=&gt;{return g.splice(Math.random()*g.length,1)})}),b})
</code></pre>
<p><strong>Method:</strong></p>
<ol>
<li><p>RegExp iterates over the centre of each word (<code>/\B(\w+)\B/g</code>) using 1st replace fn.</p>
</li>
<li><p>1st replace fn iterates an array of RegExp's for each letter-group  (<code>/[bdfkhl/g, /[gqpy]/g, etc.. </code>).</p>
</li>
<li><p>Each iteration builds a temp array of word-centre's characters appearing in current letter-group.</p>
</li>
<li><p>Each iteration then uses current letter-group's RegExp to iterate over entire word-centre, using a 2nd replace fn.</p>
</li>
<li><p>2nd replace fn randomly splices the temp array, removing a random character and returning it.</p>
</li>
</ol>
<p><strong>Demo:</strong></p>
<p>Run it in JSFiddle: <a href="https://jsfiddle.net/CookieJon/bnpznb7r/" rel="noreferrer">https://jsfiddle.net/CookieJon/bnpznb7r/</a></p>
</div>
<div id="pu10" class="pu"><h1><a href="https://github.com/isaacg1/pyth" rel="nofollow noreferrer">Pyth</a>, 79 bytes</h1>

<pre><code>sm?td++hduuXNhTeTC,f@@GTHUG.S@HGG+-GJ."by❤jã~léÜº"cJ\jPtdedd:jb.z"([A-Za-z]+)"3
</code></pre>

<p>where <code>❤</code> is U+0018.</p>

<p><a href="http://pyth.herokuapp.com/?code=sm%3Ftd%2B%2BhduuXNhTeTC%2Cf%40%40GTHUG.S%40HGG%2B-GJ.%22by%18j%C3%A3~l%C3%A9%C3%9C%C2%BA%22cJ%5CjPtdedd%3Ajb.z%22%28%5BA-Za-z%5D%2B%29%223&amp;input=It+is+well+known+that+a+text+can+still+be+read+while+the+innards+of+its+words+have+been+scrambled%2C+as+long+as+their+first+and+last+letters+plus+their+overall+outlines+remain+constant.+Given+a+text%2C+scramble+each+word+according+to+these+rules%3A%0A%0A1.+Scrambling+must+be+%28pseudo%29+random.%0A%0A1.+A+word+is+a+sequence+of+the+Latin+characters%2C+A+through+Z.%0A%0A1.+Only+initial+letters+will+ever+be+uppercase.%0A%0A1.+The+first+and+last+letters+must+stay+untouched.%0A%0A1.+When+scrambling%2C+only+letters+within+one+of+the+following+groups+may+exchange+places%3A%0A%0A+1.+%60acemnorsuvwxz%60%0A%0A+1.+%60bdfhkl%60%0A%0A+1.+%60gpqy%60%0A%0A+1.+%60it%60%0A%0A+1.+%60j%60+%28stays+in+place%29&amp;debug=0" rel="nofollow noreferrer">Try it online!</a></p>

<h2>Sample</h2>

<p>It is well knwon that a text can still be raed while the irnands of its wrods have been seraclbmd, as long as their first and last lettres plus their oaervll ontliues rmeain conntsat. Given a text, sacmrble each wrod acrncdiog to thsee relus:</p>

<ol>
<li><p>Scamrlbing must be (puesdo) rnadom.</p></li>
<li><p>A word is a suqencee of the Latin chraectars, A thuorgh Z.</p></li>
<li><p>Only iaitinl lettres will eevr be uppaersce.</p></li>
<li><p>The first and last lettres msut stay uotcnuhed.</p></li>
<li><p>When srancblimg, only lettres wiihtn one of the follnwiog guorps may enxhcage plecas:</p>

<ol>
<li><p><code>amsuvrcnoxewz</code></p></li>
<li><p><code>bhfkdl</code></p></li>
<li><p><code>gpqy</code></p></li>
<li><p><code>it</code></p></li>
<li><p><code>j</code> (stays in place)</p></li>
</ol></li>
</ol>
</div>
<div id="pu11" class="pu"><h2>Mathematica 232 Bytes</h2>

<pre><code>StringReplace[#,x:Repeated[WordCharacter,{2,∞}]:&gt;""&lt;&gt;(s=StringTake)[x,{i,i}~Table~{i,StringLength@x}/.Flatten[Thread[#-&gt;RandomSample@#]&amp;/@(StringPosition[x~s~{2,-2},#]+1&amp;/@Characters@{"acemnorsuvwxz","bdfhkl","gpqy","it","j"})]]]&amp;
</code></pre>

<p>The basic idea is to permute the subsets corresponding to the 4 distinct character groups.  Probably room for improvement.</p>
</div>
<div id="pu12" class="pu"><h1>Python 3.6, <s>349</s> 340 bytes</h1>
<pre><code>from itertools import *
from random import *
import re
def S(s):
    C=lambda c:len(list(takewhile(lambda x:c not in x,('j','it','gqpy','bhkfdl'))));L=[];B=[[]for i in range(5)]
    for l in s:c=C(l);L+=[c];B[c]+=[l];shuffle(B[c])
    return''.join(B[n].pop()for n in L)
A=lambda t:re.sub('[A-Za-z]{3,}',lambda x:x[0][0]+S(x[0][1:][:-1])+x[0][-1],t)
</code></pre>
<p>Indented with tabs.
The function is named <code>A</code>.
It doesn't use brute force, the runtime is deterministic, as OP asked.</p>
</div>
<div id="pu13" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="noreferrer">Jelly</a>, <s>80</s> 74 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="noreferrer">bytes</a></h1>

<p>-2 bytes by moving from <code>czar + vex + mow + sun</code> to <code>czar + vexes + unmown</code> (the repeated <code>e</code>s and <code>n</code>s are not a problem)<br>
-1 byte using <code>Tị</code> rather than <code>ȦÐf</code><br>
-1 byte using <code>Œle€Øa</code> rather than <code>i@€ØB&gt;⁵</code><br>
-2 bytes by reconfiguring the layout a little</p>

<pre><code>Tị
TẊị⁹ż@œp
e€ç⁸F
W;“HọƊṘ€.`]HɲøƁḤ0ẉlfrøj⁷»Ḳ¤ç/
Ḣ,ṪjÇḟ0
Œle€Øað¬œpÇ€ÑżœpÑ¥
</code></pre>

<p>A full program taking a character list (or Python formatted string), which prints the result of the scrambling.</p>

<p><strong><a href="https://tio.run/nexus/jelly#dVE/bxMxFN/vU7wRpHCUfwssMABFQmIgUiUkJF58Lzm3Pvtq@5KUibBUtGIoLB2QkFBRJdQBdeHSdMoplfgYl@/AHJ6TkEx4sZ/93u@fZ816dBg164sD3qeD4eTy4eRzHtH0/Vl1Oh2UT6KtB9N3Xzbr0cerg3p4zPfxm9ebv8@r8mpQlycb9cUH1bZVuT0d/BqP6vJ8fFKd3ozq8lujHv7Yrvbr8utGNPmk5pDHWP0cnzFDtR/Ko8llOB@Nv89ms2cepIMeKQU72vQ0@BQ9IHjqexCowXnJby0CS5hAL5WKuIdAao02cWDaID0jmFCk2CXuJR4TFrOWoqQB6EAZ3Qk7D0oLbWkdc@gEFPJBkfdkHeSq@NdhumSRaU3hldTkmDxDqUEY7TxqH8NT2WWWhc7Gig0IRTrXAigEb5J5vQmojh0Uitz9KAJet2J4uRgKLVnBOtjjtdxRkZjrYFmdyeJF7@0YHi1AOSoER7sFaUHBekjiOfogLUWLIhhpcLdPrSk6KbxaQtyJ4YVWe5ya9BLVynMvhEvsNrAXeU5WoKPl0N0Ymoz/n7jmmjmNPSi0N4VIKVnO3YthK13/ARtsgAnsa1afsmSjVx7aRinTC1F0WHjO6IxLfTalO8Q/g2KVXFhcZtpYV3R7/bfr61bSTnfUuu7ku3vrSvooetzHLFf0R5sbgr@K/gI" rel="noreferrer">Try it online!</a></strong></p>

<p>A huge amount of difficulty for Jelly here it seems (either that or I have missed a trick, which has been known to happen!) This will surely be beaten by languages with better string manipulation like <s><a href="https://github.com/m-ender/retina" rel="noreferrer">Retina</a></s>(no random functionality) or <a href="https://github.com/Adriandmen/05AB1E" rel="noreferrer">05ab1e</a>.</p>

<h3>How?</h3>

<pre><code>Tị - Link 1, get truthy items: list a
T  - truthy indexes of a
 ị - index into a

TẊị⁹ż@œp - Link 2, selective shuffle: list a, list b
T        - truthy indexes of a (those indexes that may be shuffled in b)
 Ẋ       - random shuffle
   ⁹     - link's right argument, b
  ị      - index into (gets the shuffled values)
      œp - partition b at truthy indexes of a
    ż@   - zip with reversed @rguments (place shuffled values - yields a list of lists)

e€ç⁸F - Link 3, value selective shuffle: list a, list b
e€    - c exists in b? for €ach c in a (1s where b has shuffle-able characters, else 0s)
   ⁸  - link's left argument, a
  ç   - call the last link (2) as a dyad
    F - flatten the result (from the yielded list of lists to one list)

W;“HọƊṘ€.`]HɲøƁḤ0ẉlfrøj⁷»Ḳ¤ç/ - Link 4, perform all shuffles on a word's innards: list x
W                             - wrap x in a list
                          ¤   - nilad followed by link(s) as a nilad:
  “HọƊṘ€.`]HɲøƁḤ0ẉlfrøj⁷»     -   compression of s(bdfhkl)+d( czar)+d(vexes)+d(unmown)+s( gpqy)+d( ti)
                              -     where d() looks up a word in Jelly's dictionary and s() adds a string to the compressed output.
                         Ḳ    -   split on spaces: ["bdfhkl","czarvexesunmown","gpqy","ti"]
                           ç/ - reduce by last link (3) as a dyad (shuffles by each in turn)

Ḣ,ṪjÇḟ0 - Link 5, shuffle a word: list w
Ḣ       - head w (yields the leftmost character and modifies w)
  Ṫ     - tail w (yields the rightmost character and modifies w)
 ,      - pair
        -   Note: head and tail yield 0 when w is empty, so ['a'] -&gt; ["a",0] and [] -&gt; [0,0]
    Ç   - call the last link (4) as a monad (with the modified w)
   j    - join
     ḟ0 - filter discard zeros (thus single or zero letter words pass through unchanged)

Œle€Øað¬œpÇ€ÑżœpÑ¥ - Main link: list s
Œl                 - convert s to lowercase, say t
    Øa             - lowercase alphabet, say a
  e€               - c exists in a? for €ach c in t
      ð            - dyadic chain separation (call that u)
       ¬           - not (vectorises across u), say v
        œp         - partition s at truthy indexes of v (extract words, plus empty lists from within strings of non-alphabetic characters)
          Ç€       - call the last link (5) as a monad for €ach (shuffle their innards)
            Ñ      - call the next link (1) as a monad (only keep the actual words)
                 ¥ - last two links as a dyad:
              œp   -   partition s at truthy indexes of u (get the non-words, plus empty lists from within strings of alphabetic characters)
                Ñ  -   call the next link (1) as a monad (only keep actual non-words)
             ż     - zip together
                   - implicit print
</code></pre>
</div>
<div id="pu14" class="pu"><h1>PHP, 278 Bytes</h1>

<pre class="lang-php prettyprint-override"><code>&lt;?=preg_replace_callback("#\pL\K(\pL+)(?=\pL)#",function($t){preg_match_all("#([^bdf-lpqty])|([bdfhkl])|([gpqy])|([it])|(j)#",$t[0],$p);foreach($p as$v){$k++?$c=array_keys($n=array_filter($v)):$o=[];!$n?:shuffle($n)&amp;&amp;$o+=array_combine($c,$n);}ksort($o);return join($o);},$argn);
</code></pre>

<p><a href="https://tio.run/nexus/php#LVBBbsIwELzzijSskK0Eqddi0jygvfUYaOQYJzYxtnEcEKI8u2e6pFx2Z3ZnVqtZl175GfDQ2SL9EoEfGiOTswu7ITkrjdgHOchw0rZLopI6JG6MRls5pGzWukAY6PUbliyj11n5fl@XBVq6OkhvuJC14MY0XPQknW/85@aDYM0oKQvsdJ7m7WhF1M4SiPQ6OQ88ClWjDS2k@m527dL4Y7xs6Q@pkKneTLDzx/@Zjo@2f1yDWL1uc/CU4W@SC0XAJ3yAE71Cn2UliIKHwC91Ly8DAftkrTZRBoIyugJXVFv2ArZcDWpsWyNRRxcLcNlTLdyhwQQIiBw37NYPLkQCjrIg4xhssnfaTvyWT9FSdpdCuXRjMbTbAyaIp1XK7r/WLQW@Kv8A" rel="nofollow noreferrer" title="PHP – TIO Nexus">Try it online!</a></p>

<p>Expanded
</p>

<pre><code>echo preg_replace_callback("#\pL\K(\pL+)(?=\pL)#" # patter \pL is shorter as [a-z]
,function($t){  # replacement function beginning
  preg_match_all("#([^bdf-lpqty])|([bdfhkl])|([gpqy])|([it])|(j)#",$t[0],$p); # makes groups with the regex. group 0 is the whole substring
  foreach($p as$v){ # loop through groups
    $k++?$c=array_keys($n=array_filter($v)):$o=[]; # group 0 make new empty replacement array in the other case filter the group remove empty values. 
    #You gain an array with the keys as position in the substring and the values
    #store the key array and the values array
    !$n?:shuffle($n)&amp;&amp;$o+=array_combine($c,$n); 
    #if values shuffle the values and make a new array with the keys and the shuffled values and merge the new array to the replacement array
  }
  ksort($o); # sort the replacement array ascending positions 
  return join($o); # return the replacement as string
},$argn);
</code></pre>

<p>functions</p>

<p><a href="http://php.net/manual/en/function.array-combine.php" rel="nofollow noreferrer">array_combine</a></p>

<p><a href="http://php.net/manual/en/function.array-filter.php" rel="nofollow noreferrer">array_filter</a></p>

<p><a href="http://php.net/manual/en/function.array-keys.php" rel="nofollow noreferrer">array_keys</a></p>

<p><a href="http://php.net/manual/en/function.ksort.php" rel="nofollow noreferrer">ksort</a></p>

<p><a href="http://php.net/manual/en/function.preg-replace-callback.php" rel="nofollow noreferrer">preg_replace_callback</a></p>

<p><a href="http://php.net/manual/en/function.shuffle.php" rel="nofollow noreferrer">shuffle</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/119891/">119891</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




