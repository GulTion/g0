<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::100578</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>084</td><td>Haskell</td><td>230823T000117Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/264530#264530">Dannyu N</a></td></tr>
<tr d-ix="1"><td>052</td><td>Nim</td><td>230822T231454Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/264526#264526">xigoi</a></td></tr>
<tr d-ix="2"><td>063</td><td>C# 6</td><td>161124T141430Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100985#100985">Stefan</a></td></tr>
<tr d-ix="3"><td>035</td><td>JavaScript Node.js</td><td>220813T120617Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/251051#251051">noodle m</a></td></tr>
<tr d-ix="4"><td>054</td><td>C gcc</td><td>221218T062240Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/255644#255644">l4m2</a></td></tr>
<tr d-ix="5"><td>060</td><td>Kotlin extension function</td><td>161121T124714Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100611#100611">F. Georg</a></td></tr>
<tr d-ix="6"><td>023</td><td>GolfScript</td><td>161124T211234Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/101018#101018">Codename</a></td></tr>
<tr d-ix="7"><td>015</td><td>Gema</td><td>161121T115308Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100607#100607">manatwor</a></td></tr>
<tr d-ix="8"><td>819</td><td>Perl</td><td>161121T003004Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100589#100589">user6213</a></td></tr>
<tr d-ix="9"><td>031</td><td>jq</td><td>161124T132446Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100978#100978">manatwor</a></td></tr>
<tr d-ix="10"><td>058</td><td>Mathematica</td><td>161122T011307Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100689#100689">spacemit</a></td></tr>
<tr d-ix="11"><td>013</td><td>awk</td><td>161121T170101Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100644#100644">Adam</a></td></tr>
<tr d-ix="12"><td>021</td><td>CJam</td><td>161121T205657Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100662#100662">Kade</a></td></tr>
<tr d-ix="13"><td>027</td><td>BASH + GNU sed</td><td>161121T143039Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100625#100625">Riley</a></td></tr>
<tr d-ix="14"><td>082</td><td>Python 2</td><td>161121T135349Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100620#100620">Rod</a></td></tr>
<tr d-ix="15"><td>039</td><td>Javascript</td><td>161120T235005Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100587#100587">SuperJed</a></td></tr>
<tr d-ix="16"><td>010</td><td>V</td><td>161121T021327Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100596#100596">DJMcMayh</a></td></tr>
<tr d-ix="17"><td>007</td><td>Pyke</td><td>161120T230558Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100585#100585">Blue</a></td></tr>
<tr d-ix="18"><td>075</td><td>Lua</td><td>161120T223210Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100582#100582">ATaco</a></td></tr>
<tr d-ix="19"><td>091</td><td>Batch</td><td>161120T223303Z</td><td><a href="https://codegolf.stackexchange.com/questions/100578/generate-line-number-comments/100583#100583">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Haskell, 84 bytes</h1>
<p>Assumes each indentation is done by a horizontal tab(<code>\t</code>).</p>
<pre><code>unlines.zipWith(\n l-&gt;let(x,y)=span('\t'==)l in x++&quot;{-&quot;++show n++&quot;-}&quot;++y)[0..].lines
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://nim-lang.org/" rel="nofollow noreferrer">Nim</a>, 52 bytes</h1>
<pre><code>var n=0
for l in stdin.lines:n+=1;echo &quot;#[&quot;,n,&quot;]#&quot;,l
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m704LzN3wYKlpSVpuhY3TcoSixTybA240vKLFHIUMvMUiktSMvP0cjLzUout8rRtDa1TkzPyFZSUo5V08nSUYpWVdHIgeqFGLLipmZNaolBhC9FYlJqY4piTw1WekZmTqlChaKtkoGTFpQA2pAKiAwA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Nim is indentation-sensitive, but it doesn't seem to have a problem with comments before indentation.</p>
</div>
<div id="pu2" class="pu"><h1>C# 6, <s>66</s> 63 bytes</h1>
<p>Thanks to CSharpie</p>
<p><s>(666, devils code ^^)</s> not any more ...</p>
<p>This works for all languages using &quot;C style comments&quot; (C, C++, C#, Java, ....)</p>
<p>It simply splits the string into lines, prepends every line with its index and joins the edited lines again with new line characters.</p>

<pre class="lang-cs prettyprint-override"><code>s=&gt;string.Join(&quot;\n&quot;,s.Split('\n').Select((l,i)=&gt;$&quot;/*{i}*/&quot;+l));
</code></pre>
<p>old version:</p>
<pre class="lang-cs prettyprint-override"><code>s=&gt;string.Join(&quot;\n&quot;,s.Split('\n').Select((l,i)=&gt;$&quot;/*{i,3}*/{l}&quot;));
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 35 bytes</h1>
<p>Revisited this question and found a shorter solution. It saves a few bytes to append <code>//</code> comments instead prepending <code>/**/</code> ones.</p>

<pre class="lang-javascript prettyprint-override"><code>a=&gt;a.replace(/$/gm,_=&gt;&quot;//&quot;+v++,v=1)
</code></pre>
<p><a href="https://tio.run/##TYzBCoMwEETvfsUSethFm9Bzib9St2liLepKkgpS@u2p3noZGN68efHKycVhyedZHr4EW9i2rKNfRnYezcn0U3OzrTJG1WtdN6u9UHEyJxm9HqXHgJ16Jw8px8Flda2GaZGY4QNBBL4QokygtLlz3OFhZtjAAhLY9tgg6fz0M/LR/5@Z6FptuEdHVH4" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h1>JavaScript, 47 bytes</h1>
<p>Old answer:</p>
<pre class="lang-javascript prettyprint-override"><code>a=&gt;a.split`
`.map((l,i)=&gt;&quot;/*&quot;+i+&quot;*/&quot;+l).join`
`
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, 54 bytes</h1>

<pre class="lang-c prettyprint-override"><code>a;main(i){for(;gets(&amp;a);)printf(&quot;/*%d*/%s\n&quot;,i++,&amp;a);}
</code></pre>
<p><a href="https://tio.run/##NY3LDoIwEEX3fsUEg2kLWvBtqn6Jm6bl0QSB8IgLwrfXKdbZzJ175s6obaGUtVK8pamJoVPedEQU2dCTjaSCtp2ph5wEnIWa8bB/1UFsoih2cLaWswQYX5taVaPO4N4P2jS78rniLEWAWVgOUzT2aEzYD9gBS5WyAyXQOf4deAC@doBQB04e6AaHsx/cjYvXrtrxl1BL5OrJjPrm9ac0VQZ@IU0Yn78" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
<p>Why not</p>
</div>
<div id="pu5" class="pu"><h1>Kotlin extension function, <strike>69</strike> 60 bytes</h1>
<p><strike><code>fun String.a()=lines().mapIndexed{i,s-&gt;&quot;/*$i*/$s&quot;}.joinToString(&quot;\n&quot;)</code></strike></p>
<p><code>fun String.a(){lines().mapIndexed{i,s-&gt;println(&quot;/*$i*/$s&quot;)}}</code></p>
<p>Example usage:</p>
<pre><code>fun main(args: Array&lt;String&gt;) {
  //language=kotlin
  val code = &quot;&quot;&quot;fun main(args: Array&lt;String&gt;) {
  println(&quot;Hello world!&quot;)
}&quot;&quot;&quot;
  code.a()
}
</code></pre>
<p>Output:</p>
<pre><code>/*0*/fun main(args: Array&lt;String&gt;) {
/*1*/  println(&quot;Hello world!&quot;)
/*2*/}
</code></pre>
</div>
<div id="pu6" class="pu"><h1>GolfScript, 23 Bytes</h1>

<pre><code>n/0:i;{"#"i):i+n+\+}%n*
</code></pre>

<p>There are only line comments starting with "#".</p>

<p>Ungolfed &amp; explained:</p>

<pre><code>           # the input is pushed on the stack automatically
n          # n is a predefined variable for "\n"
/          # splits the input string with the previously pushed "\n" as delimiter
0:i;       # i = 0
{          # A code block: It is used for map here (going through the input)
    "#"    # push a "#" onto the stack
    i):i  # save i + 1 in i, the value is again not popped from the stack
    +      # implicitly converts the number i to a string and concatenates "#" with it
    n      # newline
    +      # add a newline (# introduces a *line* comment)
    \      # switch the top to elements (-&gt; yields the comment as the bottom, and the line as the top element on the stack)
    +      # concatenate them
}          # end of the code block
%          # map
n          # newline
*          # join the list with newlines between them
           # outputs are done implicitly
</code></pre>

<p>I am pretty sure that this can be further simplified, especially the <code>i</code> can probably be left out.</p>

<p>You can test it here: <a href="https://golfscript.apphb.com/" rel="nofollow noreferrer">https://golfscript.apphb.com/</a>
Because this site doesn't support adding inputs, you'll have to put a string surrounded with double quotes in front of the code. <code>'\n'</code> will be a newline. Be aware of the fact, that there are other escape sequences as well. User <code>'\\'</code> if you are not sure.</p>
</div>
<div id="pu7" class="pu"><h1>Gema, <s>16</s> 15 characters</h1>

<pre><code>*\n=\!@line\n$0
</code></pre>

<p>In Gema there are only line comments, starting with <code>!</code>.</p>

<p>Sample run:</p>

<pre><code>bash-4.3$ cat l33t.gema 
e=3
g=9
i=1
o=0
t=7

bash-4.3$ gema -f l33t.gema &lt;&lt;&lt; 'Hello World!'
H3ll0 W0rld!

bash-4.3$ gema '*\n=\!@line\n$0' &lt; l33t.gema &gt; l33t-nr.gema

bash-4.3$ cat l33t-nr.gema
!1
e=3
!2
g=9
!3
i=1
!4
o=0
!5
t=7

bash-4.3$ gema -f l33t-nr.gema &lt;&lt;&lt; 'Hello World!'
H3ll0 W0rld!
</code></pre>

<p>The following are to answer <a href="https://codegolf.stackexchange.com/users/43319/ad%c3%a1m">Adám</a>'s question, whether is possible to add the line number in kind of ignored code. </p>

<p>Gema code is essentially a collection of <em>from</em>=<em>to</em> transformation rules, or <em>template</em>=<em>action</em> in Gema terms. I see no way to define a <em>template</em> that will never ever match anything, this alone not seems to be the way.</p>

<h2>Gema, 18 characters</h2>

<pre><code>*\n=c:\=@line\;:$0
</code></pre>

<p>Transforms <code>e=3</code> into <code>c:=1;:e=3</code>.</p>

<p>Luckily in Gema there are <em>domains</em>, kind of namespaces. The above code defines the dummy rules in namespace c, that we never use. Unfortunately a mentioned domain remains in effect until the end of line, so we have to explicitly to switch back to default domain.</p>

<h2>Gema, 18 characters</h2>

<pre><code>*\n=@line\=\$0\;$0
</code></pre>

<p>Transforms <code>e=3</code> into <code>1=$0;e=3</code>.</p>

<p>A less complicated alternative is to use effectless code instead of ignored one. I mean to put back exactly what was matched.</p>
</div>
<div id="pu8" class="pu"><h1>Perl, 8+1 = 9 bytes</h1>

<pre><code>say"#$."
</code></pre>

<p>Run with <code>-p</code> (1 byte penalty). (Note to people unfamiliar with PPCG rules; you also need to specify a modern version of Perl syntax using <code>-M5.010</code>, but we decided that options to select language versions are free and don't incur a byte penalty, so I didn't mention it in the original version of this post.)</p>

<p><code>-p</code> places the program into an implicit loop; it basically causes the program to become a filter that processes each line separately (i.e. the entire program is run on the first line, then the second, then the third, and so on). Perl also keeps track of a line number, called <code>$.</code>, that records how many lines of input have been read. So all the program's doing is letting <code>-p</code> read a line of input; output a <code>#</code>, the current line number (<code>$.</code>), and a newline (<code>say</code> adds a newline by default, which is helpful in this case, and is also shorter than the more commonly seen <code>print</code>); and then letting <code>-p</code> output the original line of code that it read (typically a program using <code>-p</code> would do some sort of processing on the input, but because we didn't, it's just output unchanged). Comments in Perl run from <code>#</code> to a newline (the <code>#</code> in the program itself doesn't start a comment because it's inside a string literal), so what we're basically doing is taking the opportunity to write comment lines into the file as we process it, without disturbing the "natural" read and write cycle of <code>-p</code>.</p>
</div>
<div id="pu9" class="pu"><h1>jq, 31 characters</h1>

<p>(27 characters code + 4 characters command line options.)</p>

<pre><code>"#\(input_line_number)\n"+.
</code></pre>

<p>In jq there are only line comments, starting with <code>#</code>.</p>

<p>Sample run:</p>

<pre><code>bash-4.3$ cat l33t.jq 
gsub("e";"3")|
gsub("g";"9")|
gsub("i";"1")|
gsub("o";"0")|
gsub("t";"7")

bash-4.3$ jq -Rr -f l33t.jq &lt;&lt;&lt; 'Hello World!'
H3ll0 W0rld!

bash-4.3$ jq -Rr '"#\(input_line_number)\n"+.' l33t.jq &gt; l33t-nr.jq

bash-4.3$ cat l33t-nr.jq 
#1
gsub("e";"3")|
#2
gsub("g";"9")|
#3
gsub("i";"1")|
#4
gsub("o";"0")|
#5
gsub("t";"7")

bash-4.3$ jq -Rr -f l33t-nr.jq &lt;&lt;&lt; 'Hello World!'
H3ll0 W0rld!
</code></pre>
</div>
<div id="pu10" class="pu"><h1>Mathematica, 58 bytes</h1>

<pre><code>i = 1; StringReplace[#, StartOfLine :&gt; "(*" &lt;&gt; ToString@i++ &lt;&gt; "*)"] &amp;
</code></pre>
</div>
<div id="pu11" class="pu"><h2>awk (<s>19</s> 13 bytes)</h2>
<p><strong>19 bytes</strong> : This insert &quot;#&quot;+line number above each line of code</p>
<pre><code>{print&quot;#&quot;NR&quot;\n&quot;$0}
</code></pre>
<p><strong>13 bytes</strong> : Credit &amp; thanks to @manatwork for two 13 bytes solution</p>
<p>As <code>1</code> action defaults to <code>print $0</code>:</p>
<pre><code>{print&quot;#&quot;NR}1
</code></pre>
<p>Or by replacing <code>$0</code> content</p>
<pre><code>$0=&quot;#&quot;NR RS$0
</code></pre>
</div>
<div id="pu12" class="pu"><h1>CJam, 21 Bytes</h1>

<p>I am not well-versed in CJam at all, but I knew for a fact it has comments :)</p>

<pre><code>qN%ee{"e#"o(oNo(oNo}/
</code></pre>

<p>Explanation coming soon.</p>
</div>
<div id="pu13" class="pu"><h1>BASH (+ GNU sed) 27 bytes</h1>

<pre><code>sed 'i#
='|sed 'N;s/\n//;N'
</code></pre>

<p>The first part (<code>i#</code> <code>\n</code> <code>=</code>) almost works in GNU sed (for 4 bytes), but it puts a newline after the <code>#</code>.</p>
</div>
<div id="pu14" class="pu"><h2>Python 2, 82 bytes</h2>

<p>
Works for space-only indentation</p>

<pre class="lang-python prettyprint-override"><code>for i,l in enumerate(input().split('\n')):print l.split(l.lstrip())[0]+'#%d\n'%i+l
</code></pre>

<p>Indentation-less version for 56 bytes</p>

<pre class="lang-python prettyprint-override"><code>for x in enumerate(input().split('\n')):print'#%d\n%s'%x
</code></pre>
</div>
<div id="pu15" class="pu"><h1>Javascript, <s>43</s> 39 bytes</h1>

<pre><code>a=&gt;a.replace(/^/gm,_=&gt;`/*${++b}*/`,b=0)
</code></pre>

<p>Thanks to ETH and Conor for saving 4 bytes.</p>
</div>
<div id="pu16" class="pu"><h1><a href="http://github.com/DJMcMayhem/V" rel="nofollow noreferrer">V</a>, 10 bytes</h1>

<pre><code>O:1òYjjP
</code></pre>

<p><a href="http://v.tryitonline.net/#code=TzoxG8OyWWpqUAE&amp;input=dGVzdAp0ZXN0" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu17" class="pu"><h2>Pyke, 7 bytes</h2>
<pre><code>o\Kz++r
</code></pre>
<p><a href="http://pyke.catbus.co.uk/?code=o%5CKz%2B%2Br&amp;input=Test%0ATest" rel="noreferrer">Try it here!</a></p>
<pre><code>o       -  o++
 \K     -  &quot;K&quot;
   z    -  input()
    ++  - sum(^)
      r - while no errors: GOTO start
</code></pre>
<p>I'm declaring integer comments to be the integer followed by the character <code>K</code> and then the line. An extra byte is used to stop the newline opcode from kicking in and printing an extra thing.</p>
</div>
<div id="pu18" class="pu"><h1>Lua, <s>80</s> 75 Bytes</h1>

<p><i>Saved some bytes by abusing the langauge.</i></p>



<pre><code>x=1print("--[[1]]"..(...):gsub("\n",load('x=x+1return"\\n--[["..x.."]]"')))
</code></pre>

<p>Simple enough starter answer.</p>

<h2>Ungolfed, +</h2>

<pre><code>x=1                                                     -- Assign x to 1...
print(                                                  -- Print...
      "--[[1]]"                                         -- The first line number comment...
      ..                                                -- With...
      (...):gsub(                                       -- The input, replacing all...
                 "\n",                                  -- Newlines...
                    load                                -- with a string compiled function...
                    (' \
                    x=x+1                               --Increment x by one... \
                    return"\\n--[["..x.."]]"            -- And return the new linecomment. \
                    ')
                 )
      )
</code></pre>
</div>
<div id="pu19" class="pu"><h2>Batch, 91 bytes</h2>

<pre><code>@set n=
@for /f "delims= tokens=*" %%a in (%1) do @set/an+=1&amp;call echo @rem %%n%%&amp;echo %%a
</code></pre>

<p>Batch doesn't have a way of reading STDIN until EOF, so instead the file name has to be passed as a command-line parameter.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/100578/">100578</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




