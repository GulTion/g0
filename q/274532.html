<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::274532</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>036</td><td>APL</td><td>240801T081931Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274611#274611">Sohang C</a></td></tr>
<tr d-ix="1"><td>035</td><td>Ruby</td><td>240729T094539Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274550#274550">G B</a></td></tr>
<tr d-ix="2"><td>043</td><td>PARI/GP</td><td>240801T020553Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274607#274607">alephalp</a></td></tr>
<tr d-ix="3"><td>011</td><td>M</td><td>240729T183151Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274562#274562">caird co</a></td></tr>
<tr d-ix="4"><td>021</td><td>APLDyalog Unicode</td><td>240729T043716Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274543#274543">akamayu</a></td></tr>
<tr d-ix="5"><td>027</td><td>Charcoal</td><td>240729T063814Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274546#274546">Neil</a></td></tr>
<tr d-ix="6"><td>057</td><td>Python</td><td>240729T004501Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274535#274535">shape wa</a></td></tr>
<tr d-ix="7"><td>043</td><td>Raku Perl 6 rakudo</td><td>240729T001816Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274533#274533">bb94</a></td></tr>
<tr d-ix="8"><td>6375</td><td>Vyxal s</td><td>240729T003234Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274534#274534">lyxal</a></td></tr>
<tr d-ix="9"><td>043</td><td>JavaScript Node.js</td><td>240729T010514Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274539#274539">l4m2</a></td></tr>
<tr d-ix="10"><td>014</td><td>J</td><td>240729T005525Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274538#274538">Bubbler</a></td></tr>
<tr d-ix="11"><td>024</td><td>K ngn/k</td><td>240729T004954Z</td><td><a href="https://codegolf.stackexchange.com/questions/274532/rabinowitz-wagon-pi-formula/274537#274537">att</a></td></tr>
</table>
<div id="pu0" class="pu"><h2>APL, 36 bytes</h2>
<p>This is a function that takes <code>n</code> as input and outputs a pair of integers representing the numerator and denominator of the answer:</p>
<p><code>{{⍺×⍵+⍵[2]0}/(⊂2 1),(⊢,1+2∘×)¨⍳⍵}</code></p>
<p>I'll try to shorten it by using more tacit style to remove named arguments - any suggestions are welcome 🙂.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, <s>38</s> 35 bytes</h1>

<pre class="lang-ruby prettyprint-override"><code>-&gt;n{(z=2)+(1..n).sum{|x|z/=2+1r/x}}
</code></pre>
<p><a href="https://tio.run/##KypNqvyfZvtf1y6vWqPK1khTW8NQTy9PU6@4NLe6pqKmSt/WSNuwSL@itvZ/gYKpXklmbmqxXm5igYZamuZ/AA" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://pari.math.u-bordeaux.fr" rel="nofollow noreferrer">PARI/GP</a>, 43 bytes</h1>
<pre><code>n-&gt;prod(i=0,n,[i+2*!i,!!i*k=2*i+1;0,k])[,2]
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m728ILEoMz69YMGSNAVbhaWlJWm6Fje183TtCoryUzQybQ108nSiM7WNtBQzdRQVM7WybY20MrUNrQ10smM1o3WMYqFaVNLyizTygEYY6igYGegoFBRl5pUABZQUdO2ARJpGnqamJkTtggUQGgA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p><span class="math-container">\$1\$</span>-indexed.</p>
<p>Using the fact that composition of linear fractional transformations (<span class="math-container">\$x\mapsto\frac{ax+b}{cx+d}\$</span>) corresponds to matrix multiplication. The <span class="math-container">\$n\$</span>-th output is <span class="math-container">\$\begin{bmatrix}2&amp;0\\0&amp;1\end{bmatrix}\begin{bmatrix}1&amp;3\\0&amp;3\end{bmatrix}\cdots\begin{bmatrix}n&amp;2n+1\\0&amp;2n+1\end{bmatrix}\begin{bmatrix}0\\1\end{bmatrix}\$</span>.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/DennisMitchell/m" rel="nofollow noreferrer">M</a>, 11 bytes</h1>
<pre><code>RḤ‘İ×R×\S‘Ḥ
</code></pre>
<p><a href="https://tio.run/##y/3/P@jhjiWPGmYc2XB4etDh6THBQDZQ5H@QgfXh9kdNa/7/NwUA" rel="nofollow noreferrer" title="M – Try It Online">Try it online!</a></p>
<p>Interestingly enough, the Jelly equivalent (which doesn't have rational number support) is <a href="https://tio.run/##y0rNyan8///hjiWPGmYc2XB4uubh6THBQDZQ5H/Q4fZHTWuOTnq4cwaQznrUMJfr/39TAA" rel="nofollow noreferrer">only 1 byte longer</a>. The TIO link demonstrates the results for each input <span class="math-container">\$0\$</span> to <span class="math-container">\$n\$</span>.</p>
<h2>How it works</h2>
<pre><code>RḤ‘İ×R×\S‘Ḥ - Main link. Takes an integer n on the left
R           - Generate the range [1, 2, ..., n]
 Ḥ          - Unhalve; [2, 4, ..., 2n]
  ‘         - Increment; [3, 5, ..., 2n+1]
   İ        - Inverse; [1/3, 1/5, ..., 1/2n+1]
     R      - Range; [1, 2, ..., n]
    ×       - Multiply; [1/3, 2/5, ..., n/2n+1]
       \    - Scan by:
      ×     -   Product; [1/3, 1/3×2/5, ...]
        S   - Sum; 1/3 + 1/3×2/5 + ...
         ‘  - Increment; 1 + 1/3 + 1/3×2/5 + ...
          Ḥ - Unhalve; 2 + 2×1/3 + 2×1/3×2/5 + ...
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://dyalog.com" rel="nofollow noreferrer">APL(Dyalog Unicode)</a>, <sup><s></s></sup> <strike>31</strike> <strike>27</strike><strike>24</strike> 21 bytes <sup><a href="https://github.com/abrudz/SBCS" rel="nofollow noreferrer">SBCS</a></sup></h1>
<p>It outputs the <span class="math-container">\$n\$</span>th term with the denominator comes before the numerator. Assumes <code>⎕io←0</code>. 24 -&gt; 21 bytes thanks to @att.</p>
<pre><code>∊2(×∘(+⍀)⌿⊣@0,⍨¨1+×)⍳
</code></pre>
<p><a href="https://razetime.github.io/APLgolf/?h=e9Q3NTP/UdsEAwA&amp;c=ASYA2f/iiIoyKMOX4oiYKCvijYAp4oy/4oqjQDAs4o2owqgxK8OXKeKNsw&amp;f=S3/UNqH6Ue/Ww9sfdax41LMfyKxVeNQ7V6E4M7cgJzOtUiGtKDG5JDM/j@tR39SCAqByYwOuR20TNR51NannqSuop6Tm5edm5iWW5BcBeXmlualFUHZqcUlmbmJJaopCQaa6ps6j3qmHVhxakalzaIUG0DqgXR0zHvXsPbQiCyQHlMkCGp4OFEwDKgIyDbUf9W42NAYA&amp;i=AwA&amp;r=tryapl&amp;l=apl-dyalog&amp;m=dfn&amp;n=f" rel="nofollow noreferrer">Try it on APLgolf!</a></p>
<p><a href="https://razetime.github.io/APLgolf/?h=e9Q3NSDgUdsEYyOuR31TM/OBTAMA&amp;c=e9TRpXF4@qOOGRraj3obNB/1Ln3U0fWoZ7@Rg4HOo94Vh1YYagMlVmgCVTzq3QwA&amp;f=S3/UNqH6Ue/Ww9sfdax41LMfyKxVeNQ7V6E4M7cgJzOtUiGtKDG5JDM/j@tR20SNR11N6nnqCuopqXn5uZl5iSX5RUBeXmluahGUnVpckpmbWJKaolCQqa6p86h36qEVh1Zk6hxaoQG0A2hBx4xHPXsPrcgCyQFlsoAOSAcKpgEVAZmG2o96NxsaAwA&amp;i=AwA&amp;r=tryapl&amp;l=apl-dyalog&amp;m=dfn&amp;n=f" rel="nofollow noreferrer">Try it on APLgolf! (24bytes)</a></p>
<p><a href="https://razetime.github.io/APLgolf/?h=e9Q3taDgUdsEYwMA&amp;c=e9TRpXF4@qOOGRraj3obNB/1Ln3U0fWoZ7/Go66mR72bjTR1gCQQrzi0wlDbCKiyd7MmAA&amp;f=S3/UNqH6Ue/Ww9sfdax41LMfyKxVeNQ7V6E4M7cgJzOtUiGtKDG5JDM/j@tR20SNR11N6nnqCuopqXn5uZl5iSX5RUBeXmluahGYramTqXNoxaPeqUCiY0Y6EKcdWpEJtMNA51HvZiMTAA&amp;i=AwA&amp;r=tryapl&amp;l=apl-dyalog&amp;m=dfn&amp;n=f" rel="nofollow noreferrer">Try it on APLgolf! (27bytes)</a></p>
<p><a href="https://razetime.github.io/APLgolf/?h=AwA&amp;c=qzZUMDo8/VFHV/Wj3l2Hp2s/6m141Lu19lHvUqDYo579hjqZOo96VxxaYagNVJf5qG3Co97NIBUA&amp;f=S3/UNqH6Ue/Ww9sfdax41LMfyKxVeNQ7V6E4M7cgJzOtUiGtKDG5JDM/j@tR20SNR11N6nnqCuopqXn5uZl5iSX5RUBeXmluahGYramTqXNoRfqjjhlph1ZkAs020HnUu9nQFAA&amp;i=AwA&amp;r=tryapl&amp;l=apl-dyalog&amp;m=dfn&amp;n=f" rel="nofollow noreferrer">Try it on APLgolf! (31bytes)</a></p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 27 bytes</h1>
<pre><code>ＮθＩＥ²ΣＥ∨ι⊕θΠ⊕⊞ＯＥθ⎇‹νλν⊗⊕ν¬ι
</code></pre>
<p><a href="https://tio.run/##TYyxDoMwEEP3fkXGi5QurIztgtQCEv2BEE4CKVzgcqnUr09TuuDFluxnN1t2wfqcG9qStGkdkWHX9aXnhQRuNgo87QaVUUNaj9gxLEY15BhXJMGp7LVRPYcpOYFz0ac4dxuylcAHuxv1QibLH3hgjEBG@cIWu4c0@oKccdL699wGgUX/Vedc5evbfwE" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation: Directly computes the numerator and denominator, inspired by @Bubbler's last approach.</p>
<pre><code>Ｎθ                          Input as a number
    ²                       Literal integer `2`
   Ｅ                        Map over implicit range
        ι                   Current value
       ∨                    Logical Or
          θ                 Input number
         ⊕                  Incremented
      Ｅ                     Map over implicit range
                θ           Input number
               Ｅ            Map over implicit range
                   ν        Innermost value
                  ‹         Is less than
                    λ       Inner value
                 ⎇          If true then
                     ν      Innermost value
                        ν   Else innermost value
                       ⊕    Incremented
                      ⊗     Doubled
             ⊞Ｏ             Append
                          ι Current (outer) value
                         ¬  Incremented
            ⊕               Vectorised increment
           Π                Take the product
     Σ                      Take the sum
  Ｉ                         Cast to string
                            Implicitly print
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.python.org" rel="noreferrer">Python</a>, <s>71</s> <s>70</s> <s>60</s> 57 bytes</h1>
<pre class="lang-python prettyprint-override"><code>f=lambda n,q=1,p=1:n and f(n-1,q:=q*2*n+q,p*n+q)or(2*p,q)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=NU4xDgIhEOzvFVsCcolQKQmtr7BBT5REFlix8C021-if_I0SuS0mmZnMzD7f-VEvCef5da9-3Hy23l5dPEwOUBarZLbKIDicwDMclSzGFqEFrorMDXkipkWWhfeCvacUwZM71pDwBiHmRBV2XRh8IkAICOTwfGJ6zc0Av8sSCti2wv-cAla2xFized9Ynv0C" rel="noreferrer">Attempt This Online!</a></p>
<p>Outputs the (0-indexed) nth term of the sequence as a (numerator, denominator) tuple.</p>
<p>Ungolfed algorithm:</p>
<pre class="lang-python prettyprint-override"><code>def f(n):
    numerator, denominator = 1, 1
    # i/(2i + 1) = n/(2n + 1), ..., 3/7, 2/5, 1/3
    for i in range(n, 0, -1):
        # multiply by i/(2i + 1)
        numerator *= i
        denominator *= 2 * i + 1
        # add 1 (p/q -&gt; (p + q)/q = p/q + q/q = p/q + 1)
        numerator += denominator
    return 2 * numerator, denominator
</code></pre>
<p>For n=3:</p>
<pre><code>  * 3/7     + 1      * 2/5       + 1       * 1/3        + 1         * 2
1 ----&gt; 3/7 --&gt; 10/7 ----&gt; 20/35 --&gt; 55/35 ----&gt; 55/105 --&gt; 160/105 --&gt; 320/105
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://raku.org" rel="nofollow noreferrer">Raku (Perl 6) (rakudo)</a>, <s>49</s> 43 bytes</h1>
<pre class="lang-perl prettyprint-override"><code>{2+2*[+] [\*] map {.FatRat/(2*$_+1)},1..$_}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=lZHBToQwEIbjlacY1smGtktdMCYmFQ4efACvCE0PcDGshmUNhO2TeOGgD6VP49Blo8lGE0_9M5nvm2bm9a0xj7vx8-y27mFZJd45DHWPJonknWnvTaumLNDwALWI2EUQcwqXrHpqoClfymZbQoFaUdnYv-hiE6J2fIAukm2SFLj5htFPnCs4ClYD4ZqjH4ZutE-jrZSSswx17phYxDwTOWQPPAcCJbnTVC6HWTF_OWL20P6jef17834f2VN9bZ7h1LtyQ-37rq3C6w_xf-RGeW4VV2sYPAA6BXaQQEU7Z4oKW9PDAjUkKa2ok9PJLATYsYXyZsc4Ht4v" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-2" rel="nofollow noreferrer">Vyxal</a> <code>s</code>, 51 <a href="https://github.com/Vyxal/Vyncode/blob/main/README.md" rel="nofollow noreferrer">bits<sup>v2</a></sup>, 6.375 bytes</h1>
<pre><code>ƛƛd›/;Πd
</code></pre>
<p><a href="https://vyxal.pythonanywhere.com/?v=2&amp;c=1#WyJzPSIsIiIsIsabxptk4oC6LzvOoGQiLCIiLCI3Il0=" rel="nofollow noreferrer">Try it Online!</a></p>
<p>Bitstring:</p>
<pre><code>000001100001010101101101100001101101001010101111101
</code></pre>
<p>Ports the expanded formula from Bubbler's J answer.</p>
<h2>Explained</h2>
<pre><code>ƛƛd›/;Πd­⁡​‎‎⁪⁡⁪⁠⁪⁡⁪‏‏​⁡⁠⁡‌⁢​‎‎⁪⁡⁪⁠⁪⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁢⁪‏‏​⁡⁠⁡‌⁣​‎⁪⁪⁠‎⁪⁡⁪⁠⁪⁢⁡⁪‏‏​⁡⁠⁡‌⁤​‎‎⁪⁡⁪⁠⁪⁣⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁪‏‏​⁡⁠⁡‌⁢⁡​‎‎⁪⁡⁪⁠⁪⁢⁣⁪‏‏​⁡⁠⁡‌⁢⁢​‎‎⁪⁡⁪⁠⁪⁢⁤⁪‏‏​⁡⁠⁡‌⁢⁣​‎‏​⁢⁠⁡‌­
ƛ         # ‎⁡Over each n in the range [1, in]:
 ƛ   ;    # ‎⁢  Over each m in the range [1, n]:
    /     # ‎⁣    m divided by
  d›      # ‎⁤    2m + 1
      Π   # ‎⁢⁡  Product of each fraction
       d  # ‎⁢⁢  Doubled
# ‎⁢⁣Summed by the s flag
💎
</code></pre>
<p>Created with the help of <a href="https://vyxal.github.io/Luminespire" rel="nofollow noreferrer">Luminespire</a>.</p>
</div>
<div id="pu9" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 43 bytes</h1>
<pre class="lang-javascript prettyprint-override"><code>f=(n,p=q=1)=&gt;n?f(n-1,p*n+(q*=n-~n)):[p*2,q]
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70kLz8ldcGCpaUlaboWN7XTbDXydApsC20NNW3t8uzTNPJ0DXUKtPK0NQq1bPN06_I0Na2iC7SMdApjoVqU0vKLNDJtDawzbYwMrLW1MzWT8_OK83NS9XLy0zXSNDI1NSEqYZYAAA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Port of shape warrior t's answer</p>
</div>
<div id="pu10" class="pu"><h1><a href="https://www.jsoftware.com" rel="noreferrer">J</a>, 14 bytes</h1>
<pre><code>2#.~1%2+1%]-i.
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70wa8FuJT0FdYU0BVsrIKWjYKBgBcS6egrOQT5uS0tL0nQt1hkp69UZqhppG6rG6mbqQQS3aXKlJmfkq9kppAGxobZCpp6CkUEFRHLBAggNAA" rel="noreferrer">Attempt This Online!</a></p>
<p>If we expand the formula entirely, we get <code>2 + 2*1/3 + 2*1/3*2/5 + 2*1/3*2/5*3/7 + ...</code>, which can be interpreted as a mixed base conversion of <code>[..., 2, 2, 2, 2]</code> in base <code>[..., 3/7, 2/5, 1/3]</code>.</p>
<hr />
<h1><a href="https://www.jsoftware.com" rel="noreferrer">J</a>, 19 bytes</h1>
<pre><code>2(*&gt;:)/@,1%2+1%1+i.
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70wa8FuJT0FdYU0BVsrIKWjYKBgBcS6egrOQT5uS0tL0nQtNhtpaNlZaeo76BiqGmkbqhpqZ-pBZDZqcqUmZ-Q7pKnZKWTqKRgZVEDEFyyA0AA" rel="noreferrer">Attempt This Online!</a></p>
<p>A straightforward implementation of the formula. Takes an arbitrary-precision integer, constructs the array that looks like <code>2 1/3 2/5 3/7</code>, and reduces from the right by <code>x * (1 + y)</code>.</p>
<h1><a href="https://www.jsoftware.com" rel="noreferrer">J</a>, 20 bytes</h1>
<pre><code>(&gt;:@+:#.0&amp;=,:2*!)@i.
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70wa8FuJT0FdYU0BVsrIKWjYKBgBcS6egrOQT5uS0tL0nQttmjYWTloWynrGajZ6lgZaSlqOmTqQaT2aHKlJmfkq9kpqNbpKxkqpAFZhtoKmXoKRgYVECULFkBoAA" rel="noreferrer">Attempt This Online!</a></p>
<p>Tried to be clever with some mixed-base magic:</p>
<pre><code>(1 + 1/3(1 + 2/5)) * 3*5 = 3*5 + 1*5 + 1*2
(1 + 1/3(1 + 2/5(1 + 3/7))) * 3*5*7 = 3*5*7 + 1*5*7 + 1*2*7 + 1*2*3
</code></pre>
<p>So the numerator can be computed by evaluating <code>[0!, 1!, 2!, 3!, ...]</code> in mixed base <code>[1, 3, 5, 7, ...]</code>. Then the denominator can also be represented using <code>[1, 0, 0, 0, ...]</code>. Might be useful in languages without rational number support.</p>
</div>
<div id="pu11" class="pu"><h1><a href="https://codeberg.org/ngn/k" rel="nofollow noreferrer">K (ngn/k)</a>, 24 bytes</h1>
<pre><code>2 1*1(|+\|*)/+-\(1-)\!-:
</code></pre>
<p><a href="https://ngn.codeberg.page/k#eJxLszJSMNQy1KjRjqnR0tTX1o3RMNTVjFHUteLiSlMwAGJDIDYCYmMgNgFiUyA2A2JzAHt0DBU=" rel="nofollow noreferrer">Try it online!</a></p>
<p>Input <code>n</code>. Return the <span class="math-container">\$n\$</span>th term as an integer pair.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/274532/">274532</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




