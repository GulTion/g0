<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::64308</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>112</td><td>JavaScript Node.js</td><td>240430T011154Z</td><td><a href="https://codegolf.stackexchange.com/questions/64308/a-game-of-locks-and-keys/272891#272891">l4m2</a></td></tr>
<tr d-ix="1"><td>286</td><td>Python3</td><td>240430T003831Z</td><td><a href="https://codegolf.stackexchange.com/questions/64308/a-game-of-locks-and-keys/272890#272890">Ajax1234</a></td></tr>
<tr d-ix="2"><td>042</td><td>CJam</td><td>151120T034433Z</td><td><a href="https://codegolf.stackexchange.com/questions/64308/a-game-of-locks-and-keys/64368#64368">Dennis</a></td></tr>
<tr d-ix="3"><td>053</td><td>CJam</td><td>151120T232447Z</td><td><a href="https://codegolf.stackexchange.com/questions/64308/a-game-of-locks-and-keys/64425#64425">Peter Ta</a></td></tr>
<tr d-ix="4"><td>173</td><td>Haskell</td><td>151120T225447Z</td><td><a href="https://codegolf.stackexchange.com/questions/64308/a-game-of-locks-and-keys/64423#64423">Leif Wil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 112 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(x,...z)=&gt;/,0/.test([,x])?Math.min(...x.map((t,i)=&gt;t?!z.includes(i+1)+f(x.map(u=&gt;u!=t?u:''),...z,...t):1/0)):0
</code></pre>
<p><a href="https://tio.run/##tY1BTsMwEEX3PkW6qkd1JzaELCI5OQFcoFRKSJ1i5DhRbSOrlw8mhR07YDF/8efrvbfuvXP9Rc9@b6eTWpZB0sgQ8QqyzhnP0Svn6YHFIzSPnX/FUVua/hHHbqbUM52GvtlcUdvehJNyVO8E7AZ6WwRZh430Tai2W1jBn@GhEjkHqPjST9ZNRqGZznSgLbnLOLknRcqHrExZEk5adEb3igq2F4BuNtq3z7ZdBVHWsYlfZXbrnsL4oi5QHY4AQH40pFslZdL8vaD4Voh/UoiELwhJqkT/HXv5AA" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>Open till no treasure (number with a leading 0). With key opening is free, while without key it costs</p>
</div>
<div id="pu1" class="pu"><h1>Python3, 286 bytes</h1>
<pre class="lang-py prettyprint-override"><code>def f(b):
 q,m=[(b,[],0)],-1
 for b,k,c in q:
  if m!=-1 and c&gt;=m:continue
  if all(0 not in j for j in b):m=[c,min(m,c)][m!=-1];continue
  for K in k:
   if K and b[K-1]:q+=[(b[:K-1]+[[]]+b[K:],k+b[K-1],c)]
  for i,a in enumerate(b):
   if a:q+=[(b[:i]+[[]]+b[i+1:],k+a,c+1)]
 return m
</code></pre>
<p><a href="https://tio.run/##ZZFBboMwEEX3PsUkG@ziVBhIVFHRC0TqBVyrAmJUJ9gQcBY9fWoblKaNBBb8/@bPDAzf9qs32cswXq8H2UKLa1IgOFNdclxTLmhCBN0wBG0/Qk1PtAFl4OwYUC3oVblhUJkDNG@lLpreWGUucjarrsMJmN76imMIOPpH18GlN1QrgzVtiOAhRrzelXt47@GT7@TT9qFNzfeOLM6xH48X/iXmXIjYGYWgp3gGfOqSomjlc6S5aDlWVs4LzgPectQtRcUs5FS0iZkPGaW9jAZ0@Dy2/6yxJcUicv6kqwErYymo52nolMWECBetVmW0YRHIbpJczIP4MVrVWTni995ICnYpiT5M5MoQmlgJ6/UapZCgDOXu3MLOnTuUIK9PKdwB7nY/Jg/@FhYiuxH5L8P@MvnCMOfn3ndXCg4I9jC6fXCLw64TI4T8k9JHKXuUciddfwA" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu2" class="pu"><h1>CJam, <s>59</s> <s>52</s> <s>50</s> <s>49</s> <s>45</s> <s>43</s> 42 bytes</h1>

<pre><code>qN/ee::~e!{_0+{0a&amp;}#&gt;W%_{1$|(z@-},,\;}%:e&lt;
</code></pre>

<p><em>Thanks to @MartinBüttner for golfing off 3 bytes and paving the way for 4 more!</em></p>

<p>Try it online in the <a href="http://cjam.aditsu.net/#code=qN%2Fee%3A%3A~e!%7B_0%2B%7B0a%26%7D%23%3EW%25_%7B1%24%7C(z%40-%7D%2C%2C%5C%3B%7D%25%3Ae%3C&amp;input=2%200%0A3%0A4%200%0A5%206%200%0A6%0A0" rel="nofollow">CJam interpreter</a>.</p>

<h3>How it works</h3>

<pre><code>qN/      e# Read all input and split it at linefeeds.
ee       e# Enumerate the lines.
         e# STACK: [[0 "i0 i1 ..."] [1 "j0 j1 ..."] ...]
::~      e# Apply ~ (bitwise NOT/evaluate) to each item of the pairs.
         e# STACK: [[-1 i0 i1 ...] [-2 j0 j1 ...] ...]
e!       e# Push all unique permutations of the resulting array.
{        e# For each permutation:
  _0+    e#   Push a copy and append 0 to it.
  {0a&amp;}# e#   Find the first index of an element that contains 0.
  &gt;      e#   Discard all previous elements of the array.
  W%     e#   Reverse the resulting array.
         e#   We now have a (partial) permutation that contains
         e#   all treasures and ends with a treasure.
  _      e#   Push a copy. The original (which contains lists, but no 
              numbers) will serve as accumulator.
  {      e#   Filter; for each list in the array:
    1$|  e#     Push a copy of the accumulator and perform set union.
    (    e#     Shift out the first element (bitwise NOT of 0-based index).
    z    e#     Apply absolute value to push the 1-based index.
    @-   e#     Perform set difference with the former state of the 
         e#     accumulator. This pushes an empty list iff the 1-based
         e#     index was already in the accumulator, i.e., iff we already
         e#     had a key.
  },     e#   Keep the element if we did not have the key.
  ,      e#   Count the kept elements.
  \;     e#   Discard the accumulator from the stack.
}%       e#
:e&lt;      e# Get the minimum of all results.
</code></pre>
</div>
<div id="pu3" class="pu"><h2>CJam (53 bytes)</h2>

<pre><code>Nq+N/:a::~:A,_m*_.&amp;{,}$_{{_Af=e_|}:PA,*A,,^0-P0&amp;!}#=,
</code></pre>

<p>This is rather too slow for the online interpreter.</p>

<h3>Dissection</h3>

<pre><code>Nq+N/:a::~:A      e# Parse the input into arrays and store in A
,_m*_.&amp;           e# Generate (with duplicates) a powerset of [0 1 ... n]
{,}$              e# Sort by size
_{                e# Create a copy and search for first index satisfying...
  {_Af=e_|}:P     e#   Store in P a block which does a reachability expansion
  A,*             e#   Apply it n times (no path can be longer than n)
  A,,^0-          e#   Invert to get the unreached nodes (except 0)
  P               e#   Apply P again to see what's reached from the unreached nodes
  0&amp;!             e#   Check that it doesn't include [0]
}#
=,                e# Look up the powerset element at that index and find length
</code></pre>
</div>
<div id="pu4" class="pu"><h1>Haskell, 173 bytes</h1>
<p><code>l</code> is the one you wanna call.</p>
<p>Not sure whether I shouldn't use a pseudo-<code>Map</code> instead (<code>[(Int,[Int])]</code> instead of <code>[[Int]]</code>).</p>
<pre class="lang-hs prettyprint-override"><code>l=o[].map(map read).map words.lines
o[]b|0`notElem`concat b=0|0&lt;1=1+minimum[o[n]b|n&lt;-[1..length b],b!!(n-1)/=[]]
o(n:k)b=o(filter(/=0)(k++b!!(n-1)))(take(n-1)b++[]:drop n b)
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/64308/">64308</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




