<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::274951</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>694</td><td>sed 4.2.2 r</td><td>240815T125547Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/274997#274997">guest430</a></td></tr>
<tr d-ix="1"><td>615</td><td>Python</td><td>240819T183943Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/275054#275054">Kolen Ch</a></td></tr>
<tr d-ix="2"><td>049</td><td>05AB1E</td><td>240814T083430Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/274969#274969">Kevin Cr</a></td></tr>
<tr d-ix="3"><td>101</td><td>Charcoal</td><td>240816T084104Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/275008#275008">Neil</a></td></tr>
<tr d-ix="4"><td>048</td><td>Pyth</td><td>240814T221156Z</td><td><a href="https://codegolf.stackexchange.com/questions/274951/sum-of-four-squares-grid/274988#274988">CursorCo</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.gnu.org/software/sed/" rel="nofollow noreferrer">sed 4.2.2</a> <code>-r</code>, <sub><s>1303</s> <s>1252</s> <s>1201</s> <s>1053</s> <s>838</s> <s>764</s> <s>710</s></sub> 694 bytes</h1>
<pre><code>/^(0|1)$/bz
:a;s/[1-9]/&amp;#/g;y/123456789/012345678/;s/#0/9#/;ta
s/0+/0001\n/;h;s/\n.*//;x
:b;y/10/ab/;G;s/\n//2
:c;s/(.*)\b([ab]+)\b( *)/\2\n\3\1/;h;s/\n.*/\n.... ./
:d;s%(.*)\n((.*) (.*))%sed 's/^\3$/\4\4\&amp;/;T;s/\4/\&amp;\\n/2g;q;:;a\3\3\3\2\4'&lt;&lt;&lt;\1%e
/\n$/!bd
s%.*%sed '1h;1d;x;2!s/\\.//;T;/^\\n/{s/$/\\n/p;z};:;$!x;3~2{H;d}'&lt;&lt;&lt;'&amp;'%e
s/(.)\n/\1/g;y/\n/ /;G;s/\n\w*\n/ /;/[ab]{2}/bc
h;s/\n.*//;y/ /\n/
:e;s!.*!sed -n 'h;:;x;p;x;s/.//;//b'&lt;&lt;&lt;'&amp;'!e
:f;s/b\nb/b/;s/a\na/aa/;tf;s/[ab]\n[ab]/a/;tf
s/\n(\n*)/\1/g;/\n/be
y/ab/##/;G;s/\n.*\n/ /
T;s/^(#*) \1(\w*)$/\2/;tz
s/#* (#*)(\w*)/\2\n\1/;h;s/\n.*//;T
s/10(0*)(1*)$/01\2\1/;t
s/(0*)0(1*)/\21\1/;t
y/1/0/;s/0*/&amp;&amp;&amp;&amp;/
:;G;s/\n.*\n/\n/;h;s/\n.*//;x;bb
:z
</code></pre>
<p><a href="https://tio.run/##XVJNb9swDL3rVzBwPhwXNS0n3RarxwHrYcAuvVUNIMVq4iGVPctp87Hupy8jkxXIZsEy/Ug@PpEKrjxu1V5tIYJm03WVX8LzZt1VzdpB5QkKEFzjWtO5EuwOvHtdV94FeHbGB@hWDu6@ff0MoTELFwdXjgLU3sGLaStj124MS0cci7qpiKB@cS08tfXzKbFp3UtVbwK0G58SUgX4vgkdLNbOtAGq7ojzOPspx320e1EYFfBBXs8ecRjhUu1Q5pPpzYePn2aYvZtIMVGGswhVZ0TA7AqzLJPao1qRS/s0QVRbUVjOz9BYVF9ODsRcFAsy4zQZaxs/GPt4xQYkY9S59nqi5QULbfRAiqIoVRicsnzMH@BtPKBewCjgXE/6qKe0hqjuOXuKeqipYL5UP1ShDBHzyvV0dHt7q@XAKWLvY8@WIgzS5MwkV0qWaqvyHlHoFJmMyInnEJAqkNGo/RsR9ntbNfmVH@5U@caMo@Fo4AQfjBQiHYJ7Rxa8H12/Judf5EMf8je0C3HRrh35KEAUToVemvRYz7WH0YqKbVVDb0AWhGj/1us5UTwRarW3aHkoRnuDxtBYGOc62vOOJ0hwrVh7bjXr43LWiR3PJ4redaZnmYK7OI8j6rSWMYmn@6FzotkTTZQAe07weWzyn9HfU4zM4oxCJCfS3cg5pOMGEZoxTInyDNIlwYz1ZwkO6aEmXIr5/14pa0WxPx6lyMVETMWNmP2um66qfThet38A" rel="nofollow noreferrer" title="sed 4.2.2 – Try It Online">Try it online!</a></p>
<p>did you know sed is turing complete? I happen to know that, and it makes me do things I shouldn't...</p>
<p>this does basically the same thing that the other answers are doing. we come up with a way to generate an infinite list of matrices <a href="https://tio.run/##VY7BTsMwDIbveQpLINZWgJMd1xfYA3DsJdq8NqhLqsRZ2csTnE4g4YP9@7N/y4nOpRzVQR3VokaV8L0bPGL/IdLoRndtY7r2GbUZ9oPBnoVXqivGYW8e8I4GNfbVji8SwsoT8OQSnMKZYHXzDJ85sbSenc8EIfOSWfQIV8vRnSjBJYYrrJNlulGExDZu85udxXAPGcQBzsthklKbhsZX@L1jjJZ45Fr/r24/pCmsG/P0xbBb7Eg7CJe/F9qiv8PCLvhU3uIP" rel="nofollow noreferrer">(check the order here)</a>, calculate the value of each matrix <a href="https://tio.run/##bVHbcpswEH3XV4iJ8YVxWIR7RUxe2w/oW9XMSEY2TFzhINzY9bifXroLIU47XbA42j17jlb2tui6E4gEtAH5SXpQDiBl2RrhPI4Wysy/avPtnC4vhHm0AJUqp1ZKgCx7fhwBILiHGAO3qMCyQvqw73fXNfS24DNkKjEhlVRNQX4hjRTUVGFfupWPMpOVEs8POiFvlue5WoVWotsEAlMwH8bRICdKKQp5lGmAOioGUkQHFDt7QBsEe/nzgqqT4ChXv9LzZ1lcSHE2nYWW0Zh4PsB5tvJE4/PxItRTNGxhuIILmDV7NfMJa/2wVvogjgI6z63jsxLNjnKPPw90IADz7BdYlm0wa5QzYGBAGjQhTbkRYQ5hu2FkNleOrp0OSH4GRXZEgzwX6erN23fvP3zUibiD/j9b5HGkxFxH8SKO7uhuZUt0Awl0N7wtLd9p3/JNfWh45faH1nPd2L5QuaL6URUHveOPB1002mGx3gxNtdvy2tklfyqrdYmrdSjSfNdti4NrVOHbpiqWyKwfPN9VDzZj7IYnGP3ygoX4Px44@IokEVxgUAkZfeIffOV0faOghCA4IJa8jqFy/RKkHQblCI/fMf@3AFkkV/UhMbaNrWwQvGr8rvdtVTvf3TZ/AA" rel="nofollow noreferrer">(check the math here)</a>, and then see if it's equal to the input. The two individual steps are fast and easy enough to check edge cases with; it's only the combined loop that takes a long time.</p>
<p>tio will finish on small numbers like 5 and 9, but even 6 is asking a bit much of it. hopefully my golfing will speed things up.</p>
<p>we're back into the triple digits! it's <s>around</s> more than twice as fast as it used to be for 5 &amp; 9, and the gains get even better as size increases (it still can't handle big inputs like 6 on TIO yet though). I'm not going to add any really detailed explanation yet; golfing can change an explanation a lot in sed since changing how you're storing or transforming the data itself is more effective when golfing than just finding a different way to say the same thing. once the golfing starts slowing down I'll start breaking things down and explaining them.</p>
<p>I went back to the labels on the left, jumps on the right format; it's just way easier to read them as blocks of code like that. the <code>bd</code> command has been moved onto the next line to keep everything in a non-scrolling code block, but the tio link has it on the end like it's supposed to be.</p>
</div>
<div id="pu1" class="pu"><h1>Python, 615 bytes</h1>
<pre class="lang-python prettyprint-override"><code>from numpy import*
Z=zeros
r=range
R=lambda n:r(n,-1,-1)
N=lambda M:M.shape[0]
z=lambda M,n:M if N(M)==n else(lambda w:(a:=Z((n,n)),[a.__setitem__((i*w,j*w),M[i,j])for i in r(N(M))for j in r(N(M))],a)[2])([2**i for i in r(n.bit_length())if N(M)*2**i==n][0])
def g(n):
    if n&lt;2:return array([[n]])
    if n&lt;5:r=Z(4);r[:n]=1;return r.reshape(2,2)
    else:a,b,c,d=(lambda n:next((i,j,k,l)for i in R(n)for j in R(i)for k in R(j)for l in R(k)if i*i+j*j+k*k+l*l==n))(n);A,B,C,D=map(g,(a,b,c,d));m=max(map(N,[A,B,C,D]));return block([[z(A,m),z(B,m)],[z(C,m),z(D,m)]])
lambda n:&quot;;&quot;.join(&quot;&quot;.join(map(str,map(int,l)))for l in g(n))
</code></pre>
<h1>Test</h1>
<p>Assign the function to <code>G</code>, and</p>
<pre class="lang-python prettyprint-override"><code>&gt;&gt;&gt; for i in (0, 1, 3, 4, 5, 9, 15, 67, 78):
&gt;&gt;&gt;     print(i, G(i), sep=&quot; -&gt; &quot;)
0 -&gt; 0
1 -&gt; 1
3 -&gt; 11;10
4 -&gt; 11;11
5 -&gt; 1110;0000;0000;0000
9 -&gt; 1100;1000;0000;0000
15 -&gt; 1111;1000;1010;0000
67 -&gt; 11111000;00000000;00000000;00000000;10001000;00000000;00000000;00000000
78 -&gt; 11111010;00000000;00001000;00000000;10101000;00000000;00000000;00000000
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>50</s> 49 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>∞Íonîü2íε`U0LsãεXô}Σ˜O]í€`.Δ[D˜g5‹#2δô2ô€øOOn}OOQ
</code></pre>
<p>Brute-force. Generates all <span class="math-container">\$2^k\times 2^k\$</span> sized matrices consisting of 0s and 1s, and will output the first valid one for the given input-integer <span class="math-container">\$n\$</span>.</p>
<p>-1 byte by changing the <code>∞&lt;on1š</code> (-1 and prepend <span class="math-container">\$1\$</span> manually) to <code>∞Íonî</code> (-2 and ceil the <span class="math-container">\$0.25\$</span> to <span class="math-container">\$1\$</span>)</p>
<p><a href="https://tio.run/##AVYAqf9vc2FiaWX//@KInsONb27DrsO8MsOtzrVgVTBMc8OjzrVYw7R9zqPLnE9dw63igqxgLs6UW0TLnGc14oC5IzLOtMO0MsO04oKsw7hPT259T09R//8xNQ" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##AWsAlP9vc2FiaWX/N8aSTj8iIOKGkiAiP05WIv/iiJ7DjW9uw67DvDLDrc61YFUwTHPDo861WMO0Xc61zqPLnE9dw63igqxgLs6UW0TLnGc14oC5IzLOtMO0MsO04oKsw7hPT259T09ZUf8iLlYs/w" rel="nofollow noreferrer">verify the smaller test cases up to n=7</a>.</p>
<p><strong>Explanation:</strong></p>

<p>Step 1: Generate a list of all possible outputs:</p>
<pre class="lang-python prettyprint-override"><code>∞          # Push an infinite positive list: [1,2,3,4,5,...]
 Í         # Decrease each by 2 to start at -1: [-1,0,1,2,3,...]
  o        # Take 2 to the power each: [0.5,1,2,4,8,...]
   n       # Square each: [0.25,1,4,16,64,...]
    î      # Ceil each: [1,1,4,16,64,...]
ü2         # Create overlapping pairs: [[1,1],[1,4],[4,16],[16,64],...]
  í        # Reverse each pair: [[1,1],[4,1],[16,4],[64,16],...]
ε          # Map over each pair:
 `         #  Pop and push both to the stack
  U        #  Pop the top smaller value, and save it in variable `X`
  0L       #  Push pair [1,0]
    s      #  Swap so the larger value is at the top of the stack
     ã     #  Cartesian product to create all combinations using the 1s/0s
      ε    #  Map over each list of 1s/0s
       Xô  #   Split it into blocks of size `X`
      }    #  Close the inner map
 Σ         #  Sort by:
  ˜        #   The flattened
   O       #   sum (of 1s)
]          # Close the sort and outer map
 í         # Reverse each inner list
  €`       # Flatten the list of list of lists one level down
           # (which has as side-effect that it reverses the inner lists,
           # hence the need for `í`)
</code></pre>
<p><a href="https://tio.run/##ATMAzP9vc2FiaWX//@KInsONb27DrsO8MsOtzrVgVTBMc8OjzrVYw7R9zqPLnE9dw63igqxg//8" rel="nofollow noreferrer">Try just this first step online.</a></p>
<p>Step 2: Find the first matrix that's a valid reduction for the given input-integer:</p>
<pre class="lang-python prettyprint-override"><code>.Δ         # Find the first matrix in this infinite list that's truthy for:
  [        #  Start an infinite list:
   D       #   Duplicate the current matrix
    ˜      #   Flatten it to a list
     g     #   Pop and push its length
      5‹   #   If this length is smaller than 5 (e.g. either 4 or 1):
        #  #    Stop the infinite inner loop
   2δô2ä€ø #  Split the matrix into four corner-blocks:
    δ      #   Map over each inner row:
   2 ô     #    Split it into pairs
      2ä   #   Then split the entire list into 2 equal parts as well
        €  #   Map over each inner matrix:
         ø #    Zip/transpose; swapping rows/columns
   OO      #  Sum each inner-most matrix
     n     #  Then square those sums
  }        # After the infinite loop to reduce it to a 2x2 matrix:
   OO      # Sum the four values in this matrix as well
     Q     #  Check whether it now equals the (implicit) input-integer
           # (after which the found matrix is output implicitly)
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f8/2uX0nHTTRw07lY3ObTm8xejwlkdNaw7v8Pe3zasFEkAF0YY6MGgAwrE60QY6KBBJxBBDBKEGqh@vGsIisQA" rel="nofollow noreferrer">Verify the resulting <span class="math-container">\$n\$</span> for a given matrix to test just this second step</a> (minus leading <code>.Δ</code> and trailing <code>Q</code>). I've added <code>=</code> after both <code>OO</code>, so you can also see the intermediate steps of the reduction.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 101 bytes</h1>
<pre><code>Ｎθ≔⦃⁰⟦0⟧¹⟦1⟧⦄ηＷ∧¬§ηθη«≔⦃⦄η≔ＥιλζＦζＦζＦζＦζ«≔ΣＸ⟦νμλκ⟧²ε≔⁺Ｅ§ιν⁺ξ§§ιμπＥ§ιλ⁺ξ§§ικπδ¿∨¬§ηε‹ΣΣδΣΣ§ηε§≔ηεδ»»§ηθ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=fVFBasMwEKTH-hWLThIoEBcKpTn5GEhSQ4_GB8eWaxFZdiS7CQl-SS-htLRf6Rf6mkqOBamhFQhpZ2dmd6WXz7RIVFol4nR6b5t8cvd99TWXddus2nLNFN6SmRdozZ8kPk7vIUJTFFPw7c1HcUehMIRdwQUDHMgMr6oGB81cZmyPCwpbQiyFwNG7djaDyMXLpMacgjDEg4XzSgE-EPjrNE5O-tiWOKx2ps1IUiiNCYWNae_GVmXWzDFD0eq-kuvNVJSG1ON7Cg6-SJcmXRPrNNKJ_3WbQWeOrG-B54Af1PhlmCUsmNb9FHZnFnHBb6ZdcB7lMjFU6LzOCxWX45efvel1qod__YjQ5Fmg-NW_PQM_" rel="nofollow noreferrer">Attempt This Online!</a> Link is to verbose version of code. Explanation: Lots of brute force, so can only solve inputs with <code>4×4</code> outputs before the heat death of the universe.</p>
<pre><code>Ｎθ
</code></pre>
<p>Input <code>n</code>.</p>
<pre><code>≔⦃⁰⟦0⟧¹⟦1⟧⦄η
</code></pre>
<p>Start with solutions for <code>0</code> and <code>1</code>.</p>
<pre><code>Ｗ∧¬§ηθη«
</code></pre>
<p>Repeat until a solution for <code>n</code> is found. (Also makes a copy of the solutions so far.)</p>
<pre><code>≔⦃⦄η
</code></pre>
<p>Start building solutions of twice (4×) the size.</p>
<pre><code>≔ＥιλζＦζＦζＦζＦζ«
</code></pre>
<p>For all possible sets of subsquares:</p>
<pre><code>≔ΣＸ⟦νμλκ⟧²ε
</code></pre>
<p>Calculate the value.</p>
<pre><code>≔⁺Ｅ§ιν⁺ξ§§ιμπＥ§ιλ⁺ξ§§ικπδ
</code></pre>
<p>Calculate the resulting square.</p>
<pre><code>¿∨¬§ηε‹ΣΣδΣΣ§ηε§
</code></pre>
<p>If this is a better square, then...</p>
<pre><code>≔ηεδ
</code></pre>
<p>... add or replace the previous solution for that value.</p>
<pre><code>»»§ηθ
</code></pre>
<p>Output the square for <code>n</code>.</p>
<p>108 bytes for a slightly less forceful version:</p>
<pre><code>Ｎθ≔⦃⁰⟦0⟧¹⟦1⟧⦄ηＷ∧¬§ηθη«≔⦃⦄η≔ΦＥιλ¬›×κκθζＦζＦζＦζＦζ«≔ΣＸ⟦νμλκ⟧²ε≔⁺Ｅ§ιν⁺ξ§§ιμπＥ§ιλ⁺ξ§§ικπδ¿∨¬§ηε‹ΣΣδΣΣ§ηε§≔ηεδ»»§ηθ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=fVHdToMwFI6X8hQnXJWkSzZvXNwVN5olOkn0jnDBoEhDKYyCW7bwJN4sRqPP5Ev4Cp52NJlLlATafuf7OYe-fCZ53CRVLPb7967NRtOvs--5rLt20ZVL1pCVN3N8pfiTJLvxFYTu2I0oTPRu4kY9hRwJ65wLBsSXKVlULfHbuUzZhuQUVp6nKR7snHNrM4js-ZqLFoPu4ppwCgL52uOmYbGGH3nJFCkoFJ5xw-9Wi7OqAbL14K8V82zAQ1eSoFqjWSgplJiBbjjEhTZj2swyA9Ep04idABuSSDL4hoKFj8ollmvT1olO_K8rBh0uqWmBZ0Dum9P_xzThlillptBvqhF7-M3UDxxGOS4MCb3TO0HD5en9zN7UMlHD7X-E7uhZuNHr5fQA_AA" rel="nofollow noreferrer">Attempt This Online!</a> Link is to verbose version of code. Explanation: As above but when generating the list of possible solutions, excludes values whose square exceeds the input.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/isaacg1/pyth" rel="nofollow noreferrer">Pyth</a>, 48 bytes</h1>
<pre><code>M?Gho_SsNmsCMc2sgLtGdfqHs*VTT^UhH4]]Hgf&gt;2eSsgTQZ
</code></pre>
<p><a href="https://tio.run/##K6gsyfj/39fePSM/PrjYL7fY2TfZqDjdp8Q9Ja3Qo1grLCQkLjTDwyQ21iM9zc4oNbg4PSQw6v9/SwA" rel="nofollow noreferrer" title="Pyth – Try It Online">Try it online!</a></p>
<p>Can run up to about 30 before timing out online. Try a more performant, 5 byte longer version <a href="https://tio.run/##K6gsyfj/39fePSM/PrjYL7fY2TfZqDjdp8Q9Ja3Qo1grLCREzzk0o9jBw0jBJDbWIz3Nzig1uDg9JDDq/39DAwMDAA" rel="nofollow noreferrer">here</a> (can easily do 1000 without timing out). The faster version is the same except instead of looking at all permutations of 4 numbers in the entire range of the input, we only look at all combinations (with repetition) of 4 numbers in the range up to the square root of the input.</p>
<p>This answer uses a recursive approach.</p>
<h3>Explanation</h3>
<pre><code>M?Gho_SsNmsCMc2sgLtGdfqHs*VTT^UhH4]]Hgf&gt;2eSsgTQZQ    # implicitly add Q
                                                     # implicitly assign Q = eval(input())
M                                                    # define g(G,h)
 ?G                               ]]H                #   recursive base case, if G==0: return [[H]]
                              UhH                    #   list(range(H+1))
                             ^   4                   #   4x repeated cartesian product
                     f                               #   filter this list on lambda T (this keeps only quadruplets whose squares sum to the desired value)
                        s                            #     sum of
                         *VTT                        #     vectorized product of T and T
                      qH                             #     is equal to H
         m                                           #   map over lambda d (this constructs possible outputs from the recursive calls)
                gLtGd                                #     map g over d with a first argument of G-1
          sCMc2s                                     #     take four square matrices and put them in a bigger square
    o                                                #   sort by lambda N
       sN                                            #     flattened N
      S                                              #     sorted
     _                                               #     reversed
   h                                                 #   take the first element
                                      f        Z     # find the first integer which satisfies lambda T, counting up from 0
                                            gTQ      #   g(T, Q)
                                           s         #   flatten list
                                         eS          #   largest element
                                       &gt;2            #   is less than 2
                                     g          Q    # apply g on the result and the input
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/274951/">274951</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




