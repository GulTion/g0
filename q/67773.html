<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::67773</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>007</td><td>Jelly</td><td>240424T094543Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/272773#272773">emanresu</a></td></tr>
<tr d-ix="1"><td>006</td><td>Vyxal</td><td>240424T094106Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/272772#272772">emanresu</a></td></tr>
<tr d-ix="2"><td>008</td><td>05AB1E</td><td>200918T111117Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/211269#211269">Sam</a></td></tr>
<tr d-ix="3"><td>078</td><td>R</td><td>200906T112627Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/210633#210633">Dominic </a></td></tr>
<tr d-ix="4"><td>075</td><td>Whispers v2</td><td>200906T012000Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/210627#210627">caird co</a></td></tr>
<tr d-ix="5"><td>012</td><td>Samau</td><td>151227T102547Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67845#67845">alephalp</a></td></tr>
<tr d-ix="6"><td>017</td><td>MATL</td><td>151226T165854Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67777#67777">Luis Men</a></td></tr>
<tr d-ix="7"><td>113</td><td>Factor</td><td>160425T161519Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/78505#78505">cat</a></td></tr>
<tr d-ix="8"><td>055</td><td>Sage</td><td>160425T075151Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/78439#78439">user4594</a></td></tr>
<tr d-ix="9"><td>025</td><td>PARI/GP</td><td>160204T075003Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/71027#71027">Charles</a></td></tr>
<tr d-ix="10"><td>095</td><td>Julia</td><td>151227T212010Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67876#67876">Alex A.</a></td></tr>
<tr d-ix="11"><td>032</td><td>Mathematica</td><td>151226T165509Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67776#67776">LegionMa</a></td></tr>
<tr d-ix="12"><td>035</td><td>Mathematica</td><td>151227T100218Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67842#67842">Eric Tow</a></td></tr>
<tr d-ix="13"><td>017</td><td>J</td><td>151227T153238Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67859#67859">randomra</a></td></tr>
<tr d-ix="14"><td>008</td><td>Jelly</td><td>151226T170114Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67778#67778">Dennis</a></td></tr>
<tr d-ix="15"><td>178</td><td>Python2/Pypy</td><td>151227T090536Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67841#67841">user1921</a></td></tr>
<tr d-ix="16"><td>015</td><td>Dyalog APL</td><td>151227T044758Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67835#67835">lirtosia</a></td></tr>
<tr d-ix="17"><td>015</td><td>Seriously</td><td>151227T035953Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67832#67832">quintopi</a></td></tr>
<tr d-ix="18"><td>042</td><td>Mathematica</td><td>151226T171244Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67779#67779">DavidC</a></td></tr>
<tr d-ix="19"><td>088</td><td>JavaScript ES6</td><td>151227T002444Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67820#67820">user8165</a></td></tr>
<tr d-ix="20"><td>047</td><td>Octave</td><td>151227T000811Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67818#67818">flawr</a></td></tr>
<tr d-ix="21"><td>011</td><td>Pyth</td><td>151226T174300Z</td><td><a href="https://codegolf.stackexchange.com/questions/67773/co-primality-and-the-number-pi/67785#67785">Maltysen</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 7 bytes</h1>
<pre><code>gþµFỊÆm
</code></pre>
<p><a href="https://tio.run/##y0rNyan8/z/98L5DW90e7u463Jb7//9/Q1MA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a> Port of my Vyxal answer.</p>
<pre><code> þ      # Outer product with self by
g       # gcd
  µF    # Flatten
    Ị   # Is each ≤ 1?
     Æm # Take mean
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-2" rel="nofollow noreferrer">Vyxal</a>, 6 bytes</h1>
<pre><code>ǒġ1=fṁ
</code></pre>
<p><a href="https://vyxal.pythonanywhere.com/?v=2&amp;c=1#WyIiLCIiLCLHksShMT1m4bmBIiwiIiwiMTAwIl0=" rel="nofollow noreferrer">Try it Online!</a> Output is displayed as an arbitrary-precision rational (simplified), use the <code>ḋ</code> flag if you want to convert it to decimal for some reason.</p>
<pre><code>ǒġ     # Outer product by gcd
  1=   # Equal to 1?
    fṁ # Flatten and take mean
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E" rel="nofollow noreferrer">05AB1E</a>, 8 bytes</h1>
<pre><code>LÕO·&lt;sn/
</code></pre>
<p><a href="https://tio.run/##yy9OTMpM/f/f5/BU/0PbbYrz9P//NzQwMAAA" rel="nofollow noreferrer" title="05AB1E – Try It Online">Try it online!</a></p>
<p>Explanation:</p>
<pre><code>L         Push inclusive range of (implicit) input (4 -&gt; [1, 2, 3, 4])
 Õ        Perform Euler's Totient on each element ([1, 2, 3, 4] -&gt; [1, 1, 2, 2])
  O       Sum list elements ([1, 1, 2, 2] -&gt; 6)
   ·&lt;     Double result and subtract 1 (2*6 - 1 = 11)
     sn   Square input (4 -&gt; 16)
       /  Divide sum by input squared (11 / 16 = 0.6875)
          (Implicit output)
</code></pre>
<p>It might be golf-able, I just copied <a href="https://codegolf.stackexchange.com/a/67778/89342">Dennis' Jelly method</a>,
and I haven't really bothered trying to make it any smaller.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 78 bytes</h1>

<pre class="lang-r prettyprint-override"><code>mean(mapply(function(x,y)sum(!x%%which(!y%%1:y))&lt;2,1:(N=scan()),rep(1:N,e=N)))
</code></pre>
<p><a href="https://tio.run/##DctBCoAgEADAt3gQdsGD21HyC/5BxFBIE03K12/NfTpzib5C8a2dC45Zw52vCq9aOGYB8Ur5pBwSiCUlmYW4b4oMODvC/xBVjw3IOBWtQ0QmrTV/" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>Uses <code>which(!y%%1:y)</code> to calculate divisors of y (including 1), and <code>!x%%divisors_of_y</code> to count common divisors of x and y (including 1), so <code>sum(common_divisors)&lt;2</code> is <code>TRUE</code> for co-prime pairs.</p>
<p>The R <code>mapply</code> function applies a custom function to two (or more) sets of arguments, here specified as <code>1:N</code> and <code>rep(1:N,each=N)</code> (which repeats each number in <code>1:N</code>, <code>N</code> times).</p>
<p>Conveniently, R 'recycles' the shorter argument list to the length of the longer one, so <code>1:N</code> gets repeated for us automaticaly.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/cairdcoinheringaahing/Whispers" rel="nofollow noreferrer">Whispers v2</a>, 75 bytes</h1>
<pre><code>&gt; 1
&gt; Input
&gt;&gt; φ(L)
&gt;&gt; ∑ 1 2 3
&gt;&gt; 4+4
&gt;&gt; ≺5
&gt;&gt; 2²
&gt;&gt; 6÷7
&gt;&gt; Output 8
</code></pre>
<p><a href="https://tio.run/##K8/ILC5ILSo2@v/fTsGQy07BM6@gtITLzk7hfJuGjyaI8ahjooKhgpGCMYhjom0CFuvcZQqijQ5tAlFmh7ebg2j/0hKgbgWL//8NDQwMAA" rel="nofollow noreferrer" title="Whispers v2 – Try It Online">Try it online!</a></p>
<h2>How it works</h2>
<p>Implements <a href="https://codegolf.stackexchange.com/users/12012/dennis">Dennis</a>'s <a href="https://codegolf.stackexchange.com/a/67778/66833">algorithm</a>.</p>
<p>We calculate <span class="math-container">\$m = \sum_{k=1}^n\phi(k)\$</span>. We then double <span class="math-container">\$m\$</span> and decrement it to get <span class="math-container">\$2m-1\$</span>, before squaring <span class="math-container">\$n\$</span> and dividing by it, to output <span class="math-container">\$\frac{2m-1}{n^2}\$</span></p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/AlephAlpha/Samau/tree/master/OldSamau" rel="nofollow noreferrer">Samau</a>, 12 bytes</h1>

<p><strong>Disclaimer: Not competing because I updated the language after the question was posted.</strong></p>

<pre><code>▌;\φΣ2*($2^/
</code></pre>

<p>Hex dump (Samau uses CP737 encoding):</p>

<pre><code>dd 3b 5c ad 91 32 2a 28 24 32 5e 2f
</code></pre>

<p>Using the same algorithm as Dennis's answer in Jelly.</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, <s>20</s> 17 bytes</h1>

<p>This uses <a href="https://github.com/lmendo/MATL/releases/tag/5.0.0" rel="nofollow noreferrer">current version (5.0.0)</a> of the language.</p>

<p>Approach based on <a href="https://codegolf.stackexchange.com/a/67818/36398">@flawr's answer</a>.</p>

<pre><code>i:tg!X*t!Zd1=Y)Ym
</code></pre>

<p><em>Edit (April 28, 2015)</em>: <a href="http://matl.tryitonline.net/#code=aTp0ZyFYKnQhWmQxPVg6WW0&amp;input=MTAw" rel="nofollow noreferrer">Try it online!</a> After this answer was posted, function <code>Y)</code> was renamed to  <code>X:</code>; the link includes that change.</p>

<h3>Example</h3>

<pre><code>&gt;&gt; matl i:tg!X*t!Zd1=Y)Ym
&gt; 100
0.6087
</code></pre>

<h3>Explanation</h3>

<pre><code>i:         % vector 1, 2, ... up to input number
tg!        % copy, convert into ones, transpose
X*         % Kronecker product. Produces a matrix
t!         % copy, transpose
Zd         % gcd of all pairs
1=         % is it equal to 1?
Y)         % linearize into column array
Ym         % compute mean
</code></pre>

<hr>

<p>Old answer: <strong>20 bytes</strong></p>

<pre><code>Oi:t"t@Zd1=sb+w]n2^/
</code></pre>

<p><strong>Explanation</strong></p>

<pre><code>O             % produce literal 0. Initiallizes count of co-prime pairs.
i             % input number, say N
:             % create vector 1, 2, ... N
t             % duplicate of vector
"             % for loop
    t         % duplicate of vector
    @         % loop variable: each element from vector
    Zd        % gcd of vector and loop variable. Produces a vector
    1=s       % number of "1" in result. Each "1" indicates co-primality
    b+w       % accumulate into count of co-prime pairs
]             % end
n2^/          % divide by N^2
</code></pre>
</div>
<div id="pu7" class="pu"><h1>Factor, <s>120</s> 113 bytes</h1>
<p>I've spent class golfing this and I can't get it shorter.</p>
<p>Translation of: <a href="https://codegolf.stackexchange.com/a/67876/46231">Julia</a>.</p>
<pre><code>[ [a,b] dup append 2 &lt;combinations&gt; [ members ] keep [ first2 coprime? ] filter [ length ] bi@ 2 /i 1 + swap /f ]
</code></pre>
<p>Example runs on the first 5 test cases (a value of 1000 causes it to freeze the editor, and I can't be bothered to compile an executable right now):</p>
<pre><code>! with floating point division
IN: scratchpad auto-use {
      1    
      2    
      4    
      10   
      100  
    }
    [ 
      [1,b] dup append 2 &lt;combinations&gt; [ members ] keep 
      [ first2 coprime? ] filter [ length ] bi@ 2 /i 1 + swap /f 
    ]
    map

--- Data stack:
{ 1.0 0.75 0.6875 0.63 0.6087 }
! with rational division
IN: scratchpad auto-use {
      1    
      2    
      4    
      10   
      100  
    }
    [ 
      [1,b] dup append 2 &lt;combinations&gt; [ members ] keep 
      [ first2 coprime? ] filter [ length ] bi@ 2 /i 1 + swap / 
    ]
    map
    
--- Data stack:
{ 1.0 0.75 0.6875 0.63 0.6087 }
{ 1 3/4 11/16 63/100 6087/10000 }
</code></pre>
</div>
<div id="pu8" class="pu"><h2>Sage, 55 bytes</h2>
<pre class="lang-py prettyprint-override"><code>lambda a:n((sum(map(euler_phi,range(1,a+1)))*2-1)/a**2)
</code></pre>
<p>Thanks to Sage computing everything symbolically, machine epsilon and floating-point issues don't crop up. The tradeoff is, in order to follow the output format rule, an additional call to <code>n()</code> (the decimal approximation function) is needed.</p>
<p><a href="http://sagecell.sagemath.org/?z=eJwdw0EKgzAQQNF9IHeY5Uw6RSd0JXiSUmTExAZMGtIKHl_p5_04bprnRUGHgvjdM2atGPYttKm-Ezcta0BhvQkROX8X6tQ5T9ZYEz8NDkgFnsKeHyz95X__GqyBq9pS-UHEg06BNByF&amp;lang=sage" rel="nofollow noreferrer">Try it online</a></p>
</div>
<div id="pu9" class="pu"><h1><a href="http://pari.math.u-bordeaux.fr/" rel="nofollow">PARI/GP</a>, 25 bytes</h1>

<p>Making the function anonymous would save a byte, but then I'd have to use <code>self</code> making it more expensive overall.</p>

<pre><code>f(n)=n^2-sum(j=2,n,f(n\j))
</code></pre>
</div>
<div id="pu10" class="pu"><h1>Julia, 95 bytes</h1>



<pre class="lang-julia prettyprint-override"><code>n-&gt;(c=combinations([1:n;1:n],2);((L=length)(collect(filter(x-&gt;gcd(x...)&lt;2,c)))÷2+1)/L(∪(c)))
</code></pre>

<p>Just the straightforward approach for now; I'll look into shorter/more elegant solutions soon. This is an anonymous function that accepts an integer and returns a float. To call it, assign it to a variable.</p>

<p>Ungolfed:</p>

<pre class="lang-julia prettyprint-override"><code>function f(n::Integer)
    # Get all pairs of the integers from 1 to n
    c = combinations([1:n; 1:n], 2)

    # Get the coprime pairs
    p = filter(x -&gt; gcd(x...) == 1, c)

    # Compute the probability
    return (length(collect(p)) ÷ 2 + 1) / length(unique(c))
end
</code></pre>
</div>
<div id="pu11" class="pu"><h2>Mathematica, <s>42</s> 32 bytes</h2>

<pre><code>Count[GCD~Array~{#,#},1,2]/#^2.&amp;
</code></pre>

<p>Anonymous function, uses simple brute force. The last case runs in about .37 seconds on my machine. Explanation:</p>

<pre><code>                               &amp;   A function taking N and returning
Count[               , , ]           the number of
                      1               ones
                                     in the
                        2             second
                                     level of
         ~Array~                      a matrix of
      GCD                              the greatest common denominators of
                {#,#}                 all 2-tuples in [1..N]
                          /         divided by
                           #          N
                            ^2.      squared.
</code></pre>
</div>
<div id="pu12" class="pu"><h2>Mathematica, 35 bytes</h2>

<p>Implements @Dennis's algorithm.</p>

<pre><code>(2`4Plus@@EulerPhi@Range[#]-1)/#^2&amp;
</code></pre>

<p>Compute the sum of the totient (Euler's phi function) over the range from 1 to the input value.  Multiply by floating point two (with four digits of precision) and subtract one.  (More precision can be retained by using instead "<code>2</code>" and "<code>1`4</code>".)  This is the total number of coprime pairs, so divide by the square of the input to get the desired fraction.  Because the two is an approximate number, so is the result.</p>

<p>Testing (with timing data in the left column since at least one of us thinks that's interesting), with the function assigned to <code>f</code> so that the test line is more easily read.:</p>

<pre><code>f=(2`4Plus@@EulerPhi@Range[#]-1)/#^2&amp;
RepeatedTiming[f[#]] &amp; /@ {1, 2, 4, 10, 100, 1000}
(* {{5.71*10^-6, 1.000}, 
    {5.98*10^-6, 0.750}, 
    {0.000010  , 0.6875}, 
    {0.0000235 , 0.6300}, 
    {0.00028   , 0.6087}, 
    {0.0033    , 0.6084} }  *)
</code></pre>

<p>Edit:  Showing extent of the range of inputs (swapping the precision to the one instead of the two because otherwise the results get rather monotonous) and challenging others to do the same...</p>

<pre><code>f = (2 Plus @@ EulerPhi@Range[#] - 1`4)/#^2 &amp;
{#}~Join~RepeatedTiming[f[#]] &amp; /@ {1, 2, 4, 10, 100, 1000, 10^4, 10^5, 10^6, 10^7}
(*  Results are {input, wall time, output}
    {{       1,  5.3*10^-6, 1.000}, 
     {       2,  6.0*10^-6, 0.7500}, 
     {       4,  0.0000102, 0.68750}, 
     {      10,  0.000023 , 0.63000}, 
     {     100,  0.00028  , 0.6087000}, 
     {    1000,  0.0035   , 0.608383000}, 
     {   10000,  0.040    , 0.60794971000}, 
     {  100000,  0.438    , 0.6079301507000}, 
     { 1000000,  4.811    , 0.607927104783000}, 
     {10000000, 64.0      , 0.60792712854483000}}  *)
</code></pre>

<p><code>RepeatedTiming[]</code> performs the calculation multiple times and takes an average of the times, attempting to ignore cold caches and other effects causing timing outliers.  The asymptotic limit is </p>

<pre><code>N[6/Pi^2,30]
(*  0.607927101854026628663276779258  *)
</code></pre>

<p>so for arguments >10^4, we can just return "0.6079" and meet the specified precision and accuracy requirements.</p>
</div>
<div id="pu13" class="pu"><h1>J, <s>19</s> 17 bytes</h1>

<pre><code>*:%~1-~5+/@p:|@i:
</code></pre>

<p>Usage:</p>

<pre><code>   (*:%~1-~5+/@p:|@i:) 4
0.6875
</code></pre>

<p>Explanation:</p>

<pre><code>*:%~1-~5+/@p:|@i:
               i: [-n..n]
             |@   absolute value of each element ([n..1,0,1,..n])
       5+/@p:     sum of the totient function for each element
    1-~           decreased by one, giving the number of co-prime pairs
*:%~              divided by N^2
</code></pre>

<p><a href="https://codegolf.stackexchange.com/a/67778/7311">Dennis' solution</a> gives a nice explanation how can we use the totient function.</p>

<p><a href="http://tryj.tk/" rel="nofollow noreferrer">Try it online here.</a></p>
</div>
<div id="pu14" class="pu"><h1><a href="http://github.com/DennisMitchell/jelly" rel="noreferrer">Jelly</a>, <s>12</s> 8 bytes</h1>

<pre><code>RÆṪSḤ’÷²
</code></pre>

<p><a href="http://jelly.tryitonline.net/#code=UsOG4bmqU-G4pOKAmcO3wrI&amp;input=&amp;args=MTAwMA" rel="noreferrer">Try it online!</a></p>

<p>The following binary code works with <a href="https://github.com/DennisMitchell/jelly/tree/0ea6f804d01b9da15070c77e8e7ba3ffa0f9d114" rel="noreferrer">this version of the Jelly interpreter</a>.</p>

<pre><code>0000000: 52 91 b0 53 aa b7 9a 8a  R..S....
</code></pre>

<h3>Idea</h3>

<p>Clearly, the number of pairs <strong>(j, k)</strong> such that <strong>j &leq; k</strong> and <strong>j</strong> and <strong>k</strong> are co-prime equals the number of pairs <strong>(k, j)</strong> that satisfy the same conditions. Also, if <strong>j = k</strong>, <strong>j = 1 = k</strong>.</p>

<p>Thus, to count the number of co-prime pairs with coordinates between <strong>1</strong> and <strong>n</strong>, it suffices to calculate the amount <strong>m</strong> of pairs <strong>(j, k)</strong> such that <strong>j &leq; k</strong>, then compute <strong>2m - 1</strong>.</p>

<p>Finally, since Euler's totient function <strong>&phi;(k)</strong> yields the number integers between between <strong>1</strong> and <strong>k</strong> that are co-prime to <strong>k</strong>, we can calculate <strong>m</strong> as <strong>&phi;(1) + &hellip; + &phi;(n)</strong>.</p>

<h3>Code</h3>

<pre><code>RÆṪSḤ’÷²    Input: n

R           Yield [1, ..., n].
 ÆṪ         Apply Euler's totient function to each k in [1, ..., n].
   S        Compute the sum of all results.
    Ḥ       Multiply the result by 2.
     ’      Subtract 1.
      ÷²    Divide the result by n².
</code></pre>
</div>
<div id="pu15" class="pu"><h1>Python2/Pypy, 178 bytes</h1>

<p>The <code>x</code> file: </p>

<pre><code>N={1:set([1])}
n=0
c=1.0
e=input()
while n&lt;e:
 n+=1
 for d in N[n]:
  m=n+d
  try:N[m].add(d)
  except:N[m]=set([d,m])
 for m in range(1,n):
  if N[m]&amp;N[n]==N[1]:c+=2
print c/n/n
</code></pre>

<p>Running:</p>

<pre><code>$ pypy x &lt;&lt;&lt;1
1.0
$ pypy x &lt;&lt;&lt;10
0.63
$ pypy x &lt;&lt;&lt;100
0.6087
$ pypy x &lt;&lt;&lt;1000
0.608383
</code></pre>

<p>The code counts the co-prime pairs <code>(n,m) for m&lt;n</code> twice (<code>c+=2</code>). This ignores <code>(i,i) for i=1..n</code> which is ok except for <code>(1,1)</code>, thus being corrected by initialising the counter with <code>1</code> (<code>1.0</code> to prepare for float division later) to compensate.</p>
</div>
<div id="pu16" class="pu"><h1>Dyalog APL, 15 bytes</h1>
<pre><code>(+/÷⍴)∘∊1=⍳∘.∨⍳
</code></pre>
<p>Pretty straightforward. It's a monadic function train. Iota is the numbers from 1 to input, so we take the outer product by gcd, then count the proportion of ones.</p>
</div>
<div id="pu17" class="pu"><h2>Seriously, 15 bytes</h2>

<pre><code>,;ª)u1x`▒`MΣτD/
</code></pre>

<p>Hex Dump:</p>

<pre><code>2c3ba62975317860b1604de4e7442f
</code></pre>

<p><a href="http://seriouslylang.herokuapp.com/link/code=2c3ba62975317860b1604de4e7442f&amp;input=1000" rel="nofollow">Try It Online</a></p>

<p>I'm not going to bother explaining it since it literally uses exactly the same algorithm as Dennis's Jelly solution (although I derived it independently).</p>
</div>
<div id="pu18" class="pu"><h1>Mathematica <s>43</s>  42 bytes</h1>

<p>I found <a href="https://shreevatsa.wordpress.com/2008/11/07/lattice-points-visible-from-the-origin/" rel="noreferrer">Lattice points visible from the origin</a>, from which the picture below is taken, to be helpful in reframing the problem through the following questions regarding a given square region of the unit lattice:</p>

<ul>
<li>What fraction of the unit-lattice points have co-prime coordinates?</li>
<li>What fraction of unit-lattice points can be seen from the origin?</li>
</ul>

<p><a href="https://i.stack.imgur.com/AUnvH.png" rel="noreferrer"><img src="https://i.stack.imgur.com/AUnvH.png" alt="grid"></a></p>

<hr>

<pre><code>N@Mean[Mean/@Boole@Array[CoprimeQ,{#,#}]]&amp;
</code></pre>

<hr>

<p><strong>Examples</strong></p>

<p>Trailing zeros are omitted.</p>

<pre><code>N@Mean[Mean/@Boole@Array[CoprimeQ,{#,#}]]&amp;/@Range@10
</code></pre>

<blockquote>
  <p>{1., 0.75, 0.777778, 0.6875, 0.76, 0.638889, 0.714286, 0.671875, 
  0.679012, 0.63}</p>
</blockquote>

<hr>

<p><strong>Timing</strong></p>

<p>The timing, in seconds, precedes the answer.</p>

<pre><code>N@Mean[Mean/@Boole@Array[CoprimeQ,{#,#}]]&amp;[1000]// AbsoluteTiming
</code></pre>

<blockquote>
  <p>{0.605571, 0.608383}</p>
</blockquote>
</div>
<div id="pu19" class="pu"><h1>JavaScript (ES6), 88 bytes</h1>

<pre class="lang-js prettyprint-override"><code>n=&gt;eval(`p=0;for(i=n;i;i--)for(j=n;j;j--,p+=a)for(a=1,k=j;k&gt;1;k--)a=i%k||j%k?a:0;p/n/n`)
</code></pre>

<h2>Explanation</h2>

<pre class="lang-js prettyprint-override"><code>n=&gt;
  eval(`                     // use eval to enable for loop without {} or return
    p=0;                     // p = number of pairs
    for(i=n;i;i--)           // i = 1 to n
      for(j=n;j;j--,p+=a)    // j = i to n, a will equal 1 if i and j are coprime, else 0
        for(a=1,k=j;k&gt;1;k--) // for each number from 0 to j
          a=i%k||j%k?a:0;    // if i%k and j%k are both 0, this pair is not coprime
    p/n/n                    // return result (equivalent to p/(n*n))
  `)
</code></pre>

<h2>Test</h2>

<p>Takes a while for large (<code>&gt;100</code>) values of <code>n</code>.</p>

<p><div class="snippet" data-lang="js" data-hide="true">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-js lang-js prettyprint-override"><code>var solution = n=&gt;eval(`p=0;for(i=n;i;i--)for(j=n;j;j--,p+=a)for(a=1,k=j;k&gt;1;k--)a=i%k||j%k?a:0;p/n/n`)</code></pre>
<pre class="snippet-code-html lang-html prettyprint-override"><code>N = &lt;input type="text" id="input" value="100" /&gt;
&lt;button onclick="result.textContent=solution(+input.value)"&gt;Go&lt;/button&gt;
&lt;pre id="result"&gt;&lt;/pre&gt;</code></pre>
</div>
</div>
</p>
</div>
<div id="pu20" class="pu"><h1>Octave, <s>49</s> 47 bytes</h1>
<p>Just calculating the <code>gcd</code> of all pairs and counting.</p>
<pre><code>@(n)mean(mean(gcd(c=kron(ones(n,1),1:n),c')&lt;2))
</code></pre>
<blockquote>
<p>The kronecker product is awesome.</p>
</blockquote>
</div>
<div id="pu21" class="pu"><h1>Pyth - <s>13</s> 11 bytes</h1>
<pre><code>.OqR1iM^SQ2
</code></pre>
<p><a href="http://pyth.herokuapp.com/?code=.OqR1iM%5ESQ2&amp;test_suite=1&amp;test_suite_input=1%0A2%0A4%0A10&amp;debug=0" rel="noreferrer">Test Suite</a>.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/67773/">67773</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




