<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::204124</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>351</td><td>Python3</td><td>240521T193946Z</td><td><a href="https://codegolf.stackexchange.com/questions/204124/escape-the-candlelit-maze/273226#273226">Ajax1234</a></td></tr>
<tr d-ix="1"><td>162</td><td>PowerShell 6+ for Windows</td><td>200504T083430Z</td><td><a href="https://codegolf.stackexchange.com/questions/204124/escape-the-candlelit-maze/204297#204297">mazzy</a></td></tr>
<tr d-ix="2"><td>238</td><td>Perl 5</td><td>200503T233608Z</td><td><a href="https://codegolf.stackexchange.com/questions/204124/escape-the-candlelit-maze/204288#204288">Kjetil S</a></td></tr>
<tr d-ix="3"><td>177</td><td>JavaScript ES6</td><td>200428T193936Z</td><td><a href="https://codegolf.stackexchange.com/questions/204124/escape-the-candlelit-maze/204127#204127">Arnauld</a></td></tr>
<tr d-ix="4"><td>229</td><td>Retina 0.8.2</td><td>200428T205034Z</td><td><a href="https://codegolf.stackexchange.com/questions/204124/escape-the-candlelit-maze/204128#204128">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 351 bytes</h1>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def f(b):
 d={(x,y):v for x,r in E(b)for y,v in E(r)}
 q=[(*[i for i in d if'@'==d[i]][0],[])]
 for x,y,p in q:
  if'#'==b[x][y]:return len(p)
  for X,Y in[(1,0),(-1,0),(0,1),(0,-1)]:
   J,F=(x,y),0
   while d.get(J:=(J[0]+X,J[1]+Y),-1)in[' ','^','#']:
    if d[J]in'^#':F=1;break
   if F and(T:=(x,y,x+X,y+Y))not in p:q+=[(x+X,y+Y,p+[T])]
</code></pre>
<p><a href="https://tio.run/##bVNNb9swDD1Pv4KID5YatYibFig8GMilOeSwUw8tNKtIYHkVlsmO4nY2hv32jLScjzVxEil8It97JKy6a94qN32o/W73mBn3/sv4ZWNYYUoo@UqkDIrsD29lJ9IPKCsPrfRgHTziIYWd/AihF38ZbDLFr5TtEy3hBdgynsVZViib52qSS5WLnA1MnawpaYMqlBdh3kq1uery1Jvm3TtYG8drgcdU8CxfMF3xRE6E5Ndhm8ikX68TkRMPLOQ86w3LCYW/3@zaQHHzwzR8kWZ8gSbGz3Khknz8IqgMKWOIZazxF8WBBO1AoRa5dbGO4nSeJV9X3ix/snA0h6Ur@FPaC8kW@TokE65qqJ863YxxEAMs67F6wqZ32wQyGI1GrD08bKZbUtP4t9X9TigtQHHEcMcv9Cho@mDQo4hjcEpG3NvbM5HArY8B9Jr09Pw6yLVHWmhP/Oi9o9l/OtNPOiyisuBIDx3RCkM1lYfKu88O2Sy40XsHQ4v6gMHBuT7Lo6HsJxGdGLw/k6HO9GFocHBN2kQUeg2dE7rPg6GWqk9G0cvQRWmq11W19AXf4n35Mry5Sl3Z/HgRSrtujOffKmckbG@29do2PP7uYoHXgdXeuoaX/MiUCCEuwLeX4ell@O4yfI/w7h8" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/TryItOnline/TioSetup/wiki/Powershell" rel="nofollow noreferrer">PowerShell</a> 6+ for Windows, 162 bytes</h1>



<pre class="lang-powershell prettyprint-override"><code>$f={param($m,$l)++$l
1..4|%{switch -r($m){'@#'{$l}'@ *[#^]'{&amp;$f($m-replace'@.','x@')$l}}$m=&amp;{($a=$m[-1..-$m.Count])[0]|% t*y|%{-join($a|% Ch*($i++))}}}|sort -t 1}
</code></pre>

<p><a href="https://tio.run/##fVLLboMwELz7K1ZhU@PwUCK1h1ZCQspnRHGFUkdJZQIFotAC305tnubQmgPMjndndkSaPESWX4SUbYvnoEqjLIptjF2UzHFQkp3vP9frKn9ci9MFvExxrKKhRSuUDQ1hc7D4kVZPeFaMl4lURidBQ5@6tAwpU5cajIOnysYowPjgqXkexv4@ud@KIztsj/Uais23kvA@k@tNXVOF/WVj49VxGGuaps6TrACvgF3ThjYhrr17cQktp0MVCnkJ6vAelbz7HDj9Bl2yOgQawcgB14/CI6dYhelSgXWyr4viJMUXGDoj@oxyvDdQLiSgXFrlhtlwIYu3u5SGsr5l6f7JJp8X1x8wT9KjBvNb03wXWe@SG7bmGLjJgLkd/6NH52gkZ/2zwdANwM2owVxOOxvm9tlMYWnO6IF5mp63zFDLM6hhDRUhKMpUnArx4QLG0Y@AAPCdYCbyuywUUL9wT5AV2mPZE18wNbI3GOor0rS/" rel="nofollow noreferrer" title="PowerShell – Try It Online">Try it online!</a></p>

<p>Unrolled:</p>

<pre class="lang-powershell prettyprint-override"><code>$f = {
    param($maze,$len)   # len = $null if parm omited

    ++$len
    1..4|%{
        #recursive call
        switch -Regex ($maze){
            '@#'{$len}
            '@ *[#^]'{
                &amp;$f ($maze -replace '@.','x@') $len   # leave a wall behind to avoid infinite loops
            }
        }
        #rotate -90
        $maze = &amp;{  # new context to reinit $array and $i
            $array=$maze[-1..-$maze.Count]
            $array[0]|% toCharArray|%{
                -join($array|% Chars($i++))
            }
        }
    }|sort -Top 1          # Powershell 6+ for Windows
#   }|sort|select -First 1 # Powershell 5- for Windows
#   }|sort-object -Top 1   # Powershell for Linux
}
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>, 238 bytes</h1>



<pre class="lang-perl prettyprint-override"><code>sub f{%s=@_=(1,pop);while(@_){$i=shift;$m=shift;for(1..4){@a=$m=~/.+/g;!$s{$m=join$/,reverse map{$j=$_-1;join'',map/.{$j}(.)/?$1:0,@a}1..length$a[0]}++&amp;&amp;push@_,$i,$m};$_=$m;s/@( *[\^#])/'x@'.substr$1,1/e&amp;&amp;(/#/||return$i)&amp;&amp;push@_,$i+1,$_}}
</code></pre>

<p><a href="https://tio.run/##ZVLbcpswEH3nK9SgGlSryHTqh5pRqh/oW9/SiHFT2VbGGAbhlgyhv@7uCozJVDDS7tnLOSuoTH1cXy7u/JPsuvdOqlzGKa/KimV/DvZoYpWzjlrpDnbXZLQYjV1Zx2mSfGad2kpA/4pkKfbZO@o68J5Le6KC1@a3qZ0hxbbq6LOk@cc0w1AUcYBEAmAfJ0x8pelmxdW2h45Hc9o3B7p9WD32y@ViUZ3dQeWcWk6LPqM5kGVOqJh8ePihw0cmolZFCch3TU1TngqzWMQiFK@vtWnO9YlaNmuyTDnN@/5yBlXfjWs2m29lbUgDppP36ywoXhQ6Mg6idlqB0i2BpcFstT8RxY2gHwZwwks8SjQ@4HgUcHCCW7OIyHuSrvmcYOirbw7xfLh8bz1QtbeWpJ1p0Vc16g3HlxlHEGLJoESPk@BOxkos9VWrubBADSL0lXicSk8YmQTr//LwHq7DhzNdbylwGD3dEZnEIi82GcYbhkX0mkfGWqyeTT8MESDOsmD8hfGTss6DxUtM7ani1LQVk6462ifj43zFP2VjCt2Xjdz5RDZg1sUI@jJ@BxZBFwLgm6fG/CIYuYPs/vIP" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>

<p>Rotates the maze 90° four times at each position. Easier to regexp-search-replace the entire maze as one string for <code>@ +[^#]</code> with <code>x@</code> + one less space when the next light or end is always ahead if at all. <code>@^</code> and <code>@#</code> with no space are replaced by <code>x@</code> so the <code>#</code> disappears which means the exit has been reached and we return <code>$i</code> steps taken. Array <code>@_</code> contains mazes to try out next. Hash <code>%s</code> keeps track of which mazes we've already tried so those are skiped. Nothing left to try in <code>@_</code> means no solution is to be found and <code>0</code> is returned.</p>
</div>
<div id="pu3" class="pu"><h1>JavaScript (ES6), <s> 196 ... 179 </s> 177 bytes</h1>
<p>Takes input as a matrix of characters. Returns <span class="math-container">\$0\$</span> if there's no solution.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;(o=F=(X,Y,n)=&gt;m.map((r,y)=&gt;r.map((c,x)=&gt;n?(h=x-X)*h+(v=y-Y)*v-1?0:c=='#'?o=o&lt;n?o:n:r[(g=w=&gt;1/(C=m[z+=v][w])?g(w+h):C&lt;g)(x,z=Y)&amp;&amp;F(x,y,n+1,r[x]=g),x]=c:c=='@'&amp;&amp;F(x,y,1))))()|o
</code></pre>
<p><a href="https://tio.run/##lVJhi4JAEP3urxgSajdX7/wqTQZBv6EQF8IrvSPdsMO2uP/u7SYd6S5cjSDO23HmzXv7tW22p6z@PH77lfjYtXtsS5wTgSska7ZhFcV5GZTbIyE1u6ik7pKMSZVUMSlQ@ms6LTzS4MXf0Gnjh/F7lCFO3EksUMyqWERVVCckxzPOwzeyxDK5etikyTmlcU7OXkGj5SynRLIrbuh4vFJfF1Z5IasTmWJOmXpnt6aLyf04pCoI/RFtJqqTOOyCg8jJniQOQBIEwUj@xShld3DBJajgPVDyG9Kv1CnoE/cRBA3CoBK4fhQ8qFS1Ch70vFNyUkod51/uQ6LcBsNtKR0DsrzbQtqYgbSKwE0ZFq@Rfvjb1VOGGnBDf52DMVbPfVanR4s7Jbi5s@EQt9SBRV3@VD99C0zD3Zf87s0A4JYLBBaN9cJ9Lp2RQ4N1pdkPjLl6svUWdHu0vw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>How?</h3>
<p>This is a depth-first search. We first look for the position of the player and then initiate the recursion. We keep track of the number of moves in <span class="math-container">\$n\$</span> and the length of the shortest path in <span class="math-container">\$o\$</span>.</p>
<p>Given the previous position <span class="math-container">\$(X,Y)\$</span>, we iterate on all cells <span class="math-container">\$(x,y)\$</span> of the maze and compute <span class="math-container">\$dx=x-X\$</span> and <span class="math-container">\$dy=y-Y\$</span>. We can move to the new cell if:</p>
<ul>
<li><span class="math-container">\$dx^2+dy^2=1\$</span></li>
<li>and the first non-empty cell encountered along the ray <span class="math-container">\$(X+k\cdot dx,Y+k\cdot dy),k&gt;0\$</span> is either a candle or the exit</li>
</ul>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt; (                           // m[] = input matrix
  o =                            // o = output, initially non-numeric
  F = (X, Y, n) =&gt;               // F is the main recursive function:
    m.map((r, y) =&gt;              //   for each row r[] at position y in m[]:
      r.map((c, x) =&gt;            //     for each character c at position x in r[]:
        n ?                      //       if n is defined:
          (h = x - X) * h +      //         h = dx, v = dy
          (v = y - Y) * v - 1 ?  //         if the quadrance is not equal to 1:
            0                    //           abort
          :                      //         else:
            c == '#' ?           //           if we've reached the exit:
              o = o &lt; n ? o : n  //             update o if n is better
            :                    //           else:
              r[                 //             wrapper to update r[]:
                ( g =            //               we use g to look for a candle
                  w =&gt;           //               or the exit in this direction:
                  1 / (C =       //                 move along (dx, dy) and store
                    m[z += v][w] //                 the content of the cell in C
                  ) ?            //                 if C is a space:
                    g(w + h)     //                   keep moving until it's not
                  :              //                 else:
                    C &lt; g        //                   success if C is not 'x'
                )(x, z = Y)      //               initial call to g at (X, Y)
                &amp;&amp;               //               if the move is valid:
                  F(             //                 do a recursive call:
                    x, y, n + 1, //                   at (x, y) with n + 1
                    r[x] = g     //                   invalidate the current cell
                  ),             //                 end of recursive call
                x                //               actual index in r[] ...
              ] = c              //             ... to restore the cell
        :                        //       else (n undefined):
          c == '@' &amp;&amp; F(x, y, 1) //         initiate the recursion if c is '@'
    ))                           //   end of map() loops
)() | o                          // initial call to F; return o
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language/a950ad7d925ec9316e3e2fb2cf5d49fd15d23e3d" rel="noreferrer">Retina 0.8.2</a>, 229 bytes</h1>

<pre><code>T`#^`d
s`@.*
$&amp;_
@\d|@ ( *\d)
@=$1
(\d *) @|\d@
$1=@
m`^(((.))*@.*\n(?&lt;-2&gt;.)*(?(2)$))(\d| ((.*\n)+(?&lt;-3&gt;.)*(?(3)$)\d))
$1=$5
m`^(((.))*)(\d|(\d(.*\n)+(?&lt;-2&gt;.)*(?(2)$)) )(.*\n(?&lt;-3&gt;.)*(?(3)$)@)
$1$5=$7
@
x
}sT`=`@`.*0.*
s`.*0.*

_
</code></pre>

<p><a href="https://tio.run/##VY@xCsIwEIb3e4oDg9xFLNpSXKy9h3AMMUIcHOxgHTrUZ6@XErEehOTnz/eFPG@ve3edpnNY@RChD1JYMOsLiIujIKF1kUEaswdyES2jjC4KmH0j8AieiApmq5TrqD1uy1PBlloq2TArMaJe0I43qa1yW2mrXk4aUy88M6JrwfwZken70tIlyWTqxhxAYIB3fw5NkFDYnf6mzztcpmlYDAwe/S/ggHlWKcwN5iYdETMzQ34OOvIVfAA" rel="noreferrer" title="Retina 0.8.2 – Try It Online">Try it online!</a> Outputs <code>0</code> for unsolvable, since solutions must take at least one step. Explanation:</p>

<pre><code>T`#^`d
</code></pre>

<p>Change the candle and exit to golfier characters, saving 7 bytes</p>

<pre><code>s`@.*
$&amp;_
</code></pre>

<p>If there are still squares to check, then increment the counter. (This allows the loop to terminate once it runs out of squares to check.)</p>

<pre><code>@\d|@ ( *\d)
@=$1
</code></pre>

<p>Mark the square to the right if it is lit.</p>

<pre><code>(\d *) @|\d@
$1=@
</code></pre>

<p>Mark the square to the left if it is lit.</p>

<pre><code>m`^(((.))*@.*\n(?&lt;-2&gt;.)*(?(2)$))(\d| ((.*\n)+(?&lt;-3&gt;.)*(?(3)$)\d))
$1=$5
</code></pre>

<p>Mark the square below if it is lit.</p>

<pre><code>m`^(((.))*)(\d|(\d(.*\n)+(?&lt;-2&gt;.)*(?(2)$)) )(.*\n(?&lt;-3&gt;.)*(?(3)$)@)
$1$5=$7
</code></pre>

<p>Mark the square above if it is lit.</p>

<pre><code>@
x
</code></pre>

<p>Turn the squares that were checked into walls.</p>

<pre><code>sT`=`@`.*0.*
</code></pre>

<p>If the exit still exists, then turn all of the marked squares into squares that need to be checked.</p>

<pre><code>}`
</code></pre>

<p>Repeat the above until the exit is reached or no new steps could be taken.</p>

<pre><code>s`.*0.*
</code></pre>

<p>If the exit was not reached then delete the count.</p>

<pre><code>_
</code></pre>

<p>Convert the count to decimal and delete the input.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/204124/">204124</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




