<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::266004</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>264</td><td>JavaScript</td><td>231016T091825Z</td><td><a href="https://codegolf.stackexchange.com/questions/266004/is-it-a-valid-crossword-grid/266024#266024">tsh</a></td></tr>
<tr d-ix="1"><td>9593</td><td>J</td><td>231016T063103Z</td><td><a href="https://codegolf.stackexchange.com/questions/266004/is-it-a-valid-crossword-grid/266020#266020">Jonah</a></td></tr>
<tr d-ix="2"><td>562</td><td>Python3</td><td>231015T215802Z</td><td><a href="https://codegolf.stackexchange.com/questions/266004/is-it-a-valid-crossword-grid/266010#266010">Ajax1234</a></td></tr>
<tr d-ix="3"><td>186</td><td>Retina 0.8.2</td><td>231015T231022Z</td><td><a href="https://codegolf.stackexchange.com/questions/266004/is-it-a-valid-crossword-grid/266013#266013">Neil</a></td></tr>
<tr d-ix="4"><td>067</td><td>Charcoal</td><td>231015T225127Z</td><td><a href="https://codegolf.stackexchange.com/questions/266004/is-it-a-valid-crossword-grid/266011#266011">Neil</a></td></tr>
<tr d-ix="5"><td>040</td><td>Jelly</td><td>231015T202544Z</td><td><a href="https://codegolf.stackexchange.com/questions/266004/is-it-a-valid-crossword-grid/266007#266007">Jonathan</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript, 264 bytes</h1>
<pre class="lang-javascript prettyprint-override"><code>a=&gt;new Set(a.map((r,y)=&gt;[r.map(e=(c,x)=&gt;!c||[(m=(s,t,v=a[t])=&gt;v&amp;&amp;''+v!=s?(b=v=&gt;v[0][1]?v:b(v[0]))(s)[0]=v:s)(m(a[p=[x,y]]=[0+p],[x-1,y]),[x,y-1]),e=a.at(~y).at(~x),a[y-1]?.[x]||a[y+1]?.[x]&amp;&amp;a[y+2]?.[x],r[x-1]||r[x+1]&amp;&amp;r[x+2]]),e,a.some(r=&gt;r[y])]).flat(1/0)).size&lt;3
</code></pre>
<p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-js lang-js prettyprint-override"><code>f=
a=&gt;new Set(a.map((r,y)=&gt;[r.map(e=(c,x)=&gt;!c||[(m=(s,t,v=a[t])=&gt;v&amp;&amp;''+v!=s?(b=v=&gt;v[0][1]?v:b(v[0]))(s)[0]=v:s)(m(a[p=[x,y]]=[0+p],[x-1,y]),[x,y-1]),e=a.at(~y).at(~x),a[y-1]?.[x]||a[y+1]?.[x]&amp;&amp;a[y+2]?.[x],r[x-1]||r[x+1]&amp;&amp;r[x+2]]),e,a.some(r=&gt;r[y])]).flat(1/0)).size&lt;3

const parse = (s, n = s.length ** .5) =&gt; [...Array(n)].map((_, i) =&gt; [...s.slice(i * n, (i + 1) * n)].map(v =&gt; v === '.'));
const testcases = `
......... True
#..............# True
...#........#... True
...#........#... True
......................... True
##...#.............#...## True
................................................. True
........................#........................ True
....###.....##......##.....##......##.....###.... True
................................................................ True
##....####....##...........##......##...........##....####....## True
...##.......#...........##.....##.....##...........#.......##... True
#............... False
#...#......#...# False
#..##..##..##..# False
#........................ False
.......#...###...#....... False
######....#....#....#.... False
######...##...##...###### False
...#......#......#......#......#......#......#... False
.................###....#....###................. False
...#......#...............##..................... False
....#.......#.......#........######........#.......#.......#.... False
..#.........#.......#......##......#.......#.......#.........#.. False
.#......#..............................................#......#. False
...........................##......#............................ False
####............................................................ False
#......##......##......##......##......##......##......##......# False
`.trim().split('\n').map(r =&gt; [parse(r.split(' ')[0]), r.endsWith('True')])

testcases.forEach(([i, e]) =&gt; {
  console.log(f(i), e);
});</code></pre>
</div>
</div>
</p>
<p>Input boolean matrix, output true or false.</p>
<pre class="lang-javascript prettyprint-override"><code>a=&gt;new Set(
  a.map((r,y)=&gt;[
    r.map(e=(c,x)=&gt;!c||[ // for each cell, which is either empty or
      // generate an unique symbol for its connected area
      (m=(s,t,v=a[t])=&gt;v&amp;&amp;''+v!=s?(b=v=&gt;v[0][1]?v:b(v[0]))(s)[0]=v:s)(m(a[p=[x,y]]=[0+p],[x-1,y]),[x,y-1]),
      // its 180 rotated position is non-empty
      e=a.at(~y).at(~x),
      // its ^ cell is non-empty or its v and vv cells are non-empty
      a[y-1]?.[x]||a[y+1]?.[x]&amp;&amp;a[y+2]?.[x],
      // its &lt; cell is non-empty or its &gt; and &gt;&gt; cells are non-empty
      r[x-1]||r[x+1]&amp;&amp;r[x+2]
    ]),
    // at least one non-empty cell this row
    e,
    // at least one non-empty cell this column
    a.some(r=&gt;r[y])
  ]).flat(1/0)
).size&lt;3 // if every non-empty cell connected, they have same symbol (count as 1)
         // if all other condition holds, they will be all true (count as 1)
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.jsoftware.com" rel="nofollow noreferrer">J</a>, <sup>95</sup> 93 bytes</h1>
<pre><code>((*/@(2&lt;*#])@(#;._2)*0&lt;+/)&quot;1@,.&amp;0@,|:)*/@,(-:|.&quot;1@|.),&amp;,[:(]+.+./ .*)^:_~1=[:|@-/~$j./@#:I.@,
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=lVRRS8MwEH7ypb8i27ml6drrtgdxcYWAMBB8Et9qHSJuYwiCbg9C2R_xZT74h3ybv8ZK1jaJTdcdJNfkvnx3l7v043O53XVGLT5Izlp8RKnTRjojESeU-KRPeDYCJJc315Ov9WoWnO8S1_VC4Q7HHiRMuHCB0yHz-uNeyNoD4WO3L_yUswzjuwFPMdtMkfldP-Zu0sMehgQ9ds-nm0EU81QE4eZ0iaEAfoXCl05-Tr6ZM4-QxJzMSCA6XABJ7ghF2o2cp8fFC6G3r-vV4p06cjnPbLnQYgtQE6AquDCCdqbWYjpAmygxgMpY0AI0YDnMbkOAzaAfBZDAvULbEpp5PT5-yQyQazUFPQh1UeL1uuXIChojMw0Gss77xpo8PL-pfWVepdZeoA5r41UdVmIArUfUyykS1acKiDr9SVVDN1Q1ddbCgf9Z1nhVOBrcjFnJ8kkWd2KFqUylLwMKUMOQfylMlmQOSHGq0dsxY6oUvfbHhWNlMvwfq0smnVPJB6j8tW-3Uv8C" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p><em>-2 thanks to Neil's idea of catting transpose with input instead of using over</em></p>
<p>Takes input as a 0-1 matrix, where 1 means empty space.</p>
</div>
<div id="pu2" class="pu"><h1>Python3, 562 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def g(b,B):
 q=[(x,y)for x,y in B if b[x][y]=='.']
 Q=[q.pop(0)];S=[Q[0]]
 for x,y in Q:
  for X,Y in[(1,0),(-1,0),(0,-1),(0,1)]:
   u=(x+X,y+Y)
   if u in B and u not in S and'.'==b[x+X][y+Y]:Q+=[u];S+=[u]
 return not{*q}-{*S}
F=lambda x,l,c=0,k=0:k if not x else F(x[1:],l,(T:=c+(x[0]==l))*(x[0]==l),max(k,T))
def f(n,b):
 B=[(x,y)for x,r in E(b)for y,_ in E(r)]
 D=[(x,y)for x,y in B if'#'==b[x][y]]
 return all((n-x-1,n-y-1)in D for x,y in D)and g(b,B)and all(F(i,'.')&gt;2and F(i,'#')&lt;n for i in b)and all(F(i,'.')&gt;2and F(i,'#')&lt;n for i in zip(*b))
</code></pre>
<p><a href="https://tio.run/##pVZbb9owFH5efoVXS4sNDiKdJlV03kPV8jgJgbZWWdQmYGjU4FAnWWFtfzs7ThRIINxUS2Af51y@8/n4Mlskj5H8ejFTy@UNFzKdCuUlwhiJMZoQn13RjoGeuUPmbEHHkULQo0CiKxSMke/MXWfhcm62TNdAPe48t2bRjLSpe9nnTs9puzBdsuqBs0y@ZXcgO8RmbcqIlXdtZtlZZ1NXK6KUk3nzli2ad1SLEDHNY3tyBEMZJVrsaxEQcA54mreAqHnndnpN7qQAI@sMpESSKqlNXhvP79Zro/9udHnoTf2RB@hCNuRt9sTbnScdRnueIxHGAnXJ3LE7LmiQQYcPmyC2IeOQ0sZqyKbenDyxAaUZb2Mima95u6rwpjTYG@Jn4oLd56KigO66nmAT50lpktc5eGFIiLTmwJq0FkAZaF@XWb6mmp989fRIG3RJwIAj@uNcz2QSNul3mdkF2so/QfdfMCMNn9KlTjeJ7v3IUyMSQ86fJA9kQkIhQWw0Wt/oZUE9c2In6ARN6a78KE9OBCx4rs4kcGEMbvoDxNHZ2Znx0Craw9tApeLtlxcGkJkKRsYDblUarlHR06vv9V6OU9kLAq@tAUTXg6qpt99sdf5wGdDaL96H69h2gg98og@McwtckLFDxCfi@EBqeSyMi76cXRVWWVjr7ygWXMNQNduq17LK4SpuFQX0M0L2RRuNxEQJgeLFdCoStcj0cflX6J9boUgSoZCQiQpEzNA4CEMxsmCXDaMwncp4O9jRUSulWC7RwtAuwusTw97AotdixWv1b3/g7STQF6Sil5LD8p9uhcPuZva5ZVze8Ud2hcvfj0EC2J5TT4k4uyKGkUyCSRqlNXTX1HSFAox3rsI2f1u4tkp574JatQu6Wcm4hLMEr1btGE50FNza4QbjPd6LUW11nW@zgw8cWnvPOLyTd4ZeDqS32/cxkA4tEsYYf@xQPOC//jQ8ut@51wx9eRvG6pqHvQG0kp@RFAzp@70Vz8IgIeYfaVL9aPCYD@8hjoLiw5tJYTaOhUrgOdVYPTE8eItZtksp4hyJv14IzynDmCn95jATEScxmmmz0WeTLv8D" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language/a950ad7d925ec9316e3e2fb2cf5d49fd15d23e3d" rel="nofollow noreferrer">Retina 0.8.2</a>, 186 bytes</h1>
<pre><code>\.
-
s`^(?!(.)+.?(?&lt;-1&gt;\1)+$(?(1)^)).+

ms`.*^#+$.*|.*(?&lt;!-)--?(?!-).*

O$`.
$.%`
ms`.*^#+$.*|.*(?&lt;!-)--?(?!-).*

1`-
@
+m`^((.)*)(@|-)(.*¶(?&lt;-2&gt;.)*(?(2)(?!)))?(?!\3)[@-]
$1@$4@
^[¶#@]+$
</code></pre>
<p><a href="https://tio.run/##hY0xDsIwDEV336JKkOJEtpTCiJrcgAO0jcLAwAADZey5eoBeLDhQxIgH@@v7f73H5Xm9n0sZGAimnExoDKPjYMKRfDd4dNoE4zEhsgO4TZltUk6zndlKqCEkkrRctgAnnRk07/LfpM8EEdxNmEK0aOJMaNiuS0W3nXgCblEKiFh7wx77SCNoH/UhQurXRcXR6VKYWSlZwFV9RR14@2LCdtXvtWU/oqoX" rel="nofollow noreferrer" title="Retina 0.8.2 – Try It Online">Try it online!</a> Takes input as a square array and outputs <code>1</code> for valid, <code>0</code> for invalid. Explanation:</p>
<pre><code>\.
-
</code></pre>
<p>Change <code>.</code>s to <code>-</code>s are they're easier to match.</p>
<pre><code>s`^(?!(.)+.?(?&lt;-1&gt;\1)+$(?(1)^)).+

</code></pre>
<p>Delete everything if it isn't rotationally symmetric.</p>
<pre><code>ms`.*^#+$.*|.*(?&lt;!-)--?(?!-).*

</code></pre>
<p>Delete everything if there is a row of <code>#</code>s or if there are one or two <code>-</code>s on their own.</p>
<pre><code>O$`.
$.%`
</code></pre>
<p>Transpose the array.</p>
<pre><code>ms`.*^#+$.*|.*(?&lt;!-)--?(?!-).*

</code></pre>
<p>Check the transpose for a row of <code>#</code>s or one or two <code>-</code>s on their own.</p>
<pre><code>1`-
@
</code></pre>
<p>Change one <code>-</code> to a <code>@</code>.</p>
<pre><code>+m`^((.)*)(@|-)(.*¶(?&lt;-2&gt;.)*(?(2)(?!)))?(?!\3)[@-]
$1@$4@
</code></pre>
<p>Flood fill <code>-</code>s with <code>@</code>s.</p>
<pre><code>^[¶#@]+$
</code></pre>
<p>Check that all of the <code>-</code>s were filled.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 67 bytes</h1>
<pre><code>Ｆθ⊞υＳ¿⁼υＥ⮌υ⮌ι¿⬤⁺υＥθ⭆θ§λκ∧№ι.⬤⪪ι#÷⊖Ｌλ²«Ｅυ⭆ι⎇⁼λ.ψλＪ⌕θ.⁰¤.¿‹ＬＫＡＬΣυ⎚«⎚¹
</code></pre>
<p><a href="https://tio.run/##TZDLbsIwEEXX8VdYZDOW0qjtlhXiIaWiUlT4gSgZwGLiJI6Niiq@PfVAUuqFfX3ndezyVNiyKWgYDo2V0CmZ@/4EPpGZab3bOavNEZSaC32QsO58QT1HP4sWvvCCtkfwKpGT1iosybkLIsjJ/2V3iXx0Gy8Ll5kKv4ESeeai4JgKlo03DnQiZ@mMrdBk15J@WDFbmXErfdEVwgpLizUahxVs0RzdCYj7vKs7xI@I8jDPAQ/0/6eHXnu0prDX6UU0Dbwmkrh6LqIPX7f7BjY6YHVT/JUjGx2w@B40P3WLfT8R5IhnpmaQ0dr5OvwRIy0JCwtchtQjE0ZPa6R9Y30Tt2FI0zSOwyZSVpPgJe5@MMV4xs/QmPsQrIaXC/0C" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes input as a square array of strings and outputs a Charcoal boolean, i.e. <code>-</code> for valid, nothing if not. Explanation:</p>
<pre><code>Ｆθ⊞υＳ
</code></pre>
<p>Input the square array.</p>
<pre><code>¿⁼υＥ⮌υ⮌ι
</code></pre>
<p>Check that it's rotationally symmetric.</p>
<pre><code>¿⬤⁺υＥθ⭆θ§λκ∧№ι.⬤⪪ι#÷⊖Ｌλ²«
</code></pre>
<p>Concatenate the array with its transpose and check that each row contains a <code>.</code> but when split on <code>#</code>s does not contain runs of exactly <code>1</code> or <code>2</code> <code>.</code>s.</p>
<pre><code>Ｅυ⭆ι⎇⁼λ.ψλ
</code></pre>
<p>Write just the <code>#</code>s from the array to the canvas.</p>
<pre><code>Ｊ⌕θ.⁰
</code></pre>
<p>Jump to a position where there should be a <code>.</code>.</p>
<pre><code>¤.
</code></pre>
<p>Fill the canvas with <code>.</code>s starting from here.</p>
<pre><code>¿‹ＬＫＡＬΣυ⎚
</code></pre>
<p>If this didn't fill all of the original <code>.</code>s then just clear the canvas.</p>
<pre><code>«⎚¹
</code></pre>
<p>If all of the <code>.</code>s were connected then clear the canvas and output <code>-</code>.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 40 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>;ZµŒg§’:2;§Ȧ
ŒṪḣ1ạ§ỊẸʋƇ@;QɗƬƊṪṢƊƑȧÇȧU⁼ṚƊ
</code></pre>
<p>A monadic Link that accepts a list of lists of <code>1</code>s (white) and <code>0</code>s (black) that yields <code>1</code> if valid or <code>0</code> if not.</p>
<p><strong><a href="https://tio.run/##y0rNyan8/9866tDWo5PSDy1/1DDTysj60PITy7iOTnq4c9XDHYsNH@5aeGj5w91dD3ftONV9rN3BOvDk9GNrjnWBpHcuOtZ1bOKJ5YfbTywPfdS45@HOWce6/j/cvcX/4Y6mQ2sOt///r6ysBwTKylwIhh4EcIG56AywIi4MXQA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> Or see the <a href="https://tio.run/##pVKxTsMwEN3vNx4LSyQYm4UPQEIMLOwVEurGxAYMRAoTXRBspRKWqo5USlpYHNUK/IX7I4YQ6tip7UbqSb7L@e7dPV/usj8YXCsVn/PZcnjB2ermuXcYc1a@0XIo84nMxgdyPuJMLlI5z74fRHIUn349ialIq3D@KlLxWLIiKdnZ6vZD5i8iVXLxzmdXx8U9/9w7kdkdnxbJvlKILAFVSnu/x3lRC0U@IcCEaSzgx3hr@QIIIoA6/m8in4vwS7qSrOsAa2vytFuaTpNPZoID3aJvpf1dEjYo1RF9CNtGDD0RNO/SHG3VRExVibExHc3m@K2egJMx3GsABJaiPTmjn9HGmUZmq1YGEACuv8jHeItoVGhL0aU2AcBua@5e6c6WYP84/AA" rel="nofollow noreferrer" title="Jelly – Try It Online">test-suite</a>.</p>
<h3>How?</h3>
<pre><code>;ZµŒg§’:2;§Ȧ - Link 1 (check entry lengths &amp; presence): list of lists of 1/0, Grid
;Z           - concatenate the columns
  µ          - start a new monadic chain - f(rows + columns)
   Œg        - group runs of equal elements of each row/column
     §       - sums of each run
      ’      - decrement (i.e... all black: -1, 1:0, 2:1, 3:2, 4:3, 5: 4, ...)
       :2    - integer divide by two        -1    0    0    1,   1,    2, ...
          §  - {rows + columns} sums
         ;   - concatenate
           Ȧ - any and all?
                -&gt; 0 if either an entry of length 1 or 2 exists, or
                               any row or column has no entry
                   else 1

ŒṪḣ1ạ§ỊẸʋƇ@;QɗƬƊṪṢƊƑȧÇȧU⁼ṚƊ - Main Link: list of lists of 1/0, Grid
ŒṪ                         - multidimensional truthy indices
                  Ƒ        - is invariant under:
                 Ɗ         -   last three links as a monad:
               Ɗ           -     last three links as a monad:
   1                       -       one
  ḣ                        -       head to index - i.e. [firstPair] (initial &quot;Current&quot;)
              Ƭ            -       collect up while distinct, applying:
             ɗ             -         last three links as a dyad - i.e. f(Current, All):
          @                -           with swapped arguments - i.e. f(All, Current):
         Ƈ                 -             filter keep those (of All) for which:
        ʋ                  -               last four links as a dyad - i.e. f(All, Current):
    ạ                      -                 absolute difference (vectorises)
     §                     -                 sum each
      Ị                    -                 insignificant? (effectively &quot;in (0,1)?&quot;)
       Ẹ                   -                 any? - i.e. any are neighbours/same?
           ;               -           concatenate (the result with Current)
            Q              -           deduplicate (-&gt; Current for the next Ƭ-loop)
                Ṫ          -     tail
                 Ṣ         -     sort
                             -&gt; 1 if all whites (1s) are fully connected
                                else 0
                    Ç      - call link 1
                   ȧ       - logical AND
                         Ɗ - last thee links as a monad - f(Grid):
                      U    - {Grid} reverse each
                        Ṛ  - {Grid} reverse
                       ⁼   - equal? -&gt; 1 if 180 degree symmetry else 0
                     ȧ     - logical AND
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/266004/">266004</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




