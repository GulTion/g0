<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::275254</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>911</td><td>Python3</td><td>240830T173518Z</td><td><a href="https://codegolf.stackexchange.com/questions/275254/convert-to-chomsky-normal-form/275268#275268">Ajax1234</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 911 bytes</h1>
<pre class="lang-py prettyprint-override"><code>import string as S
from itertools import*
L=str.islower
H=lambda x:x.replace('S','T')
V=product
def P(T,G):
 q,s=[b for a,b in G if a==T],[]
 for i in q:
  if''==i:return 1
  for j in map(''.join,V(*[[t]if L(t)else[b for a,b in G if a==t]for t in i])):
   if j==''or not any({*k}=={*j}for k in s):q+=[j];s+=[j]
 return 0
def f(g):
 g=[(H(a),H(b))for a,b in g]
 s,d=[*{*S.ascii_uppercase}-{a for a,_ in g}-{'S'}],{}
 G,N=[],[]
 for a,b in g:
  if all(L(i)for i in b):G+=[(a,b)]
  else:
   n=''
   for i in b:
    if L(i):G+=[(t:=(d.get(i)or s.pop()),i)];d[i]=t;i=t
    n+=i
   N+=[(a,n)]
 for a,b in N:
  if len(b)&lt;3:G+=[(a,b)];continue
  G+=[(a,b[0]+(i:=s.pop()))];N+=[(i,b[1:])]
 K=[]
 G={*G}
 for a,b in G:
  if''!=b:K+=[(a,''.join(j))for j in V(*[[t]+['']*P(t,G)for t in b])]
 F,T=[],[*{*G,*K}]
 for a,b in T:
  if len(b)==1 and not L(b):T+=[(a,B)for A,B in T if A==b]
  else:F+=[(a,b)]
 return [('S','T')]+F
</code></pre>
<p><a href="https://tio.run/##lVTNbtswDD5XT8F1B0mOG7ToDoMzDXACNAVaFAUc9OIZhfyTTJlju7aCtcj8WHuNvVJHyU7qDAOGXWyT/PjxI0W5etFfy@LyY1W/vqpNVdYaGl2rYgWygYAs63IDSme1Lsu8gQ7hkFuBoLFq8vJ7VpNrkctNnEp49p7HdVblMskYDahLF5STB1HVZbpNNEmzJdyzhTvnHoEntxFhDMuyBunGoAqYg1qCFGIRuWFEbEQZ/xOiMUSpEMqrM72tC7hAlwGsDWAjK0bpeF2qwn1gThjqCJlumeZZ3mR/L6Ij49TGpSJuBJkasBaCUgwUpQZZvLCd860VYuesWwP/ZuAN955GIlxHk8a@CPSazm2DS7YybCsRsmsmuXvNYs4HAlaY0LipCJ2dE4xlkyj1uK2qrE5kk7VnO9mrfbRgdOAg28jdtQTm7p0I34azJ@zGAzLP2S1T/DC3mHtzVMgQxzEFzDBsnwX2aN5vSOsGOzTVZ2lPsHS8yjR6ENeMq7JinLuKR5M0VJHQEyW0zStGQpmPu65awY8F3vUC86zAWXy6HKiaJGWhVbHNELH3hufRiClP7CsiyhIrDF14kSG/EWYGczyXeXtUar5flXci9m46wn4z2Lo7Brsx/ZaMQkoj555pXMnDOsS2xJW7sLPGU5q7zk173NLiqCUhLnBZUrs0t2h7i67y1JL67tSmGLwvRHw4iqvB4fQrFB6uTTS6erWXLynzPEu0Kov99QNcM7nNdar6O5WqBu/cy@OqlpuNrFm9zTPcUnKSghiCWZNpTk66PsA2YqGIPEFxsQdpKKOxTFNsgpz0muiXop8gzpXuZAtnn2FH4Qf07pi3GIAhbTrGf8amYdw0jVykwl@KZn8KXbK@4W2QBpS7YC2g2D6eO7wPTCkTw2K/fvYk9Iw6H875PyiBykAOKOMgHlhJkAysI9wQdaQD@VAG8uAT8/FpbWOR09NTYkF@PEXHjMyM0cWm1u/jtz8jvmXq2jFJ/9cSsg/kzbrv2UD2rJdtvqc2wx8afYY/aNp/mzd5/Q0" rel="nofollow noreferrer">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/275254/">275254</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




