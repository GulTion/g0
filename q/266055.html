<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::266055</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>425</td><td>JavaScript Node.js</td><td>231018T064724Z</td><td><a href="https://codegolf.stackexchange.com/questions/266055/expand-emmet-html-abbreviations/266072#266072">tsh</a></td></tr>
<tr d-ix="1"><td>465</td><td>Retina</td><td>231017T222413Z</td><td><a href="https://codegolf.stackexchange.com/questions/266055/expand-emmet-html-abbreviations/266065#266065">Neil</a></td></tr>
<tr d-ix="2"><td>1152</td><td>Python3</td><td>231017T203235Z</td><td><a href="https://codegolf.stackexchange.com/questions/266055/expand-emmet-html-abbreviations/266061#266061">Ajax1234</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 425 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>i=&gt;(s=i.match(/\w+|&quot;[^&quot;]*&quot;|\{[^}]*\}|\S/g),S=_=&gt;L=s.shift()||&quot;&quot;,U=_=&gt;s.unshift(L)&amp;&amp;&quot;&quot;,T=v=&gt;S()==v?' ':U(),D=c=&gt;T`#`?' id='+S()+D(c):T`.`?D(c+(c&amp;&amp;' ')+S()):T`[`?A()+D(c):c&amp;&amp;` class=&quot;${c}&quot;`,A=_=&gt;T`]`?'':' '+S()+(T`=`?L+S():'=&quot;&quot;')+A(),W=_=&gt;S()[0]==&quot;{&quot;?L.slice(1,-1):U(),P=(r='',l=W()||(T`(`?P()+T`)`:T`^`?U():(r=`&lt;/${S()}&gt; `,` &lt;${L}${D('')}&gt;`+W())))=&gt;Array(T`*`?-~S():2).join(l+W()+(T`&gt;`&amp;&amp;P()+(T`^`&amp;&amp;U(L='+')))+r)+(T`+`&amp;&amp;P()))()
</code></pre>
<p><a href="https://tio.run/##fVTRbts2FH33V7BMYJGWIs/O@jC3lBA0D33wQ4o4yABbHhmJjtjSkipSdgJZ@/XsUlrabR1qGODVOeeee0le8LM4CJPWqrIXRZnJl0rURiL2olhEDFPhXtg0J9PN0T/h9RYnE3zatOttl0w23WlzO32kwS37g0VLZkKTq50l9HTCOLhzoAmbYgCXdDwGdMUOLLollLFD7CFvcUdocM1SFq34GQdEZczzgfevSUoXKx7yGCKfpOMxyKmjHLzm8dWrCCiOUi2MYfi8TTvMgytXe8UTcPQWkNc7khVnPF66eOExjMENPIJ7pwVs/UvCGG5xvAyNVqkks@BiRvsGbxipmecFmt27zYER4fENWK445dDNlscgW4CIv5@et2DWRYgHHL0/b5fdeXtNPA8g7kM6/Fh0VdfiGWwmPL740/Uzp@HnUhVEO4nrNOLj8c0QbiG8I0s4Fw@S/boH/YGnlNAXK41NhZEGMcRHmTpEjY60cpFf@Q@6TL98bUore8DRVWQqUfhy/yOy/Zl8@0@2rzF529cjuRSZrIe6k3kkqL8rQVRHlePPBtqZhZV4lC44GwRhf3GzYZkPy@XIZmurrJYMf5Ral@hY1jp7g1FaatcKu0y@S/Je8T/MK5aMqra3CdB979ONRKj2VVlbUdh1Xssdw7m1lVlMp8fjMXwuG9s8yDAt99Ojm/74wLJPx1@Pv90//p5@wkmbwoB8AZs@@fXTf2hzWctvcPRfvIraDw5BADXWlsWA@y2ybgOFVUUDsv7I1/1JJ3CWrXhIIcPtZDJv0Wx@6TIyuXst9L15@ST2lR4aV0Umn8Lc7nUs1glrZ924X@cd9L/KlUHwFwX6Owc1Bi4GlTsk3GwieAXEXsIFGYQhDyNVoKbWYTfioa3VntDQVFpZ4m0Kj74bfZtBeC8q8oRYhNoRcrsyJXSky0fyBLJ/I/1TA/gPBAAdfffyFw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>Following commented code based on a previous version:</p>
<pre class="lang-javascript prettyprint-override"><code>i=&gt;(
  // tokenize the input
  //   &lt;word&gt;: \w+
  //   &lt;string&gt;: &quot;[^&quot;]*&quot;
  //   &lt;text&gt;: \{[^}]*\}
  //   other operator: \S
  s=i.match(/\w+|&quot;[^&quot;]*&quot;|\{[^}]*\}|\S/g),
  // parse the input
  P())
// Get first token, the token is consumed
S=_=&gt;L=s.shift()||&quot;&quot;
// Undo last get, the token is placed back
U=_=&gt;s.unshift(L)&amp;&amp;&quot;&quot;
// Test if next token is given value
// Consume the token and return truthy whitespace string if match
// Or return falsy empty string if not match
T=v=&gt;S()==v?' ':U()
// P (whole program) ::= V &quot;+&quot; P | V &quot;&gt;&quot; P (lookahead != &quot;^&quot;) | V &quot;&gt;&quot; P &quot;^&quot; P | &lt;empty&gt;
// V (an HTML tag) ::= &lt;text&gt; | &quot;(&quot; P &quot;)&quot; | &lt;word&gt; D | V &quot;*&quot; &lt;word&gt;
P=(
  // right part
  r='',
  // left part
  l=
    W()|| // V -&gt; &lt;text&gt;
    (T`(`?P()+T`)`: // V -&gt; &quot;(&quot; P &quot;)&quot;
     T`^`?U(): // reduce
     (r=`&lt;/${S()}&gt; `,` &lt;${L}${D``}&gt;`+W())) // V -&gt; &lt;word&gt; D
)=&gt;
  T`+`?l+r+P(): // P -&gt; V &quot;+&quot; P
  T`&gt;`?l+P()+r+(T`^`&amp;&amp;P()): // P -&gt; V &quot;&gt;&quot; P [&quot;^&quot; P]?
  T`*`?Array(-~S()).join(P(r,l)): // V -&gt; V &quot;*&quot; &lt;word&gt;
  l+r // reduce
// D (all atributes) ::= &quot;#&quot; &lt;word&gt; | &quot;.&quot; &lt;word&gt; | &quot;[&quot; A | &lt;empty&gt;
D=c=&gt; // `c` is all class names collected yet
  T`#`?' id='+S()+D(c): // D -&gt; &quot;#&quot; &lt;word&gt; D
  T`.`?D(c+' '+S()): // D -&gt; &quot;.&quot; &lt;word&gt; D
  T`[`?A()+D(c): // D -&gt; &quot;[&quot; A D
  c+c&amp;&amp;` class=&quot;${c}&quot;` // reduce
// A (`[]` style attributes) ::= &lt;word&gt; A | &lt;word&gt; &quot;=&quot; &lt;word&gt; A | &lt;word&gt; &quot;=&quot; &lt;string&gt; A | &quot;]&quot;
A=_=&gt;
  T`]`?'': // &quot;]&quot;
  ' '+S()+(T`=`?L+S():'=&quot;&quot;')+A() // &lt;word&gt; [&quot;=&quot; (&lt;word&gt; | &lt;string&gt;)]? A
// W slice &lt;text&gt; to remove &quot;{}&quot; or return empty string if next token is not &lt;text&gt;
W=_=&gt;S()[0]==&quot;{&quot;?L.slice(1,-1):U()
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language" rel="nofollow noreferrer">Retina</a>, 465 bytes</h1>
<pre><code>\^+
$&amp;+
+`([^&gt;]+&gt;((\()|(?&lt;-3&gt;\))|(?(3)&gt;)|[^()&gt;])+(?(3)^))\^
($1)
\)|$
/$&amp;
{%`^( *[^()&gt;+]+)\*(\d+)(.*)
$2*$($1$3¶)
G`.
%`^(( *)((\()|(?&lt;-4&gt;\))|(?(4)[&gt;+])|[^()&gt;+])+(?(4)^))\+
$1/¶$2
%`^( *)(((\()|(?&lt;-4&gt;\))|(?(4)[&gt;+])|[^()&gt;+])+(?(4)^))\&gt;(.+)
$1$2¶  $1$5¶$1/$2
)%`^( *)\((.+)\)/$
$1$2
%`^( *)((/|())\w+)(.*?)(/)?$
$1&lt;$2&gt;$#4*$5$#6*$(&lt;/$2&gt;
&gt;#(\w+)
 id=&quot;$1&quot;&gt;
+`&gt;\.(\w+)
 class=&quot;$1&quot;&gt;
+`(class=&quot;.+)&quot; class=&quot;
$1 
]
 ]
+`&gt;\[(\w+)(=&quot;([^&quot;]*)&quot;|=([^ ]*))? 
 $1=&quot;$3$4&quot;&gt;[
[]{[]|}/?

</code></pre>
<p><a href="https://tio.run/##lZPNjpswFIX3fgpKPCMbtyBCUqnVYBZdTLezmkr8KAQ8AxoSKDGDKshr5QHyYum1SSZVW1XqytfnfvccX6K0Qpbb1D3dkPvVKUoYwrcMsRUJEx4zTkhE6EiCuw8ej6iqiEc5HcOEUB5Tpu8JpVGCCHYpiuiIkYNv0XCzSohhaY7FjEYWiXJGiW1RhOcWBhp7xwNF9ysbKRZgek1bXNIWNIT5cyCbEhc6EV7qOscDnqMpCqb/Z5wTm8FTXDw/HgwDziV4uQ7Y0bNfRBQSUQdr7BrjjAQMer1NQIlDA0Xc4TnHs4WFl3j2ERa8Ay@O@IwoEhll7pvYNTl8Wx7ZZzGr0t3uTSfnK6SalxYYGyhGRqznQj1HfBN@HjO2qDn6UBlQ0cBAsAV4eXhh8hCF8RDG494J0Amj4@GUl6@8q3hVIqhYw9ZVnb1872optKDaDd816ZaJzZ9K8i88@bWrM6ylojgpRJqLdsq15jyl7KkGqOWN6s@mtjKzm/RZqGI2AbZe352O@XR4SOahLGUlfPOrqKra6Ou2yt/Bt6or9RTfi69IoYm/dC5ajJpB27w3HrXPHqV2uWnqVqZbGRatePLNQspm99lx@r63f9Sd7NbCzuqN06cyK4JXP3/oF/2nx@dv2YMZD1lVZi9go4cvV7YeCtGKN5n/rjd8@KIUA6ROyno76WwwpFpgC//PTux/Ag" rel="nofollow noreferrer" title="Retina – Try It Online">Try it online!</a> Link includes test cases. Explanation:</p>
<pre><code>\^+
$&amp;+
</code></pre>
<p>Add a <code>+</code> after any <code>^</code>s.</p>
<pre><code>+`([^&gt;]+&gt;((\()|(?&lt;-3&gt;\))|(?(3)&gt;)|[^()&gt;])+(?(3)^))\^
($1)
</code></pre>
<p>Convert <code>^</code>s into the equivalent brackets.</p>
<pre><code>\)|$
/$&amp;
</code></pre>
<p>Innermost elements should be on a single line.</p>
<pre><code>{`
)`
</code></pre>
<p>Process as much as possible.</p>
<pre><code>%`^( *[^()&gt;+]+)\*(\d+)(.*)
$2*$($1$3¶)
G`.
</code></pre>
<p>Process multiplications.</p>
<pre><code>%`^(( *)((\()|(?&lt;-4&gt;\))|(?(4)[&gt;+])|[^()&gt;+])+(?(4)^))\+
$1/¶$2
</code></pre>
<p>Process siblings.</p>
<pre><code>%`^( *)(((\()|(?&lt;-4&gt;\))|(?(4)[&gt;+])|[^()&gt;+])+(?(4)^))\&gt;(.+)
$1$2¶  $1$5¶$1/$2
</code></pre>
<p>Process children, appending a closing tag after them.</p>
<pre><code>%`^( *)\((.+)\)/$
$1$2
</code></pre>
<p>Unwrap lines starting and ending in brackets.</p>
<pre><code>%`^( *)((/|())\w+)(.*?)(/)?$
$1&lt;$2&gt;$#4*$5$#6*$(&lt;/$2&gt;
</code></pre>
<p>Surround tags with <code>&lt;&gt;</code>s, removing attributes from closing tags, and add closing tags for single-line tags.</p>
<pre><code>&gt;#(\w+)
 id=&quot;$1&quot;&gt;
</code></pre>
<p>Process ids.</p>
<pre><code>+`&gt;\.(\w+)
 class=&quot;$1&quot;&gt;
+`(class=&quot;.+)&quot; class=&quot;
$1 
</code></pre>
<p>Process classes.</p>
<pre><code>]
 ]
+`&gt;\[(\w+)(=&quot;([^&quot;]*)&quot;|=([^ ]*))? 
 $1=&quot;$3$4&quot;&gt;[
</code></pre>
<p>Process attributes. I can do this on one line but it turns out to be a byte longer.</p>
<pre><code>[]{[]|}/?

</code></pre>
<p>Remove the remaining syntax.</p>
</div>
<div id="pu2" class="pu"><h1>Python3, 1152 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>import re
R=re.findall
def U(t):
 [N]=R('^\w+',t);n='&lt;'+N
 if(i:=R('(?&lt;=#)\w+',t)):n+=f' id=&quot;{i[0]}&quot;'
 if(c:=R('(?&lt;=\.)\w+',t)):n+=' class=&quot;'+' '.join(c)+'&quot;'
 if(a:=R('(?&lt;=\[)[^\]]+',t)):n+=' '+' '.join(i+'=&quot;&quot;'if'='not in i else re.sub('(?&lt;=\=)[^&quot;]+',lambda x:f'&quot;{x.group()}&quot;',i)for i in R('(?:\w+\=&quot;[^&quot;]+&quot;)+|(?:\w+\=[^\s\]]+)+|\w+',a[0]))
 e=''
 if(o:=re.findall('(?&lt;=\{)[^\}]+',t)):e=o[0]+' '
 return n+'&gt;'+e,f'&lt;/{N}&gt;'
F=lambda t,I:t if type(t)==list else '  '*I+''.join(U(t))
def f(s,I,c,l):
 if'('==s[0]:s.pop(0);t=[];f(s,I+1,t,[]);s.insert(0,t);
 t=s.pop(0)
 if')'!=t:
  if[]!=s:
   S=s.pop(0)
   if')'==S:c.append('  '*I+f'&lt;{t}&gt;&lt;/{t}&gt;')
   if'&gt;'==S:Q,W=U(t);C=[];c.append(T:=['  '*I+Q,C,'  '*I+W]);l.append(T);f(s,I+1,C,l)
   if'+'==S:C=[];f(s,I,C,l);c.append(F(t,I));c.extend(C)
   if'^'==S[0]:c.append(F(t,I));C=[];f(s,len(l)-len(S),C,l);l[-len(S)].extend(C)
   if'*'==S:x=s.pop(0);s.insert(0,t);C=[];f(s,I,C,l);c.extend(T:=[C for _ in range(int(x))])
  else:Q,W=U(t);c.append('  '*I+Q+W)
P=lambda x:'\n'.join(i if type(i)==str else P(i)for i in x)
def M(s):S=R('\&gt;|\+|\*|\+|\^+|\(|\)|[^(?:\&gt;\+\*\+\^\(\))]+',s);l,c=[],[];f(S,0,c,l);return P(c)
</code></pre>
<p><a href="https://tio.run/##nVVbb9s2GH3Xr2CUB5KmqrlNBwxyqD0YKJaHBkm9Ig@6DLJExVwZShXp1oXj356R1CVeA3jtHiRR5DlH53z8aLff9KaRF7@13dMTf2ibToOOeR9ox8Kay6oQwqtYDT4ijSMPJNcZ/YBgnn4lMNB4ISm8hOTaA7xGPLJL6PdLeo6HdRxJQmsIeEX9PU/m2cGHDltO2DT8FxiCUhRKUR8SCGD4d8MlKjGBA6945iU4ydMsO6YecTiB1PchryGFstGAS8ABE4qZdKHargcRakR8qyGKh3VVgF1UQ3@/C@@7ZtsibOwGHNdNZ8hGwX06MnZT6juej8njOGPcKOvHTLlAhYmLsQcYhb33Jjoq6vD9vQ1xGEMw2hiSDeEZm3rbSSAJjCFhQQ0vf9lfH2LovaODVx1cRSZYDfS3lpntoVRwpfuQEAA4uyJwqIbdPez2sUYquArKQNjdNNVBkFJlPhqpsG1aNMcLTZNs4WDkdaCDJMMLFXKpWKfR3O65BzQd0U4DwzOqjZwZJ9kZVXYIVkcY0KMoXUVlWLQtkxUaHJpce32ITThzhyM2dtjb4I5a54ultTQx/4xoMrBvg2UwDO@MTzFB8JRgaaIOqsSpLqd8bu1Z9x0yFcV2gu20nViOxNwSbZFeYCcxwSQS@JV9rHAvLJLhNXshOHNOdlOJvqvwS4uDgI2@BLYf/7L92BXyniEuNdphnFlxu/nPdfu@2LfkDns3dOp1mMrxuEx9xE0fKd31bXSDjrp/13fQe6RwtLLHMI0fU9PsM3fPzYUeU/yY5PZExClJZ@bKU5Qab6bBlalIUJpkgQu3CuauDRdDo9@YY/7UdjbMewQr/iXeilhwaPq2n4Wv4OztfHzrMaQla9GUnz5vG83@A2ol21i1hSTs4Wew@f/7RJ6vP5/Au3SzX08rxmjDiop1fS1mb@ICk7oxRrq4Pc0874nWUtgW98wOzntq6H5hX/ePN/3j4oSarhLNtWDU/4MJ0YCvTSeqMx@UjbBR6UX2I@SN4/4UZ0SfwrZ7ZyoAd87V4QS0CPv/t0LqZNOxmvqFqmpV@Nm@FLz8dJLrGCOQrPcb1rEfJ8QvCM760i4Cs7rVupEOArQtktRcbh386R8" rel="nofollow noreferrer">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/266055/">266055</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




