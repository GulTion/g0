<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::168807</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>011</td><td>Vyxal 3</td><td>240206T162333Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/269837#269837">pacman25</a></td></tr>
<tr d-ix="1"><td>024</td><td>MATL</td><td>180719T195339Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168907#168907">Sundar R</a></td></tr>
<tr d-ix="2"><td>024</td><td>K ngn/k</td><td>180718T185954Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168839#168839">ngn</a></td></tr>
<tr d-ix="3"><td>088</td><td>Kotlin</td><td>180726T061310Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/169274#169274">JohnWell</a></td></tr>
<tr d-ix="4"><td>066</td><td>Attache</td><td>180719T135002Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168870#168870">Conor O&</a></td></tr>
<tr d-ix="5"><td>108</td><td>R</td><td>180718T150316Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168820#168820">ngm</a></td></tr>
<tr d-ix="6"><td>075</td><td>JavaScript ES6</td><td>180718T144214Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168817#168817">Arnauld</a></td></tr>
<tr d-ix="7"><td>020</td><td>Jelly</td><td>180719T121216Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168866#168866">Jonathan</a></td></tr>
<tr d-ix="8"><td>027</td><td>APL Dyalog Classic</td><td>180718T152847Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168825#168825">ngn</a></td></tr>
<tr d-ix="9"><td>066</td><td>Python 2</td><td>180718T205243Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168850#168850">Chas Bro</a></td></tr>
<tr d-ix="10"><td>083</td><td>Clean</td><td>180718T235712Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168854#168854">Οurous</a></td></tr>
<tr d-ix="11"><td>105</td><td>Batch</td><td>180718T233949Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168853#168853">Neil</a></td></tr>
<tr d-ix="12"><td>074</td><td>Wolfram Language Mathematica</td><td>180718T154050Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168827#168827">JungHwan</a></td></tr>
<tr d-ix="13"><td>024</td><td>MATL</td><td>180718T190046Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168840#168840">Luis Men</a></td></tr>
<tr d-ix="14"><td>040</td><td>APL Dyalog Unicode</td><td>180718T133526Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168813#168813">Ad&#225;</a></td></tr>
<tr d-ix="15"><td>165</td><td>PHP</td><td>180718T150345Z</td><td><a href="https://codegolf.stackexchange.com/questions/168807/find-the-cells-neighbours/168821#168821">Night2</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-3" rel="nofollow noreferrer">Vyxal 3</a>, 11 bytes</h1>
<pre><code>Πʀ⁰hẆÞȮ1⁾¹i
</code></pre>
<p><a href="https://vyxal.github.io/latest.html#WyIiLCIiLCLOoMqA4oGwaOG6hsOeyK4x4oG+wrlpIiwiUyIsIls0LDRdXG42IiwiMy40LjEiXQ==" rel="nofollow noreferrer">Try it Online!</a></p>
<p>Output is sorted in footer but is not necessary to the program bytecount</p>
<p>input is of the form <code>[w,h], n</code></p>
</div>
<div id="pu1" class="pu"><h1>MATL, 24 bytes</h1>
<pre><code>X[h3Y6&amp;fh2-+1GX\1Gw!Z}X]
</code></pre>
<p><a href="https://matl.io/?code=X%5Bh3Y6%26fh2-%2B1GX%5C1Gw%21Z%7DX%5D&amp;inputs=%5B5+4%5D%0A2&amp;version=20.9.1" rel="nofollow noreferrer">Try it on MATL Online</a></p>
<p>Takes inputs <code>[w h]</code> and <code>i</code>. 8 bytes of this was <s>shamelessly stolen from</s> inspired by Luis Mendos' answer, though the overall approach is different.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://gitlab.com/n9n/k" rel="nofollow noreferrer">K (ngn/k)</a>, <s>27</s> 24 bytes</h1>

<pre><code>{x/x!''(x\y)-1-3\(!9)^4}
</code></pre>

<p><a href="https://tio.run/##VcxBDoIwEIXhvad4JCa0C7RDKQhzDXaAwQ3GYDBhVULw6rUILszs5nv5@2i4D851xWzPNghDYetJRhTpWgS5vCaLK4v5WE3vsehwguX21bNou9vjyZYnHmWzHMpKJEjYSFYgxEiQ4oIcpJqfKclkQDFIQ/tR5kdmV8O0aQrKoHzA@ED2VYLm2Kt/ru2tr3aiNavwd437AA" rel="nofollow noreferrer" title="K (ngn/k) – Try It Online">Try it online!</a></p>

<p><code>{</code> <code>}</code> is a function with arguments <code>x</code> (the dimensions <code>h w</code>) and <code>y</code> (the index <code>i</code>)</p>

<p><code>(!9)^4</code> is <code>0 1 2 3 4 5 6 7 8</code> without the <code>4</code></p>

<p><code>3\</code> encodes in ternary: <code>(0 0;0 1;0 2;1 0;1 2;2 0;2 1;2 2)</code></p>

<p><code>1-</code> subtracts from <code>1</code>, giving neighbour offsets: <code>(1 1;1 0;1 -1;0 1;0 -1;-1 1;-1 0;-1 -1)</code></p>

<p><code>x\y</code> is the base-<code>x</code> encoding of <code>y</code> - the coordinates of <code>y</code> in the matrix</p>

<p><code>-</code> subtracts each offset, giving us 8 pairs of neighbour coordinates</p>

<p><code>x!''</code> is mod <code>x</code> for each - wrap coordinates around to stay within the matrix</p>

<p><code>x/</code> decodes from base <code>x</code> - turns pairs of coordinates into single integers</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://kotlinlang.org" rel="nofollow noreferrer">Kotlin</a>, 88 bytes</h1>

<p>Uses zero based indexes and outputs an 8 element list.</p>

<pre><code>{h:Int,w:Int,i:Int-&gt;List(9){(w+i+it%3-1)%w+(h+i/w+it/3-1)%h*w}.filterIndexed{i,v-&gt;i!=4}}
</code></pre>

<p><a href="https://tio.run/##lVfbbtw2EH3XV4yNtNE6Wu3K9xi10SZoigJpAzR@6SNX4q7YSKRKUpENw9@eHl60q3Wdogkcm5KOzsyZGc5Qn5RthPyyOKK3mjPLK1orTbYWhkpVcdqoZk1lzZqGb/hVUlvbmavFwj1zj3JjWfmJ3wEhNzwvVbv4u@fGCiXNoji/vFxeJO@ErMDI6S1vmpeGfudiU69Ur02S5zms3SqtRMUa@k0pzXfPa6UqkyS/iM9cUqeMsFiRkBauaEN1RgMxcDOSSs4l37ApgERGmtteS4L3pNbeB/giSm7I9FqrHhdyQyJPkj9VTwzGrSJmTN9ysLbManGHOEgjIAlIkNSk1WDcaiDe8JZLazKSfbvi2kVPq5YaNSAGGYx5m1Z11PC1ndfO21JpyXXmLNUQOgWulLV4XeP2E7BbBzEezOQ9LplRkq0a7lIGX4GiBo4@lWprZmlQfVNtVY/P@R3ocrp16Y5qsWLwTfeGUiYBWgspLMfjLjJp1gETeDgra@LVhs8Qw3fIJb9jbddw52XXWyTp@tQ7P1yfZtEJzU3f2FFzMHuVJLQkKoiOiU4ooVOiM6JzoouELoleU7GkokiKYypOqDil4ixJVr2l1lWM6Xgp1qJEnu/BVJzRBId1AsopPS0TuqCJDayTAk93lrD@XzyJUSEsYk2CBmZomdG96l9WJDnqAVmORVicZaDA/5OM8FNkdJERgnJG6XK@YoZXiOHPIXyo@ngPcmoi1BqBPvz7@Q5y3U4NgUwS6HBanBj/b@nZjz37eUaXGb3GneUWt4y4r3qUjGzFFAmqAoClpz7z1BeJQyAQLh4B6Z8GD7Z@LD2smJheZs/9IHXfrvp8z/KJd@0iSs5czYzArZjzILk49WqPfYScnq3s4ykSXMWlV3ISNGeuNKLsk4g8HiN4nO0cKbayi52Pz/wkyR@9z7mDoBFp7BgzoIO17J5WHEHDxirmfr/yypeXRk9W2N0ZoVoQsbgF7vORg0ps3tjJQn3SD@hdR4hpCjZcXcfL9ZQ8Wjaz/yK6uYZLgeUGq/8iuMUOV7qCltiUwmYA7jNrMChcu5EKpG2ntGXSwhTaJ1ot/v7Vo5m5l9xAsFRxI/TuTdethSybvuJVMPYRBBXTFQhUV6smguDfSlQVl6NLwpt1I2zux5vfwghhDRfQjqME32h9f2sw23q2QbAHIc1BktyiN38ybm//@FZJyP/w8o0WGFJhdvLQlSwva@maEgzESWOFRbt2/fBHuWk9PEJhtkQewX60SJLFwtU7cE4uoolx6qxtOIYBhvR@o3doNPbRxmUMUJ6se4xNrTADTFr7GF7Rr9I6GZWt49rnza9ndB1KEHzhMAA7r8chFyyuRdP4ken79yBsPb7hZMfMTJxxlToSdE1vvL/xjfF@OtQCUd5wjAvwWz9HFXp7Axd0PvP497Cevp7RQ3DRE9yyT9zbVZiYQiLQcYZ5fdnW1p61gY8xcf6l94I34RBgX5odulRN38oQnFlG33sz25tO1g4bGpLjiOZdfq2y8AdvtTl97FdWs9LuXlEyVEGrqr5RLpoohTIGFole8X3np@5si0zy7Qkkj9DUK3/lca@E/e5kXsy@C/eexi0URBY2pRoiNypqkrJs9873E6CHPKd6B39O/r9V7/DPyZ@4FSXv8M9pD4qC@EUMhF34EIRHR5MY/Oac75r7J4ZW4YZ/e18Rq6r9InDwbfVsq39P0tfS5Okf84k773zd@6r3RgDGpWccXwpb49fYZh/i6c1DaH4THTq4ptNH3z9uXUupNA7E2rsSzvDukO77QsuETJnemCv6SWt2/8NHJFFubuIOA8F71q4qhgNdp91mUfIpDTnj1KFrePzlJaKHRvblob5ynWXwv4X7Pb@J2/chHV6JXWG@SpGixbBL09HwmO/pfBDZ5/mNOLg@fXz8EopX@6PvNuonuw8Cf/Z293qD9h28qoTpGuaz2mbjzo9XrhYnz5PJbjZOnoWpBx99JzQdd0zsLqE30LX35r2QPJ0dHORgEzaNKSM6pMNZ7o7OD8LmViEW6ezRP@0Qbpsepi9G2heR98WW@DC0Phf2NOQZe6973o9ZNBlpXwR8ZPA3G5nOYmo/YLDdlbxzn2kZKhpHTua/KqpphDBw18wdtcKO3o4oF5pHLC2adsrxQaGvMFSxh9y3yCxGbDR5@IZV4VsgQ1pc0iKrOYjOudg6cgPFbsZ8WKfxTzifnc2ybTj3HizRmPduFM9D3dl1Bw3nuON/I8NhbDmbBP0rKXdfLs7hUeu3JPMb0/mVhE5T6q4eY8NJ4hKVm/iF2@Zf/gE" rel="nofollow noreferrer" title="Kotlin – Try It Online">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/ConorOBrien-Foxx/Attache" rel="nofollow noreferrer">Attache</a>, 66 bytes</h1>

<pre><code>{a.=[]Moore[Integers@@__2,{Push[a,_]},cycle-&gt;1]Flat[a@_][0:3'5:8]}
</code></pre>

<p><a href="https://tio.run/##XcpNC4JAFIXhvb9iFlGbW/iREIIhBEGLwkW7y2UYpqsGouJMixB/@zQgQXR2z@FV1irdsKtElrtJ7XKka9@PjJfOcs2jKQopY5jKl2lQgaQZ9Fu3vD1GdG6VRVVIwjBLNml2oNndmB8GV8OgawrK8dnZOxt7UoYNrisQGAg/TEGIPYg9weLwz9Hi9OvY23/Jb@8dUUDkPg" rel="nofollow noreferrer" title="Attache – Try It Online">Try it online!</a></p>

<p>I still need to implement <code>Moores</code> and <code>NMoore</code>, but I still have <code>Moore</code> which serves as an iteration function. Essentially, <code>Integers@@__2</code> creates an integer array of shape <code>__2</code> (the last two arguments) of the first <code>Prod[__2]</code> integers. This gives us the target array. Then, <code>Moore</code> iterates the function <code>{Push[a,_]}</code> over each Moore neighborhood of size <code>1</code> (implied argument), with the option to cycle each element (<code>cycle-&gt;1</code>). This adds each neighborhood to the array <code>a</code>. Then, <code>Flat[a@_]</code> flattens the <code>_</code>th member of <code>a</code>, that is, the Moore neighborhood centered around <code>_</code> (the first argument). <code>[0:3'5:8]</code> obtains all members except the center from this flattened array.</p>

<p>This solution, with an update to the language, would look something like this (49 bytes):</p>

<pre><code>{Flat[NMoore[Integers@@__2,_,cycle-&gt;1]][0:3'5:8]}
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, <s>125 111</s> 108 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(x,i,m=array(1:prod(x),x),n=rbind(m,m,m),o=cbind(n,n,n),p=which(m==i,T)+x-1)o[p[1]+0:2,p[2]+0:2][-5]
</code></pre>

<p><a href="https://tio.run/##PcjNCsMgEATge58ix12yQjVJD6G@RW@SQ2qQePAHaal9emsilJnDN5OK6e6sK@bt9csGD5ksObmmtH6BzzGFDTJSrZfpaf0GjmqQgtTn9FSDFOVnt3oHJ6WlB/aZcQwqKr7011lQVOLEoti0FAMaRhqRbnj5mzdPh0XzUE8amvlhjuUH" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>

<p>14 and 8 bytes golfed by @JayCe and @Mark.</p>

<p>Input is <code>[w, h], i</code> because R populates arrays column first.</p>

<p>Makes the array and then "triples" it row- and column-wise. Then locate <code>i</code> in the original array and find it's neighborhood. Output without <code>i</code>.</p>
</div>
<div id="pu6" class="pu"><h1>JavaScript (ES6), 75 bytes</h1>
<p><em>Saved 2 bytes thanks to @KevinCruijssen</em></p>
<p>Expects a 0-based index.</p>

<pre class="lang-javascript prettyprint-override"><code>(h,w,i)=&gt;[...'12221000'].map((k,j,a)=&gt;(i+w+~-k)%w+~~(i/w+h+~-a[j+2&amp;7])%h*w)
</code></pre>
<p><a href="https://tio.run/##bY7NbsJADITvPIUvwG4zbOxNltADvAjisOKnSfgJAtTcePWwWlqEmkqWLNvzeab23/66vlTn2@TUbLbdbt6pEi0qPV8sjTFjsdYKM49X5ujPSu1Rw4ejqpI2uU/2ehjaXVVpm5Rh9ss6saNipYflR6u7dXO6NoetOTRfaqdy5HBaU5oSgwRkQTloCpqBPsOGB32An4C4cA96yUBZhIsIux7iIG9IeC5BydHMRbPiDyLIYH@QKHuGe0Xknl5@UzH@q@4B" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<p>The surrounding indices are returned in the following order:</p>
<p><span class="math-container">$$\begin{matrix}5&amp;4&amp;3\\6&amp;\cdot&amp;2\\7&amp;0&amp;1\end{matrix}$$</span></p>
<h3>How?</h3>
<p>The indices <span class="math-container">\$I_{dx,dy}\$</span> of each surrounding cell at <span class="math-container">\$(x+dx,y+dy)\$</span> are given by:</p>
<p><span class="math-container">$$\begin{align}I_{dx,dy}&amp;=((x+dx) \bmod w)+w((y+dy) \bmod h)\\&amp;=((N+dx) \bmod w)+w((\left\lfloor\frac{N}{w}\right\rfloor+dy) \bmod h)\end{align}$$</span></p>
<p>where <span class="math-container">\$N=wy+x\$</span> is the index of the target cell.</p>
<p>We walk through the list <span class="math-container">\$[1,2,2,2,1,0,0,0]\$</span> and subtract <span class="math-container">\$1\$</span> to get the value of <span class="math-container">\$dx\$</span>, which gives:</p>
<p><span class="math-container">$$[0,1,1,1,0,-1,-1,-1]$$</span></p>
<p>For the corresponding values of <span class="math-container">\$dy\$</span>, we use the same list shifted by 2 positions, which gives:</p>
<p><span class="math-container">$$[1,1,0,-1,-1,-1,0,1]$$</span></p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 20 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>

<pre><code>PRs©Ṫ{œi+€Ø-Ż¤ŒpḊœị®
</code></pre>

<p>A dyadic link accepting a list of the dimensions on the left, <code>[h,w]</code>, and the cell as an integer on the right, <code>i</code>, which yields a list of the neighbourhood.</p>

<p><sup>Note: the order is different to that in the examples which is allowed in the OP</sup></p>

<p><strong><a href="https://tio.run/##ATUAyv9qZWxsef//UFJzwqnhuap7xZNpK@KCrMOYLcW7wqTFknDhuIrFk@G7i8Ku////WzQsNV3/Mg" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>

<h3>How?</h3>

<pre><code>PRs©Ṫ{œi+€Ø-Ż¤ŒpḊœị® - Link: [h,w], i
P                    - product -&gt; h*w
 R                   - range -&gt; [1,2,3,...,h*w]
    Ṫ{               - tail of left -&gt; w
  s                  - split into chunks -&gt; [[1,2,3,...w],[w+1,...,2*w],[(h-1)*w+1,...,h*w]]
   ©                 - ...and copy that result to the register
      œi             - multi-dimensional index of (i) in that list of lists, say [r,c]
             ¤       - nilad followed by link(s) as a nilad:
          Ø-         -   literal list -&gt; [-1,1]
            Ż        -   prepend a zero -&gt; [0,-1,1]
        +€           - addition (vectorises) for €ach -&gt; [[r,r-1,r+1],[c,c-1,c+1]]
              Œp     - Cartesian product -&gt; [[r,c],[r,c-1],[r,c+1],[r-1,c],[r-1,c-1],[r-1,c+1],[r+1,c],[r+1,c-1],[r+1,c+1]]
                Ḋ    - dequeue -&gt; [[r,c-1],[r,c+1],[r-1,c],[r-1,c-1],[r-1,c+1],[r+1,c],[r+1,c-1],[r+1,c+1]]
                   ® - recall (the table) from the register
                 œị  - multi-dimensional index into (1-indexed &amp; modular)
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://www.dyalog.com/" rel="nofollow noreferrer">APL (Dyalog Classic)</a>, 27 bytes</h1>



<pre class="lang-apl prettyprint-override"><code>{(⍺⊥⍺|(⍺⊤⍵)-⊢)¨1-1↓4⌽,⍳3 3}
</code></pre>

<p><a href="https://tio.run/##bY/PSsNAEMbvfYq5JQsGd/OnUd8mpE1YTLJlNxfRXlQKpl0RxKMHq0LvUgTBSx9lXiTOpr0I3YVh2N8333ybzapgcpVVqgzyKjNG5j0@vkiFiyfeF1SvfbQ/2H1Svdm3H2i3LMBuzXYbEQhcPMe4@j1B@xVBNO97Q1Nol7j63m2wu4XjB@0rGKXbUU1y32D3zvDhzTVrdlydq3qWaWlUA7JslJZNCUpPpnrUupyUqqZh7bZ3d8UpZb3w1KWHy3uvyGTlufB2q@eDWTs17cj3Y4hZwlrgICCEGMZwBucg@AFxQiIBEYKgv5EmJU0ywISJAxyDSMkghITGU4ICIhY6SG/OeG/OByIGT/7//gE" rel="nofollow noreferrer" title="APL (Dyalog Classic) – Try It Online">Try it online!</a></p>

<p><code>{</code> <code>}</code> is a function with arguments <code>⍺</code> (the dimensions <code>h w</code>) and <code>⍵</code> (the index <code>i</code>)</p>

<p><code>⍳3 3</code> is a matrix of all 2-digit ternary numbers: <code>0 0</code>, <code>0 1</code>, ..., <code>2 2</code></p>

<p><code>,</code> enlists the matrix as a vector</p>

<p><code>1↓4⌽</code> removes the centre element <code>1 1</code> by rotating 4 to the left (<code>4⌽</code>) and dropping one (<code>1↓</code>)</p>

<p><code>1-</code> subtracts from 1, giving all 8 neighbour offsets</p>

<p><code>(</code> <code>)¨</code> applies the function train in parentheses to each offset</p>

<p><code>⍺⊤⍵</code> is the base-<code>⍺</code> encoding of <code>⍵</code> - the coordinates of <code>⍵</code> in the matrix</p>

<p><code>(⍺⊤⍵)-⊢</code> subtracts the current offset, giving the coordinates of a neighbour</p>

<p><code>⍺|</code> is mod <code>a</code> to wrap around coordinates and stay within the matrix</p>

<p><code>⍺⊥</code> decodes from base <code>⍺</code></p>
</div>
<div id="pu9" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, <s>79</s> <s>69</s> 66 bytes</h1>



<pre class="lang-python prettyprint-override"><code>lambda h,w,i:[(i+q%3-1)%w+(i/w+q/3-1)%h*w for q in range(9)if q-4]
</code></pre>

<p><a href="https://tio.run/##XZBLDsIwDETXcApvEAk1atIPBSS4SMiiCEIjQWkipIrTl9T9LJC88czzxHHz/VTvOunM6dI9y9f1VkKFLdqjYjZyq3Qr@aqNmI3byMXUVZsWzNuDA1uDL@vHnR24NeC2me56g1EAR98DiqkMIVSuEZRAkAgJCTuEPcIhKEJzhIkTPSfzIAdMpggpzRRjyET2wEyGKBkAQdE5RRcDKWk@IZLcYYN5DzFjcnxakPtfmuvjctF4W3@G@6DH9em8RjP@tvsB" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>

<p>3 bytes gifted by <a href="https://codegolf.stackexchange.com/users/17602/neil">Neil</a> noting that <code>(x*w)%(h*w)==((x)%h)*w==(x)%h*w</code>.</p>

<p>0-indexed solution.</p>
</div>
<div id="pu10" class="pu"><h1><a href="https://github.com/Ourous/curated-clean-linux" rel="nofollow noreferrer">Clean</a>, <s>85</s> 83 bytes</h1>

<pre><code>import StdEnv
r=(rem)
$h w i=tl[r(n+i/w)h*w+r(r(m+i)w)w\\n&lt;-[0,1,h-1],m&lt;-[0,1,w-1]]
</code></pre>

<p><a href="https://tio.run/##LcyxDsIgFEDRvV/B0AEEYps4ylYHE7eObQdCUUh41FD0xZ8XGcydznJNsDoW2NZXsAS0j8XDc0uZjHm9xHeTFE0WWNM6gsSrHKZEI/dHZO6APNFEgXuGDOc5nuXUiV442S8C/sCKpYxZ16UiLTnVuvI196Afe5HXWxk@UYM3@w8" rel="nofollow noreferrer" title="Clean – Try It Online">Try it online!</a></p>

<p>Treats <code>i</code> as a coordinate <code>(0 &lt;= p &lt; h, 0 &lt;= q &lt; w)</code>, and generates the values of the adjacent elements where the value is <code>p'w + q'</code>.</p>
</div>
<div id="pu11" class="pu"><h2>Batch, 105 bytes</h2>

<pre><code>@for /l %%c in (0,1,8)do @if %%c neq 4 cmd/cset/a(%3/%2+%1+%%c/3-1)%%%1*%2+(%3%%%2+%2+%%c%%3-1)%%%2&amp;echo.
</code></pre>

<p>0-indexed. Saved 23 bytes by stealing @ChasBrown's modulo 3 trick.</p>
</div>
<div id="pu12" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 74 bytes</h1>
<pre><code>Mod[i=#;w=#2;Mod[i+#2,w]+i~Floor~w+w#&amp;@@@{-1,0,1}~Tuples~2~Delete~5,1##2]&amp;
</code></pre>
<p><a href="https://tio.run/##Rcq9CsIwGIXhPVcR@KAo/YpNNFOJZBA3wcGtdCia0kBrpEYyhObW4w8F4QzPgXdsXa/H1plrmzq5Sid7q42Eykvg1e/kwNE3uYnHwdop@txDppQKBcMS2Rwvr8egn5HHgx6001EgA@BNltYVOU/m7moo9p1S0GQbFQgJAunusxlJKP9kSMVCjnSLlC0B@5KQOb0B" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
<p>Takes input in reverse (<code>i, w, h</code>), 0-based.</p>
<h3>3x3 matrix with the center cell in it, (60 bytes)</h3>
<pre><code>(Join@@(p=Partition)[Range[#2#]~p~#,a={1,1};3a,a,2a])[[#3]]&amp;
</code></pre>
<p>Takes (<code>w, h, i</code>), 1-based.</p>
<p><a href="https://tio.run/##NcixCsMgFEDR3a8ICEHhhaK2XYLFuVPoKg6PkrQOMSG4ifl1GwOFOxzujPE7zhj9G8ukWWHPxQdj2KoH3KKPfgncvjB8Rksldfu6U0CdBIjcKwQEiY5bS5VzbeE9GTYfoqXdYzKGuvZiEiHpCs3RPcOfovJ2UlaqY0GjKsVJkQnJ5Qc" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
</div>
<div id="pu13" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, 24 bytes</h1>
<pre><code>*:2Geti=&amp;fh3Y6&amp;fh2-+!Z{)
</code></pre>
<p>Inputs are <code>h</code>, <code>w</code>, <code>i</code>. The output is a row vector or column vector with the numbers.</p>
<p>Input <code>i</code> and output are 1-based.</p>
<p><a href="https://tio.run/##y00syfn/X8vKyD21JNNWLS3DONIMSBrpaitGVWv@/2/CZcJlBgA" rel="nofollow noreferrer" title="MATL – Try It Online">Try it online!</a> Or <a href="https://tio.run/##y00syfmf8F/LysA9tSTTVi0twzjSDEga6WorRlVr/lfX1VWPcAn5b8JlwmXGBSINgdiUywhIGwOhIQgCAA" rel="nofollow noreferrer">verify all test cases</a>.</p>
<h3>Explanation</h3>
<pre><code>*     % Take two inputs implicitly. Multiply
      % STACK: 16
:     % Range
      % STACK: [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16]
2G    % Push second input again
      % STACK: [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16], 4
e     % Reshape with that number of rows, in column-major order
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16]
t     % Duplicate
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16],
      %        [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16]
i=    % Take third input and compare, element-wise
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16],
      %        [0 0 0 0; 0 1 0 0; 0 0 0 0; 0 0 0 0]
&amp;f    % Row and column indices of nonzeros (1-based)
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16], 2, 2,
h     % Concatenate horizontally
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16], [2 2]
3Y6   % Push Moore mask
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16], [2 2],
      %        [1 1 1; 1 0 1; 1 1 1]
&amp;f    % Row and column indices of nonzeros (1-based)
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16], [2 2],
      %        [1; 2; 3; 1; 3; 1; 2; 3], [1; 1; 1; 2; 2; 3; 3; 3] 
h     % Concatenate horizontally
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16], [2 2],
      %        [1 1; 2 1; 3 1; 1 2; 3 2; 1 3; 2 3; 3 3] 
2-    % Subtract 2, element-wise
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16], [2 2],
      %        [-1 -1; 0 -1; 1 -1; -1 0; -1 0; -1 1; 0 1; 1 1] 
+     % Add, element-wise with broadcast
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16],
      %        [1 1; 2 1; 3 1; 1 2; 3 2; 1 3; 2 3; 3 3]
!     % Transpose
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16],
      %        [1 2 3 1 3 1 2 3; 1 1 1 2 2 3 3 3]
Z{    % Convert into a cell array of rows
      % STACK: [1 5 9 13; 2 6 10 14; 3 7 11 15; 4 8 12 16],
      %        {[1 2 3 1 3 1 2 3], [1 1 1 2 2 3 3 3]}
)     % Index. A cell array acts as an element-wise (linear-like) index
      % STACK: [1 2 3 5 7 9 10 11]
</code></pre>
</div>
<div id="pu14" class="pu"><h1><a href="https://www.dyalog.com/" rel="nofollow noreferrer">APL (Dyalog Unicode)</a>, 40 <a href="https://codegolf.meta.stackexchange.com/a/9429/43319" title="When can APL characters be counted as 1 byte each?">bytes</a><sup><a href="https://github.com/abrudz/SBCS" rel="nofollow noreferrer" title=".dyalog files using a single byte character set">SBCS</a></sup></h1>



<p>Anonymous infix function. Takes <code>h</code> <code>w</code> as left argument and <code>i</code> as right argument.</p>

<pre class="lang-apl prettyprint-override"><code>{1↓4⌽,3 3↑,⍨⍣2⍪⍨⍣2⊃⊖∘⍉/(¯1+⍺⊤⍵),⊂⍺⍴⍳×/⍺}
</code></pre>

<p><a href="https://tio.run/##SyzI0U2pTMzJT///qG@qp/@jtgkG/6sNH7VNNnnUs1fHWMH4UdtEnUe9Kx71LjZ61LsKxupqftQ17VHHjEe9nfoah9Ybaj/q3fWoa8mj3q2aOo@6mkC83i2Pejcfnq4PZNf@TwMa/Ki3D2JHV/Oh9SBzgbzgIGcgGeLhGfzfRMFEIU3BlAtCGwBpUyBtyGWoYAykjYC0IUgcAA" rel="nofollow noreferrer" title="APL (Dyalog Unicode) – Try It Online">Try it online!</a>  </p>

<p><code>{</code>…<code>}</code> "dfn"; <code>⍺</code> is left argument (dimensions) and <code>⍵</code> is right argument (index).</p>

<p> <code>×/⍺</code> product (multiplication-reduction) of the dimensions</p>

<p> <code>⍳</code> the first that many indices</p>

<p> <code>⍺⍴</code> use the dimensions to <strong>r</strong>eshape that</p>

<p> <code>⊂</code> enclose it (to treat it as a single element)</p>

<p> <code>(</code>…<code>),</code> prepend the following:</p>

<p>  <code>⍺⊤⍵</code> encode the index in mixed-radix <code>h</code> <code>w</code> (this gives us the coordinates of the index)</p>

<p>  <code>¯1+</code> add negative one to those coordinates</p>

<p> <code>⊖∘⍉/</code> reduce by rotate-the-transpose<br>
  <sup>this is equivalent to <code>y⊖⍉x⊖⍉</code>… which is equivalent to <code>y⊖x⌽</code>… which rotates left as many steps as <code>i</code> is offset to the right (less one), and rotates up as many steps as <code>i</code> is offset down (less one), causing the the 3-by-3 matrix we seek to be in the top left corner</sup></p>

<p> <code>⊃</code> disclose (because the reduction reduced the vector to scalar by enclosing)</p>

<p> <code>⍪⍨⍣2</code> stack on top of itself twice (we only really need thrice for single-row matrices)</p>

<p> <code>,⍨⍣2</code> append to itself twice (we only really need thrice for single-column matrices)</p>

<p> <code>3 3↑</code> take the first three rows of the first three columns</p>

<p>The next two steps can be omitted if returning a 3-by-3 matrix is acceptable:</p>

<p> <code>,</code> ravel (flatten)</p>

<p> <code>4⌽</code> rotate four steps left (brings the centre element to the front)</p>

<p> <code>1↓</code> drop the first element</p>
</div>
<div id="pu15" class="pu"><h1><a href="http://www.php.net/" rel="nofollow noreferrer">PHP</a>, 165 bytes</h1>
<p>This is &quot;0-based&quot;. There must be a better solution in PHP, but this is a starting point!</p>
<pre class="lang-php prettyprint-override"><code>&lt;?list(,$h,$w,$i)=$argv;for($r=-2;$r++&lt;1;)for($c=-2;$c++&lt;1;)$r||$c?print(($k=(int)($i/$w)+$r)&lt;0?$h-1:($k&gt;=$h?0:$k))*$w+(($l=$i%$w+$c)&lt;0?$w-1:($l&gt;=$w?0:$l))%$w.' ':0;
</code></pre>
<p>To run it:</p>
<pre><code>php -n &lt;filename&gt; &lt;h&gt; &lt;w&gt; &lt;i&gt;
</code></pre>
<p>Example:</p>
<pre><code>php -n cell_neighbours.php 4 5 1
</code></pre>
<p>Or <a href="https://tio.run/##JcpBDoIwFIThq7gYQ58FBaMboPYspom2sYGmELvh7D5r3U3@@YINzKP2bllFDVsj1XCkcI/P9/CYo0BUzXlAlHLsBirFlGL@BXHbYHSIblqFwEuJPEjAnZBIItLYatim6/N3U7C67fEiOiDJzL2C2@cJU1wqzmeXfs4T5fNY7aq@HZj5wlfuPnNY3Twt3Exf" rel="nofollow noreferrer" title="PHP – Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/168807/">168807</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




