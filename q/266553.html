<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::266553</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>nan</td><td>Scala</td><td>231107T112855Z</td><td><a href="https://codegolf.stackexchange.com/questions/266553/produce-the-shortest-suffix-for-an-almost-arbitrary-string/266558#266558">138 Aspe</a></td></tr>
<tr d-ix="1"><td>136</td><td>Scala 2</td><td>231107T163426Z</td><td><a href="https://codegolf.stackexchange.com/questions/266553/produce-the-shortest-suffix-for-an-almost-arbitrary-string/266574#266574">corvus_1</a></td></tr>
<tr d-ix="2"><td>026</td><td>Jelly</td><td>231107T174941Z</td><td><a href="https://codegolf.stackexchange.com/questions/266553/produce-the-shortest-suffix-for-an-almost-arbitrary-string/266577#266577">Nick Ken</a></td></tr>
<tr d-ix="3"><td>154</td><td>Python</td><td>231107T082151Z</td><td><a href="https://codegolf.stackexchange.com/questions/266553/produce-the-shortest-suffix-for-an-almost-arbitrary-string/266556#266556">bsoelch</a></td></tr>
<tr d-ix="4"><td>038</td><td>Charcoal</td><td>231107T081343Z</td><td><a href="https://codegolf.stackexchange.com/questions/266553/produce-the-shortest-suffix-for-an-almost-arbitrary-string/266555#266555">Neil</a></td></tr>
<tr d-ix="5"><td>127</td><td>JavaScript Node.js</td><td>231107T124649Z</td><td><a href="https://codegolf.stackexchange.com/questions/266553/produce-the-shortest-suffix-for-an-almost-arbitrary-string/266564#266564">Arnauld</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="http://www.scala-lang.org/" rel="nofollow noreferrer">Scala</a>, <del>267</del> 190 bytes</h1>
<p>A port of <a href="https://codegolf.stackexchange.com/a/266556/110802">@bsoelch's Python answer</a> in Scala.</p>
<p>Saved 77 bytes thaks to @corvus_192</p>
<hr />
<p>Golfed version. <a href="https://ato.pxeger.com/run?1=ZY9LTsMwEIbXzSksS0g2SUNSKJRAKkHLo1CeLS0PsTCJk6Zyk2C7BRLlJGxgAWdgxTnobUgosIDF6J_5_0-amcdX4RBGKm9XsMxI6I-JT604EtIL7o9iAa-nH9HNkDoSHJAgBKkCgEs9MMoHRLgvLLDBOXm46kgehP41tsBZGEhgf5EAxLkrWYg8BCHGpdLCAoDwb9KlQv6mZvgv36WMRaAfceYWWEFVm_-oymJ1xTR_AL1dAFleE8KAZ4HZgcCu_3YvY-mVa9N3YdfTCeGIaInGsI069PbnHYQ1CDWoG2Zlcam6vFJb3dhsNLe2d3Zbe_vtg8Oj45PTTves1z-_uIRYKVb1bKYyXUbt6I7yBhFUuRsEjCJjHQk1wXoSxP1ADlqhS-_1EYlTJ2eQow2xXR_OO6qT6WI8mjMNw8ApsYnu8ihGJlbVXoGjRMVrSW4PKHEzJclmXzx_69PTTD8B" rel="nofollow noreferrer">Attempt this online!</a></p>
<pre class="lang-scala prettyprint-override"><code>s=&gt;{var(a,z,l)=(Seq[String](),&quot;&quot;,&quot;.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;)
val V=l+l.toLowerCase
while(0&lt;(s+z).zipWithIndex.map{case(c,j)=&gt;j*c+c}.sum%1000){a=a.drop(1)++V.map(z+);z=a.head}
z}
</code></pre>
<p>Ungolfed version. <a href="https://tio.run/##bZHrT8IwFMW/81ccl5i0siwbvkkwQXyh@EBAfMSQuhWoKRtsU3yEvx3vHhBi@NTe3z2nPbeNXKHFfB68vUs3xrVQPn4LgCf7GFHBRDiIyqiGofh@acWh8gevvIyOr2JUUiUwJhprn/WZYXD@H7VlFK/BF1LrAN0g1N6abml7d99xssaskOfpM0qSZTAxWWwphmGYUGXU/SSTbaJZRkNF8SIvwaRk3IRedVm2U9re2d3bPzisHtdOTs/OL@qXV43rm9u75n2r3XnoPj49G3zFks37KTR0I5jKkJBGEdqKg7SuiUjmkhDNGzklQXMJJhmYLIHKgErBdKi0BGMRHZgouTUSY9ajo2kubv2ocVfFw7rvya@kg1@4dBuYS7P7HkflCIw25HY4tuBiZkUfI2zCsW0bG/QwPM@PZTRaLC8MxowsxWI@VHpvmrWIHs8dkxXHUAovx/kEdlrOCgtl@muz@fwP" rel="nofollow noreferrer">Try it online!</a></p>
<pre class="lang-scala prettyprint-override"><code>object Main {
  def main(args: Array[String]): Unit = {
    println(f(&quot;&quot;))
    println(f(&quot;Test&quot;))
    println(f(&quot;Hello World&quot;))
    println(f(&quot;235711&quot;))
  }

  def f(s: String, q: String = &quot;&quot;, i: Int = 0, Q: List[String] = List(), l: String = &quot;.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;): String = {
    val lLower = l + l.toLowerCase
    var QNew = Q
    var qNew = q
    var iNew = i
    while ((s + qNew).map(_.toInt).zipWithIndex.map { case (c, ind) =&gt; (ind + 1) * c }.sum % 1000 != 0) {
      QNew = QNew.drop(1) ++ lLower.map(qNew + _)
      qNew = QNew.head
      iNew = 0
    }
    qNew
  }
}
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.scala-lang.org/" rel="nofollow noreferrer">Scala 2</a>, <s>153</s> <s>142</s> 136 bytes</h1>
<pre class="lang-scala prettyprint-override"><code>s=&gt;{def z:Stream[String]=s#::z.flatMap(x=&gt;'.'to'z'diff &quot;/:;&lt;=&gt;?@[\\]^`&quot;map(x+))
z.find(_.zipWithIndex.map{case(c,j)=&gt;j*c+c}.sum%1000&lt;1)}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZY_PTsJAEIfP8hSTNaatSKEYolnZqokHTSQc1HAA1LXdrUu226a7NVjC3XfwwkWfwIOvwtvY8ucic5lkvm8mv_n81gGVtP07RA1JVZTTiOE00YaLaT_VaLz0kpcJCwz0qFAwqwG8UQkcw53JhIqA-NBPjUjUcD0YA_nKDW-cLj808Wch41DgEjEabw2i9zEuXC6p6dHUnhLfci2TWIUVCs4BNfFZl_jnF8PRaPz4jOLKqTtOrVwRKrSf3EKkA2Feb1TIpm6JZwHVzA6OJg7xJ4dBPZi7Oo8PvFar1fWc-SbPD0CVJi7_sGkWaQyXWUbft6kcDA9KGCCrJwHScmqksrmNkOPsldVsAkL_2T3TZs0r7Kkd4ZpJmcAgyWRYeZXVudqx2sedE89bHaoM97Yy5rVN9sVi3f8A" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Recursively constructs an infinite Stream of possible suffixes and chooses the first with the correct sum. They iterate from shortest to longest, so it produces the correct output.</p>
<h2>Alternative Solution, <s>158</s> 139 bytes:</h2>
<pre class="lang-scala prettyprint-override"><code>s=&gt;Stream.iterate(Seq(s))(_.flatMap(s=&gt;'.'to'z'diff &quot;/:;&lt;=&gt;?@[\\]^`&quot;map(s+))).flatten.find(_.zipWithIndex.map{case(c,j)=&gt;j*c+c}.sum%1000&lt;1)
</code></pre>
<p>Same idea as above, without a recursive function. Sadly, <code>Stream.iterate</code> and <code>flatten</code> is very verbose.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 26 bytes</h1>
<pre><code>·πÉ√òW;‚Äù.¬§·∏ä
√á;@O√óJS∆ä»∑·∏ç
0√ß1#·∏¢√ë
</code></pre>
<p><a href="https://tio.run/##ATkAxv9qZWxsef//4bmDw5hXO@KAnS7CpOG4igrDhztAT8OXSlPGisi34biNCjDDpzEj4biiw5H///8ubGw" rel="nofollow noreferrer" title="Jelly ‚Äì Try It Online">Try it online!</a></p>
<p>A full program that takes a string argument and implicitly prints the suffix needed.</p>
<p><em>Thanks to Neil for pointing out a problem related to base decompression, now fixed (at a cost of two bytes and a 64-fold efficiency penalty!</em></p>
<h2>Explanation</h2>
<pre><code>·πÉ√òW;‚Äù.¬§·∏ä     # ‚Äé‚Å°Helper link 1: takes an integer and generates a suffix
·πÉ            # ‚Äé‚Å¢Base decompress into:
 √òW;‚Äù.¬§      # ‚Äé‚Å£- Word characters (A-Za-z0-9_) concatenated to &quot;.&quot;
       ·∏ä     # Remove first character (avoids issue related to suffixes that start with .)
‚Äé‚Å§
√á;@O√óJS∆ä»∑·∏ç  # ‚Äé‚Å¢‚Å°Helper link 2: Takes an integer as left argument and the original string as right argument and returns 1 if it meets the requirements and zero if not
√á           # ‚Äé‚Å¢‚Å¢Call helper link 1
 ;@         # ‚Äé‚Å¢‚Å£Concatenate the output of this to the original string
   O        # ‚Äé‚Å¢‚Å§Codepoints
       ∆ä    # ‚Äé‚Å£‚Å°As a monadic chain:
    √óJ      # ‚Äé‚Å£‚Å¢Multiply by indices
      S     # ‚Äé‚Å£‚Å£Sum
        »∑·∏ç  # ‚Äé‚Å£‚Å§Divisible by 1000
‚Äé‚Å§‚Å¢
0√ß1#·∏¢√ë       # ‚Äé‚Å§‚Å£Main link: takes a string as its argument and returns the suffix needed
0√ß1#         # ‚Äé‚Å§‚Å§Starting with zero, find the first integer that when called into helper link 2 returns truthy
    ·∏¢        # Head (since # returns a list)
     √ë       # ‚Äé‚Å¢‚Å°‚Å°Call helper link 1 to regenerate the suffix

üíé
</code></pre>
<p>Created with the help of <a href="https://vyxal.github.io/Luminespire" rel="nofollow noreferrer">Luminespire</a>.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 154 bytes</h1>
<pre class="lang-python prettyprint-override"><code>def f(s,q=&quot;&quot;,Q=[]):
 while(i:=0)+sum((i:=i+1)*ord(c)for c in s+q)%1000:Q=[q+c for c in{*map(chr,range(46,123))}-{*&quot;/:;&lt;=&gt;?@[\\]^`&quot;}]+Q;q=Q.pop()
 return q
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=VZDNSsQwFIX3fYoQEHKbjrYz_tExKrjQbUFwMVNxaBIbSPPXFJFhXkQ3s9F38m0c0RG6O-c793Iv5_3TvcbWmu32Y4hycv71xoVEkvSZZxhnFVvUUCbopVVaEFWyHGg_dORHKlpAagMnDUgbUIOUQT31cFDkeV7uNj1t0D5Zp93KkaYNWViZZ0GOT7NiOgPYTNYpPirnF-zy6nqxXNaPT3hT02ruWXXorCOQoCDiEAzyfx92LigTiSQYAyT_hnM-8veijyNwJ7S26MEGPR6czk7OimKEbiwXt1bLHfw9uq_nGw" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p><code>{*map(chr,range(46,123))}-{*&quot;/:;&lt;=&gt;?@[\\]^`&quot;}</code> produces an iterable of the allowed characters by taking all ASCII-characters form <code>.</code> to <code>z</code> (smallest and largest allowed character) and the removing the additional characters.<br>
Using the standard library would take the same amount of characters: <code>from string import*</code> <code>&quot;._&quot;+digits+ascii_letters</code></p>
<hr />
<h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 147 bytes</h1>
<pre class="lang-python prettyprint-override"><code>def f(s,Q=[]):
 while(i:=0)+sum((i:=i+1)*ord(c)for c in s)%1000:Q=[s+c for c in{*map(chr,range(46,123))}-{*&quot;/:;&lt;=&gt;?@[\\]^`&quot;}]+Q;s=Q.pop()
 return s
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m72soLIkIz9vwYKlpSVpuhY3J6ekpimkaRTrBNpGx2pacSmUZ2TmpGpkWtkaaGoXl-ZqgJiZ2oaaWvlFKRrJmmn5RQrJCpl5CsWaqoYGBgZWQH3F2skKMPFqrdzEAo3kjCKdosS89FQNEzMdQyNjTc1a3WotJX0raxtbO3uH6JiY2LgEpdpY7UDrYttAvYL8Ag1NLoWi1JLSIqDJUKflFhRl5pVopGkoKWlqcsE5KSkpKPyQ1OISFAGP1JycfIXw_KIcVIVGxqbmhoYoQs75Kanu-TlpQEGIpbBwAQA" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 38 bytes</h1>
<pre><code>‚äûœÖœâÔº¶œÖ¬ø¬¨‚Öà¬øÔπ™Œ£Ôº•‚Å∫Œ∏Œπ√ó‚äïŒª‚ÑÖŒ∫œÜÔº¶Œ£‚ü¶Œ±Œ≤‚≠ÜœáŒ∫._‚üß‚äûœÖ‚Å∫ŒπŒ∫Œπ
</code></pre>
<p><a href="https://tio.run/##NY7BDsIgEETvfsXG05Kg0XOPHoyHapN6MDGmwQKWdAtKQT8faY3HmZ15O20nfOsEpVTFscPI4cOKhXYeMDIwGvDoAl6QsZ8qnYzksI4DluKJFcURXxwM43A2gxrxYFuvBmWDkkjZPXlprCDsMyFLnTkzfSJcBYc7hzp4Yx8Tbrvh0OfUct0sbzn53zS/MdONFaBoVFDlSkDDipR2Tqpm70in1Zu@" rel="nofollow noreferrer" title="Charcoal ‚Äì Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>‚äûœÖœâÔº¶œÖ
</code></pre>
<p>Start a breadth-first search with an empty suffix.</p>
<pre><code>¬ø¬¨‚Öà
</code></pre>
<p>Check that a solution hasn't yet been found.</p>
<pre><code>¬øÔπ™Œ£Ôº•‚Å∫Œ∏Œπ√ó‚äïŒª‚ÑÖŒ∫œÜ
</code></pre>
<p>If the input plus current suffix is not a multiple of <code>1000</code>, then:</p>
<pre><code>Ôº¶Œ£‚ü¶Œ±Œ≤‚≠ÜœáŒ∫._‚üß
</code></pre>
<p>Loop over all valid characters.</p>
<pre><code>‚äûœÖ‚Å∫ŒπŒ∫
</code></pre>
<p>Append the character to the suffix and add this to the list of suffixes to check.</p>
<pre><code>Œπ
</code></pre>
<p>But if it is then output the suffix as the solution.</p>
<p>Would be only 36 bytes to output the full string:</p>
<pre><code>‚äûœÖÔº≥Ôº¶œÖ¬ø¬¨‚Öà¬øÔπ™Œ£Ôº•Œπ√ó‚äïŒª‚ÑÖŒ∫œÜÔº¶Œ£‚ü¶Œ±Œ≤‚≠ÜœáŒ∫._‚üß‚äûœÖ‚Å∫ŒπŒ∫Œπ
</code></pre>
<p><a href="https://tio.run/##NY7LCsIwEEX3fsXgagJRdN2lC@miWqgLQaTEJrWh06Tk4e/H1OLyDvecO90gXGcFpVRHP2DkUJo5hiY4bd7IWLHprQOMDHQPeLEB7/m6psrKSBabOGElZtQcbnpSHkvTOTUpE5REYhyuTmojCMcM5thn/CddwIfg8OKw7i2W44HDmFvbfbt95ub/rZqiXyaypABFXkGdkYCaFSmdrFTt2VKfdh/6Ag" rel="nofollow noreferrer" title="Charcoal ‚Äì Try It Online">Try it online!</a> Link is to verbose version of code.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 127 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;{for(S=n=&quot;&quot;,B=Buffer;B(s+S).map(c=&gt;t+=c*++i,i=t=0),t%1e3|!/^[\w.]*$/.test(S);S=g(n++))g=n=&gt;n?B([n&amp;127])+g(n&gt;&gt;7):&quot;&quot;;return S}
</code></pre>
<p><a href="https://tio.run/##dY6xDoIwFEV3v0IbNX0WUXQwkbya4OAHdERMCLQEg61pqw7qtyODk8H1nJuTe87vuStsffVzbUrZKmwd8qcylgrUSEiQYHJTSto4oY4JCC/5lRbIPcNixlgd1OhxCYGfRHL9Gi1O6fERZrPxIvTSeSogFlhRzRhA1QW53iU01dNotcmAdYLzDWwJia30N6uH4t0WRjvTyLAxFVWUEIDBDyrLsofuu/89@GAa9Wf9Ve0H" rel="nofollow noreferrer" title="JavaScript (Node.js) ‚Äì Try It Online">Try it online!</a></p>
<p>Or <strong><a href="https://tio.run/##dc6xDoIwFIXh3adQoqaXIoIOJJJbExx8AEbEhEBLMNiStuigPjsyOBldv/8M51LcClPqprMrqSo@CBwMsodQmkgMvASTXgiuvRolshTlviaSsQhoQjK5DDdRDjsTJ2RkSgH8a9GREpmlWLqUNl6DFgPw7CLk2@dsfc5Odz9352vfcmNJCjHEmttey2n6GkoljWq536qaCOI4AJMvqqrqhx7G5z/4qFrxZ/1Jwxs" rel="nofollow noreferrer">121 bytes</a></strong> if we can return the full string instead of just the suffix.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/266553/">266553</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




