<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::209409</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>140</td><td>Python3</td><td>200812T141958Z</td><td><a href="https://codegolf.stackexchange.com/questions/209409/never-trust-a-mastermind/209470#209470">Stef</a></td></tr>
<tr d-ix="1"><td>047</td><td>Charcoal</td><td>200811T190452Z</td><td><a href="https://codegolf.stackexchange.com/questions/209409/never-trust-a-mastermind/209422#209422">Neil</a></td></tr>
<tr d-ix="2"><td>125</td><td>R + gtools</td><td>200816T091812Z</td><td><a href="https://codegolf.stackexchange.com/questions/209409/never-trust-a-mastermind/209627#209627">Dominic </a></td></tr>
<tr d-ix="3"><td>107</td><td>JavaScript ES6</td><td>200811T171644Z</td><td><a href="https://codegolf.stackexchange.com/questions/209409/never-trust-a-mastermind/209416#209416">Arnauld</a></td></tr>
</table>
<div id="pu0" class="pu"><h2>Python3, <s>304</s> <s>301</s> <s>299</s> <s>296</s> <s>275</s> <s>249</s> <s>221</s> <s>185</s> <s>178</s> <s>168</s> <s>157</s> 140 bytes</h2>
<pre><code>lambda l:any(all(sum((x in t)+9*(x==y)for x,y in zip(p,t))==int(t[4:])for t in l)for p in permutations('ABCDEFGH',4))
from itertools import*
</code></pre>
<p>Lambda expecting input in the form of an array. <a href="https://tio.run/##RY7BboQgEIbvPsXcFramQdykrYkHRBffoe2BTbUlQSCIifblLeihXGbm//5/BreFH2vKV@f3sf7YtZweXxJ0Jc2GpNZoXiaEVlAGAn56u6K1rjc8Wg9rviX1Vznk8oBxXSsTUHi/VZ8HD4nqo3WpdYOfliCDsmZGF9bwtruL/pLfMM5GbydQYfDBWj2Dmpz14bqnrEpZL833gEgOL7gC59OhESnjloDw8@y0ihXjPS0tCmC8E4RCL@5dnHh8BQHeip4UWbKQAtJpUgIXoo@W5KQno/RkaUsb42fgX2RNQ2Pp2r4kJyuh5Q0j9JhKmnHBeQwIJqIInMVP0D8" rel="nofollow noreferrer">Try it online!</a></p>
<p>Or 156 bytes as a full python program with textual input/output:</p>
<pre><code>from itertools import*
l=input()
print(any(all(sum((x in t)+9*(x==y)for x,y in zip(p,t))==int(t[4:])for t in l.split())for p in permutations('ABCDEFGH',4)))
</code></pre>
<p><a href="https://tio.run/##RY/BboQgFEX3fsXLbAZaM0GcpO0kLBAd/IemCzOlLQkCQUy0P29BF2VD3r333Lzn1/jjbP3qw/Zwn4qdTqdNj96FCDqqEJ0zEwwT6MIwbf0cES580Daiwa5oMAZN84jQAtpCxM9vT2hhbMVfLsBSrln91R75MmLMWMbi@/X2sfsxu@YyeaNT6y75LOmLV2Gc4xC1sxM680a03V325/KKMd7ShkXO6pwNg/1WiJTwgm@gFvVA@Qq8ZaaqgItOEgq9vHdpEulVBEQre1IVOUIqyM2kBiFlnyI5SQ@P0sPLLW3CD@Bf5E1D09e1fU0Or4ZWNJzQfappIaQQCZBcJhEET0vQPw" rel="nofollow noreferrer">(try it online)</a></p>
<p>Could save 2 bytes by replacing <code>'ABCDEFGH'</code> with <code>range(8)</code>, but then input should be in the form <code>012311,024602,765411,222210,236701</code>.</p>
<p>edit: move <code>r=[0,1,2,3]</code> outside of function and remove <code>[]</code> to save 3 bytes</p>
<p>edit: remove <code>()</code> around <code>return</code> value to save 2 bytes</p>
<p>edit: replace <code>def f(p,t):</code> with <code>lambda p,t:</code> to save about 8 bytes</p>
<p>edit: replace <code>[...].count(True)</code> with <code>sum(...)</code> to save 5+3=8 bytes</p>
<p>edit: remove intermediary variable <code>m</code> to save 5 bytes</p>
<p>edit: use <code>:=</code> in a much better way to get rid of the nested <code>lambda</code> and the awkward <code>(,,)[-1]</code> and save 26 bytes</p>
<p>edit: <a href="https://codegolf.stackexchange.com/users/58563/arnauld">@Arnauld</a> fixed a mistake with the rules of mastermind and golfed it down to 221 bytes</p>
<p>edit: @Arnauld did some magic with the booleans and ints to golf it to 185</p>
<p>edit: replace <code>for i in range(4)</code> with <code>for x,y in zip(p,t)</code> to save 7 bytes</p>
<p>edit: save 10 bytes by replacing <code>(lambda l:...)(input())</code> with <code>l=input()   ...</code></p>
<p>edit: @Arnauld saves 8 bytes by replacing <code>t.count(x)and 1+9*(x==y)</code> with <code>(x in t)+9*(x==y)</code> (which is also easier to understand in my opinion) plus 3 bytes by requiring whitespace-separated input to replace <code>.split(',')</code> with <code>.split()</code></p>
<p>edit: @Arnauld saves 1 byte by replacing <code>import itertools as i</code> with <code>from itertools import*</code></p>
<p>edit: @Arnauld removed 16 bytes by making it a lambda instead of a full python program</p>
<p><strong>Less compact, more readable version</strong></p>
<pre><code>import itertools as i

r=0,1,2,3
def f(p,t):
    correct = [p[i]==t[i] for i in r]
    misplaced = [t.count(p[i]) and not correct[i] for i in r]
    return sum(correct) * 10 + sum(misplaced) == int(t[4:])

def z(line):
    return any(all(f(p,t) for t in line.split(',')) for p in i.permutations('ABCDEFGH',4))

print(z(input()))
</code></pre>
<ul>
<li><code>f(p,t)</code> is <code>True</code> if combination <code>p</code> passes test <code>t</code>. <code>p</code> is a size-4 array which might not contain duplicates (eg <code>ABCD</code>). <code>t</code> is a size-6 array which might contain duplicates (eg <code>CCCC10</code>).</li>
<li><code>z(line)</code> is <code>True</code> if there exists at least one legal combination <code>p</code> which passes all tests <code>t</code>; tests are described by the comma-separated string <code>line</code>.</li>
</ul>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 47 bytes</h1>
<pre><code>⊙ＥＸ⁸¦⁴Ｅ⁴§α﹪÷ιＸ⁸λ⁸∧⬤ι⁼№ιλ¹⬤θ⁼Ｉ…⮌λ²ΣＥι∨⁼ν§λξ∧№λνχ
</code></pre>
<p><a href="https://tio.run/##RU7LCsIwEPyV0NMGImjpoeApRC09iKJH8RDagIE10bSp9utjUl972WUeO9NcpGusxBD2TpseuBlhK2@wtw/loGSkoIwkoGCE97Vp1RNkRGzr0UJt@pUedKtAM/KzII2ektK0uGmBIyZ@ffcSOxDWxxydZIwsJk3k739edj2IsUElLvYGBzUo1ylI6jypj/46NYwfdg4@JvNvh4w8v8nvrIiYlDWn31mGcDplohJinmcsq3jFp0PwzXqRZ@dzmA34Ag" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Brute-force, but only takes a second or so on TIO. Outputs a Charcoal boolean, i.e. <code>-</code> for truthy, nothing for falsy. Explanation:</p>
<pre><code>⊙ＥＸ⁸¦⁴Ｅ⁴§α﹪÷ιＸ⁸λ⁸
</code></pre>
<p>Generate all possible codes including duplicates, and see if any of them satisfies the following.</p>
<pre><code>∧⬤ι⁼№ιλ¹
</code></pre>
<p>Check that the code contains no duplicates, and...</p>
<pre><code>⬤θ
</code></pre>
<p>... check whether all of the guesses satisfy the following.</p>
<pre><code>⁼Ｉ…⮌λ²
</code></pre>
<p>Get the result of the guess and check that it equals the following.</p>
<pre><code>ΣＥι
</code></pre>
<p>Map over each character of the code.</p>
<pre><code>∨⁼ν§λξ
</code></pre>
<p>Check whether it's an exact match.</p>
<pre><code>∧№λνχ
</code></pre>
<p>Check whether it's misplaced.</p>
<p><s>60</s> <s>46</s> 44-byte version for a version that allows duplicates in the code:</p>
<pre><code>⊙ＥＸ⁸¦⁴Ｅ⁴§α﹪÷ιＸ⁸λ⁸⬤θ⁼Σλ⁺×⁹ΣＥι⁼ν§λξΣＥα⌊⟦№ιν№λν
</code></pre>
<p><a href="https://tio.run/##RY5LC8IwEIT/SuhpAxFUPCieQtTSg1DQW@kh2IIL28Q@4uPXx8Rq3Ut2PmZ2crnq7mI1eZ93aAaQ5gVHfYPcPuoO1oKtuGARrASTQ2aq@gk6EFs5spCZYYd3rGpAwaYI8ZBZcx4fSQStYPvWaerh5BqgQHNyPZyxqXvYCBZprMDJZ/5lJNiTj7d@vtiPBpsgC2Vd@HVImmAYBUVR8u9svS@KRKVKzZeJSFKZys@i5GG/WCZl6Wd3egM" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Brute-force, so takes a few seconds on TIO for falsy cases. Outputs a Charcoal boolean, i.e. <code>-</code> for truthy, nothing for falsy. Explanation:</p>
<pre><code>⊙ＥＸ⁸¦⁴Ｅ⁴§α﹪÷ιＸ⁸λ⁸
</code></pre>
<p>Generate all possible codes including duplicates, and see if any of them satisfies the following.</p>
<pre><code>⬤θ
</code></pre>
<p>Check whether all of the guesses satisfy the following.</p>
<pre><code>⁼Σλ⁺
</code></pre>
<p>Extract the result of the guess (when passed a string which contains non-digits, <code>Sum</code> looks for embedded integer(s) and takes their sum rather than their digital sum) and check that it equals the sum of the following:</p>
<pre><code>×⁹ΣＥι⁼ν§λξ
</code></pre>
<p>Count 9 for each exact match.</p>
<pre><code>ΣＥα⌊⟦№ιν№λν
</code></pre>
<p>Count each match (whether exact or misplaced).</p>
<p>Edit: I had inadvertently calculated 4⁸ instead of 8⁴, so the code was taking 16 times longer than it needed to.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a> + gtools, <s>130</s> 125 bytes</h1>

<pre class="lang-r prettyprint-override"><code>function(l)any(apply(permutations(8,4),1,function(c)all(sapply(l,function(g)g[[2]]==c(x&lt;-sum(c==el(g)),sum(c%in%el(g))-x)))))
</code></pre>
<p><a href="https://tio.run/##hZNNb@IwEIbv@RUWqwpbSnfzAZRWm0MIIRx6atkTQsgYL0R1PmQ7FVD1t7O2gVIWAnMa@533mbET8y1LZxzzNVzIomACWRkWkvIszedTsqTkLdj@rXIi0yKHDOF8DXFZsjUsVU0lsd4XsGu3kO3aX4UEYcag2FWy4/4CLcZjbzIJAgJXv@9FlUESBJQpAdlmdZfmd7v1/Qrp2Gb4jU7TvKzklKVCBl@wFfqwgAq2a7M6tlnvFR2boMq1DwrJRclSCdd2s4nQscANMizJEm7G7lNrYj/Ho1H88nos4FRWXB1eQzaujcXPNJd0QblytJ86E7SHfSLr07IkFVITT4aGBDbCXtR33YbdCKM4cTyVDJNBbHYiFa6jk34ydNwGQuAHeMcsnRucV4dztDkeKI@vzUkyNDjN9c4ofh3F8w6U3XR9PZQxp/nR3qod4tQe9nqeSeL@0HfOOe1ajj5DP@qFCvjdBYytU2fzvfMeDxeLVbjO/7fSrS31T6cIgCyAeRCg5JTQOc0JBbxi1HAeL3GiJIrM9SRhEpokCtUn974Nobghz3HF5k0BdD2gK5yVe6rr1IzXO/wlOJuli6qoBCBYUBvMCrkE75QL/S4BJoSWEs8Uzjp72NB00JDRy5/4suxdl30tD8Ln1xq9dUNv39A7N/SH6@N1b9gfr9td56CDX3vM9h8" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>Colours are represented by digits 1..8.  Returns 'TRUE' for valid games and 'FALSE' for invalid gamemaster responses.</p>
<p><strong>Commented:</strong></p>
<pre class="lang-r prettyprint-override"><code>mastermind_check=function(l)            # l=list of lists of [guess,response]
 any(                                   # do any of...
  apply(permutations(8,4),1,            # all possible codes...
   function(c)all(                      # produce all valid responses for...
    sapply(l,                           # every [guess,response] pair...
     function(g)                        # using this function to define valid response:
      all(g[[2]]==c(                    # - both of these must be the same:
        x&lt;-sum(c==el(g)),               #   - response[1] == sum of correct cols in correct pos
        sum(c%in%el(g))-x               #   - response[2] == sum of correct cols in any pos
      )                                 #                    minus response[1]
)))))                                   # ...?
</code></pre>
<hr />
<h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 114 bytes</h1>

<pre class="lang-r prettyprint-override"><code>function(l){while(T)T=!all(y&lt;-sample(1:8,4),sapply(l,function(g)g[[2]]==c(x&lt;-sum(y==el(g)),sum(y%in%el(g))-x)));1}
</code></pre>
<p><a href="https://tio.run/##hZRLb@IwFIX3@RUeUIUtpW0e0NdMFiGkYdEVZVYVQm7wEKuOiWKnhVb8dmqbV1vI4JWTe87n45vY5SrHQpIyp3wyTjOSvgSrfxVPJZ1xyNDHW0YZgUM0DH5hxuDiz7nAeaFeuXc3dhvZAhcFW0Bm70xTNH168kajIEjhXMmrHC6CgDBVUHL9dEb52fr5fI4Q@u0uVYgXMqa8qOSYUSGDHW2OPiygBluvM9@vs9hU9HgPKq59UMhSFIxKuLBbLYT2AjfIsUwz@P7k3rVH9kM8HMaDx72gJLIq1Y415N21sbigXJIpKZWjc3c1QhvYEllLy5JESE38FhqmsBF2o57rNuxGGMWJ46lJP7mPzZtIDdfRk17Sd9wGQqAJXjGjE4Pz6nCONsf3yuNrc5L0DU5zvQOKX0fxvC1lna6nQxkz5Xt7uzbEd3vY7XpmEvf6vnPI6dRy9B56UTdUwK8uYGxXdTbfO1zj@qhYDdf52ZWbWqn/PUUA5AyYUwCKkqRkQnhKQFkxYji3xzhREkWmPUmYhGYSheqTe19CKG5YclyxSUsArQdkbk7R@kdyauJ1t38Jzp/ptJpVAqRYEBs8z2QGXkkp1DkQAKcpKSR@VjirCfhMEiAzLLeburwPHx5j4xTgjTKmJSDDTF4AMCD57FXryWbDlE9Bq9lSTcAlTtXFsOuIUlvWz8sCmg3ojMPB3/h42duVm@CowNcCk7JO0T6p6JxUXO0VR@vXp2LenADc/r8NrrOtA0i5ajldf04ELjfU1Sc" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
<p>Stochastic function that checks random codes until it finds one that could satisfy the gamemaster responses, at which point it halts and returns <code>1</code>.<br />
Halting is assured in finite time for all valid gamemaster responses.<br />
If gamemaster response is invalid, function never halts.</p>
</div>
<div id="pu3" class="pu"><h1>JavaScript (ES6), <s> 116 112 </s> 107 bytes</h1>
<p>Expects an array of entries in the following format: <code>[[a,b,c,d], &quot;XY&quot;]</code>, where <code>a</code> to <code>d</code> are integers in <code>[0..7]</code>, <code>X</code> is the number of correct digits and <code>Y</code> is the number of near-misses.</p>
<p>Returns <strong>0</strong> or <strong>1</strong>.</p>

<pre class="lang-javascript prettyprint-override"><code>f=(a,n)=&gt;n&gt;&gt;12?0:!a.some(([a,x])=&gt;!a.every(o=(d,i)=&gt;o[x-=d^(v=n&gt;&gt;i*3&amp;7)?a.includes(v):10,v]^=1)|x)|f(a,-~n)
</code></pre>
<p><a href="https://tio.run/##dZDBTtwwEIbvPIW5ELt4jZMsqkSVRVkn69w4cEyDZCXO1ihrL3GIFgE99gH6iH2RZbJUoogyh7E8880/v32rRuXr3myHmXWN3u/bBCtqSbKwi0UYXfKLY8W822iMS0V3FTSgoEfdP2CX4IYaqLhyN0uaGzwmMGS@xCdfyaVixtbdfaM9HslFyOlY3SQhedqRpxY2zH5asu/13b3pNQ5aHxDWa9WsTKevH2yNOWGDux56Y9eYML/tzICD7xaw1vW5qn9gj5IFejxCSKEE4Q0kzzZqgM5Zmc6K6nH@zNjZmhCobl/pEpWMMc98Z2qNOUVzUh269dQN0qXI8pUsArDe6N1Vi2tCKPLlvEKncJxXqCLfYGPtrHedZp1b4w27dcbiAIG1rWpy2@B4ToAP0J9fvyGfIngvgblnsp82hCFNRS55RAu5yuEmIOB/RCYLHk5GRtWZ5mhieUgnQzymQsoC2GkkCtHfeMdG0Ss7yWegi94HsMb@o/xGp8tlBEeeFTH/jI5pJpYpj9B/441GBzz@hPsoLqQQYEWmEsSpSOFDoo/0gX0B" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>f = (                     // f is a recursive function taking:
  a,                      //   a[] = input
  n                       //   n = 12-bit counter, initially undefined, to
) =&gt;                      //       describe all possible codes
n &gt;&gt; 12 ?                 // if n = 4096:
  0                       //   stop the recursion
:                         // else:
  !a.some(([a, x]) =&gt;     //   for each entry [a, x, y] in a[], with a[] =
                          //   guess, x = correct digits and near-misses:
    !a.every(o =          //     we use the object o to keep track of the
                          //     digits that were already extracted from n,
                          //     in order to discard invalid codes
      (d, i) =&gt;           //     for each value d at position i in a[]:
      o[                  //
        x -=              //       update x:
          d ^ (           //         compare d with ...
            v =           //         ... v which is defined as ...
              n &gt;&gt; i * 3  //         ... the next 3-bit digit extracted from n
              &amp; 7         //
          ) ?             //         if d is not equal to v, decrement x if ...
            a.includes(v) //           ... v appears elsewhere in a[]
          :               //         else:
            10,           //           subtract 10 from x
        v                 //       actual index in o to ...
      ] ^= 1              //       ... mark this digit as used; or yield 0
                          //       and exit every() if it was already used
    )                     //     end of every(); the iteration fails if it's
    | x                   //     falsy or x is not equal to 0
  )                       //   end of some()
  | f(a, -~n)             //   do a recursive call with n + 1
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/209409/">209409</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




