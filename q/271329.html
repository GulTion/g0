<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::271329</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>103</td><td>Charcoal</td><td>240227T083828Z</td><td><a href="https://codegolf.stackexchange.com/questions/271329/contract-a-tensor/271338#271338">Neil</a></td></tr>
<tr d-ix="1"><td>024</td><td>Python + NumPy</td><td>240227T035945Z</td><td><a href="https://codegolf.stackexchange.com/questions/271329/contract-a-tensor/271336#271336">alephalp</a></td></tr>
<tr d-ix="2"><td>115</td><td>JavaScript Node.js</td><td>240227T033010Z</td><td><a href="https://codegolf.stackexchange.com/questions/271329/contract-a-tensor/271335#271335">tsh</a></td></tr>
<tr d-ix="3"><td>025</td><td>APL Dyalog Unicode</td><td>240226T222400Z</td><td><a href="https://codegolf.stackexchange.com/questions/271329/contract-a-tensor/271332#271332">Kamila S</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 103 bytes</h1>
<pre><code>≔θδＷ⁺υδ«≔⌊δδ→»≔Ｘ⁰⊕↔…⌊θ¹εＦΦＥＸＬθⅈ﹪÷ιＸＬθ…⁰ⅈＬθ⁼§ιη§ιζ«≔⁺⟦⁰⟧Φι∧⁻λη⁻λζγ≔⊟γβ≔εαＦγ≔§ακα≔θγＦι≔§γκγ§≔αβ⁺§αβγ»⭆¹⊟ε
</code></pre>
<p><a href="https://tio.run/##ZVHda8IwEH@ef8U9ppBB/WC6@SRuA2GCuJdB6UO1WRoWU21T3Rz727u7NNaCeWl/9/vI3WWbJcU2T3Rdz8pSScMOHNJg2jtlSgtgK12VrKJSAL@9O69ZKqN21Y6lQSO@W@ZHwZ7WSmYW4V/P61b5SRQs5LAw20LshLEiZbNNmevKCjb/2Woxz/J9m3fAvH6Ah4PAnM@8APaqtMWQZbL3cW/CSJs57Qcj6TJPK52zhbHP6qhSwRSHG@k6MVJQK@QhV8sReDlUiS7ZzC5MKr4pIMNqB57J1NmA20sUxhx8f6iZmZQmQUI3/hacmyslrapdzZ5JrG06NcEhIejmlgH48qWNhMNX4CXXx5KtQ904ZOPo3NvJ2uCWaIpuyYndC64KZSx7t/iRtPs@7XTPBA4yresIz4jDhMMo5j0AiJB/4PDo0cBxg9jBKCLdlRzjL5ENCh03ukjRifzYkxg55BB6NHSpkxi1EFJCfX/U/w" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>≔θδＷ⁺υδ«≔⌊δδ→»
</code></pre>
<p>Calculate the number of dimensions of the input tensor.</p>
<pre><code>≔Ｘ⁰⊕↔…⌊θ¹ε
</code></pre>
<p>Generate a list of a zero tensor of two fewer dimensions as the initial value of the result tensor.</p>
<pre><code>ＦΦＥＸＬθⅈ﹪÷ιＸＬθ…⁰ⅈＬθ⁼§ιη§ιζ«
</code></pre>
<p>Loop over the multidimensional indices of all the elements of the tensor where the coordinates in the two given axes are identical.</p>
<pre><code>≔⁺⟦⁰⟧Φι∧⁻λη⁻λζγ≔⊟γβ≔εαＦγ≔§ακα
</code></pre>
<p>Get the parent list of the corresponding element of the result tensor.</p>
<pre><code>≔θγＦι≔§γκγ§≔αβ⁺§αβγ
</code></pre>
<p>Get the element of the input tensor and add it to that result element.</p>
<pre><code>»⭆¹⊟ε
</code></pre>
<p>Pretty-print the final result. (This is to show that the result is a single element when the input has two dimensions, as otherwise the output would be indistinguishable.)</p>
<p>The above algorithm may not be optimal as it was back-ported from a 79 byte version that used my experimental multidimensional indexing branch. Explanation:</p>
<pre><code>≔θδＷ⁺υδ«≔⌊δδ→»
</code></pre>
<p>Calculate the number of dimensions of the input tensor as before.</p>
<pre><code>≔×⁰…⌊θ¹ε
</code></pre>
<p>Generate a list of a zero initial result tensor. (This is slightly shorter because <code>Times</code> fully vectorises on that branch but it only vectorises over single dimensional arrays on TIO.)</p>
<pre><code>ＦＥＸＬθⅈ﹪÷ιＸＬθ…⁰ⅈＬθ«
</code></pre>
<p>Loop over the multidimensional indices of the input tensor.</p>
<pre><code>≔⁺⟦⁰⟧Φι∧⁻λη⁻λζδ
</code></pre>
<p>Get the multidimensional index of the result element.</p>
<pre><code>¿⁼§ιη§ιζ§≔εδ⁺§εδ§θι
</code></pre>
<p>Update that element if the coordinates in the two given axes are identical.</p>
<pre><code>»⭆¹⊟ε
</code></pre>
<p>Pretty-print the final result.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a> + <a href="https://numpy.org/doc/stable/index.html" rel="nofollow noreferrer">NumPy</a>, 24 bytes</h1>
<p>-3 bytes thanks to <a href="https://codegolf.stackexchange.com/users/91267/mukundan314">@Mukundan314</a>.</p>
<pre class="lang-python prettyprint-override"><code>lambda a,i:a.trace(0,*i)
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=zVI7TsQwFJQofQaKp61s9HaVOGGTXWm5iHFhWCKCSGIZp8hZaCIhOANn4TQ8fxAFF6CKPTNvZuSX1w-7-MdpXN-60-377Ltt-_lshruzAYP90ey8M_cPvMCrXiT66-KyH-zkPIzzYBcwLzBaxs7GGziB4koVCCWC1MhAVQg1wnU87xEahFZrhCARyEisiG5JFBSgaI5Uh3SRkZE6Dqs2OmWKfA45AkJeHRySTsaUJlFkRg2KdKmiH-X_kwIyFwjO8YWyr07qYFRkeB-O2T_Iq4zLn3qEl78wVSv1nxjV6ASSshaaMdZNjtYMPcIT9COEHR7JYJo9rbLjo90Z58zCjUDgQSUE0db1o-c8DxK1ge0NbDDM5Z9kXdP3Gw" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu2" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 115 bytes</h1>
<pre class="lang-javascript prettyprint-override"><code>f=(m,x,y,j)=&gt;(r=m.map?.((n,i)=&gt;f(n,x-1,y-1,x?j:i)),y?x?r:r.reduce(a=(u,v)=&gt;u.map?.((w,i)=&gt;a(w,v[i]))??u+v):r[j])??m
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=xVPBjtMwED1w61eMtIfarJs2aXfb7SrNiQsHOHBCrqU1rdNNaZzKTtpEiC_hsgf4KPgaxnYKC-JOpMj287w3b6yZL191tVVPT9-aOh8tvts8JSVrWcf2NF0Rk5ZRKY9ZRIhmBSI5ru0oZh3-bbZfFpSyLmszszSRUdtmo4hMScNOGNtcqGdPlbieeCEozbLm-kSXhu8F7suQ-seL97Wy9UZaZSGFhwHnEwYxg0SwAfApgxmDG7-_ZTBnsBCCgQuB0QriBK6gNnKjoMqhflRQytoU7QBlOBIXSHdc4KiI_LtwSPxNIrwsX_gc_RVmuOuTg3MycwohLvH55-EKxdDbJBymXg-dPbPGY6QmN3iaif9rJwl2nJWJt4Nvti3yXBmla5DanpUBeaj07jncKuttOz_-_Xs3IuRw6Sc9fOu2vSsXPu3x5FIU4vFvGAuKxZ_muHPW1_LPj8co4GjBE5-LoIDoLCh4CCvbVNo1RF1UGos6y85C6FBcpf4IHzpIBg8RdklJKDbv8YDdQ8ZX0cvxjsFwSCN7PBQ1Ga71WuMJm5mcIF3Bqb8YMyDr7TXtF5d9HMJaF_b63ds30VEaq0hLKb0f_GrvKK_MK7l5JISXDFoGHQMlqCN9wrrRuK2hwiHIwywiN6DVQUWHake8tEXnelfkHamQmqbwF6rQWIXUz_Q-TNhlyH8C" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.dyalog.com/" rel="nofollow noreferrer">APL (Dyalog Unicode)</a>, 25 bytes</h1>

<pre class="lang-apl prettyprint-override"><code>{+/⍺⍉⍨(r-2)⌊⍋⍋(⍳r←⍴⍴⍺)∊⍵}
</code></pre>
<p><a href="https://tio.run/##SyzI0U2pTMzJT///v1pb/1Hvrke9nY96V2gU6RppPurpetTbDUQaj3o3Fz1qm/CodwsY7dJ81AGU2lr7/z8A" rel="nofollow noreferrer" title="APL (Dyalog Unicode) – Try It Online">Try it online!</a></p>
<p>Follows a golf suggested by Marshall. My original answer that shows the idea better:</p>
<pre class="lang-apl prettyprint-override"><code>{+/⍺⍉⍨(⍳r-2)@(⍵~⍨⍳r)⊢(r-2)@⍵⊢0⍴⍨r←⍴⍴⍺}
</code></pre>
<p>Matrix on the left, the two axes on the right. Works by noticing that tensor contraction on two axes given a tensor A is equivalent to dyadic transposition with rank(A)-2 in place of axes and iota everywhere else. Then we sum once by trailing axis. Transposition reduces rank by one, sum on trailing axis also reduces rank by one. Hence the resulting tensor has rank of rank(A)-2. Assumes quad IO of zero.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/271329/">271329</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




