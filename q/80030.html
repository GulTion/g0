<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::80030</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>006</td><td>Itr</td><td>230808T053355Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/263861#263861">bsoelch</a></td></tr>
<tr d-ix="1"><td>033</td><td>Matlab</td><td>171221T170855Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/151461#151461">LukeS</a></td></tr>
<tr d-ix="2"><td>005</td><td>Husk</td><td>171214T234530Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/150681#150681">ბიმო</a></td></tr>
<tr d-ix="3"><td>048</td><td>Octave</td><td>160516T212916Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80039#80039">Luis Men</a></td></tr>
<tr d-ix="4"><td>104</td><td>Clojure</td><td>170102T002115Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/105307#105307">NikoNyrh</a></td></tr>
<tr d-ix="5"><td>055</td><td>Julia</td><td>160517T011056Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80048#80048">Dennis</a></td></tr>
<tr d-ix="6"><td>008</td><td>J</td><td>160516T224719Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80044#80044">ljeabmre</a></td></tr>
<tr d-ix="7"><td>049</td><td>Haskell</td><td>160516T205617Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80036#80036">Anders K</a></td></tr>
<tr d-ix="8"><td>009</td><td>Jelly</td><td>160517T004311Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80047#80047">Dennis</a></td></tr>
<tr d-ix="9"><td>019</td><td>MATL</td><td>160516T193416Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80031#80031">Luis Men</a></td></tr>
<tr d-ix="10"><td>064</td><td>JavaScript ES6</td><td>160516T230207Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80045#80045">Neil</a></td></tr>
<tr d-ix="11"><td>090</td><td>Python</td><td>160516T223046Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80042#80042">orlp</a></td></tr>
<tr d-ix="12"><td>017</td><td>05AB1E</td><td>160516T211619Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80038#80038">Adnan</a></td></tr>
<tr d-ix="13"><td>041</td><td>Matlab / Octave</td><td>160516T213529Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80040#80040">Luis Men</a></td></tr>
<tr d-ix="14"><td>083</td><td>Ruby</td><td>160516T202743Z</td><td><a href="https://codegolf.stackexchange.com/questions/80030/discrete-convolution-or-polynomial-multiplication/80034#80034">Value In</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/bsoelch/OneChar.js/blob/main/ItrLang.md" rel="nofollow noreferrer">Itr</a>, 6 bytes</h1>
<p><code>##C*µS</code></p>
<p>reads two lists from standard input, returns a list</p>
<p><a href="https://bsoelch.github.io/OneChar.js/?lang=Itr&amp;src=IyNDKrVT&amp;in=WzEsMV0gWzEsNCw2LDQsMV0=" rel="nofollow noreferrer">online interpreter</a></p>
<h2>Explanation</h2>
<pre><code>##     ; read two lists from standard input
  C    ; go through all diagonals of the Cartesian product
   *   ; multiplying the elements from the two lists
    µS ; sum up the diagonals
       ; implicit output
</code></pre>
</div>
<div id="pu1" class="pu"><h1>Matlab, 33 bytes</h1>



<pre class="lang-matlab prettyprint-override"><code>@(x,y)sum(spdiags(flip(x').*y),1)
</code></pre>

<p><a href="https://tio.run/##DYnLDkAwEADvfsSurKar9TpI/If0IKhIiCZF@PrqYeYwc07X@CzBdkKI0MNLH/r7AO/mbVw92H1z8KYosg@JMVgYmNhQtKYqwgaTGBspm5JYqTq@vNCKW9KyMhh@" rel="nofollow noreferrer" title="Octave – Try It Online">Try it online!</a></p>

<p>Creates a matrix of all element-wise products of the inputs, then sums along the diagonals.
The <code>,1</code> at the end forces matlab to sum along the correct direction when one of the input vectors has length 1.</p>

<p>In Octave <code>spdiags</code> does not work for vectors, resulting in an error when one of the inputs has length 1. Matlab 2016b or newer is required for the explicit expansion of the element-wise product.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="nofollow noreferrer">Husk</a>, 5 bytes</h1>

<pre><code>mΣ∂Ṫ*
</code></pre>

<p><a href="https://tio.run/##yygtzv7/P/fc4kcdTQ93rtL6//9/tKGOrmEsiILCWAA" rel="nofollow noreferrer" title="Husk – Try It Online">Try it online!</a></p>

<p><strong>Note:</strong> When supplying the zero-polynomial/empty list, you need to specify its type (ie. <code>[]:LN</code>)!</p>

<h3>Explanation</h3>

<pre><code>mΣ∂Ṫ*  -- implicit inputs xs ys, for example: [1,-1] [1,1]
   Ṫ*  -- compute the outer product xsᵀ·ys: [[1,1],[-1,-1]]
  ∂    -- diagonals: [[1],[1,-1],[-1]]
mΣ     -- map sum: [1,0,1]
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.gnu.org/software/octave/" rel="nofollow noreferrer">Octave</a>, 48 bytes</h1>
<pre><code>@(p,q)ifft(fft([p q*0]).*fft([q p*0]))(1:end-1)
</code></pre>
<p><a href="http://ideone.com/To0xFl" rel="nofollow noreferrer"><strong>Try it here</strong></a>.</p>
<h3>Explanation</h3>
<p>Discrete convolution corresponds to multiplication of the (discrete-time) Fourier transforms. So one way to multiply the polynomials would be transform them, multiply the transformed sequences, and transform back.</p>
<p>If the <a href="https://en.wikipedia.org/wiki/Discrete_Fourier_transform" rel="nofollow noreferrer">discrete Fourier transform (DFT)</a> is used instead of the Fourier transform, the result is the <a href="https://en.wikipedia.org/wiki/Circular_convolution" rel="nofollow noreferrer"><em>circular</em> convolution</a> of the original sequences of polynomial coefficients. The code follows this route. To make circular convolution equal to standard convolution, the sequences are zero-padded and the result is trimmed.</p>
</div>
<div id="pu4" class="pu"><h2>Clojure, 104 bytes</h2>

<pre><code>#(vals(apply merge-with +(sorted-map)(for[i(range(count %))j(range(count %2))]{(+ i j)(*(% i)(%2 j))})))
</code></pre>

<p>Merging to <code>sorted-map</code> guarantees that values are returned in the correct order. I wish there were a few more test cases.</p>
</div>
<div id="pu5" class="pu"><h1>Julia, <s>62</s> 55 bytes</h1>

<pre><code>~=endof
p%q=[sum(diag(p*rot180(q'),-k))for k=1-~q:~p-1]
</code></pre>

<p><a href="http://julia.tryitonline.net/#code=ZihwLHEsZT1lbmRvZik9W3N1bShkaWFnKHAqcm90MTgwKHEnKSwtaykpZm9yIGs9MS1lKHEpOmUocCktMV0KCnByaW50bG4oZihbMSwxXSxbMV0pKQpwcmludGxuKGYoWzEsMV0sWzEsMV0pKQpwcmludGxuKGYoWzEsMV0sWzEsMiwxXSkpCnByaW50bG4oZihbMSwxXSxbMSwzLDMsMV0pKQpwcmludGxuKGYoWzEsMV0sWzEsNCw2LDQsMV0pKQpwcmludGxuKGYoWzEsLTFdLFsxLDEsMSwxLDFdKSkKcHJpbnRsbihmKFs4MDA4NSwxMzM3XSxbLTI0MzE5LDQwNl0pKQ&amp;input=" rel="nofollow">Try it online!</a></p>
</div>
<div id="pu6" class="pu"><h1>J, <s>10</s> 8 bytes</h1>

<pre><code>[:+//.*/
</code></pre>

<p>Usage:</p>

<pre><code>ppc =: [:+//.*/    NB. polynomial product coefficients 
80085 1337 ppc _24319 406
_1947587115 7 542822
</code></pre>

<p>Description: The program takes takes two lists, makes a multiplication table, then adds the numbers on the positive diagonals. </p>
</div>
<div id="pu7" class="pu"><h1>Haskell, <s>55</s> 49 bytes</h1>

<pre class="lang-hs prettyprint-override"><code>(a:b)#c=zipWith(+)(0:b#c)$map(a*)c++[]#b
_#c=0&lt;$c
</code></pre>

<p>Defines an operator <code>#</code>.</p>
</div>
<div id="pu8" class="pu"><h1><a href="http://github.com/DennisMitchell/jelly" rel="nofollow">Jelly</a>, 9 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow">bytes</a></h1>

<pre><code>0;+
×'Ṛç/
</code></pre>

<p><a href="http://jelly.tryitonline.net/#code=MDsrCsOXJ-G5msOnLw&amp;input=&amp;args=WzgwMDg1LDEzMzdd+Wy0yNDMxOSw0MDZd" rel="nofollow">Try it online!</a> or <a href="http://jelly.tryitonline.net/#code=MDsrCsOXJ-G5msOnLwrDpyJH&amp;input=&amp;args=WzEsMV0sIFsxLDFdLCBbMSwxXSwgWzEsMV0sIFsxLDFdLCBbMSwtMV0sIFs4MDA4NSwxMzM3XQ+WzFdLCBbMSwxXSwgWzEsMiwxXSwgWzEsMywzLDFdLCBbMSw0LDYsNCwxXSwgWzEsMSwxLDEsMV0sIFstMjQzMTksNDA2XQ" rel="nofollow">verify all test cases</a>.</p>

<h3>How it works</h3>

<pre><code>×'Ṛç/  Main link. Arguments: p, q (lists)

×'     Spawned multiplication; multiply each item of p with each item of q.
  Ṛ    Reverse the rows of the result.
   ç/  Reduce the rows by the helper link.


0;+    Helper link. Arguments: p, q (lists)

0;     Prepend a 0 to p.
  +    Perform vectorized addition of the result and q.
</code></pre>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, 19 bytes</h1>
<pre><code>PiYdt&quot;TF2&amp;YStpsw]xx
</code></pre>
<p><a href="http://matl.tryitonline.net/#code=UGlZZHQiVEYyJllTdHBzd114eA&amp;input=WzEsMV0KWzEsNCw2LDQsMV0" rel="nofollow noreferrer"><strong>Try it online!</strong></a></p>
<h3>Explanation</h3>
<p>This builds a block-diagonal matrix with the two inputs, reversing the first. For example, with inputs <code>[1 4 3 5]</code>, <code>[1 3 2]</code> the matrix is</p>
<pre><code>[ 5 3 4 1 0 0 0
  0 0 0 0 1 3 2 ]
</code></pre>
<p>Each entry of the convolution is obtained by shifting the first row one position to the right, computing the product of each column, and summing all results.</p>
<p>In principle, the shifting should be done padding with zeros from the left. Equivalently, <em>circular</em> shifting can be used, because the matrix contains zeros at the appropriate entries.</p>
<p>For example, the first result is obtained from the shifted matrix</p>
<pre><code>[ 0 5 3 4 1 0 0
  0 0 0 0 1 3 2 ]
</code></pre>
<p>and is thus <code>1*1 == 1</code>. The second is obtained from</p>
<pre><code>[ 0 0 5 3 4 1 0
  0 0 0 0 1 3 2 ]
</code></pre>
<p>and is thus <code>4*1+1*3 == 7</code>, etc. This must be done <code>m+n-1</code> times, where <code>m</code> and <code>n</code> are the input lengths. The code uses a loop with <code>m+n</code> iterations (which saves some bytes) and discards the last result.</p>
<pre><code>P          % Take first input (numeric vactor) implicitly and reverse it
i          % Take second input (numeric vactor) 
Yd         % Build diagonal matrix with the two vectors
t          % Duplicate
&quot;          % For each column of the matrix
  TF2&amp;YS   %   Circularly shift first row 1 step to the right
  t        %   Duplicate
  p        %   Product of each column
  s        %   Sum all those products
  w        %   Swap top two elements in stack. The shifted matrix is left on top
]          % End for
xx         % Delete matrix and last result. Implicitly display
</code></pre>
</div>
<div id="pu10" class="pu"><h2>JavaScript (ES6), 64 bytes</h2>

<pre><code>(a,b)=&gt;a.map((n,i)=&gt;b.map((m,j)=&gt;r[j+=i]=m*n+(r[j]||0)),r=[])&amp;&amp;r
</code></pre>

<p>Returns the empty array if either input is empty. Based on my answer to <a href="https://codegolf.stackexchange.com/a/78582/17602">Polynomialception</a>.</p>
</div>
<div id="pu11" class="pu"><h1>Python, 90 bytes</h1>

<pre><code>lambda p,q:[sum((p+k*[0])[i]*(q+k*[0])[k-i]for i in range(k+1))for k in range(len(p+q)-1)]
</code></pre>
</div>
<div id="pu12" class="pu"><h1><a href="http://github.com/Adriandmen/05AB1E" rel="nofollow">05AB1E</a>, <s>18</s> 17 bytes</h1>

<h3>Code</h3>

<pre><code>0Ev²¹g&lt;Å0«y*NFÁ}+
</code></pre>

<h3>Explanation</h3>

<p><strong>The theory behind:</strong></p>

<p>To find the convolution, let's take the example <code>[1, 2, 3]</code>, <code>[3, 4, 5]</code>. We position the values of the first array upside down and vertically, like this:</p>

<pre><code>3
2
1
</code></pre>

<p>Now, we place the second array like a ladder and multiply it by :</p>

<pre><code>3 ×       [3  4  5]
2 ×    [3  4  5]
1 × [3  4  5]
</code></pre>

<p>Resulting into:</p>

<pre><code>        9   12   15
    6   8   10
3   4   5
</code></pre>

<p>Then, we add them up, resulting into:</p>

<pre><code>        9   12   15
    6   8   10
3   4   5       

3   10  22  22   15
</code></pre>

<p>So, the convolution is <code>[3, 10, 22, 22, 15]</code>.</p>

<p><strong>The code itself:</strong></p>

<p>We are going to do this step by step using the <code>[1, 2, 3]</code>, <code>[3, 4, 5]</code> as the test case.</p>

<pre><code>0Ev²¹g&lt;Å0«y*NFÁ}+
</code></pre>

<p>We first push <code>0</code> and then we <code>E</code>valuate the first input array. We map over each element using <code>v</code>.</p>

<p>So, for each element, we push the second array with <code>²</code> and then the length of the first array using <code>¹g</code> and decrease this by 1 (with <code>&lt;</code>). We convert this into a <strong>list of zeros</strong> with <strong>(length 1st array - 1)</strong> zeros, using <code>Å0</code> and append this to our list. Our stack now looks like this for the first item in the input list:</p>

<pre><code>[3, 4, 5, 0, 0]
</code></pre>

<p>We multiply this array with the current item, done with <code>y*</code>. After that, we push <code>N</code>, which indicates the index of the current item (zero-indexed) and rotate the array that many times to the right using <code>FÁ}</code>. Finally, we add this to our initial value (<code>0</code>). So, what basically is done is the following:</p>

<pre><code>[0, 0, 9, 12, 15] +
[0, 6, 8, 10, 0] +
[3, 4, 5, 0, 0] =

[3, 10, 22, 22, 15]
</code></pre>

<p>Which is then implicitly printed. Uses <strong>CP-1252</strong> encoding. <a href="http://05ab1e.tryitonline.net/#code=MEV2wrLCuWc8w4Uwwqt5Kk5Gw4F9Kw&amp;input=WzgwMDg1LCAxMzM3XQpbLTI0MzE5LCA0MDZd" rel="nofollow">Try it online!</a>.</p>
</div>
<div id="pu13" class="pu"><h1>Matlab / Octave, 41 bytes</h1>
<pre><code>@(p,q)poly([roots(p);roots(q)])*p(1)*q(1)
</code></pre>
<p>This defines an anonymous function. To call it, assign it to a variable or use <code>ans</code>.</p>
<p><a href="http://ideone.com/mjDuII" rel="nofollow noreferrer"><strong>Try it here</strong></a>.</p>
<h3>Explanation</h3>
<p>This exploits the facts that</p>
<ul>
<li>The (possibly repeated) roots characterize a polynomial up to its leading coefficient.</li>
<li>The product of two polynomials has the roots of both.</li>
</ul>
<p>The code computes the roots of the two polynomials (function <code>roots</code>) and concatenates them into a column array. From that it obtains the coefficients of the product polynomial with a leading <code>1</code> (function <code>poly</code>). Finally the result is multiplied by the leading coefficients of the two polynomials.</p>
</div>
<div id="pu14" class="pu"><h1>Ruby, 83 bytes</h1>
<p>Almost directly pulled out of <a href="https://codegolf.stackexchange.com/questions/76218/expand-roots-into-a-polynomial/76268#76268">an answer I did earlier regarding expanding roots into a polynomial</a>.</p>
<pre><code>-&gt;a,b{q=a.map{|c|r=b.map{|e|e*c};b=[0]+b;r}
q.pop.zip(*q).map{|e|(e-[p]).reduce:+}}
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/80030/">80030</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




