<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::42333</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>027</td><td>Vyxal 3</td><td>240124T165834Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/269531#269531">pacman25</a></td></tr>
<tr d-ix="1"><td>098</td><td>JavaScript ES6</td><td>141216T181650Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42416#42416">edc65</a></td></tr>
<tr d-ix="2"><td>122</td><td>JavaScript ES6</td><td>141215T174659Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42385#42385">apsiller</a></td></tr>
<tr d-ix="3"><td>121</td><td>Python 2</td><td>141216T051639Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42399#42399">xnor</a></td></tr>
<tr d-ix="4"><td>156</td><td>R</td><td>141216T092338Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42401#42401">plannapu</a></td></tr>
<tr d-ix="5"><td>128</td><td>Python 2</td><td>141213T183103Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42344#42344">feersum</a></td></tr>
<tr d-ix="6"><td>140</td><td>Python 2</td><td>141213T074227Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42335#42335">KSab</a></td></tr>
<tr d-ix="7"><td>043</td><td>Pyth</td><td>141213T205149Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42345#42345">isaacg</a></td></tr>
<tr d-ix="8"><td>305</td><td>C#</td><td>141213T233112Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42346#42346">Carl Wal</a></td></tr>
<tr d-ix="9"><td>063</td><td>CJam</td><td>141213T074844Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42336#42336">Optimize</a></td></tr>
<tr d-ix="10"><td>074</td><td>APL NARS2000</td><td>141213T130427Z</td><td><a href="https://codegolf.stackexchange.com/questions/42333/verify-a-minesweeper-board/42341#42341">marinus</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-3" rel="nofollow noreferrer">Vyxal 3</a>, 27 bytes</h1>
<pre><code>ėf:⸠'X=Ḟ£?ṂÞȯ1⁾ƛ'XC}¥'XẠᵛᶲ₌
</code></pre>
<p><a href="https://vyxal.github.io/latest.html#WyIiLCIiLCLEl2Y64rigJ1g94biewqM/4bmCw57IrzHigb7GmydYQ33CpSdY4bqg4bWb4bay4oKMIiwiIiwiWFg0WDIgNVg2WDQgWFg2WFggNFhYNTQgMlg0WFgiLCIzLjQuMSJd" rel="nofollow noreferrer">Try it Online!</a></p>
</div>
<div id="pu1" class="pu"><h1>JavaScript (ES6) 98</h1>
<p>Using <em>some</em> to apply a function to each character of the string.<br />
The function returns</p>
<ul>
<li>false if blank</li>
<li>NaN if 'X' (repeatedly subtracting values from a non numeric char like 'X' gives NaN)</li>
<li>A numeric value of 0 if there are the right number of adiacent 'X', else non 0.<br />
The inner check is made using <em>map</em> just because it's shorter than <em>forEach</em></li>
</ul>
<p><em>some</em> returns true at the first truthy value (in this case, nonzero) meaning a failed check. The result is negated to give a more recognizable true/false.</p>
<pre class="lang-js prettyprint-override"><code>F=v=&gt;![...v].some(
  (x,p)=&gt;x!=' '&amp;&amp;[1,-1,l=v.search(' '),-l,++l,-l,++l,-l].map(q=&gt;x-=v[p+q]=='X')|x
)
</code></pre>
<p><strong>Test</strong> In FireFox / FireBug console</p>
<pre><code>;[&quot;02X2 13X2 X212&quot;,&quot;XXXX XXXX X7XX XXXX&quot;,&quot;XX5X2 5X6X4 XX6XX 4XX54 2X5XX&quot;
,&quot;02X2 13X2 X211&quot;,&quot;XXXX XXXX XXXX XXXX&quot;,&quot;XX4X2 5X6X4 XX6XX 4XX54 2X4XX&quot;,&quot;111 1X1 111&quot;]
.forEach(t =&gt; console.log(t, F(t)))
</code></pre>
<p><em>Output</em></p>
<pre><code>02X2 13X2 X212 false
XXXX XXXX X7XX XXXX false
XX5X2 5X6X4 XX6XX 4XX54 2X5XX false
02X2 13X2 X211 true
XXXX XXXX XXXX XXXX true
XX4X2 5X6X4 XX6XX 4XX54 2X4XX true
111 1X1 111 true
</code></pre>
</div>
<div id="pu2" class="pu"><h1>JavaScript (ES6), <s>135</s> <s>133</s> <s>125</s> 122</h1>

<pre><code>f=s=&gt;s.split(" ")[e="every"]((l,i,a)=&gt;[...l][e]((c,j)=&gt;!(-[-1,0,k=1][e]((y,m,q)=&gt;q[e](x=&gt;k+=(a[i+y]||0)[j+x]=="X"))-c+k)))
</code></pre>

<p>Provide input to the function as a string:</p>

<pre><code>f("XX4X2 5X6X4 XX6XX 4XX54 2X4XX");
</code></pre>

<p>For an explanation, see the old version, below. The new version replaces the <code>for</code> loops with <code>every</code> calls, and uses the variable <code>e="every"</code> to do <code>someArray[e](...)</code> instead of <code>someArray.every(...)</code>.</p>

<p>Also, the counter <code>k</code> is now indexed at <code>1</code> so that the <code>k+=...</code> expression is always truthy, in order to keep the <code>every</code> loop running. We eliminate that extra <code>1</code> by subtracting the <code>true</code> result (which numerically coerces to <code>1</code>) returned by the <code>every</code> operation <code>[-1,0,k=1][e](...)</code>.</p>

<hr>

<p>Old version:</p>

<pre><code>f=s=&gt;s.split(" ").every((l,i,a)=&gt;[...l].every((c,j)=&gt;{q=[-1,k=0,1];for(y of q)for(x of q)k+=(a[i+y]||0)[j+x]=="X";return c=="X"||k==c}))
</code></pre>

<p>Code with spaces and comments:</p>

<pre><code>f=s=&gt;s.split(" ")                 // split on spaces
      .every((l,i,a)=&gt;             // for every line
                                   //     l: line string, i: line number, a: whole array
          [...l].every((c,j)=&gt;{    // for every character
                                   //     c: character, j: index in string
              q=[-1,k=0,1];        // define counter k=0 and q=[-1,0,1]
              for(y of q)          // use q to loop adjacent spaces
                  for(x of q)

                      k+=              // add the following boolean to k:

                          (a[i+y]      //   from line number i+y...
                                 ||0)  //   (or a dummy zero, to prevent lookups on undefined)
                          [j+x]        //   ...get index j+x from the above value...
                                =="X"; //   ...and compare it to "X"

              return !(k-c)     // after the loop, this character passed if
                                // the char equals the number of counted X's (so k-c is 0)
                                // or it is an X itself (so `k-c` is NaN)
          })
      )
</code></pre>

<p>The JavaScript <code>every</code> array method takes a callback and applies the callback to every element of the array. If any callback returns a falsey value, the <code>every</code> call returns <code>false</code>.</p>

<p>Booleans in JS are coerced to 1 or 0 when part of an addition. For each surrounding space, we "add" the boolean result of comparing its value to <code>X</code> and then add that value to the counter <code>k</code> in the expression <code>k += (... == "X")</code>. Therefore, <code>k</code> contains a count of the number of surrounding <code>X</code>s, because <code>true</code> counts as <code>1</code> and <code>false</code> counts as <code>0</code>.</p>
</div>
<div id="pu3" class="pu"><h2>Python 2, 121</h2>

<pre class="lang-python prettyprint-override"><code>def f(B):n=B.find(' ')+1;R=range(len(B));print all(B[I]in' X'+`sum(2&gt;I%n-i%n&gt;-2&lt;I/n-i/n&lt;2&lt;B[i]&gt;'W'for i in R)`for I in R)
</code></pre>

<p>This is heavily inspired by <a href="https://codegolf.stackexchange.com/a/42344/20260">feersum's answer</a>. The order of the day is overkill: rather than checking for mines in the 9 neighbors of the cell, check every single cell to see whether it's a neighboring mine.</p>

<p>We check if two cells are neighbors with <code>2&gt;r&gt;-2&lt;c&lt;2</code>, where <code>r</code> and <code>c</code> are the row and column differences of cells, equivalent to <code>{r,c}&lt;{-1,0,1}</code>. These coordinates are computed from the cell indices <code>I</code> and <code>i</code> as <code>c=I%n-i%n</code> and <code>r=I/n-i/n</code>. It's more efficient to index directly into the string and extract rows and columns than to convert it to a 2D object like a list of lists. The mine check is <code>B[i]&gt;'W'</code>, equivalent here to <code>B[i]=='X'</code>.</p>

<p>Using <code>enumerate</code> would have saved two characters over the ugly <code>range(len(B))</code> except that it returns an iterator object which does not support two nested loops through it.</p>
</div>
<div id="pu4" class="pu"><h1>R, 156 chars</h1>
<pre><code>a=b=do.call(rbind,strsplit(scan(,&quot;&quot;),&quot;&quot;));for(i in 1:nrow(a))for(j in 1:ncol(a))b[i,j]=sum(a[abs(i-row(a))&lt;2&amp;abs(j-col(a))&lt;2]==&quot;X&quot;);v=a!=&quot;X&quot;;all(b[v]==a[v])
</code></pre>
<p>With indents, spaces and line breaks, for legibility:</p>
<pre class="lang-r prettyprint-override"><code>a = b = do.call(rbind,strsplit(scan(,&quot;&quot;),&quot;&quot;)) #Reads stdin and turn into a matrix
for(i in 1:nrow(a)) #Ugly, ugly loop
    for(j in 1:ncol(a))
        b[i,j] = sum(a[abs(i-row(a))&lt;2 &amp; abs(j-col(a))&lt;2]==&quot;X&quot;)
v = a!=&quot;X&quot;
all(b[v]==a[v])
</code></pre>
<p>Examples:</p>
<pre><code>&gt; a=b=do.call(rbind,strsplit(scan(,&quot;&quot;),&quot;&quot;));for(i in 1:nrow(a))for(j in 1:ncol(a))b[i,j]=sum(a[abs(i-row(a))&lt;2&amp;abs(j-col(a))&lt;2]==&quot;X&quot;);v=a!=&quot;X&quot;;all(b[v]==a[v])
1: XX4X2 5X6X4 XX6XX 4XX54 2X4XX
6: 
Read 5 items
[1] TRUE
&gt; a=b=do.call(rbind,strsplit(scan(,&quot;&quot;),&quot;&quot;));for(i in 1:nrow(a))for(j in 1:ncol(a))b[i,j]=sum(a[abs(i-row(a))&lt;2&amp;abs(j-col(a))&lt;2]==&quot;X&quot;);v=a!=&quot;X&quot;;all(b[v]==a[v])
1: XXXX XXXX XXXX XXXX
5: 
Read 4 items
[1] TRUE
&gt; a=b=do.call(rbind,strsplit(scan(,&quot;&quot;),&quot;&quot;));for(i in 1:nrow(a))for(j in 1:ncol(a))b[i,j]=sum(a[abs(i-row(a))&lt;2&amp;abs(j-col(a))&lt;2]==&quot;X&quot;);v=a!=&quot;X&quot;;all(b[v]==a[v])
1: XX5X2 5X6X4 XX6XX 4XX54 2X5XX
6: 
Read 5 items
[1] FALSE
</code></pre>
</div>
<div id="pu5" class="pu"><h1>Python 2, <s>132 129</s> 128</h1>
<pre class="lang-python prettyprint-override"><code>def f(s):w=s.find(' ');E=dict(enumerate(s));return all(E[i]in' X'+`sum(E.get(i+d/3*~w+d%3+w,5)&gt;'O'for d in range(9))`for i in E)
</code></pre>
<p>I used <code>enumerate</code> in a golf...and even used <code>range</code> elsewhere in the same program. Clearly something is wrong here.</p>
<p>Edit: Iterate over <code>dict(enumerate(s))</code> rather than <code>enumerate(s)</code>, so <code>enumerate</code> does not need to be called twice.</p>
</div>
<div id="pu6" class="pu"><h1>Python 2, 140</h1>
<pre class="lang-python prettyprint-override"><code>s=input();w=s.index(' ')+1
print all(c in'X 'or(int(c)==sum(s[max(0,a-1):max(0,a+2)].count('X')for a in[i-w,i,i+w]))for i,c in enumerate(s))
</code></pre>
</div>
<div id="pu7" class="pu"><h1>Pyth, 43</h1>

<pre><code>Jhxzd!f-@zT+" X"`sm/:+*JNztd+d2\Xm+T*kJU3Uz
</code></pre>

<p>Try it <a href="http://isaacg.scripts.mit.edu/pyth/index.py" rel="nofollow">here</a>.</p>

<p><strong>Explanation:</strong></p>

<ul>
<li><code>Jhxzd</code>: This is the location of the first space in the input + 1. (<code>z</code> in the input, <code>d</code> is space.) It is the separation in the input between vertically adjacent cells on the board.</li>
<li><code>!f</code>: This is the logical not (<code>!</code>) of a filter (<code>f</code>), which will be <code>True</code> if and only if the expression is falsy for every element of the sequence.</li>
<li><code>-@zT</code>: Take the character at location <code>T</code> (the lambda variable) from the input, and remove any appearances of: (This will be truthy if the character is not removed, and falsy if it is.</li>
<li><code>+" X"</code>: Remove space, X, and</li>
<li><code>`</code>: Repr of</li>
<li><code>sm</code>: sum  of map to</li>
<li><code>/           \X</code>: count of "X" in</li>
<li><code>:+*JNz</code>: The slice of the input prefixed by <code>J</code> dummy characters</li>
<li><code>td+d2</code>: From d-1 to d+2.</li>
<li><code>m+T*kJU3</code>: For d in [T, T+J, T+2*J].</li>
<li><code>Uz</code> For T in <code>range(len(input))</code>.</li>
</ul>
</div>
<div id="pu8" class="pu"><h1>C#, <strike>321 320</strike> 305</h1>

<pre><code>bool s(string B){var L=B.Split(' ').Select(s=&gt;' '+s+' ').ToList();var b=new string(' ',L[0].Length);L.Insert(0,b);L.Add(b);Func&lt;int,int,IEnumerable&lt;int&gt;&gt;E=Enumerable.Range;return E(1,b.Length-2).All(x=&gt;E(1,L.Count-2).All(y=&gt;L[y][x]=='X'||L[y][x]-'0'==E(x-1,3).Sum(X=&gt;E(y-1,3).Sum(Y=&gt;L[Y][X]=='X'?1:0))));}
</code></pre>

<p>First attempt golfing anything, and I know that C# isn't the ideal language.</p>

<p>I hope writing an instance method is allowed, otherwise add another 7 characters for <code>static</code>.</p>

<p>Spaced out:</p>

<pre><code>bool s(string B) {
    var L = B.Split(' ').Select(s =&gt; ' ' + s + ' ').ToList();
    var b = new string(' ', L[0].Length);
    L.Insert(0, b);
    L.Add(b);
    Func&lt;int, int, IEnumerable&lt;int&gt;&gt; E = Enumerable.Range;
    return E(1, b.Length - 2).All(x =&gt;
        E(1, L.Count - 2).All(y =&gt;
            L[y][x] == 'X' ||
            L[y][x] - '0' == E(x - 1, 3).Sum(X =&gt;
                E(y - 1, 3).Sum(Y =&gt;
                  L[Y][X] == 'X' ? 1 : 0))));
}
</code></pre>

<p>Using Linq saves some space compared to for loops, but it's harder to debug.</p>

<p>I learned a few things like converting <code>char =&gt; int</code> by subtracting <code>'0'</code>.</p>

<p>It seemed simpler to pad out the board with spaces so iterating over it would be easier.</p>
</div>
<div id="pu9" class="pu"><h1>CJam, <s>70 65</s> 63 bytes</h1>
<pre><code>1l_S#):L)S*+:Q{Ii33/2%[0~1LL)L(L~)L~_))]W):Wf+Qf='X/,(scI==&amp;}fI
</code></pre>
<p>This can be golfed a lot.</p>
<p>Gives <code>1</code> for a valid board and <code>0</code> for an invalid board.</p>
<p><strong>Test cases</strong></p>
<pre><code>{-1:W;
1l_S#):L)S*+:Q{Ii33/2%[0~1LL)L(L~)L~_))]W):Wf+Qf='X/,(scI==&amp;}fI
}6*]N*
</code></pre>
<p>Input</p>
<pre><code>02X2 13X2 X211
XXXX XXXX XXXX XXXX
XX4X2 5X6X4 XX6XX 4XX54 2X4XX
02X2 13X2 X212
XXXX XXXX X7XX XXXX
XX5X2 5X6X4 XX6XX 4XX54 2X5XX
</code></pre>
<p>Output</p>
<pre><code>1
1
1
0
0
0
</code></pre>
<p><a href="http://cjam.aditsu.net/" rel="nofollow noreferrer">Try it online here</a></p>
</div>
<div id="pu10" class="pu"><h2>APL (NARS2000) (74)</h2>

<pre><code>{~0∊(G&gt;9)∨G=(⍴G)↑{+/∊9&lt;⍵∘⌷¨G∘.⊖(G←2-⍳3)∘.⌽⊂Z}¨⍳⍴Z←G↑⍨2+⍴G←¯1+⎕D⍳⊃⍵⊂⍨⍵≠' '}
</code></pre>

<p>Also works in Dyalog APL if <code>⎕ML</code> is set to <code>3</code>.</p>

<p>Explanation:</p>

<ul>
<li><code>⊃⍵⊂⍨⍵≠' '</code>: split <code>⍵</code> on the spaces and use the lists to form a matrix.</li>
<li><code>G←¯1+⎕D⍳</code>: find the index in <code>⎕D</code> for each value, subtract 1, and store this in <code>G</code>. (<code>⎕D</code> contains the digits, any non-digit will turn into <code>10</code>).</li>
<li><code>Z←G↑⍨2+⍴G</code>: add two lines and columns of zeroes at the edge of the matrix, to deal with the wraparound</li>
<li><code>{</code>...<code>}¨⍳⍴Z</code>: for each position in <code>Z</code>, find the amount of bombs in the Moore neighbourhood of that position:
<ul>
<li><code>G∘.⊖(G←2-⍳3)∘.⌽⊂Z</code>: rotate <code>Z</code> left, right, up, down, left-up, right-up, left-down, and right-down.</li>
<li><code>⍵∘⌷¨</code>: for each of these, find the element at <code>⍵</code> in each of these rotated matrices</li>
<li><code>+/∊9&lt;</code>: count how many elements are higher than 9 (this is the amount of bombs).</li>
</ul></li>
<li><code>(⍴G)↑</code>: remove the added lines of zeroes again,</li>
<li><code>G=</code>: check whether each element in <code>G</code> is equal to the amount of bombs surrounding that position (this should be true for all non-bomb squares),</li>
<li><code>(G&gt;9)∨</code>: and check whether the elements in <code>G</code> are higher than <code>9</code> (these are the bombs).</li>
<li><code>~0∊</code>: return <code>1</code> if the resulting matrix contains no zeroes (=all squares are either bombs or the correct number), and <code>0</code> if it does. </li>
</ul>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/42333/">42333</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




