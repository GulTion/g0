<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::273527</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>125</td><td>sed r</td><td>240612T210457Z</td><td><a href="https://codegolf.stackexchange.com/questions/273527/build-the-first-6-letters-of-an-italian-codice-fiscale-tax-identification-numbe/273627#273627">Jan Blum</a></td></tr>
<tr d-ix="1"><td>234</td><td>Bash</td><td>240610T103004Z</td><td><a href="https://codegolf.stackexchange.com/questions/273527/build-the-first-6-letters-of-an-italian-codice-fiscale-tax-identification-numbe/273592#273592">Themooni</a></td></tr>
<tr d-ix="2"><td>052</td><td>05AB1E</td><td>240610T082935Z</td><td><a href="https://codegolf.stackexchange.com/questions/273527/build-the-first-6-letters-of-an-italian-codice-fiscale-tax-identification-numbe/273586#273586">Kevin Cr</a></td></tr>
<tr d-ix="3"><td>176</td><td>Python</td><td>240608T200802Z</td><td><a href="https://codegolf.stackexchange.com/questions/273527/build-the-first-6-letters-of-an-italian-codice-fiscale-tax-identification-numbe/273532#273532">Nicola S</a></td></tr>
<tr d-ix="4"><td>138</td><td>JavaScript ES6</td><td>240608T142542Z</td><td><a href="https://codegolf.stackexchange.com/questions/273527/build-the-first-6-letters-of-an-italian-codice-fiscale-tax-identification-numbe/273528#273528">Arnauld</a></td></tr>
<tr d-ix="5"><td>082</td><td>Charcoal</td><td>240608T225309Z</td><td><a href="https://codegolf.stackexchange.com/questions/273527/build-the-first-6-letters-of-an-italian-codice-fiscale-tax-identification-numbe/273538#273538">Neil</a></td></tr>
<tr d-ix="6"><td>092</td><td>Retina 0.8.2</td><td>240608T151253Z</td><td><a href="https://codegolf.stackexchange.com/questions/273527/build-the-first-6-letters-of-an-italian-codice-fiscale-tax-identification-numbe/273529#273529">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.gnu.org/software/sed/" rel="nofollow noreferrer">sed</a> -r, 125 bytes</h1>
<p>Expecting all-uppercase input</p>
<pre><code>s/ (..? \w+|\S+)$/_&amp;/
s/\W//g
:1
s/([AEIOU])([^AEIOU_])/\2\1/
t1
/^[^AEIOU_]{4}/s/(.)./\1/
s/_.*/X&amp;X/
s/(...).*_(...).*/\2\1/
</code></pre>
<p><a href="https://tio.run/##RVBNb9NAEL3Pr5gDqptWziqIExc0WU/sgemOtbaL06bNBVRxaREp4gD8ddKxC1Sa3X375vsdPn8q7@6/H4@HgKfL5Tvc/Tj/tevOF6/C/iTAIew@hnAHb1cOT6@JxYabxen17Yz2N4uwe71bBXhcQbj9z/588zt4@HKxDJPzEPbLszCejBP0Js6f7f@@z/nHI5XNZJilM5UkQMojXpAfHmIUWHPfU9lv8ZJzJRApK6EOWIlHZYZoFWNtupmQpBpjQ6qcau7AYVbre0a7wqogJ9WgouQMqdQNZ/FvFsONAafkYKomlmuBjai0reE6D4m9ZBcbgZq4p0RIg/fo/c@ZcoVFj43ZpodaBhUf2fAfEmgYleA9RWvn@mvKbvLCFC@U4RVtE2dQdlGs68T9imsDLSxv2ObFzTd41kMHqZ2IkxhiMN9TjzkVLjgNSEWpVLpwPYNnunrSESSJ0XSKVS0ox5kx17ajFkxw3EI7bV1nSYaePHi9VlI0bF1gJ6EjvbR5GNI1TURP8QPy6Lq71NBZEkIrEosq9FvdpoSphmHrI8DIk7cTXXN2q@HPw9fHLw/3h2P57Qk" rel="nofollow noreferrer" title="sed – Try It Online">Try it online!</a></p>
<h1><a href="https://www.gnu.org/software/sed/" rel="nofollow noreferrer">sed</a> -r, 135 bytes</h1>
<p>Variant that accepts input in either case</p>
<pre><code>s/./\U&amp;/g
s/ (..? \w+|\S+)$/_&amp;/
s/\W//g
:1
s/([AEIOU])([^AEIOU_])/\2\1/
t1
/^[^AEIOU_]{4}/s/(.)./\1/
s/_.*/X&amp;X/
s/(...).*_(...).*/\2\1/
</code></pre>
<p><a href="https://tio.run/##RVDbbtpAEH2fr5iHCkMiY1H1qS@VuYS0IoBKaFHjBA1mMaOudtB6ncS9/Hrp2L1E2svZMztnZk5p9nHhqvO5TPpJtu4kBZQJdvv9d5g9Xf7IVpe9V8m2kyibfU40@nagsHuXTt4v1ve97t1Di7b3vSR7nQ0SCANIHv6z39/8TPR7v6fig0Zk279INp1NA7WI8hfbv/ef/PM5jY@kCz9yKZYdQ2rNM96QblPlOcPQhEDxbY2fjN8zjMhbwlmFY9Zf3sBI9ganYg8NYlfg6EjWGleYEhR6KyEYXHzDcZQqaQXG5JRJLRdH41mfngWvBCbOKRirGosvGK7Y8ukkOPSVMypZ5keGKZlAjjCttEbQt/Hk9xgFvBY5BJhyZVlbFvyHGK4Nzgg@UC6nVn9IfqdFX5johRL8QrUzHmZGTZGyZI1bHArMooU/GGkHF53gsfVjVnGhRN6YwQLt2dRoU@HGuAopii3FOflgQDPVPS4J5pznYgX3OlqU@rxlRL1d0QkWjJsals3UhWcnmPpQqd6SXS64VIOVhBXZR2mbIbujhgiUf8XJc34ktRpW4phwEc0NWwu3ta2dw3kB61pbgI1poiu2O@N1Fb/kFFhceY79bw" rel="nofollow noreferrer" title="sed – Try It Online">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.gnu.org/software/bash/" rel="nofollow noreferrer">Bash</a>, 234 bytes</h1>
<pre class="lang-bash prettyprint-override"><code>s=${@: -2:1}
l=${@: -1}
u=1
(($#&gt;2&amp;&amp;`wc -m&lt;&lt;&lt;$s`&lt;4&amp;&amp;`grep -c [\'-]&lt;&lt;&lt;$l`&lt;1))&amp;&amp;l=$s$l&amp;&amp;u=2
f=${@:1:(($#-$u))}
v=&quot;[aeiou '-]&quot;
p=[!aeiou]
c=${f//$v}
((`wc -m&lt;&lt;&lt;$c`&gt;4))&amp;&amp;c=${c:0:1}${c:2}
head -c3&lt;&lt;&lt;${l//$v}${l//$p}x
head -c3&lt;&lt;&lt;$c${f//$p}x
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=VY9NboMwEIX3PsWUWgYvrADNorIARVVXvQJFwnFNiUSEBXFSKfVJumGRHqpX6ClqQ6Qqq_fm75uZr8tWjO10iSMafZtDwx5_fsccnzccWMoTi7pr4KzJExRF-L5ICalPEtg-yzI81tnaxe-D0sAklK8hq3y-q7OEUkIcYMQdISZPUTPDEu4pDBtKLTrmQSnUrjfg5gKk8_JuDiskXXOzWuGjdVv_98m6WHuuL0seuxu9pha1Sry5Cx5807mbBxfV9uOmKBeuS18_LiiKAUdKtj0EL0L2uodnBU9i2IphF8AnHAYIS260VgOvQu-7_jR7itBCmaZF_wA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>🏆: broke syntax highlighting</p>
<p>Call as a bash function or script, with the name as arguments in lowercase. You may need to escape 's as otherwise bash will try parsing a string.<br />
ATO link has automatic lowercase conversion for your convenience.</p>
<p>thanks to @GammaFunction for <a href="https://codegolf.stackexchange.com/a/273419/88192">his entry into a previous challenge</a> that helped me separate consonnants and vowels.</p>
<p>explanation:</p>
<pre class="lang-bash prettyprint-override"><code># implicit: bash automatically separates arguments by whitespace, so calling `script a b c` is equivalent to calling script(a, b, c) in other languages
s=${@: -2:1}     # set s to the (s)econd to last argument
l=${@: -1}       # set l to the (l)ast argument
u=1              # u counts the numer of arguments that make up the last name, 1 by default
  $#&gt;2           # there are more than 2 arguments
        `wc -m&lt;&lt;&lt;$s`&lt;4     # the second to last argument has 2 characters or less (wc counts a trailing char, and &lt; is shorter than &lt;=, so we use 4 instead of 2)
                        `grep -c [\'-]&lt;&lt;&lt;$l`&lt;1  # the last argument has no `'` or `-`
((    &amp;&amp;              &amp;&amp;                      ))  # if the 3 last expressions are all true...
                                                &amp;&amp;l=$s$l&amp;&amp;u=2 # then concatenate the last 2 arguments, making the last name, and set u to 2
f=${@:1:(($#-$u))} # set f to all arguments until u, making the (f)irst name
v=&quot;[aeiou '-]&quot; #store a regular expression for later
p=[!aeiou]     #store another regular expression
c=${f//$v}     #set c to the (c)onsonnants in the first name, using the first regex.
((`wc -m&lt;&lt;&lt;$c`&gt;4))  #if there are more than 3 of them...
                  &amp;&amp;c=${c:0:1}${c:2}  #set c to c[0]+c[2:], skipping the second consonnant
           ${l//$v}${l//$p}x   #concat consonnants and vowels in the last name, and an additionnal x
head -c3&lt;&lt;&lt;                    #trim the previous to 3 characters and output to stdout
head -c3&lt;&lt;&lt;$c${f//$p}x         #do the same to the first name, but using $c, which may have the second consonnant missing
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, <s>53</s> 52 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>#R©¬a®g3@®1èg3‹**&gt;®g‚£íðýlεáΣžMså}ÀDžNÃg4@N*.$Á'x«3£
</code></pre>
<p>Outputs as a lowercase pair of 3-char strings.</p>
<p><a href="https://tio.run/##AWkAlv9vc2FiaWX//yNSwqnCrGHCrmczQMKuMcOoZzPigLkqKj7CrmfigJrCo8Otw7DDvWzOtcOhzqPFvk1zw6V9w4BExb5Ow4NnNEBOKi4kw4EneMKrM8Kj//9HaXVsaWV0IEx1IERpIE1hcmU" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##TZHNihNBEMdfpRiFgbARJJ7dnWz2A8kmYbPKoniodDozhU1X6OkJGWEhIvgAHr1JEBR18eLBg3uYYa/7EHmRWD27itBDVf26pj7@zTlOSG8X5W4Em3fvIdott/dOqy/VN6wu085edfmw/px2NqtfrdZjIZvVh2pdf69/1L/Nzc/64836@uokrz9d1Kve9dWgfps@2hu0Htyv38TL6munWm8vdrYvoqSdoRw4pZwNWYp2osToJZygfLpQKpCu9h7bZyU8024awD46g9AvoEeS6XRAPNVwxGZ265NNYT9DY7RNdR5YJv@w9xqGr6EXJ4INC@@hFZYYSjPtqAGOGA7D3YG14vakLrFLw@UhGZrPGbqusFqK5yoL@Ai1R4uQFNLPN0Q7dFOIPRwzz3wgVBiSRRj@eiHvWEMfxT5BxfOmVxfdBJtJ/rH4f8jwHEurnfh9LcJxnpPkGOiGkfvx0M00N8KwbLa4U6xfUCpIBbkoJDY29GsKBKBtARi3DbYVOh80lQqiMuVhwAEpxYZhKmvHiVN3jOUdxjiXYEhwXoodBV1SR5Yhcb5oao/IKoaRPIdgicdoFtwMiGaCt8ijegUHS5WhPE0AbAlhGA80GSPxWWlKa2GQiv@0lLHEnuuQMyYz0U5OGr38Aw" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<p>Step 1: Split the input into first name and surname:</p>
<pre class="lang-python prettyprint-override"><code>#               # Split the (implicit) input-string on spaces
 R              # Reverse this list
  ©             # Store it in variable `®` (without popping)
   ¬            # Push its first item (without popping the list)
    a           # Check if it's alphabetic (aka doesn't contain any &quot;'-&quot;-chars)
   ®            # Push list `®` again
    g           # Pop and push the length of this list
     3@         # Check if this list-length is &gt;=3
   ®            # Push list `®` yet again
    1è          # Pop and leave just its second item
      g         # Pop and push the length of this string
       3‹       # Check if this string-length is &lt;3
   **           # Combine all three checks
     &gt;          # Increment this 0 or 1 to 1 or 2
      ®g        # Push the length of list `®` again
        ‚       # Pair the two together
         £      # Split the list into parts of those sizes
          í     # Reverse each inner list
           ðý   # Join each inner list with space delimiter
</code></pre>
<p><a href="https://tio.run/##AUMAvP9vc2FiaWX//yNSwqnCrGHCrmczQMKuMcOoZzPigLkqKj7CrmfigJrCo8Otw7DDvf//R2l1bGlldCBMdSBEaSBNYXJl" rel="nofollow noreferrer">Try just step 1 online.</a></p>
<p>Step 2: Convert the surname and first name to the three letter Codice fiscale portions, and output the resulting pair:</p>
<pre class="lang-python prettyprint-override"><code>l               # Convert everything to lowercase
 ε              # Map over the pair with surname and first name:
  á             #  Only leave the letters, removing &quot; '-&quot;-characters
   Σ            #  Sort these letters by:
    žM          #   Push the vowels(-y) constant string: &quot;aeiou&quot;
      s         #   Swap so the current letter is at the top
       å        #   Check if it's in this string
   }À           #  After the sort: rotate the string once towards the left
     D          #  Duplicate this string
      žNÃ       #  Only keep all consonants(+y) of this copy
         g      #  Pop and push the length of this consonants-string
          4@    #  Check if this consonants-length is &gt;=4
            N*  #  Multiply it by the 0-based map-index
     .$         #  Remove that many leading characters
       Á        #  Rotate the string back once towards the right
        'x«    '#  Append &quot;x&quot;
           3£   #  Pop and keep the first three characters
                # (after which the result is output implicitly)
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 176 bytes</h1>
<pre class="lang-python prettyprint-override"><code>lambda F,K=lambda S,b=&quot;[\W&quot;:sub(b+&quot;AEIOU]&quot;,&quot;&quot;,S):[(sub(f&quot;(.){Q}.)&quot;,r&quot;\1\2&quot;,K(P))+K(P,&quot;[^&quot;)+&quot;X&quot;)[:3]for P,Q in zip(split(&quot; (.. ?\w+|\S+)$&quot;,F),[&quot;.(.&quot;,&quot;(&quot;])][::-1]
from re import*
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=bVRdb6NGFH3qy_yKu6iSocGWdvtSWbIqDDZOMmAWyJasnVZjPLanHTNogG28aX5JXyJV7XP_TvtrevFHnEaLMB7NuXPumXuP7u9_lbt6o4qnP1aD-Z9Nvep-98_fkm0XSwZj-3pwXCb2YmDM5j8Y_apZmIsLwxldTm_uDNsw7MTqz8x2e2WYPevh_WPPMmxtzN_O3xn2tRlZ1gV-bWP2o2FdGJlhzfrf3q2Uhsh-D6KAz6I0q1KK2jTA7PXg-_mvF7_Nkwvra8MeW_bM6Jk9TGQad9bdrN_vvr0jK622oDmIbal0_c1B979fJVxrpSsYwAxjMIMUBW9TGIYxJ053w_CFWFQKAQH7x4Y4oZOJQxzJ7yFg-ONNnh9RhAPXpUFGhryuWTfdwQeulycU4Q-xN0xT4jItGdAGPIEkKO0Ie0HsUkpcteTgK7mCl48NPh273rSFRbEGd8Ok5MWaV0fYnVA39Anua6nqmsP0M3gdByOkaslD340p8ViBkCPFesP1C2nUn3hhirAWCsYKXuUeTzMvdsioKBD2UJ5Qen2-t-fHYTgiYyFFWSoY6qbgqK7KN6KFh3E4jiLiM16zgoHToPD6fJqGqZ-GxOea6SV0apgotaqf4XQy9mOP-KKRAgur4LQSx7Lg6ZRMOFAGrx8kd7LJKCNXLFflXvqQ6QU7Xh2VD-MrNzrDnZd4q3x4FXnkSsFHtiu4fkX-8Ta8mmaEcnSKqiqBBBKG6gQPpxlNEkI7U73iat9uheX_tHdF2--QxmNCG4GlDPLWC0KdyQM3oP4NOeyi8EOGc83jJMCWBLxogHW6knVzputnM1E3DrAlmBCtJir2SjlNLoNwSkKR5wr9scR2dRydsxM5paFLW1ihVRNW_v90EjktPBWQ7b5Q8-w2m15mJGo9sNaiUODouqlONY_TJKI-iUSRK4jQxm3E-XREaRS6JGHyk9oXjMkFK56LGoRpQj-QpGb5LzC6zzcMLf4itztJ3GuSqEIwmHZCLqR8QR5SmuC9053cFQWE61fKQz9L6S252WHNvmSmy-z2JiMZb8kTIRdc47t-LgsdZuEIB0hvP6PaiVKZVp-06KqRsmBbbsNPNvD7kuc1X-L0aYN6-jDTtux-vxi8s_ZncrUtm0MYcv6sRGGuzBNRrylLrk3LOsSK1Tn8zeA5Qx8Oc67HMLpY4tx9OBE8QrVRjVzCgsPDKf7RhkLV8HDiejQsUmILceDOi6OGA6MFODSNUB0TvMHAw2x9ejr8_wc" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Expects uppercase input. Outputs a list of two strings: surname, then name.</p>
<p>Based on my previous answer (below) but treats name and surname in a loop rather than explicitly.</p>
<p>Indebted to Arnauld for the name/surname regexp <code>/ (.. ?\w+|\S+)$/</code>. The &quot;4 letters, skip the second&quot; regexp <code>/(.).(..)/</code> is also used by Neil.</p>
<hr />
<h3>Previous (with explanation):</h3>
<h1><a href="https://www.python.org" rel="nofollow noreferrer">Python</a>, 180 bytes</h1>
<pre class="lang-python prettyprint-override"><code>from re import*
K=lambda S,b=0:sub(&quot;[[\^W&quot;[b::2]+&quot;AEIOU]&quot;,&quot;&quot;,S)+&quot;X&quot;*b
def f(F):
 n,s,_=split(&quot; (.. ?\w+|\S+)$&quot;,F)
 return(K(s)+K(s,1))[:3]+(sub(&quot;(.).(..)&quot;,r&quot;\1\2&quot;,K(n))+K(n,1))[:3]
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=bVXdbuJGFL7qzTzFWasS9uKgbnpTIaHK2GBCxgbZztbZkK4GM4ZpzYw1tndD0zxJb_amfYK-TPs0PeYnpNGODLL4zvnON985OvzxV7mrN0p--fJnU-cXP_zzd67VFjQHsS2Vrt-S60HBtssVg9heDr7rV83SNO7uFj__ZNwt-_3L-67hjK5mN_eGbRh2bHWN1Hi7JCueQ26OrT4BaVf2x0FVFqI2DTB7Pfhx8bn7-yLuWt8a9tgiWK1utDSvzcrq4pf9zrLu-t_fd819MbNn9TDLMmxtLN4tLg372pRWGylPkQft_34z5VorXcEA7u5JrjQUQuJNJBiGsSDOxYbhA5GoFAIC9seGKKaTiUOcgj9AwPDDmyw7oggHrkuDlAx5XbOLZAfvuV6dUITfR94wSYjLdMGANuAJJEH_jrAXRC6lxFUrDr4qcnh5bPDp2PVmLSzkGtwNKwou17w6wu6EuqFP8HddqLrmMPsNvI6DEYVqyUPfjSjxmETIKcR6w_ULadSfeGGCsBYKxgpe1R7PUi9yyEhKhD2UJ5Ren-_t-VEYjshYFKIsFQx1Izmqq7KNaOFhFI7nc-IzXjPJwGlQeH3OpmHiJyHxuWZ6BZ0aJkrl9TOcTMZ-5BFfNIVAYxWc3sTRFsxOyIQDZfD6ILmTTkYpmbJMlXvpQ6aX7Hh1VD6Mpu78DHde4q3y4XTukamCD2wnuX5F_uE2nM5SQjlOiqoqgQQFDNUJHs5SGseEdmY652rfboX2f9pPRdvvkEZjQhuBVgZZOwtCnckDN6D-DTn8isIPFc6eR3GALQm4bIB1Lgp2kTFdPw8TdaMAW4IFcdRExV4pp_FVEM5IKLJM4XyssF0dR2fsRE5p6NIWVjiqMSv_nx3PnRaeCUh3X_E8vU1nVymZtzOw1kIqcHTdVCfPoySeU5_MhcwUzHGM24hz9pzSeeiSmBWf1N4wViyZfDY1CJOYvidxzbJfYfSQbRiO-Iva7iR2r0mspGAw64RcFMUL8pDSGO-d7IqdlBCuXykP_TSht-Rmh559bZiu0tublKS8JY9FseQan_WzLXSYhiNcIL39Cms3SmW2ew1P3hSFZFtuw0cb-EPJs5qvcPu0QT19WHlb9rB_GVxa-5xMbcvmEJabJ4JeU5Zcm9YhROTnqDeDZ-I-HNZbj2GwXJm58XjKf4Jqo5piBUsOj6f4JxukquHxxPVkWKTEzuEaXkij94sS0jwwWoC70gjVscAbDDys1NPfwn8" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Expects uppercase input.</p>
<h4>Explanation</h4>
<pre class="lang-python prettyprint-override"><code>from re import*                     # We will be using regexps.

K=lambda S,b=0:                     # Utility function. Takes a string and a 0/1 flag.
  sub(&quot;[[\^W&quot;[b::2]+&quot;AEIOU]&quot;,&quot;&quot;,S)  # If b=0, deletes vowels and symbols ([\WAEIOU]).
                                    # If b=1, deletes everything except vowels ([^AIEOU]).
  +&quot;X&quot;*b                            # If b=1, it also adds a &quot;X&quot;.

def f(F):
 n,s,_=split(&quot; (.. ?\w+|\S+)$&quot;,F)   # Arnauld's regexp splits name (n) and surname (s).
 return(K(s)+K(s,1)                 # Call K() on s, first for consonants (b=0), then for
                                    #  vowels and trailing &quot;X&quot; (b=1), and...
                   )[:3]            #  keep 3 chars.
  +(                                # Same for n, but, ...
    sub(&quot;(.).(..)&quot;,r&quot;\1\2&quot;,K(n))    #  if K(n,0) contains any seq of 4 chars (&quot;(X)Y(ZW)&quot;),
                                    #  keep only the two groups in parentheses: &quot;XZW&quot;.
    +K(n,1))[:3]
</code></pre>
<hr />
<h3>PS</h3>
<p>Answering my own question (which is allowed, although waiting some time is advised). I only waited 8 hours because I didn't really get a head start (thought about this problem this morning), and I'm less proficient than other Python golfers so I don't believe this is going to be a winning Python entry.</p>
<p>In particular, I liked the regexp-based answers that have been posted so I wanted to try my own.</p>
</div>
<div id="pu4" class="pu"><h1>JavaScript (ES6), 138 bytes</h1>
<p>Expects the input in lowercase and returns a string in lowercase as well.</p>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;(g=r=&gt;(s.split(/ (.. ?\w+|\S+)$/)[+!r].replace(/[aeiou\W]/g,c=&gt;(c&gt;{}?v+=c:0,&quot;&quot;),v=&quot;&quot;).replace(r,&quot;&quot;)+v+&quot;x&quot;).slice(0,3))()+g(/\B.(?=..)/)
</code></pre>
<p><a href="https://tio.run/##bZTBbuM2EIbveYqpUEASZMuL7W0DJ0CBfYIeenB8oCiKonfEIUjKlbPdNyjQS4/te/R59gX6COlISCJ6NzZNGKNPM5yZf3gSZxGkNy5uLbXqqds/hf1dofee91AHhyYWOyjqGu4ffqt@f/ilKn/clYfqB3@svXIopCp2B6EMjQ@/Hnd6I/lFeff5y/252ssP7zZZVm7Oe95fcT/bqnOVTWwMaNj0bvNTWRZlpYvdw891cb@v63JXPt0ebgAOkIltPy/wJhAaazJYPhvIfMC@FxkcN88kqgkGwT81SvkCzuQgJQ7TSjYqRrGNFzgr376CM3n2bRPjSkrhUQCO0Bp27dUavR28RExILiFowu7V3QupsZMtXZHGapC9QFRWq5C9kLJHaXVC9hyeYlRAj9DmgmFkR3N0q6VPorfCMiXQ6F75q4xQ962NKekNQUfXx5zJjqbWJ/VU1jI5Z2XI67SerfbWqpXsDBrnCBo/WsVJBdnPOJONt51zK6mFisIKECOnHlOfaKOONiGVF76FPEJP1MWEjH2nfZuQZkTDHSV4@bf4XSrPPpPcewUovkn8ObqYepUo5CQkuSX5Rnhe5rVHbeNP0r1B5lfokntzcsk5TwSP4mKV/04hjxd7oiQ6KtY7hWDYLUJDq@oamjCEhMzJd4oWeRJL4FnQiz4t@i4hR6MZkrOMDaUKGeSAelzJBZhTX46Qkq0PQ6qQQdkRRL5FseVBicl0oPRDqhA@HI@RCeK73DGYwSbTYY2UhHN8xFx4KdbKI1qJVyTxcAbhsm98BieuSDIwXd7s@3SZyCSVd7N8tTeWgBMaw9p3H/lCTGbTGSsJHM@wsckwMekQnZUrGQSeaWmPwEbYpJuDjQHPCRmF/ARq4rnnUU8rz6YgPyUkWSOAcqvMfAklpEUMaT3HC9f9bc2b6TImuU9q9hkMNsrz0us5AzbT0s2b403dkf8oZF8UBzDWbYDGCMcS9nfwmf2giuBVgD10BT8ub9kmyfLdrWokPdtqJ9qPti3evy@hWuAKMv5WUCxv7heX95D/9@@fX//@i/ccPkD@9Z8/8pL9fSlvn/4H" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>s =&gt; (                  // s = input string
  g = r =&gt; (            // g is a helper function taking a regex r
    s.split(            // split the original string ...
      / (.. ?\w+|\S+)$/ // ... using a regex that matches the surname
    )[+!r]              // keep the name if r is defined,
                        // or the surname otherwise
    .replace(           // replace:
      /[aeiou\W]/g,     //   match all vowels and non-letter characters
      c =&gt; (            //   for each matched character c:
        c &gt; {} ?        //     if c is a letter (i.e. a vowel):
          v += c        //       append it to v
        :               //     else:
          0,            //       do nothing
        &quot;&quot;              //     always remove the original character
      ),                //
      v = &quot;&quot;            //   start with v = &quot;&quot; (string of vowels)
    )                   // end of replace() -&gt; only consonants remain
    .replace(r, &quot;&quot;) +   // apply the regex r to conditionally remove
                        // the second consonant (for the name only)
    v + &quot;x&quot;             // append the vowels and a trailing &quot;x&quot;
  ).slice(0, 3)         // keep the first 3 characters
)() +                   // 1st call to g for the surname with no regex
g(                      // 2nd call to g for the name with a regex that
  /\B.(?=..)/           // matches the 2nd character if the 4th one is
)                       // defined
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 82 bytes</h1>
<pre><code>≔AEIOUθ≔⪪Ｓ η≔⟦⪫⮌Ｅ⊕∧⬤§η±¹№αι›³Ｌ§η±²⊟ηω⪫ηω⟧ηＵＭη⭆²Φι∧№αν⁼λ№θν⭆η…⁺Φι∨¬κ∨⊖μ№θ§⁺§η¹AA³X³
</code></pre>
<p><a href="https://tio.run/##bZDBasMwDIbvfQqTkwLeoe0xJ5N1I6NrwsJgMHYwqYjNHCd1nG57@kxOm6WHGWQk2fr1SZWSrmqlGUfR97q2EIldlr9GnJ3iZHXNlZ3RHjLbDb70TtsaYs4iFtGtll/vT6228IJndD3Cs@yoonLYoPV4BGHJjAHhM3vEb1CcHbCWHmEdk07aDtaD5EyH6NEhvTjYcrZHW3v1T9kmng5nRduBmrwvsglCBf/jQkcgads0kvpT@sIf4DacPWgTumjOAt0fgiWZ3WmQpgczk51CejrJqiAJD4sSyaY/lcFUEUlhhh4W4dzBofXwGU/uPS4LaeIb7Xm8qfpm1nVYtBBh09vruNHbHCXjeMjSfC9YKYrVeHc2vw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes input in upper case (could take in mixed case at a cost of a byte). Explanation:</p>
<pre><code>≔AEIOUθ
</code></pre>
<p>Get the vowels in a variable as this saves a byte.</p>
<pre><code>≔⪪Ｓ η
</code></pre>
<p>Input the name and split it on spaces.</p>
<pre><code>≔⟦⪫⮌Ｅ⊕∧⬤§η±¹№αι›³Ｌ§η±²⊟ηω⪫ηω⟧η
</code></pre>
<p>Extract the surname and given name.</p>
<pre><code>ＵＭη⭆²Φι∧№αν⁼λ№θν
</code></pre>
<p>For each name, sort the consonants to the start and the vowels to the end and ignore other characters.</p>
<pre><code>⭆η…⁺Φι∨¬κ∨⊖μ№θ§⁺§η¹AA³X³
</code></pre>
<p>Remove the second consonant of four in the given name, then take the first three letters of each name, filling with <code>X</code> if necessary.</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language/a950ad7d925ec9316e3e2fb2cf5d49fd15d23e3d" rel="nofollow noreferrer">Retina 0.8.2</a>, <s>94</s> 92 bytes</h1>
<pre><code>(.+?) (..? \w+|\S+)$
$2¶$1
%`\W

%O$`([AEIOU])|.
$.1
(¶.).(.[^AEIOU])
$1$2
%`$
X
%M!`^...
¶

</code></pre>
<p><a href="https://tio.run/##RZD/attADMf/11No4GCHsIP0BYrzo92GU4e53cqaFSvO1RE7TuFsd83oc@UB8mKZYloKdyB99OsrBduyp9MguS1dmZ0SM7ocYmLMJa7@jl5XxWgYQXRxPERjGJSrnwCDPCqTh3T@Nb/7PXw1EJkxJMeDGZrEPDy@cYjG0YUWRHAPg8Wn8tEYA8cDnE6psy@4IP22qyqGiW1b@ny7xx82bBimFBxh1uGMNStYmMrG4rW4p7PFvsbplpyzvrYNqBmctK3F/B/O4lShE5iRV5I6rrc2sLqBBa8E5t6rMdNuLKFmuGLHu53gJHTeasum2jJck23JE6adzmjV586xShR8txi@WMwIvlElu77fhMJah3yQ@AMJ/qK9twEyS/hdmoY17nAikMV5eLLSLyqq@Lnff9Gr1aZ9LmhEr8ENwQ1XlTjBjUqN01D1RPRWBe1gedZfB/aCaWg7LVyyrwSXeiqFUJB7ln4MuTWdQUvVH5y/VFvSo0Ehngnz@Mayc3C315Fwb8@sYLe2QV/9Hw" rel="nofollow noreferrer" title="Retina 0.8.2 – Try It Online">Try it online!</a> Takes input in upper case but link is to test suite that uppercases input. Explanation:</p>
<pre><code>(.+?) (..? \w+|\S+)$
$2¶$1
</code></pre>
<p>Extract the surname and given name. (Note: this assumes that there won't be two spaces in a row.)</p>
<pre><code>%`\W

</code></pre>
<p>Remove all non-letters, but on each name separately, so that the newline doesn't get removed.</p>
<pre><code>%O$`([AEIOU])|.
$.1
</code></pre>
<p>Sort the vowels to the end on each name separately.</p>
<pre><code>(¶.).(.[^AEIOU])
$1$2
</code></pre>
<p>Remove the second consonant of the given name if there are at least four.</p>
<pre><code>%`$
X
%M!`^...
</code></pre>
<p>For each name, take the first three letters, filling in with an <code>X</code> if there are only two.</p>
<pre><code>¶

</code></pre>
<p>Join the codes of the surname and given name together.</p>
<p>Edit: Saved 2 bytes thanks to @Arnauld.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/273527/">273527</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




