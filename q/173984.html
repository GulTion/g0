<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::173984</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>037</td><td>Wolfram Language Mathematica</td><td>181014T184400Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/174005#174005">alephalp</a></td></tr>
<tr d-ix="1"><td>061</td><td>Haskell</td><td>231012T035555Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/265930#265930">alephalp</a></td></tr>
<tr d-ix="2"><td>055</td><td>Maxima</td><td>231011T120436Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/265915#265915">138 Aspe</a></td></tr>
<tr d-ix="3"><td>046</td><td>Pari/GP</td><td>181014T182805Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/174003#174003">alephalp</a></td></tr>
<tr d-ix="4"><td>018</td><td>APL Dyalog Extended</td><td>191205T000710Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/196651#196651">Bubbler</a></td></tr>
<tr d-ix="5"><td>074</td><td>Haskell</td><td>181014T165914Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/174000#174000">xnor</a></td></tr>
<tr d-ix="6"><td>109</td><td>JavaScript ES6</td><td>181014T103847Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/173998#173998">Arnauld</a></td></tr>
<tr d-ix="7"><td>084</td><td>Haskell</td><td>181013T234048Z</td><td><a href="https://codegolf.stackexchange.com/questions/173984/multiply-numerical-polynomials/173986#173986">Delfad0r</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 37 bytes</h1>
<pre><code>b[r=Range@+##,#]b[#,r-#2]&amp;
b=Binomial
</code></pre>
<p><a href="https://tio.run/##LcmxCsMgFIXhvU9x4EKWGko0q0X6BKWrOGhIWqEaELeQZzcId/r4z0m@/tbka1x826DRgi364/N3NXciQS5YEmUk6YZb0K@Y9xT9v71LzNUSxic2GANyGPAwOI5JYDoFupJV7NyVvEtuxb/inrtnuwA" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
<p>-5 bytes thanks to <a href="https://codegolf.stackexchange.com/users/81203/att">att</a>.</p>
<hr />
<h2><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 42 bytes</h2>
<pre><code>Table[b=Binomial;b[#,i-#2]b[i,#],{i,+##}]&amp;
</code></pre>
<p><a href="https://tio.run/##LckxCsMwEETRqwwsuMmaYMldcBA5QYp0QoUUbLJgORDcCZ1dQbDV48/keH7WHE95x7ZhQXvFtK8@LQ85vlnifkueWEYyIXlhClyEL0Q1DO35k@P0hPGODc6BAgZcHUqZGFNldI1q1blrdDfaVn@rPXdr@wM" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
<hr />
<h2><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 57 bytes</h2>
<p>Saved one byte thanks to <a href="https://codegolf.stackexchange.com/users/74672/misha-lavrov">Misha Lavrov</a>.</p>
<pre><code>Inverse[b=Array[Binomial,0{,}+##]].(b[[;;,#]]b[[;;,#2]])&amp;
</code></pre>
<p><a href="https://tio.run/##LcnLCgIhFAbgVzkgDEWny@jshglr1669uHDCIWE0MAlCfHZLOKvvv3iTntab5B6mLjBBvYWPjW@r5ukSo/mqqwsv78yKp4xlx5jWh82s1DjiP1LgWm@7eo8uJMVgf4YFpASmoYOjhJx7hL4gNDkpyKHJaefUBf2C@tAs9Qc" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, 61 bytes</h1>

<pre class="lang-hs prettyprint-override"><code>n#m=[n!(m+n-i)*i!n|i&lt;-[1..n+m]]
_!0=1
n!k=n*(n-1)!(k-1)`div`k
</code></pre>
<p><a href="https://tio.run/##NYxBDoIwFET3nIKCi5ZSIglLPyfQlUtsgEQTPqVfYlE33r1WiJvJy2TeDL0zt2nynlILDTFuJSkUGTL64EE1ZVGQtFpHLdtDGREzQBknVQrGTcjuiq/OeKT5uThoOOaj@IuVzsdA@CMd2R4JbD@fWn5ZZ6oOznl5HGnnhvt77aRMYoA6TqTcunQUYjv3Xw" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>
<p>Based on <a href="https://codegolf.stackexchange.com/a/173986/9288">@Delfad0r's answer</a>, but using the formula in <a href="https://codegolf.stackexchange.com/a/174003/9288">my PARI/GP answer</a>.</p>
</div>
<div id="pu2" class="pu"><h1><a href="http://maxima.sourceforge.net/" rel="nofollow noreferrer">Maxima</a>, 55 bytes</h1>
<p>Golfed version. <a href="https://tio.run/##PYzBCsIwEETv@YqleMjq9tCkJ0V/JPQQ0cBiNy21h/x9bGBxLo83AyOxsMRakxXKeL1L/Lxn/u72yXkRjvPRc5/x/HcmQWIaSC4Z682YtGxQgDOEMBAME0GjU3rl2Oi0d@ped68@Nk7wWsAaOLJunHdbQjvtoH9AR5DUS3ATosFT/QE" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>f(m,n):=makelist(binomial(m,i-n)*binomial(i,m),i,1,m+n)
</code></pre>
<p>Ungolfed version. <a href="https://tio.run/##PY4xDsIwDEX3nOILMSTgDk07IcFFog4pUMlqnaDSIbcPDUR4eX7fkvXFJxaf86SFgsHlinGJ91kr7LNvftFs6Gvi5@fC702PHKLwfhHiJpjT35nEEJjQEuQcjDJHpaa4IoEDnNvjdiAU2squsi@0NbfVu3rvqveFAx4Rv36vlcOmkytPD2huOBCm6snZwZQGOX8A" rel="nofollow noreferrer">Try it online!</a></p>
<pre><code>f(m,n) := block(
    local(i),
    makelist(binomial(m,i-n)*binomial(i,m), i, 1, m+n)
)$

for x in [[1, 1], [1, 2], [1, 3], [1, 4], [2, 2], [2, 4], [3, 3], [3, 4], [4, 4]] do (
    print(x[1], &quot; -&gt; &quot;, f(x[1], x[2]))
)$
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="http://pari.math.u-bordeaux.fr/" rel="nofollow noreferrer">Pari/GP</a>, 46 bytes</h1>
<pre><code>m-&gt;n-&gt;b=binomial;[b(m,i-n)*b(i,m)|i&lt;-[1..m+n]]
</code></pre>
<p><a href="https://tio.run/##LYnBCsMgEER/ZcnJbTWgya2NPyJ70EPKQrQSekih/24V9jJv3kyNJ5tXbTts0LLxxfi0JS7vzPF4hKSyZlPwlhTrjD9@mmDnOd8LUYu1Hl91gfFQTy6fXqchE@zqCpawpyNEDSFYDZZ66XTCRbgOOtmd@CL/Ir4OErY/" rel="nofollow noreferrer" title="Pari/GP – Try It Online">Try it online!</a></p>
<p>I did not expect the formula to be so simple: the <span class="math-container">\$i\$</span>-th element of the output for <span class="math-container">\$(m,n)\$</span> is <span class="math-container">\${m \choose i-n} {i \choose m}\$</span>.</p>
<p>In fact, it can be proven that <span class="math-container">\$\sum_{i=0}^{m+n} {m \choose i-n} {i \choose m} {x \choose i} = {x \choose m} {x \choose n}\$</span>. The RHS counts the number of ways to choose two subsets of <span class="math-container">\$\{1,2,\dots,x\}\$</span> of size <span class="math-container">\$m\$</span> and <span class="math-container">\$n\$</span> respectively; while the LHS counts, for each <span class="math-container">\$i\$</span>, the number of ways to choose a subset of size <span class="math-container">\$i\$</span>, and two subsets of size <span class="math-container">\$m\$</span> and <span class="math-container">\$n\$</span> respectively whose union is the chosen subset of size <span class="math-container">\$i\$</span>.</p>
<hr />
<h2><a href="http://pari.math.u-bordeaux.fr/" rel="nofollow noreferrer">Pari/GP</a>, 62 bytes</h2>
<p>Saved one byte thanks to <a href="https://codegolf.stackexchange.com/users/59487/mr-xcoder">Mr. Xcoder</a>.</p>
<pre><code>m-&gt;n-&gt;b=matpascal(m+n);([b[i,m+1]*b[i,n+1]|i&lt;-[1..#b]]/b~)[^1]
</code></pre>
<p>Sadly, GP does not have a built-in for pointwise product.</p>
<p><a href="https://tio.run/##LYlBCsMgEEWvMqQbbTRFk10aLzJMQQspQhRJs0ih9OpWwc289/4ku3v5SnmFBXKQJkrjlmCPZN9Pu7HQRz4zdOhF6BVdq8QiX3@XqIbh4ohu7sfxoSjblLYPO0EaSLuPR9GuRgcrO1ERL1cT5wIQlQBFRQp149g4Veq269Zj@4@tp0ri@Q8" rel="nofollow noreferrer" title="Pari/GP – Try It Online">Try it online!</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/abrudz/dyalog-apl-extended" rel="noreferrer">APL (Dyalog Extended)</a>, <sub><s>20</s></sub> 18 bytes</h1>



<pre class="lang-apl prettyprint-override"><code>,((×⌿!\)⌹⊢!⍨\⊢)⍳⍤+
</code></pre>

<p><a href="https://tio.run/##SyzI0U2pTMzJT9dNrShJzUtJTfn/qG@qp/@jtgmG/3U0NA5Pf9SzXzFG81HPzkddixQf9a6IAdKaj3o3P@pdov0/DajuUW8fREtX86H1xo/aJgJ5wUHOQDLEwzP4v6FCmoKhwqPeuUDSiAvEMwLzDIC0MZhvDOUbAFkmYBETuIgBkG3KZYSky1DBTMEMLIKsz9BIwdAALIqs10zBCKjBlMsYw0xjoCRQnymXCZqUIUiLJZA2MVAwNwAA" rel="noreferrer" title="APL (Dyalog Extended) – Try It Online">Try it online!</a></p>

<p>A tacit dyadic function that takes <code>m</code> and <code>n</code> as left and right arguments respectively. Mainly uses the matrix division built-in <code>⌹</code> to solve the linear equations:</p>

<p><span class="math-container">$$
\begin{bmatrix}
\binom{1}{1} &amp; \binom{1}{2} &amp; \cdots &amp; \binom{1}{n+m} \\
\binom{2}{1} &amp; \binom{2}{2} &amp; \cdots &amp; \binom{2}{n+m} \\
\vdots       &amp; \vdots       &amp; \ddots &amp; \vdots         \\
\binom{n+m}{1} &amp; \binom{n+m}{2} &amp; \cdots &amp; \binom{n+m}{n+m}
\end{bmatrix}
\begin{bmatrix}
a_1 \\ a_2 \\ \vdots \\ a_{n+m}
\end{bmatrix}
=
\begin{bmatrix}
\binom{1}{n} \binom{1}{m} \\
\binom{2}{n} \binom{2}{m} \\
\vdots \\
\binom{n+m}{n} \binom{n+m}{m}
\end{bmatrix}
\Leftrightarrow Ba = v $$</span></p>

<p>When <span class="math-container">\$ B \$</span> and <span class="math-container">\$ v \$</span> are ready, the answer is simply <code>v⌹B</code>. So the main work is to golf the parts to build <span class="math-container">\$ B \$</span> and <span class="math-container">\$ v \$</span>.</p>

<h3>How it works</h3>

<pre class="lang-apl prettyprint-override"><code>,((×⌿!\)⌹⊢!⍨\⊢)⍳⍤+  ⍝ Left argument: n, Right argument: m
,(            )⍳⍤+  ⍝ Pass [n m] and [1 .. n+m] to the inner function
         ⊢!⍨\⊢      ⍝ Compute B
  (×⌿!\)            ⍝ Compute v
        ⌹           ⍝ Solve the linear equation
</code></pre>

<h3>Computing <span class="math-container">\$ B \$</span></h3>

<p><code>x!y</code> computes <span class="math-container">\$ \binom{y}{x} \$</span>.</p>

<pre class="lang-apl prettyprint-override"><code>⊢!⍨\⊢  ⍝ Left: [n m], Right: [1 .. n+m]
⊢   ⊢  ⍝ Use right argument for both sides (L, R)
 !⍨\   ⍝ Outer product by flipped binomial:
       ⍝ For each pair of l∊L and r∊R, compute r!l or lCr
</code></pre>

<h3>Computing <span class="math-container">\$ v \$</span></h3>

<pre class="lang-apl prettyprint-override"><code>×⌿!\  ⍝ Left: [n m], Right: [1 .. n+m]
  !\  ⍝ Outer product by binomial function
      ⍝ Result is a matrix of two rows [U V]
×⌿    ⍝ Reduce by multiply; compute U×V element-wise
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.haskell.org/" rel="noreferrer">Haskell</a>, 74 bytes</h1>



<pre class="lang-hs prettyprint-override"><code>a%b|let a?i|a&lt;1=0^(i-b)^2|d&lt;-a-1=div(i*d?(i-1)-(d-i)*d?i)a=map(a?)[1..a+b]
</code></pre>

<p><a href="https://tio.run/##NY1BCsIwEEWvkoVCRjPFiMuGnMATlBR@SMHBtJRaXOXuMV24e//x4b3weU8514pzLHnaFbwU9NbdRi0cabyX1DPYuiRfLZfkm7bEOrFQW0JwM1YNT4PtOlxjqDNkOeRTrZss@0kNGiaaVqCi0PNxfASj4h9D/QE" rel="noreferrer" title="Haskell – Try It Online">Try it online!</a></p>

<p>Uses a recursive formulation I found. Let <span class="math-container">\$g_b(a,i)\$</span> be the coefficient of <span class="math-container">\$p_i\$</span> in <span class="math-container">\$p_a p_b\$</span>, which is implemented in the code by <code>a?i</code> (with <code>b</code> fixed). We can express <span class="math-container">\$g_b\$</span> recursively as</p>

<p><span class="math-container">$$g_b(a,i)=\frac{i\cdot g_b(a-1,i-1)-(a-1-i)\cdot g_b(a-1,i-1)}{a}$$</span></p>

<p>with base case
<span class="math-container">$$g_b(0,i)=
\begin{cases}
1,\text{ if }b=i\\
0,\text{ otherwise}\\
\end{cases}
$$</span></p>

<p>The base case corresponds to the expansion for <span class="math-container">\$p_b\$</span>, which has a single nonzero coefficient of <span class="math-container">\$p_i\$</span> at <span class="math-container">\$i=b\$</span>. The code implements this indicator function as <code>0^(i-b)^2</code>.</p>

<p>The code has guards belonging to the definition of <code>?</code> in the <code>let</code> binding. It's perhaps easier to read as the following (non-working) code where the definition of <code>a?i</code> expects <code>b</code> as a global variable. Perhaps confusingly, the <code>a</code> in the definition of <code>?</code> is not always the same as the input to <code>%</code>, since it recurses down.</p>

<pre class="lang-hs prettyprint-override"><code>a?i|a&lt;1=0^(i-b)^2|d&lt;-a-1=div(i*d?(i-1)-(d-i)*d?i)a
a%b=map(a?)[1..a+b]
</code></pre>

<p>The main function <code>%</code> lists the coefficients for each <code>i</code> from 1 to a+b. It's possible to code the recursion in <code>%</code> directly by zipping shifted lists, but I did not find a short way to do it especially with the dependence on the position <code>i</code>.</p>
</div>
<div id="pu6" class="pu"><h1>JavaScript (ES6), 109 bytes</h1>
<p>This is really just a port of <a href="https://codegolf.stackexchange.com/a/173986/58563">Delfad0r's great answer</a>, implemented as nested recursive functions.</p>
<p>Takes input as <code>(n)(m)</code>.</p>

<pre class="lang-javascript prettyprint-override"><code>n=&gt;m=&gt;(g=i=&gt;i?[...g(i-1),(h=k=&gt;k&amp;&amp;h(k-1)-(b=(y,x=k)=&gt;y?x*b(y-1,x-1)/y:i-k&amp;1||-1)(k,i)*b(n)*b(m))(i)]:[])(n+m)
</code></pre>
<p><a href="https://tio.run/##dY7BbsMgEETv/QpO1tKCbQxtlUhLPsTyIUkThxLjqKkqW8q/u4t6aQuRRitW@4aZ9@3X9rr/cJdPGca3w3LEJaAd0EKPDq3btGVZ9uCk4gJO6NH6ojiBp13CDmEWE3qOdt5MjzuYpRITnap57aQv1O1GC3jhOB1DHAPn4Hi3bjsO4Wngy34M1/F8KM9jD0cgWnHOqoohWtYqwZruIUGaX0hNiGA6Q@m/FEkLZjKgSUCSEez5P9sk0VTwhZQBs@mKqqo6Q2cr0M9NzEh66PuddfTFsMRk7pjUT8oqPg2N17pbvgE" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>How?</h3>
<p>The function <span class="math-container">\$b(y,x)\$</span> computes:</p>
<p><span class="math-container">$$-(-1)^{i-k}{x\choose y}$$</span></p>
<p>It's slightly shorter to return <span class="math-container">\$-(-1)^{i-k}\$</span> as the last iteration of this function than processing it separately. Because we compute the product of three binomial coefficients, the signs of the first two of them are simply cancelling each other out.</p>
<p>The function <span class="math-container">\$h()\$</span> is used to compute:</p>
<p><span class="math-container">$$\sum_{k=1}^{i}-b(k,i)\times b(n,k)\times b(m,k)\\
=\sum_{k=1}^{i}{(-1)^{i-k}{i\choose k}{k\choose n}{k\choose m}}$$</span></p>
<p>And the function <span class="math-container">\$g()\$</span> is used to compute each term <span class="math-container">\$a_i\$</span> for <span class="math-container">\$1\le i \le n+m\$</span>.</p>
</div>
<div id="pu7" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, 84 bytes</h1>

<pre class="lang-hs prettyprint-override"><code>n#m=[foldr1(-)[i!k*k!n*k!m|k&lt;-[i,i-1..0]]|i&lt;-[1..n+m]]
_!0=1
n!k=n*(n-1)!(k-1)`div`k
</code></pre>
<p><a href="https://tio.run/##NUzBDoMgFLv7FaI7gIiRZMfhF2ynHRlRE7eIyNOo2y7@O0PNDm3apm1bz@bZ985BbIV8DX0zccyI1MgkBoGHXc2FSZ1qxrMsV2rV3noJ1CoVlCgXPABkBCQYGCcIG89Voz@VcRrG9zILiXXakf/wrNJue9yUCmytQdh6vJX4sddY4Tf3ZbrCaW6H755RGoVCFGFE6ZHFHSHHufsB" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>
<h2>Explanation</h2>
<p>Given a polynomial <span class="math-container">\$q\$</span>, the following algorithm (see <a href="https://en.wikipedia.org/wiki/Newton_polynomial" rel="nofollow noreferrer">here</a>) computes the unique coefficients <span class="math-container">\$a_0,a_1,\ldots\$</span> such that <span class="math-container">\$q=a_0p_0+a_1p_1+\ldots\$</span>.</p>
<p>Let
<span class="math-container">$$
\Delta^{(0)}q(x)=q(x)\\
\Delta^{(i+1)}q(x)=\Delta^{(i)}q(x+1)-\Delta^{(i)}q(x).
$$</span></p>
<p>Then <span class="math-container">\$a_i=\Delta^{(i)}q(0)\$</span>.</p>
<p>Moreover, it can be easily proved that
<span class="math-container">$$
\Delta^{(i)}q(0)=\sum_{k=0}^{i}(-1)^{i-k}{i\choose k}q(k).
$$</span></p>
<hr />
<pre class="lang-hs prettyprint-override"><code>_!0=1
n!k=n*(n-1)!(k-1)`div`k
</code></pre>
<p><code>n!k</code> is the binomial coefficient <span class="math-container">\$n\choose k\$</span>.</p>
<hr />
<pre class="lang-hs prettyprint-override"><code>n#m=[foldr1(-)[i!k*k!n*k!m|k&lt;-[i,i-1..0]]|i&lt;-[1..n+m]]
</code></pre>
<p>The function <code>#</code> computes the answer to the challenge. It simply uses the observation above to compute
<span class="math-container">$$
a_i=\sum_{k=0}^{i}(-1)^{i-k}{i\choose k}{k\choose n}{k\choose m}.
$$</span>
The <code>foldr1(-)</code> is the only thing that needs explaining. When applied to a list <span class="math-container">\$[b_0,b_1,\ldots,b_l]\$</span>, <code>foldr1(-)</code> returns
<span class="math-container">$$
b_0-(b_1-(\ldots-(b_{l-1}-b_l)\ldots)=\sum_{j=0}^{l}(-1)^jb_j
$$</span></p>
<hr />
<h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, <s>108</s> 100 bytes</h1>
<p>I'm also keeping this one. It is, in my opinion, more elegant, albeit much more verbose.</p>
<pre class="lang-hs prettyprint-override"><code>n#m=take(n+m).tail$head&lt;$&gt;iterate(zipWith(-)=&lt;&lt;tail)[x!n*x!m|x&lt;-[0..]]
_!0=1
n!k=n*(n-1)!(k-1)`div`k
</code></pre>
<p><a href="https://tio.run/##JYxBDoIwFET3nIIKi9bSRhKXlBPoyoULJNrEJnxKvwSqEsPdsehmMnmZN40erem6ZcHEKa@tocgdk15DlzZG34u0BG8G7Q39QH8G31DBVFGsA1ZNBLcTcfNUiGonZV1HV7JTeYTEKtxSFDkj1Ia83eF1swtg//SjqihkLZshWLmU@zprQ4O11ZHTgMrp/nill99MlME5@eGA6dg83j/G@SZWqow3nP9Z0jL2P1@@" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>
<hr />
<pre class="lang-hs prettyprint-override"><code>_!0=1
n!k=n*(n-1)!(k-1)`div`k
</code></pre>
<p><code>n!k</code> is the binomial coefficient <span class="math-container">\$n\choose k\$</span>.</p>
<hr />
<pre class="lang-hs prettyprint-override"><code>n#m=take(n+m).tail$head&lt;$&gt;iterate(zipWith(-)=&lt;&lt;tail)[x!n*x!m|x&lt;-[0..]]
</code></pre>
<p>The function <code>#</code> computes the answer to the challenge. Let <span class="math-container">\$q=p_n\cdot p_m\$</span>.</p>
<ul>
<li><code>[x!n*x!m|x&lt;-[0..]]</code> is the infinite list
<span class="math-container">$$
\left[{0\choose n}{0\choose m},{1\choose n}{1\choose m},{2\choose n}{2\choose m},\ldots\right]
$$</span>
i.e.
<span class="math-container">$$
[q(0),q(1),q(2),\ldots].
$$</span></li>
<li>Given a list <span class="math-container">\$[b_0,b_1,b_2,\ldots]\$</span>, the function <code>zipWith(-)=&lt;&lt;tail</code> returns <span class="math-container">\$[b_1-b_0,b_2-b_1,\ldots]\$</span>. Thus the code <code>head&lt;$&gt;iterate(zipWith(-)=&lt;&lt;tail)[x!n*x!m|x&lt;-[0..]]</code> returns the infinite list
<span class="math-container">$$
[\Delta^{(0)}q(0),\Delta^{(1)}q(0),\Delta^{(2)}q(0),\ldots]=[a_0,a_1,a_2,\ldots].
$$</span></li>
<li>Finally with <code>take(n+m).tail</code> we drop <span class="math-container">\$a_0\$</span> and we take the first <span class="math-container">\$n+m\$</span> coefficients, thereby solving the challenge.</li>
</ul>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/173984/">173984</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




