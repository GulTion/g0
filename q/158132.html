<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::158132</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>018</td><td>Uiua</td><td>240314T004930Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/271792#271792">noodle m</a></td></tr>
<tr d-ix="1"><td>110</td><td>Swift</td><td>240314T003242Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/271791#271791">macOSist</a></td></tr>
<tr d-ix="2"><td>097</td><td>Zsh</td><td>221228T024930Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/256096#256096">roblogic</a></td></tr>
<tr d-ix="3"><td>133</td><td>Haskell</td><td>180319T014842Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/159549#159549">Aearnus</a></td></tr>
<tr d-ix="4"><td>029</td><td>SM83</td><td>210425T162033Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/224385#224385">NoLonger</a></td></tr>
<tr d-ix="5"><td>071</td><td>Julia 1.0</td><td>210426T135229Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/224457#224457">MarcMush</a></td></tr>
<tr d-ix="6"><td>009</td><td>Vyxal s</td><td>210423T141624Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/224264#224264">Aaroneou</a></td></tr>
<tr d-ix="7"><td>6015</td><td>MMIX</td><td>210425T165354Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/224388#224388">NoLonger</a></td></tr>
<tr d-ix="8"><td>107</td><td>Julia</td><td>201030T003918Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/214399#214399">binaryca</a></td></tr>
<tr d-ix="9"><td>186</td><td>Gameboy Z80 Assembly</td><td>201029T221536Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/214393#214393">corvus_1</a></td></tr>
<tr d-ix="10"><td>011</td><td>05AB1E legacy</td><td>200306T145147Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/200664#200664">Grimmy</a></td></tr>
<tr d-ix="11"><td>256</td><td>Clojure</td><td>200306T143719Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/200663#200663">Attilio</a></td></tr>
<tr d-ix="12"><td>066</td><td>C gcc</td><td>200305T190347Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/200625#200625">S.S. Ann</a></td></tr>
<tr d-ix="13"><td>225</td><td>Forth</td><td>190810T051534Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/189646#189646">nonForgi</a></td></tr>
<tr d-ix="14"><td>082</td><td>Julia 1.0</td><td>190808T143222Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/189535#189535">Simeon S</a></td></tr>
<tr d-ix="15"><td>110</td><td>Python 3</td><td>190808T034727Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/189513#189513">Kuldeep </a></td></tr>
<tr d-ix="16"><td>131</td><td>C</td><td>180316T094914Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158324#158324">ErikF</a></td></tr>
<tr d-ix="17"><td>137</td><td>Lua 5.3</td><td>181026T154543Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/174795#174795">David</a></td></tr>
<tr d-ix="18"><td>nan</td><td>Lua</td><td>180726T074335Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/169277#169277">Visckmar</a></td></tr>
<tr d-ix="19"><td>020</td><td>MATL</td><td>180709T233316Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/168323#168323">Sundar R</a></td></tr>
<tr d-ix="20"><td>079</td><td>Javascript ES6</td><td>180319T061803Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/159555#159555">Yair Ran</a></td></tr>
<tr d-ix="21"><td>082</td><td>JavaScript ES6</td><td>180314T182945Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158138#158138">Rick Hit</a></td></tr>
<tr d-ix="22"><td>031</td><td>x8664</td><td>180409T064528Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/161607#161607">Ian Chew</a></td></tr>
<tr d-ix="23"><td>049</td><td>K4</td><td>180408T192638Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/161585#161585">mkst</a></td></tr>
<tr d-ix="24"><td>129</td><td>><></td><td>180408T120720Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/161562#161562">SE - sto</a></td></tr>
<tr d-ix="25"><td>115</td><td>Excel VBA</td><td>180316T033908Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158295#158295">Taylor R</a></td></tr>
<tr d-ix="26"><td>022</td><td>Pip</td><td>180320T231549Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/159749#159749">DLosc</a></td></tr>
<tr d-ix="27"><td>094</td><td>Haskell</td><td>180319T143947Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/159606#159606">Pharap</a></td></tr>
<tr d-ix="28"><td>014</td><td>Jelly</td><td>180314T183007Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158140#158140">Erik the</a></td></tr>
<tr d-ix="29"><td>100</td><td>Python 3</td><td>180318T183018Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/159521#159521">Dat</a></td></tr>
<tr d-ix="30"><td>029</td><td>Perl 5 p</td><td>180314T190737Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158147#158147">Ton Hosp</a></td></tr>
<tr d-ix="31"><td>109</td><td>pwsh</td><td>180317T205808Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/159476#159476">lit</a></td></tr>
<tr d-ix="32"><td>098</td><td>Java 8</td><td>180315T085506Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158205#158205">Kevin Cr</a></td></tr>
<tr d-ix="33"><td>105</td><td>PowerShell Core</td><td>180317T080121Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158441#158441">Tessella</a></td></tr>
<tr d-ix="34"><td>012</td><td>Stax</td><td>180314T202458Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158156#158156">recursiv</a></td></tr>
<tr d-ix="35"><td>307</td><td>Fortran GFortran</td><td>180316T221932Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158408#158408">rafa1111</a></td></tr>
<tr d-ix="36"><td>064</td><td>Chip</td><td>180316T193819Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158392#158392">Phlarx</a></td></tr>
<tr d-ix="37"><td>099</td><td>PHP</td><td>180314T220709Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158172#158172">Ethan</a></td></tr>
<tr d-ix="38"><td>041</td><td>Ruby</td><td>180315T182531Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158252#158252">benj2240</a></td></tr>
<tr d-ix="39"><td>051</td><td>6502 machine code routine C64</td><td>180316T142503Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158348#158348">Felix Pa</a></td></tr>
<tr d-ix="40"><td>092</td><td>SNOBOL4 CSNOBOL4</td><td>180314T182959Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158139#158139">Giuseppe</a></td></tr>
<tr d-ix="41"><td>075</td><td>PHP 4</td><td>180316T103126Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158329#158329">Christop</a></td></tr>
<tr d-ix="42"><td>121</td><td>Yabasic</td><td>180316T032910Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158294#158294">Taylor R</a></td></tr>
<tr d-ix="43"><td>070</td><td>Wolfram Language Mathematica</td><td>180315T232833Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158284#158284">Misha La</a></td></tr>
<tr d-ix="44"><td>092</td><td>R</td><td>180314T211645Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158162#158162">Vlo</a></td></tr>
<tr d-ix="45"><td>040</td><td>APL Dyalog Classic</td><td>180315T205751Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158265#158265">Adalynn</a></td></tr>
<tr d-ix="46"><td>016</td><td>Japt v2.0a0</td><td>180314T220758Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158173#158173">Shaggy</a></td></tr>
<tr d-ix="47"><td>017</td><td>Retina</td><td>180314T182727Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158136#158136">mbomb007</a></td></tr>
<tr d-ix="48"><td>097</td><td>Python 3</td><td>180314T212455Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158163#158163">Rick Ron</a></td></tr>
<tr d-ix="49"><td>063</td><td>Python</td><td>180315T131534Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158220#158220">ManfP</a></td></tr>
<tr d-ix="50"><td>330</td><td>Rust</td><td>180315T114158Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158212#158212">dragonit</a></td></tr>
<tr d-ix="51"><td>097</td><td>Python 2</td><td>180315T084113Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158204#158204">AvahW</a></td></tr>
<tr d-ix="52"><td>007</td><td>AutoHotKey</td><td>180315T080928Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158202#158202">tsh</a></td></tr>
<tr d-ix="53"><td>011</td><td>Husk</td><td>180314T213808Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158168#158168">Zgarb</a></td></tr>
<tr d-ix="54"><td>031</td><td>CJam</td><td>180315T052328Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158197#158197">Marcos</a></td></tr>
<tr d-ix="55"><td>021</td><td>Charcoal</td><td>180315T004753Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158184#158184">Neil</a></td></tr>
<tr d-ix="56"><td>072</td><td>Python 3</td><td>180315T000052Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158180#158180">The Fift</a></td></tr>
<tr d-ix="57"><td>012</td><td>05AB1E</td><td>180314T210652Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158160#158160">Emigna</a></td></tr>
<tr d-ix="58"><td>072</td><td>C</td><td>180314T191732Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158148#158148">Steadybo</a></td></tr>
<tr d-ix="59"><td>016</td><td>Vim</td><td>180314T204506Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158157#158157">Endenite</a></td></tr>
<tr d-ix="60"><td>015</td><td>Husk</td><td>180314T202405Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158155#158155">ბიმო</a></td></tr>
<tr d-ix="61"><td>092</td><td>Haskell</td><td>180314T192114Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158149#158149">Wheat Wi</a></td></tr>
<tr d-ix="62"><td>019</td><td>Pyth</td><td>180314T185118Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158146#158146">Mr. Xcod</a></td></tr>
<tr d-ix="63"><td>021</td><td>Pyth</td><td>180314T184222Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158143#158143">user4854</a></td></tr>
<tr d-ix="64"><td>009</td><td>V</td><td>180314T182523Z</td><td><a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158135#158135">DJMcMayh</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Uiua, 18 bytes</h1>
<pre><code>/◇⊂⍜▽¯◿2⇡⧻.⊜□≠@A⌵.
</code></pre>
<p><a href="https://uiua.org/pad?src=0_10_0-dev_1__RiDihpAgL-KXh-KKguKNnOKWvcKv4pe_MuKHoeKnuy7iipzilqHiiaBAQeKMtS4KCkYgIndIQVQgSUYgY0FQU2xPQ0sgSVMgQUxSRUFEWSBPTj8iCg==" rel="nofollow noreferrer">Try it</a></p>
<pre><code>/◇⊂⍜▽¯◿2⇡⧻.⊜□≠@A⌵.­⁡​‎⁪⁪⁠⁪⁪⁠⁪⁪⁠‎⁪⁡⁪⁠⁪⁢⁡⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁡⁢⁪‏‏​⁡⁠⁡‌⁢​‎‎⁪⁡⁪⁠⁪⁤⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁣⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁤⁪‏‏​⁡⁠⁡‌⁣​‎‎⁪⁡⁪⁠⁪⁣⁤⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁡⁪‏‏​⁡⁠⁡‌⁤​‎‎⁪⁡⁪⁠⁪⁣⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁣⁪‏‏​⁡⁠⁡‌⁢⁡​‎‎⁪⁡⁪⁠⁪⁢⁣⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁤⁪‏‏​⁡⁠⁡‌⁢⁢​‎‎⁪⁡⁪⁠⁪⁤⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁢⁪‏‏​⁡⁠⁡‌⁢⁣​‎‎⁪⁡⁪⁠⁪⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁪‏‏​⁡⁠⁡‌­
                ⌵.  # ‎⁡Push an uppercase copy
             ≠@A    # ‎⁢Mask of those not equal to A
           ⊜□       # ‎⁣Partition, boxing each string
        ⇡⧻.         # ‎⁤Copy, push the range 0 to its length
      ◿2            # Modulo 2 (alternating 0s and 1s)
   ⍜▽¯              # ‎⁢⁢At positions with 1s, swapcase
/◇⊂                 # ‎⁢⁣Reduce by joining each unboxed string
💎
</code></pre>
<p>Created with the help of <a href="https://vyxal.github.io/Luminespire" rel="nofollow noreferrer">Luminespire</a>.</p>
<p>I don't like formatting Uiua explanations like this since it's hard to explain everything on one line (especially because I like to do pretty in-depth explanations). Particularly for Uiua it can feel awkward reading the code down and to the left while reading the explanation all the way to the right. But, there's a clear tradeoff, doing explanations this way takes much less time, and I don't have that much time right now so this'll do.</p>
</div>
<div id="pu1" class="pu"><h1>Swift, 110 bytes</h1>
<pre class="lang-swift prettyprint-override"><code>import Darwin
var x=0,f={for c in($0+&quot;&quot;).utf8{c&amp;95==65 ?(x^=1,0).1:putchar(CInt(x&gt;0&amp;&amp;66...90~=c&amp;95 ?c^32:c))}}
</code></pre>
<p><code>f(_:)</code> is the closure you want.</p>
<p>If you're on Linux instead of macOS, you can replace <code>import Darwin</code> with <code>import Glibc</code> to save a byte (and you have to do it anyway if you want it to compile). For platform independence, <code>import Foundation</code> can be used instead.</p>
<p>This is an almost direct port of <a href="https://codegolf.stackexchange.com/a/158205/118665">@KevinCruijssen's Java answer</a> to Swift, with:</p>
<ul>
<li>some things shuffled around,</li>
<li>a call to <code>~=(lhs:rhs:)</code> (the pattern matching operator) to condense the range check,</li>
<li>a tuple shenanigan to let us use the ternary conditional operator instead of <code>if</code>-<code>else</code>, and</li>
<li>a bit of C interop abuse because Swift names are long.</li>
</ul>
<h2>Notes</h2>
<ul>
<li><p><code>CInt</code> is a <code>typealias</code> for <code>Int32</code>, the type expected by <code>putchar(_:)</code> (for reasons beyond my mortal comprehension; C is weird).</p>
</li>
<li><p>For reasons slightly closer to a realm I can grasp (i.e. exit codes), <code>putchar(_:)</code> also <em>returns</em> an <code>Int32</code>, meaning we can't directly put a call to it in a ternary conditional that expects <code>Void</code> (an alias for <code>()</code>), which is the result type of <code>x^=1</code> (because, in Swift, assignment operators rightfully don't return anything).</p>
<p>So, instead, I shoved <code>x^=1</code> into a tuple and added <code>0</code> as the second element, and then accessed it with <code>.1</code>. This still evaluates <code>x^=1</code>, but returns an <code>Int32</code> (the type the <code>0</code> literal is inferred as) rather than a <code>Void</code>, which calms down the type checker a bit.</p>
</li>
<li><p>The <code>~=(lhs:rhs:)</code> operator is used internally for custom pattern matching (i.e. <code>switch</code> statements, <code>if case</code>, and the like). There's an overload defined on <code>ClosedRange</code> that checks if <code>rhs</code> is contained in <code>lhs</code>. We abuse that here.</p>
</li>
<li><p>Because Swift really doesn't want you to do things like this with an ordinary <code>String</code>, we have to access the <code>utf8</code> property of the input to get a <code>[UInt8]</code> that we can iterate over.</p>
</li>
<li><p>We need to concatenate <code>&quot;&quot;</code> with <code>$0</code> (the implicit closure parameter, aka the input) to help the type checker figure out that <code>$0</code> is a <code>String</code>.</p>
</li>
</ul>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.zsh.org/" rel="nofollow noreferrer">Zsh</a>, 97 <s>107</s> bytes</h1>
<pre class="lang-sh prettyprint-override"><code>for c (${(s..)1})case $c {a|A)((j^=1));;[b-z])((j))&amp;&amp;c=$c:u;|[B-Z])((j))&amp;&amp;c=$c:l;|*)s+=$c;}
&lt;&lt;&lt;$s
</code></pre>
<p>-10 thanks to @GammaFunction.
<a href="https://tio.run/##qyrO@P8/Lb9IIVlBQ6Vao1hPT9OwVjM5sThVQSVZoTqxxlFTQyMrztZQU9PaOjpJtyoWxNfUVFNLtlVJtiq1rol20o1CFcyxrtHSLNYGMq1ruWxsbFSK////X@7hGKLg6aaQ7BgQnOPv7K3gGazg6BPk6ugSqeDvZw8A" rel="nofollow noreferrer">Try it Online!</a>
  <s><sub><a href="https://tio.run/##qyrO@P8/y9bAOi2/SKFCQUOlWqPYykrTsFazOjmxOFVBpUIhM08hscZRU0Mjy9ZQN0tT07rC1to6Okm3KhYkpqmpplZhq1JhVQoUdNKNQhXM4UotTky2LijKzCtJAxpW@////3IPxxAFTzeFZMeA4Bx/Z28Fz2AFR58gV0eXSAV/P3sA" rel="nofollow noreferrer" title="Zsh – Try It Online">107bytes</a></sub></s></p>
</div>
<div id="pu3" class="pu"><h2>Haskell, <s>199</s> 133 bytes</h2>
<pre><code>import Data.Char
l c|isUpper c=toLower c|1&lt;2=toUpper c
f _&quot;&quot;=&quot;&quot;
f b(c:cs)|toLower c=='a'=f(not b)cs|1&lt;2=(if b then l else id)c:f b cs
</code></pre>
<p>Run using <code>f False &quot;&lt;string&gt;&quot;</code></p>
<p>Ungolfed version:</p>
<pre><code>import Data.Char

flipCase c
    | isUpper c = toLower c
    | otherwise = toUpper c

f &quot;&quot; _ = &quot;&quot;
f b (c:cs)
    | toLower c == 'a' = f cs $ not b
    | True = (if b then flipCase else id) c:f b cs
</code></pre>
</div>
<div id="pu4" class="pu"><h1>SM83, <s>29</s> 28 bytes; Z80, <s>30</s> 29 bytes</h1>
<ul>
<li>SM83 version</li>
</ul>
<pre><code>06 00 2A 4F CB AF D6 41
28 0C FE 1A 79 30 01 A8
12 13 B7 20 ED C9 78 EE
20 47 18 E6
</code></pre>
<ul>
<li>Z80 version (changes in stars)</li>
</ul>
<pre><code>06 00 *7D 23* 4F CB AF D6 41
28 *0E* FE 1A 79 30 *03* A8
12 13 B7 20 *EE* C9 78 EE
20 47 18 *E7*
</code></pre>
<h1>Disassembly and explanation</h1>
<pre><code>fun:
    ld b,0      ; 06 00     we start out in non-swapping state
loop:
#ifdef SM83
    ld a,(hl+)  ; 2A        load character
#else
    ld a,(hl)   ; 7D
    inc hl      ; 23        Z80 doesn't have autoinc addressing
#endif
    ld c,a      ; 4F        save copy in c
    res 5,a     ; CB AF     Clear bit 5
    sub 65      ; D6 41     subtract 'A'
    jr z,is_a   ; 28 0C/0E  if 0, was 'A' or 'a'; handle that later
    cp 26       ; FE 1A     compare to 26
    ld a,c      ; 79        reload from copy
    jr nc,put   ; 30 01/03  skip next if was letter (&lt;26)
    xor b       ; A8        xor in caps lock setting
put:
    ld (de),a   ; 12        store
    inc de      ; 13        and increment
    or a        ; B7        check if zero by self-or (cheap trick)
    jr nz,loop  ; 20 ED/EE  loop if wasn't 0
    ret         ; C9        and return otherwise
is_a:
    ld a,b      ; 78
    xor 32      ; EE 20
    ld b,a      ; 47        flip caps lock setting
    jr loop     ; 18 E6/E7  jump back to loop
</code></pre>
<p>Heavily based on <a href="https://codegolf.stackexchange.com/users/46901">corvus_192</a>'s <a href="https://codegolf.stackexchange.com/a/214393">answer</a>.
The differences:</p>
<ul>
<li>I counted bytes of machine code, not assembly</li>
<li>I changed <code>jp</code> (absolute jump, three bytes) to <code>jr</code> (relative jump, two bytes), saving five bytes</li>
<li>I moved the case-fold (<code>res 5,a</code>) to before the test for A, saving a compare-to-constant and a jump (four more bytes saved)</li>
<li>This produced the sequence <code>cp 65; jr z,is_a; sub 65</code>, which can be collapsed to <code>sub 65; jr z,is_a</code>, saving two more bytes.</li>
<li>It's cheaper to test if <code>a</code> is 0 by executing <code>or a</code> (<code>and a</code> also works) than <code>cp 0</code>; it doesn't tell you sign, but we didn't need that.</li>
</ul>
<p>In total, these changes (well, not the counting difference) save twelve bytes from the original.</p>
</div>
<div id="pu5" class="pu"><h1><a href="http://julialang.org/" rel="nofollow noreferrer">Julia 1.0</a>, <sup><s>73</s></sup> 71 bytes</h1>

<pre class="lang-julia prettyprint-override"><code>f(s,b=0)=[c∈&quot;aA&quot; ? b=32-b : print(c+isletter(c)sign('_'-c)b) for c=s]
</code></pre>
<p><a href="https://tio.run/##ZVLNattAEL7nKQZfbFOl9OcWMEG4LQ0NTWkCpZRSRquRNfZ6V91Z2VafIM@ZF3FnJbmUWIeVtDvz/e2sW8v4@nA8VjPJisWr@eKHeXp8nGA@gWsoFm/fXBZwBU1gF2fmBYulGCnMzFx45WbTX9NLMy/mUPkAZiE/FWfyUBP8btlsoAh@7/TsAOt22wj4HQWIemzxTwelX72czC96bOtm8wvtXfptwxYje@1jx1JTCdIaQyJVa2131vGtxgg1Ng05gX1NridYYiO3XiVsqAPF6nwb0nfhMZTKTOKmqW1HgOB8NDWwA47Xz@GTGXIl@KrHZSeRY5v0ZbBFLSSHzlAGqEVYbpPmGAYD2rNKlt2WXMyABaIHIdMG6sHooLWk3Sf0wpcdNN5yZJOl4ib4SCaqsIFAt6o2pFhGNSXvuGzRJusejKbnRfcj7DkONY3fa@hKQG7tO3arZFSwotgNkAGd3pZV0i41cACHsQ1oIfCqjjIyJ3lWb0ERJMFZruiqP0qh03izSr4KpDfii7UKF0D1qvnqf9S0qMwGUeQbS6f8e57kDW0cB@T/3EbjETcEW0LR@AQcpZHA0PWjN@geXGUpNWko8OgwDYdSi5zNDuaoT1ryXF9nw3gaIquLgMm/3Nu75afnZfuP@QPcfPh3Djf3kN9@fZ@/@w53n3Wijn8B" rel="nofollow noreferrer" title="Julia 1.0 – Try It Online">Try it online!</a></p>
<p>Stolen and improved from <a href="https://codegolf.stackexchange.com/a/189535/98541">Simeon Schaub's great answer</a></p>
<p>-2 bytes thanks to <a href="https://codegolf.stackexchange.com/users/90445/czylabson-asa">Czylabson Asa</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/Lyxal/Vyxal" rel="nofollow noreferrer">Vyxal</a> <code>s</code>, <s><sup>12</s></sup> <s><sup>10</s></sup> 9 bytes</h1>
<p><em>Saved 2 bytes by using <code>ṡ</code> to split the string with a regex.</em></p>
<p><em>Saved 1 byte by using <code>⁽</code> to define the function.</em></p>
<pre><code>`a|A`ṡ⁽Nẇ
</code></pre>
<p><a href="http://lyxal.pythonanywhere.com?flags=s&amp;code=%60a%7CA%60%E1%B9%A1%E2%81%BDN%E1%BA%87&amp;inputs=The%20end%20of%20the%20institution%2C%20mAintenance%2C%20and%20administration%20of%20government%2C%20is%20to%20secure%20the%20existence%20of%20the%20body%20politic%2C%20to%20protect%20it%2C%20and%20to%20furnish%20the%20individuals%20who%20compose%20it%20with%20the%20power%20of%20enjoying%20in%20safety%20and%20tranquility%20their%20natural%20rights%2C%20and%20the%20blessings%20of%20life%3A%20and%20whenever%20these%20great%20objects%20are%20not%20obtained%2C%20the%20people%20have%20a%20right%20to%20alter%20the%20government%2C%20and%20to%20take%20measures%20necessary%20for%20their%20safety%2C%20prosperity%20and%20happiness.&amp;header=&amp;footer=" rel="nofollow noreferrer">Try it Online!</a></p>
<p>Explanation:</p>
<pre><code>           # Implicit input
`a|A`ṡ     # Split string every instance 'a' OR 'A'
      ⁽N   # Define a function that swaps the casing of strings
        ẇ  # Apply the function to every 2nd string
           # 's' flag: concatenate top of the stack and print
</code></pre>
</div>
<div id="pu7" class="pu"><h1>MMIX, 60 bytes (15 instrs)</h1>
<pre><code>E3020000 83030000 E7000001
CBFF0320 25FFFF41 5AFF0003
C7020220 F1FFFFFA 33FFFF1A
48FF0002 C6030302 A3030100
E7010001 5B03FFF4 F8000000
</code></pre>
<h1>Disassembly and explanation:</h1>
<pre><code>fun SETL  $2,0              // E3020000: mask = 0
0H  LDBU  $3,$0,0           // 83030000: loop: chr = *src (src, dst are both char *)
    INCL  $0,1              // E7000001: src++
    ANDN  $255,$3,32        // CBFF0320: tmp = chr &amp; ~32
    SUB   $255,$255,'A'     // 25FFFF41: tmp -= 'A'
    PBNZ  $255,1F           // 5AFF0003: iflikely(!tmp) goto nota
    XOR   $2,$2,32          // C7020220: mask ^= 32
    JMP   0B                // F1FFFFFA: goto loop
1H  CMPU  $255,$255,26      // 33FFFF1A: nota: tmp = tmp &lt;=&gt; 26
    BNN   $255,1F           // 48FF0002: if(tmp &gt; 0) goto notlet
    XOR   $3,$3,$2          // C6030302: chr ^= mask
1H  STBU  $3,$1,0           // A3030100: notlet: *dst = chr
    INCL  $1,1              // E7010001: dst++
    PBNZ  $3,0B             // 5B03FFF4: iflikely(chr) goto loop
    POP   0,0               // F8000000: return
</code></pre>
<p>This was heavily inspired by <a href="http://codegolf.stackexchange.com/users/46901">corvus_192</a>'s <a href="https://codegolf.stackexchange.com/a/214393">answer</a>.</p>
<p>It's essentially the same algorithm, except with multiple simplifications due to MMIX's symmetric register architecture.</p>
</div>
<div id="pu8" class="pu"><h1><a href="http://julialang.org/" rel="nofollow noreferrer">Julia</a>, 107 bytes</h1>

<pre class="lang-julia prettyprint-override"><code>let b=false;[c in&quot;aA&quot; ? b=!b : print(b&amp;&amp;isletter(c) ? c&lt;'@' ? c+32 : c-32 : c) for c::Char=read(stdin)];end
</code></pre>
<p><a href="https://tio.run/##JYpBCsIwEAC/svbQpoiCemstKn2GeEg2G7oS05JNQV8fI54GZua5etaHd86eEpjBaS/U3xE4VPpWwaW4jYEOlsghKVPXLOVMFBW2peK5uTY/bk/HcuHujxbcHAG7bpx0HCJpqyRZDu2jp2BzHufXwl4nngM4DiwTWZAVkUTc6v1n/wU" rel="nofollow noreferrer" title="Julia 1.0 – Try It Online">Try it online!</a></p>
<p>The <code>let</code> block is unfortunate, but apperently julia's scope is broken and b is undefined otherwise.</p>
<p>Here's the same program but with loops instead of comprehension, and <code>if</code> instead of conditionals.</p>
<pre class="lang-julia prettyprint-override"><code> let b=false # whether to invert charachters
# normally this would be &quot;for c in read(stdin,String)&quot;, 
# but reading a byte array and converting the bytes to chars saves one (byte).
for c::Char in read(stdin)  
if c in &quot;aA&quot; 
   b = !b
else
   print(if b &amp;&amp; isletter(c) 
            if c&lt;'@' # capitalization check
               c+32  # ascii code shenanigans to change case
            else
               c-32
            end
         else
            c # c is not a letter or we aren't swapping
         end)
end
end
end
</code></pre>
</div>
<div id="pu9" class="pu"><h1>Gameboy Z80 Assembly, 186 bytes</h1>
<pre><code>f:
 ld b,0
l:
 ld a,[hli]
 ld c,a
 cp 65
 jp z,a
 cp 97
 jp z,a
 res 5,a
 sub 65
 cp 25
 ld a,c
 jp nc,o
 xor b
o:
 ld [de],a
 inc de
 cp 0
 jp nz,l
 ret
a:
 ld a,b
 xor 32
 ld b,a
 jp l
</code></pre>
<p>This answer was heavily influenced by <a href="https://codegolf.stackexchange.com/users/58688/ian-chew">Ian Chew's</a> <a href="https://codegolf.stackexchange.com/a/161607">x86 assembly answer</a>.</p>
<h2>Commented version</h2>
<pre><code>; input in hl
; output in de
; b is used for the caps lock state, 00000000 = no capslock, 00100000 = capslock
; a and c are used for the character
f:
 ld b,0
loop:
; load a character from the input and advance the source pointer
 ld a,[hli]
;save character in c
 ld c,a
; check if character is 'a' or 'A'
 cp 65
 jp z,is_a
 cp 97
 jp z,is_a
; check if character is a letter by setting the 5th bit to zero and checking for the range 25..65
 res 5,a
 sub 65
 cp 25
; load the character back from c
 ld a,c
; if it is not a letter, simply output it
 jp nc,output
; if it is a letter, apply the current case swap
 xor b
; output the character and advance the destination pointer
output:
 ld [de],a
 inc de
; end of input?
 cp 0
 jp nz,loop
; return
 ret

is_a:
; change the case swap mask by xoring with 32
 ld a,b
 xor 32
 ld b,a
; continue the loop
 jp loop
</code></pre>
</div>
<div id="pu10" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/tree/fb4a2ce2bce6660e1a680a74dd61b72c945e6c3b" rel="nofollow noreferrer">05AB1E (legacy)</a>, 11 bytes</h1>

<pre><code>„AaS¡εNFš]J
</code></pre>

<p><a href="https://tio.run/##MzBNTDJM/f//UcM8x8TgQwvPbfVzO7ow1uv///CMxBKFjMSCgtS8YoXyjNQ8hZKMVAXnxIJin/zkbIXs1EqF/DyFyvzSIhA7KT@xKEUhJT@1OE8dpK0sVSFRIS@/JDlDITNPIbPEHgA" rel="nofollow noreferrer" title="05AB1E (legacy) – Try It Online">Try it online!</a></p>
</div>
<div id="pu11" class="pu"><h1><a href="https://clojure.org/" rel="nofollow noreferrer">Clojure</a>, 256 bytes</h1>

<h2>Golfed</h2>

<p><code>(require[clojure.string :refer :all])(def u upper-case)(defn f[x](if(=(u x)x)(lower-case x)(u x)))(defn i[a](="A"(u a)))(defn g[x](let[v(vec(map str x))](join""(filter(complement i)(reduce-kv(fn[c k e](if(i e)(concat(take k c)(map f(drop k c)))c))v v)))))</code></p>

<h2>Ungolfed</h2>

<pre><code>(ns acapslock.core
  (:require [clojure.string :as str]))


(defn flip
  [x]
  (if (= (str/upper-case x) x) (str/lower-case x) (str/upper-case x)))

(defn isa
  [a]
  (or (= "a" a) (= "A" a)))

(defn foo 
  [x]
  (str/join "" (filter (complement isa) (reduce-kv (fn [coll idx elem] (if (isa elem)(concat (take idx coll) (map flip (drop idx coll))) coll)) (vec (map str x)) (vec (map str x))))))
</code></pre>

<h2>Explanation</h2>

<p>The solution works in two steps:</p>

<ul>
<li><p>First, we go through the input character by character. If we find an <code>a</code> or an <code>A</code>, we flip the case of the rest of the string.</p></li>
<li><p>Then we filter out all <code>a</code>'s and <code>A</code>'s.</p></li>
</ul>

<h2>Tests</h2>

<pre><code>(ns acapslock.core-test
  (:require [clojure.test :refer :all]
            [acapslock.core :refer :all]))


(deftest a-test
  (testing "test cases"
    (is (= "" (foo "")))
    (is (= "The quick brown fox jumps over the lZY DOG." (foo "The quick brown fox jumps over the lazy dog.")))
    (is (= "CompilTION FINISHED SUCCESSFULLY." (foo "Compilation finished successfully.")))
    (is (= "WhT Hppens when the CPSlOCK KEY ON YOUR KEYBOrd doesn't hVE  notch in it?" (foo "What happens when the CapsLock key on your keyboard doesn't have a notch in it?")))
    (is (= "The end of the institution, mINTENnce, ND dministrTION OF GOVERNMENT, IS TO SECURE THE EXISTENCE OF THE BODY POLITIC, TO PROTECT IT, nd to furnish the individuLS WHO COMPOSE IT WITH THE POWER OF ENJOYING IN Sfety ND TRnquillity their nTURl rights, ND THE BLESSINGS OF LIFE: nd whenever these greT OBJECTS re not obtINED, THE PEOPLE Hve  RIGHT TO lter the government, ND TO Tke meSURES NECESSry for their sFETY, PROSPERITY nd hPPINESS." (foo "The end of the institution, maintenance, and administration of government, is to secure the existence of the body politic, to protect it, and to furnish the individuals who compose it with the power of enjoying in safety and tranquillity their natural rights, and the blessings of life: and whenever these great objects are not obtained, the people have a right to alter the government, and to take measures necessary for their safety, prosperity and happiness.")))
    (is (= "" (foo "aAaaaaAaaaAAaAa")))
    (is (= "CPSlOCK LOCKS CPSlOCK" (foo "CapsLock locks cAPSlOCK")))
    (is (= "wHt if CPSlOCK IS lreDY ON?" (foo "wHAT IF cAPSlOCK IS ALREADY ON?")))

    )) 
</code></pre>
</div>
<div id="pu12" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, 66 bytes</h1>



<pre class="lang-c prettyprint-override"><code>u;f(char*s){for(u=0;*s;s++)u^=6305%*s?!putchar(*s&amp;64?*s^u:*s):32;}
</code></pre>

<p>Similar to another solution but doesn't use <code>ctype</code> functions.</p>

<p><em>-1 byte thanks to [ceilingcat]!</em></p>

<p><a href="https://tio.run/##ZYzLDoIwEEX3fkUl0ZQajfHBgsYY4ifImqSWFqpAkWFUNH47lqU6izuTnDlXzjMp@x65pjIXDQP/pW1DcbfkDDjMZj4mu2C93E4Y7Mc1tsMXZTANNnsGCYbOCNcr/u5LYSrqv0aaenGuyBWNvJBTY@8V0fZBzljWQOxNNaR1uBDPjqQ2W3g@d61APXcM7sGWtSlEa6zzTGUgVykBlFIBaCyK7s8QkXAzRBS59YtbdYzFdzjy7j8" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
</div>
<div id="pu13" class="pu"><h1><a href="https://en.wikipedia.org/wiki/Forth_(programming_language)" rel="nofollow noreferrer">Forth</a>, 225 bytes</h1>
<pre><code>: d DUP ; : x SWAP ; : w WITHIN ; : a d d 65 = x 97 = OR ; : y d d 65 91 w x 97 123 w OR ; : ~ INVERT ; x VALUE s 0 VALUE f : l 0 DO I s + C@ a IF f ~ TO f THEN y IF f IF 32 XOR d THEN a ~ IF EMIT THEN ELSE EMIT THEN LOOP ; l
</code></pre>
<p>What happening:</p>
<pre><code>: d DUP ;                     \ shortcut for duplicating value on stack
: a d d 'A' = SWAP 'a' = OR ;             \ testing, if char is 'a' or 'A'
: y d d 'A' '[' WITHIN SWAP 'a' '{' WITHIN OR ;   \ testing, if char is within letters
: ~ INVERT ;                      \ shortcut for negation
SWAP                          \ swap addr and len of the string after s&quot; command
VALUE s                       \ pop addr to s
0 VALUE f                     \ write 0 to f(lag)
: l 0 DO                      \ declaration of loop named 'l' from 0 to len (len is laying on top of the stack, remember)
I s + C@                      \ push iteration number on stack and load char from s + iteration

        \ this IF is searching for 'a' or 'A'
a IF
    f ~ TO f              \ if we found 'a' or 'A', then flip the f(lag)
    THEN
y IF                      \ if char is letter
    f IF                  \ and f is set
    32 XOR d THEN             \ change case of symbol

    a ~ IF                \ if it's not 'a' or 'A' then print char
        EMIT
        THEN 
ELSE
    EMIT                  \ print char
THEN
LOOP ;

l
</code></pre>
<hr />
<p><a href="https://tio.run/##TU9bT8IwGH33V5zwKhouQQPExAVKaDJXwgr4Wh3j4qRQbsMH/vo82zDxoT3Xfl8aW3dYPiziHLIsrEAv59gdV59f@HD2vEFsU6yP39s97GnucGCcmJ8LIruowhlnPB73WLnrIEJ/MkIXHaQIZ15Jz5hJPZRBIQw7EZ5aeGGl/UxQ4yK4/AXtOl8UWb3RJL3lV8hgKsaaIsXU8ycCe9RuLGYhoeorSNr36L1ykxwwuEIrgh6KgDsKi1ezgXcOjkrf5NMHEG9Sl4bwQ/FP@krlX0my7Bc" rel="nofollow noreferrer" title="Forth (gforth) – Try It Online">Try it online!</a></p>
<p>Actually code in <em>tio</em> is <strong>285 bytes</strong>, but this is because <em>Footer</em> didn't work for defining string, so i had to include string definition in actual code.</p>
</div>
<div id="pu14" class="pu"><h1><a href="http://julialang.org/" rel="nofollow noreferrer">Julia 1.0</a>, 82 bytes</h1>



<pre class="lang-julia prettyprint-override"><code>s-&gt;foldl((b,c)-&gt;c∈"aA" ? !b : (print(c+32isletter(c)sign('_'-c)b);b),s,init=1&lt;0)
</code></pre>

<h2>Explanation</h2>

<h3>De-golfed:</h3>



<pre class="lang-julia prettyprint-override"><code>function f(s::String)::Bool
    foldl(s, init=false) do b, c
        if c ∈ "aA"
            return !b
        else
            print(c + 32 * (isletter(c) &amp; b) * sign('_'-c))
            return b
        end
    end
end
</code></pre>

<p><code>foldl(f, s, init=false)</code>: takes a function <code>f</code> that maps a state and a <code>Char</code> <code>c</code> to a new state. Applys <code>f</code> repeatedly over each <code>Char</code> of the string <code>s</code>, always passing the state previously returned by <code>f</code> back to <code>f</code>. <code>init</code> is the initial state. Here the state represents whether caps-lock is on.</p>

<p><code>if c in "aA"</code>: If <code>c</code> is an upper- or lowercase <code>'a'</code>, just return the opposite state.</p>

<p><code>isletter(c) &amp; b</code>: <code>Bool</code>, returns true iff <code>c</code> is a letter and <code>b</code> indicates, that caps-lock is on.</p>

<p><code>sign('_'-c)</code>: <code>-1</code> if <code>c</code> is lowercase, <code>1</code> if <code>c</code> is uppercase.</p>

<p><code>print(c + 32 * (isletter(c) &amp; b) * sign('_'-c))</code>: <code>Bool</code>s act like 0/1 under simple arithmetic operations, so if caps-lock should have an effect, this either adds or substracts 32 from <code>c</code>, returning a <code>Char</code> with opposite case. Then just print that.</p>

<p><a href="https://tio.run/##ZVLNbtNAEL73KYZcYgsHUbgV2soKICoqimglxAmN1@N4k82u2RkncZ@gz8mLhNnERaj1YW3vznx/O8veWTzd7ZvzPc8umuBql2VVYfLZhfnz8DDBcgKX8KKCM8i6aL1k5uXbN5YdiVDMTM524bPpr@nM5FX@rsoLLqy3cn76/nW@b7LJXUvwu7dmBVUMWw9N2MGyX3cMYUMRRI8d3g9Qh8WrSX5y4HA@y0@0dx7WnXUoNmifonJLNXBvDDE3vXPDs44fLQq02HXkGbYt@QPBHDu@DiphRQMo1hD6mL6rgLFWZmI/TW0bAgQfxLRgPVi5fAqfzJCvITQHXOtZrPRJXwFr1ELy6A0VgFqE9Tpplng0oD2LZNmvyUsBlkECMJk@0gGMdlpL2v2IXoV6gC44K9YUqbiLQciICjsS6FbTxxTLqKa2G1v36JL1AEbTC6z7Alsrx5oubDV0JSC/DIP1i2SUsSEZjpARvd6WU9IhNdgIHqWP6CDaRSs8Mid5Tm9BETjBOdvQ2eEohU7jzSr5IpLeSKiWKpwB1avmq/@iaVFdHEVR6Bw95n/gSd7QyTgg/@c2GhdcEawJWeNj8JRGAuOg4xVH3UdXRUqNO4p2dJiGQ6mZn80OlqhPWspSX8@G8XGInC4Mpvx2627mX56WbT@Xd3D16d85XN1Cef39Y/nhJ9x81Yna/wU" rel="nofollow noreferrer" title="Julia 1.0 – Try It Online">Try it online!</a></p>
</div>
<div id="pu15" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 110 bytes</h1>



<pre class="lang-python prettyprint-override"><code>code_golf=lambda s:"".join([j.swapcase()if i&amp;1else j for i,j in  enumerate(__import__('re').split(r"a|A",s))])
</code></pre>
</div>
<div id="pu16" class="pu"><h1>C, <strike>167</strike> <strike>168</strike> <strike>158</strike> 131 bytes</h1>

<p>Thanks for @Martin Ender for the code review: I've switched the stream processing for string processing to help with reusability. Also many thanks to @RiaD and @ceilingcat for their suggestions.</p>



<pre class="lang-c prettyprint-override"><code>c,d;(*t[][2])()={{isupper,tolower},{islower,toupper}};f(char*s){for(d=1;c=*s++;)t[0][1](c)==97?d=!d:putchar(t[!t[d][0](c)][1](c));}
</code></pre>

<p><a href="https://tio.run/##RY/LTsMwEEX3@QpX3dhpitpKFQLXIN6fwMLyIozt1FKII3sCgsi/TnCqClZz77lnM7BuAKal66AdtCGHiNr5i@NN8Y8Av3qT0QSV5rREqeROMcrEOLo49L0JFfrWf5qQqkxOKZPTkhK3FI51KCMbrQ9Uiy0HUcbVijOUGyW3igIT4uryVouFvu4HnHWKcoFSq2zk@WwxnibXIXmvXUc/vNNsLAiZdRLlbr9XvMjdWWobg5HGikT3bbylkeWYH@sYI3PjWQsGh9CRDS/SVL@BNrYhd/cPj0/PL3/3zH/AtnUTp/Vr3ba/" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>

<h1>How does it work?</h1>

<pre class="lang-c prettyprint-override"><code>/* int c is the input character,
   int d is the Caps Lock flag (1=off, 0=on)  starting as "Off". */
int c, d;
/* array of comparison functions and transformation functions for each state */
(*t[][2])() = {{isupper, tolower}, {islower, toupper}};

f(char *s) {
  /* Loop if we haven't hit the terminator */
  for(d = 1; c = *s++;)
    t[0][1](c) == 97 ?
      /* If tolower(c)=='a' then flip the Caps Lock state */
      d=!d:
      /* Otherwise, convert character according to the following table:

                       Character case
         Caps Lock  UPPER       LOWER
                ON  tolower()   toupper()
               OFF  toupper()   tolower()
      */
      putchar(t[!t[d][0](c)][1](c));
  }
}
</code></pre>

<h1>Notes</h1>

<ul>
<li><code>s[][]</code> is where the magic happens: <code>[][0]</code> is the comparison function and <code>[][1]</code> is the related transformation function for each state.</li>
<li><code>!</code> is applied to the comparison function to force it into the range [0,1].</li>
</ul>
</div>
<div id="pu17" class="pu"><h1><strong><a href="http://lua.org/" rel="nofollow noreferrer">Lua 5.3</a>, 137 bytes</strong></h1>
<pre><code>a=0s=&quot;&quot;io.read():gsub(&quot;.&quot;,function(c)if c:find&quot;[aA]&quot;then a=not a else l=c:lower()s=s..(a and c or l==c and c:upper()or l)end end)print(s)
</code></pre>
<p><a href="https://repl.it/@dholton/ACM-Code-Golf-1" rel="nofollow noreferrer">Try it online!</a></p>
<hr />
<h3>Notes:</h3>
<p>My result was very similar to @Visckmart above. But I included the <code>print(s)</code> in my byte count. Also the try it online test uses Lua 5.1, where my final result is in Lua 5.3. To make my final answer run on the website linked above I had to add a single space in between defining <code>a</code> and <code>s</code>: <code>a=0 s=&quot;&quot;</code> which make it 138 bytes when using Lua 5.1</p>
</div>
<div id="pu18" class="pu"><h1><a href="https://www.lua.org" rel="nofollow noreferrer">Lua</a>, <del>152</del> 151 bytes</h1>



<pre class="lang-lua prettyprint-override"><code>p=io.read()a=0s=""for c in p:gmatch"."do l=c:lower()if c:find"[aA]"then a=(a+1)%2 else s=s..((c:find"%A"or a==0)and c or l==c and c:upper()or l)end end
</code></pre>

<p><a href="https://tio.run/##LU/BSgUxDPyVUHjYIixPjwtBHl69exAPsc265fU1pe26vK9fU/EQyAyTmUza6DgKRpkqU7CO8NzQmEUqeIgZyvx9o@5XM5kgkNDPSXau1sUF/LzEHMwHXT5NXzkDoaXHJ3d6Bk6NoWGbJmv/ZaeLUVNCPDvKQd0VJUQPf2jeShm2g3SsjM6hX@01drbNHe8rdVhJVbnBPtI0El6ptDfxV7jyHSTDXbY69i@hGiAIt/wwzn4YCLJokVEq9pdf" rel="nofollow noreferrer" title="Lua – Try It Online">Try it online!</a></p>

<hr>

<h3>Explanation</h3>

<pre class="lang-lua prettyprint-override"><code>p = io.read() -- reads the input
a = 0
s = ""
for c in p:gmatch"." do -- loops through the string 'p' (the input) calling each character 'c'
  l = c:lower() -- stores the lowercase version of 'c'
  if c:find("[aA]") then -- if 'c' is a lowercase or uppercase 'A'
    a = (a+1)%2 -- flip the value of 'a' between 0 and 1, from what I've seen it uses less space
  else
    s = s..((c:find("%A") or a==0) and c or l==c and c:upper() or l)
    s = s..   -- append to the string 's'
            (c:find("%A") or a==0)   -- if this is not a letter or the "reversion" is off
                                   and c or   -- then append 'c' else
                                            l==c and c:upper() or l   -- if 'c' is lowercase then append it as uppercase else append it as lowercase
  end
end
</code></pre>

<p>If you have any questions, feel free to ask and i'll try to answer.</p>
</div>
<div id="pu19" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, <s>23</s>  20 bytes</h1>

<pre><code>'a A'Yb&amp;Ybt2L)Yo2L(g
</code></pre>

<p><a href="https://tio.run/##TVJNb9RADL3zK3xqQIp6WIkDCLGNWlArVhTRHsgBqd7ESbydzISxs2n484tnExA5TDT@eM/veXpUd3q6evvx6t2H8mJbbn@eMoQiK/cX5V43uzdl2Oxet6ebzY/bU/bYEfwauXqGfQyThya8wGHsB4FwpAhqaYe/Z6hDe5m9yq5DP7BD5WCl7Fk6qkHGqiKRZnRuTkUJk3wNoTn3sxdlHVNPDj2yV/LoK8oBrQjrPuFoXECtp03MvievObCABhCqxkhnMHqxWrLuv@j7UM8wBMfKVZ6KhxiUKgXWhcBCzRjTqOs0NR@5HtEJTF2AyhQFsbjCxLrUDGEy7UZA/hBm9q11gWBDOi@QEb2Z5ox0Tg0cwaOOER1EbjuVlTmN58wZQ5AE57ih9@fU1JGn1WAjbyOhQtgfbHABNK0@pLuaW1Tny1AUBkfQ4ZEAF56kDZ2ue/rft1W44jNBTyhmn4CntCaMs205rnMvqvLkmgwUeVXY4TAYtUjaJxZoXzqKwn7pGeAgu2CPxtkhUBXfHtz99RfLTLfFI9x9/heCuwcodt8/FTcl3H/dZn8A" rel="nofollow noreferrer" title="MATL – Try It Online">Try it online!</a></p>

<h3>Explanation:</h3>

<pre><code>'a A'Yb   % form a cell array containing {'a', 'A'}
&amp;Yb       % split input into substrings, with either of those ('a' or 'A') as delimiters
t2L)      % extract out the even positioned cells from that result
Yo        % switch the case of those substrings
2L(       % place the result back in even positioned cells of the original cell array
g         % convert cell array to matrix, concatenating all substrings in the process
          % implicit output
</code></pre>

<hr>

<p>Older answer (23 bytes):</p>

<p><a href="https://tio.run/##TVJNb9QwEL3zK0YcmkvEAakHECIbtVRbUVFEe@geVmI2mSTeOrbxTDYbJPrXt@NNQOTgyPPx3rw37lHs6efq8vPqw6fNRbEptqe361WGZdYXL0/r45/V@FJs/PaiO2231@@f1qfssSP4NZjqGXbRjw4af4T90AcGf6AIommLvyeoffsue5Nd@T4Yi2K8lhpnuKMaeKgqYm4Ga6dUlDDJ1eCbc79xLEaG1JNDj8YJOXQV5YBahHWfcCTOoNrTJmbXk5McDIN4YKqGSGcwOmotafdf9J2vJwjeGjFVnopD9EKVgJGZQEPNENOoyzS1OZh6QMswdh4qVeRZ4wKjkbkm@FG1KwG5vZ@Ma7ULGBuSaYaM6NQ0q6RTajARHMoQ0UI0bSe8MKfxrDqjCJzgrGno4zk1duRoMVjJ20go4Hd7HZwBVavz6S7qFtX5PBT5YAk6PBDgzJO0oZVlT//7tggXfCboCVntY3CU1oRx0i3HZe5ZVZ5c40DRLAo7DEGpmdM@sUT90lGW@kvPAAPfeX00Vg@Gqvz@YO@vvmpmXJePcHvzLwS3D1De/fhSXm/g/luRvQI" rel="nofollow noreferrer">"H@'aA'm?~XHx}@w~?Yo]&amp;h</a></p>

<p>Other methods I tried: </p>

<pre><code>0w"@t'aA'm?x~}y?Yo]w]]xv!
t'aA'mXHYsot&amp;y*XzcYowf([]H(
t'aA'mXHYsoy3Y2m*32*Z~c[]H(
</code></pre>
</div>
<div id="pu20" class="pu"><h2>Javascript (ES6), <s>80</s> 79 bytes</h2>

<p><em>(Partly based off of <a href="https://codegolf.stackexchange.com/a/158138">this answer</a> by Rick Hitchcock. Posting as a separate answer because I don't have sufficient reputation to comment.)</em></p>

<p><em>(Saved 1 byte thanks to @l4m2's post <a href="https://codegolf.stackexchange.com/questions/158132/no-a-just-caps-lock/158138#comment391456_158138">here</a>.)</em></p>

<pre><code>a=&gt;a.replace(j=/a()|./gi,(c,o=c[`to${j^c&gt;{}?'Low':'Upp'}erCase`]())=&gt;(j^=!o,o))
</code></pre>
</div>
<div id="pu21" class="pu"><h1>JavaScript (ES6), <s>93</s> <s>88</s> <s>84</s> 82 bytes</h1>
<p><em>(saved 5 bytes thanks to @Shaggy, 4 bytes thanks to @user81655, and 2 bytes thanks to @l4m2.)</em></p>
<pre><code>a=&gt;a.replace(A=/./g,c=&gt;c in{a,A}?(A=!A,''):A?c:c[`to${c&lt;{}?'Low':'Upp'}erCase`]())
</code></pre>
<p><strong>Test cases:</strong></p>
<p><div class="snippet" data-lang="js" data-hide="true" data-console="true" data-babel="false">
<div class="snippet-code snippet-currently-hidden">
<pre class="snippet-code-js lang-js prettyprint-override"><code>let f=

a=&gt;a.replace(A=/./g,c=&gt;c in{a,A}?(A=!A,''):A?c:c[`to${c&lt;{}?'Low':'Upp'}erCase`]())

console.log(f("The quick brown fox jumps over the lazy dog."));
console.log(f("Compilation finished successfully."));
console.log(f("What happens when the CapsLock key on your keyboard doesn't have a notch in it?"));
console.log(f("The end of the institution, maintenance, and administration of government, is to secure the existence of the body politic, to protect it, and to furnish the individuals who compose it with the power of enjoying in safety and tranquillity their natural rights, and the blessings of life: and whenever these great objects are not obtained, the people have a right to alter the government, and to take measures necessary for their safety, prosperity and happiness."));
console.log(f("aAaaaaAaaaAAaAa"));
console.log(f("CapsLock locks cAPSlOCK"));
console.log(f("wHAT IF cAPSlOCK IS ALREADY ON?"));</code></pre>
</div>
</div>
</p>
</div>
<div id="pu22" class="pu"><h1>x86-64, 31 bytes</h1>

<p>Conforms to the System-V calling convention, tested in Ubuntu 16.04. Takes input from a pointer to a null-terminated in rsi, and outputs the result as a null-terminated string in rdi. rdi is expected to pointer to a buffer that's already been allocated with sufficient size.</p>

<p>Disassembly for byte count:</p>

<pre><code>   0:       31 d2                   xor    edx,edx
   2:       ac                      lods   al,BYTE PTR ds:[rsi]
   3:       88 c1                   mov    cl,al
   5:       24 df                   and    al,0xdf
   7:       3c 41                   cmp    al,0x41
   9:       75 05                   jne    10 &lt;not_A&gt;
   b:       80 f2 20                xor    dl,0x20
   e:       eb f2                   jmp    2 &lt;loop&gt;
  10:       2c 41                   sub    al,0x41
  12:       3c 19                   cmp    al,0x19
  14:       77 02                   ja     18 &lt;not_ascii&gt;
  16:       30 d1                   xor    cl,dl
  18:       91                      xchg   ecx,eax
  19:       aa                      stos   BYTE PTR es:[rdi],al
  1a:       84 c0                   test   al,al
  1c:       75 e4                   jne    2 &lt;loop&gt;
  1e:       c3                      ret
</code></pre>

<p>Commented Assembly (GAS):</p>

<pre><code>.intel_syntax noprefix
.text
// rsi has the input char*, rdi has the output char*.
// Input char* is \0-terminated.
.global caps
caps:
    // Use this for xor mask.
    xor     edx, edx
// Loop is set up as a do-while loop.
loop:
    // al = *rdi++
    lodsb

    // Save the character we read into cl.
    // We use al because the instructions are shorter.
    mov     cl, al

    // Make upper case
    and     al, 0b11011111

    // 65 = 'A'
    cmp     al, 65
    jne     not_A
is_A:
    // Invert capitialization mask
    xor     dl,0x20
    // Continue
    jmp     loop

not_A:
    // Now we check if input character is ascii.
    // Basically, if (al-'A' &gt; 'Z'-'A'), it's not ascii
    sub     al, 65
    cmp     al, 25

    ja      not_ascii
ascii:
    // Flip capitilization if necessary.
    xor     cl, dl

not_ascii:
    // Restore saved character that we read.
    // xchg is 1 byte, as opposed to mov, which is 2.
    xchg    ecx, eax

    // Write out the character to the output buffer.
    stosb

endloop:
    // If al == 0, break
    test    al, al
    jnz     loop

end:
    // Just return, we've already written out the null
    // character to the output string.
    ret
</code></pre>

<p>Testing code in C, takes the input string via the first command line argument, prints out the result string:</p>

<pre><code>#include &lt;stdio.h&gt; //puts
#include &lt;stdlib.h&gt; //malloc, free
#include &lt;string.h&gt; //strlen

void caps(char* output, char* input);

int main(int argc, char** argv) {
    char* instr = argv[1];
    char* buf = malloc(strlen(instr) + 1);
    caps(buf, instr);

    // Print converted string.
    puts(buf);

    free(buf);
}
</code></pre>
</div>
<div id="pu23" class="pu"><h1><a href="http://kx.com/download/" rel="nofollow noreferrer">K4</a>, 49 bytes</h1>

<p><strong>Solution:</strong></p>

<pre><code>{@[x;&amp;.q.mod[;2]@&amp;-':w;.q.upper]_/|w:&amp;"a"=_x,"a"}
</code></pre>

<p><strong>Examples:</strong></p>

<pre><code>q)k){@[x;&amp;.q.mod[;2]@&amp;-':w;.q.upper]_/|w:&amp;"a"=_x,"a"}"The quick brown fox jumps over the lazy dog."
"The quick brown fox jumps over the lZY DOG."
q)k){@[x;&amp;.q.mod[;2]@&amp;-':w;.q.upper]_/|w:&amp;"a"=_x,"a"}"Compilation finished successfully."
"CompilTION FINISHED SUCCESSFULLY."
q)k){@[x;&amp;.q.mod[;2]@&amp;-':w;.q.upper]_/|w:&amp;"a"=_x,"a"}"What happens when the CapsLock key on your keyboard doesn't have a notch in it?"
"WhT Hppens when the CPSLOCK KEY ON YOUR KEYBOrd doesn't hVE  notch in it?"
q)k){@[x;&amp;.q.mod[;2]@&amp;-':w;.q.upper]_/|w:&amp;"a"=_x,"a"}"aAaaaaAaaaAAaAa"
""
</code></pre>

<p><strong>Explanation:</strong></p>

<p>Fairly heavy, will look at other answers to see if I can golf this down:</p>

<pre><code>{@[x;&amp;.q.mod[;2]@&amp;-':w;.q.upper]_/|w:&amp;"a"=_x,"a"} / the solution
{                                               } / lambda with implicit input x
                                           x,"a"  / append "a" to input
                                          _       / lowercase
                                      "a"=        / boolean list where input is "a"
                                     &amp;            / indices where true
                                   w:             / save as w
                                  |               / reverse
                                _/                / drop over (remove these indices from...)
 @[ ;                 ;        ]                  / apply [var;indices;function]
                       .q.upper                   / uppercase
                  -':w                            / deltas of w
                 &amp;                                / where, builds list of ascending values
                @                                 / apply
      .q.mod[;2]                                  / mod 2 to generate boolean list
   x                                              / apply uppercase to input x at these locations
</code></pre>

<p><strong>Notes:</strong></p>

<p>Think I may have missed the point. I enabled/disable caps when an <code>a</code> is encountered. Passes the first test cases but not the ones where caps is apparently already enabled...</p>
</div>
<div id="pu24" class="pu"><h1><a href="https://esolangs.org/wiki/Fish" rel="nofollow noreferrer">&gt;&lt;&gt;</a>, <strike>139</strike> 129 bytes</h1>
<pre><code>1vo   &lt;
&gt;&gt;i:&quot;z&quot;)?^:&quot;A&quot;^&gt;~~&gt;~1$-
^o+&lt; &gt;::&quot;aA&quot;@=?^=?^$v
^o-^?  (&quot;^&quot;$*48:v?@:&lt;
^ vv? )&quot;Z&quot;:v?(&lt; &gt;&gt;o
  &gt;  ^v  &lt; &gt;:0 )?^;
  :&lt; ^v?( &quot;a&quot;
</code></pre>
<p>A language with no concept of &quot;characters&quot; is surely the right tool for the job :)</p>
</div>
<div id="pu25" class="pu"><h1>Excel VBA, 115 bytes</h1>

<p>A declared <code>sub</code>routine that takes input, <code>s</code> of expected type <code>variant/string</code> and outputs to the range <code>[A1]</code>.</p>
<pre class="lang-vb prettyprint-override"><code>Sub f(s)
For i=1To Len(s)
c=Mid(s,i,1)
u=UCase(c)
If u=&quot;A&quot;Then d=Not d Else[A1]=[A1]+IIf(d,u,LCase(c))
Next
End Sub
</code></pre>
</div>
<div id="pu26" class="pu"><h1><a href="https://github.com/dloscutoff/pip" rel="nofollow noreferrer">Pip</a>, 22 bytes</h1>

<p>(The <code>SC</code> operator was added because of this challenge.)</p>

<pre><code>{LCaQ'a?xX!:ii?SCaa}Mq
</code></pre>

<p><a href="https://tio.run/##Fcs9DoMwDAbQq3xM3KFLhqwwVB3a1QVLtpBsQ9IfVPXsQWxveaHR2m/IdO0pfR/dRTXdMtF/XFu7C1UIRbAVfIQNVRiZogw@LVh4hxt2f22nn07bjNm5WH@2N4NgXieBGrSmAw" rel="nofollow noreferrer" title="Pip – Try It Online">Try it online!</a></p>

<h3>Explanation</h3>

<pre><code>                        i is 0, x is empty string (implicit)
                     q  Read a line of input
{                  }M   Map this function to its characters:
 LCa                     The character, lowercased
    Q'a                  Is it equal to lowercase a?
       ?                 If so:
          !:i             Logically negate i in place (0 -&gt; 1, 1 -&gt; 0)
        xX                Repeat the empty string that many times (thus, always return
                          empty string when the character is a/A)
                         Else:
             i?           Is i truthy (1)? If so, caps lock is on, so return:
               SCa         The character, swap-cased
                          Else return:
                  a        The character, unchanged
</code></pre>
</div>
<div id="pu27" class="pu"><h1>Haskell, <s>96</s> 94 Bytes</h1>
<p>(Unix Line Endings)</p>
<pre><code>import Data.Char
t=toUpper
i c|c&gt;'Z'=t c|0&lt;1=toLower c
f(x:s)|t x=='A'=f$i&lt;$&gt;s|0&lt;1=x:f s
f x=x
</code></pre>
</div>
<div id="pu28" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 14 bytes</h1>

<pre><code>Œu=”Aœp⁸ŒsJḤ$¦
</code></pre>

<p><a href="https://tio.run/##VVC7UcRADG1FAaGHApghICWmAZ0t2zrW2mUln3EGLRwxGUMNFzNzhXCNGC02Adl@3n9PIczLcj6Ot5eX97vzW7q8ns5Hvf8@fVx9fS7L8tATkDQQWzA/sqixjcZRKhiQxUhQaqoAHYTNwMJqGQugcLp4oCwDiVXAChZBqR4z/YrRs2PJ2X/qu9jMkGJg47oq4JSjUW3Athr4Uztmt@i3NA0fuBkxKEx9hDoOKaq/G0xsKybFiXIxINnHmaVzFii2ZPMqmVGeRg5uOhcCZxC0MWOAzF1vujmXeIFUXUGLXOCWbn6/pp6EvGbBuHmXCQ3ibu/BFdC7Six387WoqdZQFFMg6PFAgKtP6YbBVpl/u23FDR8JBkL1@RSEag@DeYY25i332qoqq2mizFvDHlNya9XrHw" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<p>Full program.</p>

<p>Explanation:</p>

<pre><code>Œu=”Aœp⁸ŒsJḤ$¦ Arguments: x
Œu             Uppercase x
  =”A          ^ Equals 'A' (vectorizes)
     œp⁸       ^ Partition ⁸ [⁸=x]
             ¦ Apply link A, keep results at specific indices B
        Œs     A: Swap case
            $  B: Form a &gt;=2-link monadic chain
          JḤ      Arguments: y
          J       Get list indices ([1, length(list)]) of y
           Ḥ      Double (vectorizes) ^
                  This way, we only "apply" link A to even indices, so every second
                  element, starting from the secondd one.
</code></pre>
</div>
<div id="pu29" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 100 bytes</h1>



<pre class="lang-python prettyprint-override"><code>def f(x):x=x.replace('A','a').split('a');return''.join(i.swapcase()if i in x[1::2]else i for i in x)
</code></pre>

<p><a href="https://tio.run/##lZVvj@I2EMbf76cY7RtAipDavqNCJzaYJXdcjEg4yq1WlTdMwLvBTm2zkH757Th/2Lv2KrW8CMEezzzzzE@mrNxBq1/e3naYQ96/DEaX8WVosCxEhv3epBf0RG8wtGUhXd@//mrQnYzq9YbPWqq@HNqzKDNhsT@QOUiQCi4PP41GPz9iYZEWcm3a5cGbQ@t@98EwBni4Afr00gPCHyeZvcCT0WdF8Rd4Ph1LC/oVDTjaLsSfFez0ftgLmjOhPpayEE5qipdK2gPuwJ6yDK3NT0VRdZG3m4NwcBBlicrC@YCqThiK0i40lXzBCihHpU/Gvz9pYXZUCa3q@WOvCAKUdtnBNyDdh9s2rReNagc6r/NJZZ10J68ngKOQyqESKsMABAWJ3dFrdKYRTGf2vjV1ROUCkBacBovZyWCdDC8Ui3S6y/6kdxWUmiYgs8AHl0Y7zBwJagrQUk4zIRtaNTv5KncnUfiWNWTklvazcHCWrokp9ZnMpQKonnUl1d43aEWOrmpSGqFoKgUVrfwBaUAJGrwowMj9wdm2spdXkOuUwfp0hcxxVG95s7GdIBXfG6RJ6KdnEm5BUK/kK/125BbugkYU6rLAzve6ju9NFK4F4Vvf2sadeEE4orBknwWFHgFhqhq7RnfTVeBdsyUa2XbooaDS1g67oYqJoI9/TCb0ddvB1sFS0MNCNlkmBQ8/dSye55MUotl1HaIEJosVm0y3wOMPvZvHm5tMG@MHNm6hv/0v0H/dwpTfX9U1zKcRj2EWxVEyZ1NI1mHIkmS2Xiy218DNIYX534FvtX1iXhRs@Xrl3@/4t7h/YfD/YY/ilMU16vEUOtBrlXwG9/wLW8WfWZwG3paUQ8LC9YpBOmfAfosSOhsyH@kX7jhZtuSLKI3CwAcvVzxlIblLx/8d80UCmzmHkH9e8oRRMGyidF5nXPINW/n0LP7It1F8D1EMSQ05qU1X/0A8Xa/eAfchXtaCLKaziU@0iGZsBD/EOwV@95HkJvAOdxSzadBIYXy5YDAntGEV3c9T3@APwfZlOaQ11gmZlUDM/JS/h3rG0m3gHUqWbBWlW6/psFxSwSS5onBlpx3/gh5JB0O3eZ7TTZJfEaE5FQYbeG89vNcLnK6EPfYLVP3rPT4YjOokYpy/Lz7Ix0G9Whq6CftiPG75p42A/lACMXj7Cw" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
</div>
<div id="pu30" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a> <code>-p</code>, <s>31</s> <s>30</s> 29 bytes</h1>

<p>-1 byte thanks to <a href="https://codegolf.stackexchange.com/users/9296/nwellnhof">@nwellnhof</a></p>

<p>-1 byte thanks to <a href="https://codegolf.stackexchange.com/users/3324/ikegami">@ikegami</a></p>



<pre class="lang-perl prettyprint-override"><code>#!/usr/bin/perl -p
s/a([^a]*)a?/$1^uc$1^lc$1/egi
</code></pre>

<p><a href="https://tio.run/##Fcs9C8IwEIfxr/IfBF9AQgfnDq7uDtLCNT1MaLk7klTplze2y49neYzTfKs1Ozq9euouZ2rdoekXvzFvOH7HWp@BCgKZsWR8AwtKYNzJ8kP9hIlXqGDVJe09KKURo3KW4759GATR4gOiIJb2p1aiSq5X@wM" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
</div>
<div id="pu31" class="pu"><h1>pwsh, 109 bytes</h1>

<pre><code>$Input|%{$i=$_[0]-ceq'a';$r='';foreach($s in $_.split('a')){$r+=($s.ToUpper(),$s.ToLower())[$i];$i=!$i};$r}
</code></pre>
</div>
<div id="pu32" class="pu"><h1>Java 8, <s>119</s> <s>108</s> 98 bytes</h1>

<pre class="lang-java prettyprint-override"><code>s-&gt;{int f=0,t;for(int c:s)if((t=c&amp;95)==65)f^=1;else System.out.printf(&quot;%c&quot;,f&lt;1|t&lt;66|t&gt;90?c:c^32);}
</code></pre>
<p>-11 bytes thanks to <em>@OlivierGrégoire</em>.<br />
-10 bytes thanks to <em>@Nevay</em>.</p>
<p><strong>Explanation:</strong></p>
<p><a href="https://tio.run/##bVRhT9tADP2@X2FV2pZKpYJNIEEpqOo2DY3BtCKNCYHkXpzmyvUuu3NaMuC3d74knUa1qk2bnP3e87PdOS5xxxVk5@n9WhkMAb6ito@vALRl8hkqgot4C7B0OgWVqBz9zS2E7kCePstH3oGRtYILsDCEddg5eZRsyIa7PR5kzifxTh2Frs6ShIfqzeF@dzg82O9md8O9AZlAMKkC06LvSu4XXsKzpPNadXrZ8d4THx8cPPHJ4e6pOlJ37991B8/rQcNblFMjvC19LXAh8pMJC8bs5ha7jXSmwEnnKif4VWp1D1PvVhYy9wDzclEEcEvywHJs8HcFqZv1O3V5m8yxWxTaCImTLG11yCmFUCpFIWSlMdVW/I8cGXIsxNgAq5xsDT7GIpw7ob@nCgSpcqWPv6cOfSqsFOzbmLYkQLCOVS5NAM2nL8FjGWRTcFmNqm1gzWXU1qurZ7JoFfUAJQjTRdTLvhEvObNYrF2Q5R7oAOwgkCo91WD0ILEk2Rv0qUsrKJzRYnAvBhfeMSkWWQ2BPMpKHy1p1aR6qdMSTSzcgRLnnPRXM6w0NzGFW4ndQiBj5yppVCwzYEZcNZAerfTJCGkVE7QHi1x6NOD1LOfQMkd5RjogCCHCGZ3RUX0ULae2p0I@8yT9cNO5CA@AUqu4K/csblHaa0SRKwxt3K95Ym1ouB2Nf31rC2e8J1gQBrEvgKU4DugrGSzf6m6q6kXXQkFetxXG0RDqELbmBkcor3gZjeRrawg342PkEkCNvk3M5fjLy6DV59EVnH36ewpnExidf/84@vATLi@2Jukarx86/9njepHqkGaRZNmbPbJ9lYQ@u7H8B4y8xyrptoDb@2ts0gI/r/8A" rel="nofollow noreferrer">Try it online.</a></p>
<pre class="lang-java prettyprint-override"><code>s-&gt;{                           // Method with char-array parameter and no return-type
  int f=0,t;                   //  Flag-integer, starting at 0
  for(int c:s)                 //  Loop over the characters of the input as integers
    if((t=c&amp;95)==65)           //   If the current character is an 'A' or 'a':
      f^=1;                    //    Toggle the flag (0→1 or 1→0)
    else                       //   Else:
      System.out.printf(&quot;%c&quot;,  //    Print integer as character
        f&lt;1|                   //     If the flag-integer is 0,
        t&lt;66|t&gt;90?             //     or the current character isn't a letter:
         c                     //      Simply output the character as is
        :                      //     Else (the flag it 1 and it's a letter)
         c^32);}               //      Print it with its case reversed
</code></pre>
</div>
<div id="pu33" class="pu"><h1><a href="https://github.com/PowerShell/PowerShell" rel="noreferrer">PowerShell Core</a>, 105 bytes</h1>



<pre class="lang-powershell prettyprint-override"><code>"$args"|% t*y|%{if($_-in97,65){$c=!$c}else{Write-Host -n($_,("$_"|%("*per","*wer")[$_-in65..90]))[!!$c]}}
</code></pre>

<p><a href="https://tio.run/##K8gvTy0qzkjNydFNzi9K/f9fSSWxKL1YqUZVoUSrska1OjNNQyVeNzPP0lzHzFSzWiXZVlEluTY1pzi1OrwosyRV1yO/uERBNw@oSkdDSSUeqFNDSasgtUhJR0kLaLaSZjRYv5mpnp6lQaymZrQi0IDY2tr/QLucEwuKffKTsxVygESxQrJjQHCOv7O3EgA" rel="noreferrer" title="PowerShell Core – Try It Online">Try it online!</a></p>

<p>What with no real ternary operator and no default alias for printing to screen, it's not that short.</p>

<ul>
<li><code>% t*y</code> expands to <code>| ForEach-Object -Method ToCharArray</code> equiv. of <code>"$args".ToCharArray()</code></li>
<li><code>Write-Host -n</code> is for the parameter <code>-NoNewLine</code></li>
<li><code>"$_"</code> turns the <code>[char]</code> type back to <code>[string]</code> (chars have no upper/lower case in .Net)</li>
<li><code>|% *per</code> does the same method call shortcut as earlier, but for <code>.ToUpper()</code>, same with <code>.ToLower()</code></li>
<li><code>($a,$b)[boolean test]</code> abused as fake-ternary operator</li>
<li><code>!!$c</code> force-casts to <code>[bool]</code> here it starts undefined <code>$null</code> so it gets forced it into existence as "caps lock: $false".</li>
</ul>
</div>
<div id="pu34" class="pu"><h1><a href="https://github.com/tomtheisen/stax" rel="nofollow noreferrer">Stax</a>, 12 <a href="https://github.com/tomtheisen/stax/blob/master/docs/packed.md#packed-stax" rel="nofollow noreferrer">bytes</a></h1>

<pre><code>ìo'½`║â↨╪U?5
</code></pre>

<p><a href="https://staxlang.xyz/#p=8d6f27ab60ba8317d8553f35&amp;i=The+quick+brown+fox+jumps+over+the+lazy+dog.%0ACompilation+finished+successfully.%0AWhat+happens+when+the+CapsLock+key+on+your+keyboard+doesn%27t+have+a+notch+in+it%3F%0AThe+end+of+the+institution,+maintenance,+and+administration+of+government,+is+to+secure+the+existence+of+the+body+politic,+to+protect+it,+and+to+furnish+the+individuals+who+compose+it+with+the+power+of+enjoying+in+safety+and+tranquillity+their+natural+rights,+and+the+blessings+of+life%3A+and+whenever+these+great+objects+are+not+obtained,+the+people+have+a+right+to+alter+the+government,+and+to+take+measures+necessary+for+their+safety,+prosperity+and+happiness.%0AaAaaaaAaaaAAaAa&amp;a=1&amp;m=2" rel="nofollow noreferrer">Run and debug it online</a></p>

<p>It splits on a regex, and then alternately toggles case.  Here's the same program, unpacked, ungolfed, and commented.</p>

<pre><code>"a|A"|s split on regex /a|A/
rE  reverse and explode array to stack
W   repeat forever...
p   print top of stack with no newline
:~p print top of stack, case inverted, with no newline
</code></pre>

<p><a href="https://staxlang.xyz/#c=%22a%7CA%22%7Cs%09split+on+regex+%2Fa%7CA%2F%0ArE%09reverse+and+explode+array+to+stack%0AW%09repeat+forever...%0Ap%09print+top+of+stack+with+no+newline%0A%3A%7Ep%09print+top+of+stack,+case+inverted,+with+no+newline&amp;i=The+quick+brown+fox+jumps+over+the+lazy+dog.%0ACompilation+finished+successfully.%0AWhat+happens+when+the+CapsLock+key+on+your+keyboard+doesn%27t+have+a+notch+in+it%3F%0AThe+end+of+the+institution,+maintenance,+and+administration+of+government,+is+to+secure+the+existence+of+the+body+politic,+to+protect+it,+and+to+furnish+the+individuals+who+compose+it+with+the+power+of+enjoying+in+safety+and+tranquillity+their+natural+rights,+and+the+blessings+of+life%3A+and+whenever+these+great+objects+are+not+obtained,+the+people+have+a+right+to+alter+the+government,+and+to+take+measures+necessary+for+their+safety,+prosperity+and+happiness.%0AaAaaaaAaaaAAaAa&amp;a=1&amp;m=2" rel="nofollow noreferrer">Run this one</a></p>
</div>
<div id="pu35" class="pu"><h1><a href="https://gcc.gnu.org/fortran/" rel="nofollow noreferrer">Fortran (GFortran)</a>, 307 bytes</h1>

<pre><code>CHARACTER(999)F,G
G=' '
READ(*,'(A)')F
N=1
M=1
DO I=1,999
IF(F(I:I)=='a'.OR.F(I:I)=='A')THEN
M=-M
ELSEIF(M==1)THEN
G(N:N)=F(I:I)
N=N+1
ELSE
J=IACHAR(F(I:I))
SELECTCASE(J)
CASE(65:90)
G(N:N)=ACHAR(J+32)
CASE(97:122)
G(N:N)=ACHAR(J-32)
CASE DEFAULT
G(N:N)=F(I:I)
ENDSELECT
N=N+1
ENDIF
ENDDO
PRINT*,TRIM(G)
END
</code></pre>

<p><a href="https://tio.run/##XY7BjoMgEIbv8xTegFabxaa7wYQDkcFiFDfIPoCHtrc2afr@LpW6yfbAwMz/zc9/vt0f9@laXM7pMc/1UXlVB/RUCMFM3kAjSUbAo9J0kxOqGGEGnOTQx6OHzEqeRxasoYbayjIpyUR2g9/9tYqwcEQXN4oesBsxsr2UPE0b6irHZKKjs9vyBYJWWvXM8/JlMGKHdajViLRlsNyfh0p8sNUj4e12X75k8VXxsnzXi1XPNBr104W3DOh0@mpN47Q1z6oH@PbWhU0evO1ps6Dz/DiNYfpffgE" rel="nofollow noreferrer" title="Fortran (GFortran) – Try It Online">Try it online!</a></p>

<p>Since Fortran has not "advanced" tools for dealing with strings, I came up with this little monster.</p>

<p>Indented and commented:</p>

<pre><code>CHARACTER(999)F,G&#9;!Define input and output strings (up to 999 characters)
G=' '&#9;&#9;&#9;!Fill output with spaces
READ(*,'(A)')F&#9;&#9;!Take input
N=1&#9;&#9;&#9;!Represent the position to be written in output string
M=1&#9;&#9;&#9;!M=-1: Change case; M=1: Do not change case
DO I=1,999
&#9;IF(F(I:I)=='a'.OR.F(I:I)=='A')THEN&#9;!If the character is A...
&#9;&#9;M=-M&#9;&#9;&#9;&#9;!Ah-ha - you pressed cPS-LOCK!
&#9;ELSEIF(M==1)THEN&#9;&#9;&#9;!Case the character is not A, and do not need to change case...
&#9;&#9;G(N:N)=F(I:I)&#9;&#9;&#9;!...only copy the character
&#9;&#9;N=N+1
&#9;ELSE !Otherwise...
&#9;&#9;J=IACHAR(F(I:I))&#9;&#9;&#9;!...get ascii of current character
&#9;&#9;SELECTCASE(J)
&#9;&#9;&#9;CASE(65:90)&#9;&#9;&#9;!If is upper case,
&#9;&#9;&#9;&#9;G(N:N)=ACHAR(J+32)&#9;!now is lower case
&#9;&#9;&#9;CASE(97:122)&#9;&#9;&#9;!If is lower case,
&#9;&#9;&#9;&#9;G(N:N)=ACHAR(J-32)&#9;!now is upper case
&#9;&#9;&#9;CASE DEFAULT&#9;&#9;&#9;!If do not belong to alphabet,
&#9;&#9;&#9;&#9;G(N:N)=F(I:I)&#9;&#9;!simply copy the character
&#9;&#9;ENDSELECT
&#9;&#9;N=N+1
&#9;ENDIF
ENDDO
PRINT*,TRIM(G) !Trim out trailing spaces
END !That's all folks!
</code></pre>
</div>
<div id="pu36" class="pu"><h1><a href="https://github.com/Phlarx/chip" rel="nofollow noreferrer">Chip</a>, 64 bytes</h1>
<pre><code>,Ava
&gt;B#
&gt;C#.,Bb
&gt;D##&gt;Cc
&gt;E##&gt;Dd
`~+L^Ee
G~+)~vS
g,\-zm.
f{-F`~'
</code></pre>
<p><a href="https://tio.run/##Fcu7DoIwFIDh/TzFSToQw@URauSiC5uDizGUcrQNsW2gYtCkr15l@r/ll0q7GLPDIoCXDHjFiqzsgdeM8UoCb/6tB@hC2t4aglNId2E5wyO75p9nAfdvfuxCEuNFCY9KOEdmxrcig14RVsLNrZUjjrSiNbja17S5t2IacLA0m2TbFkKBxnqpUBvUfv8D" rel="nofollow noreferrer" title="Chip – Try It Online">Try it online!</a></p>
<h3>How it works</h3>
<p><em>This is where I wish I could color-code the source. However, all of the below are full programs, and may be run on their own.</em></p>
<p>First things first, write a (slightly mangled) cat program.</p>
<pre><code> A-a

     Bb
     Cc
     Dd
     Ee
G
g
f--F
</code></pre>
<p>Now invert capitalization of all characters <code>A-Za-z</code>.</p>
<p>This is determined by:</p>
<ol>
<li><code>c &amp; 0x1F != 0</code>
<ul>
<li>Filter out anything whose low 5 bits are zero</li>
<li>This is done by the left most column and upper <code>~</code></li>
</ul>
</li>
<li><code>((c &amp; 0x1F) + 0x5) &amp; ~0x1F == 0</code>
<ul>
<li>Filter out anything, that when added to 5, carries into or beyond the 6th bit</li>
<li>This is done by the two <code>#</code> columns</li>
</ul>
</li>
<li><code>c &amp; 0x40 != 0</code>
<ul>
<li>Filter out anything that is less than 64</li>
<li>This is done by the lower <code>~</code></li>
</ul>
</li>
</ol>
<p>The program assumes it will receive no characters above 127.</p>
<p>The results are aggregated and, the inversion is done by the <code>{</code> at the bottom.</p>
<pre><code>,Ava
&gt;B#
&gt;C#. Bb
&gt;D## Cc
&gt;E## Dd
`~+' Ee
G~&lt;
g,\*
f{-F
</code></pre>
<p>But attach that to a toggle (T flip-flop) that is initially off. Now, the toggle decides whether to invert the capitalization, and the filter from above decides which characters to apply it to. Put a <code>*</code> above the <code>m</code> to toggle on every cycle.</p>
<pre><code>,Ava
&gt;B#
&gt;C#. Bb
&gt;D## Cc
&gt;E## Dd
`~+' Ee
G~&lt;
g,\-zm.
f{-F`~'
</code></pre>
<p>Toggle the toggle when we see an <code>Aa</code>, and suppress that character too. We have an <code>Aa</code> if the filter above says we have <code>A-Za-z</code>, and the low five bits equal one (<code>c &amp; 0x1F == 1</code>).</p>
<pre><code>,Ava
&gt;B#
&gt;C#.,Bb
&gt;D##&gt;Cc
&gt;E##&gt;Dd
`~+L^Ee
G~+)~vS
g,\-zm.
f{-F`~'
</code></pre>
</div>
<div id="pu37" class="pu"><h1><a href="http://php.net" rel="nofollow noreferrer">PHP</a> <s>101</s> 99 bytes</h1>

<pre><code>for($s=$argn;$i&lt;strlen($s);$i++)lcfirst($s[$i])==a?$s=strtolower($s)^strtoupper($s)^$s:print$s[$i];
</code></pre>

<p>Run like this:</p>

<pre><code>echo '[the input]' | php -nR '[the code]'
</code></pre>

<p>Ungolfed:</p>

<pre><code>for ($s = $argn; $i &lt; strlen($s); $i++) {
    if (lcfirst($s[$i]) == 'a') {
        $s = strtolower($s) ^ strtoupper($s) ^ $s; // Flip the whole string's case.
    } else {
        print $s[$i]; // Print the current letter.
    }
}
</code></pre>

<p>This just loops through the string with a for loop, and on each iteration it checks if the current letter is <code>a</code>, if so, then flip the case of the whole string (method from <a href="https://stackoverflow.com/a/6612519/3088508">here</a>), and if not, then print the current letter.</p>
</div>
<div id="pu38" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="noreferrer">Ruby</a>, <s>42</s> 41 bytes</h1>



<pre class="lang-ruby prettyprint-override"><code>-&gt;s{s.sub!(/a(.*)/i){$1.swapcase}?redo:s}
</code></pre>

<p><a href="https://tio.run/##jVJNb5tAFLz7V0xRrdqVQ9RrJMei2K5RUBwFu5FrcVjDUjYhu5QHcWiS3@4@qLHanrqHtx8zb2Z2tUW1qw/J@HB2SS9kU7V7NzgXA/vj8FwNX95/smkv8kiQfJsUMjYX9HbY9oCttUolflQqesCuMHuNxDzjvnrMCeZJFigZzsTPGrH5blsj/Bf/2wbT5RfbCkethWsec5WJUhmmK60olTGoiiJJlFRZVrPwkbTylteYe9desJhNEaxddxYE87Xvb05qd6kokYo8l5qwT6VuPV2Rk2841YOswT61qYpmvTOiiDm8JP2haXuSENCmjFIoDVVO2PouXWHxr95NkC3dK1zNNuBIm@X6tll/Xv6p9nWGv7WOEYUjeDTFcXhii9NTdDEzLoTI@W3T3P9o6HMJOvuubb9wVvDmJz68AI5/O3OmTbrmDvtFCZWcYjOeFfKIhr3QloJTxgavSudVOYJ8zmVUyviV9aPMaIkxWsiOUlGQfW@UZqiQVGUlY8m2RUM@44lgDfo0RJ9wdsnVQh/bThLjcdc3gZULYvgCViJUxh@oNbOVpoY8OhK7fdiTOj78Ag" rel="noreferrer" title="Ruby – Try It Online">Try it online!</a></p>

<p>A lambda accepting a string, mutating the string in place, and returning it. The trick here is that <code>sub</code> returns the string (a truthy value) if a substitution was made, and returns <code>nil</code> otherwise. The existence of <code>swapcase</code> is pretty handy, too.</p>

<p>-1 byte: Replace boolean logic with ternary operator, thanks to <a href="https://codegolf.stackexchange.com/users/77598/asone-tuhid">Asone Tuhid</a></p>



<pre class="lang-ruby prettyprint-override"><code>-&gt;s{
  s.sub!(/a(.*)/i){     # Replace "a" followed by anything with
    $1.swapcase         #   the case-swapped capture group
  } ? redo              # If a match was found, restart the block
    : s                 # Otherwise, return the modified string
}
</code></pre>
</div>
<div id="pu39" class="pu"><h1><a href="https://en.wikibooks.org/wiki/6502_Assembly" rel="noreferrer">6502 machine code</a> routine (C64), 51 bytes</h1>
<pre><code>A0 00 84 FE B1 FC F0 2A C9 41 F0 06 90 1A C9 C1 D0 08 A9 80 45 FE 85 FE B0 11
B0 06 C9 5B B0 08 90 04 C9 DB B0 02 45 FE 20 16 E7 C8 D0 D6 E6 FD D0 D2 60
</code></pre>
<p>Expects a pointer to a 0-terminated input string in <code>$fc/$fd</code>, outputs to the screen.</p>
<h3>Commented disassembly</h3>
<pre><code> .caps:
A0 00       LDY #$00
84 FE       STY $FE             ; init capslock state
 .loop:
B1 FC       LDA ($FC),Y         ; next char from string
F0 2A       BEQ .done           ; NUL -&gt; we're done
C9 41       CMP #$41            ; compare to 'a'
F0 06       BEQ .isa            ; if equal, toggle capslock
90 1A       BCC .out            ; if smaller, direct output
C9 C1       CMP #$C1            ; compare to 'A'
D0 08       BNE .ctog           ; if not equal, check for letter
 .isa:
A9 80       LDA #$80            ; toggle bit 7 in caps lock state
45 FE       EOR $FE
85 FE       STA $FE
B0 11       BCS .next           ; and go on
 .ctog:
B0 06       BCS .cZ             ; if char larger 'A', check for 'Z'
C9 5B       CMP #$5B            ; compare with 'z'+1
B0 08       BCS .out            ; larger or equal -&gt; direct output
90 04       BCC .tog            ; smaller -&gt; apply capslock
 .cZ:
C9 DB       CMP #$DB            ; compare with 'Z'+1
B0 02       BCS .out            ; larger or equal -&gt; direct output
 .tog:
45 FE       EOR $FE             ; toggle bit from capslock state
 .out:
20 16 E7    JSR $E716           ; output char
 .next:
C8          INY                 ; and loop to next char
D0 D6       BNE .loop
E6 FD       INC $FD
D0 D2       BNE .loop
.done:
60          RTS
</code></pre>
<hr />
<h3>Example assembler program using the routine:</h3>
<p><strong><a href="https://vice.janicek.co/c64/#%7B%22controlPort2%22:%22joystick%22,%22primaryControlPort%22:2,%22keys%22:%7B%22SPACE%22:%22%22,%22RETURN%22:%22%22,%22F1%22:%22%22,%22F3%22:%22%22,%22F5%22:%22%22,%22F7%22:%22%22%7D,%22files%22:%7B%22caps.prg%22:%22data:;base64,AQgLCOIHnjIwNjEAAACpF40Y0KnYoAggHqup4YX8qQiF/SArCKkIhf1MpQigAITMhP6l/YUCIELx8PuF+yl/ySCwEskN8A7JFNDrpf7QBqUCxf3w4abP8Ap4pNOx0Sl/kdFYpfsgFuemz/AMeKTTsdEJgJHRWKX7yRTwH6T+kfzJDfAJyIT+0K3m/dCpqQCk/sjQAub9kfzmzGCk/tACxv2IhP6wkKAAhP6x/PAqyUHwBpAaycHQCKmARf6F/rARsAbJW7AIkATJ27ACRf4gFufI0Nbm/dDSYA1JTlBVVD4gAA==%22%7D,%22vice%22:%7B%22-autostart%22:%22caps.prg%22%7D%7D" rel="noreferrer">Online demo</a></strong></p>
<p><a href="https://i.stack.imgur.com/fhfI6.png" rel="noreferrer"><img src="https://i.stack.imgur.com/fhfI6.png" alt="screenshot" /></a></p>
<p><strong>Code in <a href="http://cc65.github.io/doc/ca65.html" rel="noreferrer">ca65</a> syntax:</strong></p>
<pre><code>.import caps ; link with routine above

.segment &quot;BHDR&quot; ; BASIC header
                .word   $0801           ; load address
                .word   $080b           ; pointer next BASIC line
                .word   2018            ; line number
                .byte   $9e             ; BASIC token &quot;SYS&quot;
                .byte   &quot;2061&quot;,$0,$0,$0 ; 2061 ($080d) and terminating 0 bytes

.bss
string:         .res    $800

.data
prompt:         .byte   $d, &quot;input&gt; &quot;, $0

.code
                lda     #$17            ; set upper/lower mode
                sta     $d018

                lda     #&lt;prompt        ; display prompt
                ldy     #&gt;prompt
                jsr     $ab1e

                lda     #&lt;string        ; read string into buffer
                sta     $fc
                lda     #&gt;string
                sta     $fd
                jsr     readline

                lda     #&gt;string        ; call our caps routine on buffer
                sta     $fd
                jmp     caps

; read a line of input from keyboard, terminate it with 0
; expects pointer to input buffer in $fc/$fd
; NO protection agains buffer overflows !!!
.proc readline
                ldy     #$0
                sty     $cc             ; enable cursor blinking
                sty     $fe             ; temporary for loop variable
                lda     $fd
                sta     $2              ; initial page of string buffer
getkey:         jsr     $f142           ; get character from keyboard
                beq     getkey
                sta     $fb             ; save to temporary
                and     #$7f
                cmp     #$20            ; check for control character
                bcs     prepout         ; no -&gt; to normal flow
                cmp     #$d             ; was it enter/return?
                beq     prepout         ; -&gt; normal flow
                cmp     #$14            ; was it backspace/delete?
                bne     getkey          ; if not, get next char
                lda     $fe             ; check current index
                bne     prepout         ; not zero -&gt; ok
                lda     $2              ; otherwise check if we're in the
                cmp     $fd             ;    first page of the buffer
                beq     getkey          ; if yes, can't use backspace
prepout:        ldx     $cf             ; check cursor phase
                beq     output          ; invisible -&gt; to output
                sei                     ; no interrupts
                ldy     $d3             ; get current screen column
                lda     ($d1),y         ; and clear 
                and     #$7f            ;   cursor in
                sta     ($d1),y         ;   current row
                cli                     ; enable interrupts
output:         lda     $fb             ; load character
                jsr     $e716           ;   and output
                ldx     $cf             ; check cursor phase
                beq     store           ; invisible -&gt; to store
                sei                     ; no interrupts
                ldy     $d3             ; get current screen column
                lda     ($d1),y         ; and show
                ora     #$80            ;   cursor in
                sta     ($d1),y         ;   current row
                cli                     ; enable interrupts
                lda     $fb             ; load character
store:          cmp     #$14            ; was it backspace/delete?
                beq     backspace       ; to backspace handling code
                ldy     $fe             ; load buffer index
                sta     ($fc),y         ; store character in buffer
                cmp     #$d             ; was it enter/return?
                beq     done            ; then we're done.
                iny                     ; advance buffer index
                sty     $fe
                bne     getkey          ; not zero -&gt; ok
                inc     $fd             ; otherwise advance buffer page
                bne     getkey
done:           lda     #$0             ; terminate string in buffer with zero
                ldy     $fe             ; get buffer index
                iny
                bne     termidxok       ; and advance ...
                inc     $fd
termidxok:      sta     ($fc),y         ; store terminator in buffer
                inc     $cc             ; disable cursor blinking
                rts                     ; return
backspace:      ldy     $fe             ; load buffer index
                bne     bsidxok         ; if zero
                dec     $fd             ;   decrement current page
bsidxok:        dey                     ; decrement buffer index
                sty     $fe
                bcs     getkey          ; and get next key
.endproc        
</code></pre>
</div>
<div id="pu40" class="pu"><h1><a href="http://www.snobol4.org/csnobol4/" rel="nofollow noreferrer">SNOBOL4 (CSNOBOL4)</a>, <s>141</s> 92 bytes</h1>

<pre><code>&#9;I =INPUT
S&#9;I ANY("Aa") REM . R =REPLACE(R,&amp;LCASE &amp;UCASE,&amp;UCASE &amp;LCASE) :S(S)
&#9;OUTPUT =I
END
</code></pre>

<p><a href="https://tio.run/##JYxBC4IwAEbP@is@PJiCdOoUSIjtIJjJpkTHqYOJsYlbhb9@KZ3e44PvGaU7/To55xVIi6puG59tmlXPKMh4EIOSG46gSCmpyywnEU3CMs8YQdjuSP7Af4xxZhGLfe/eNltrS/qkujr3kNxC8nkWyuArhYKVAjmfTan7CZNYoRVW/V527zRfBgxaGHXYbx8BDqVtLzEqjPbyAw" rel="nofollow noreferrer" title="SNOBOL4 (CSNOBOL4) – Try It Online">Try it online!</a></p>

<p>Assumes a single line of input.</p>

<p>A whopping 49 bytes saved by <a href="https://codegolf.stackexchange.com/users/267/ninjalj">@ninjalj</a>!</p>

<p>Line <code>S</code> does all the work, explained below:</p>

<p><pre><code>I                    # in the subject string I match the following PATTERN:
 ANY("Aa")           # match A or a and
 REM . R             # match the remainder of I, assigning this to R
 =REPLACE(           # replace the PATTERN above with
          R, ...)    # R with swapped cases.
   :S(S)             # and if there was a match, goto S, else goto next line </pre></code></p>
</div>
<div id="pu41" class="pu"><h2>PHP 4, <strike>77 76</strike> 75</h2>
<pre><code>foreach(spliti(a,$argn)as$b)echo$a++&amp;1?strtoupper($b)^strtolower($b)^$b:$b;
</code></pre>
<p>Split into substrings by <code>A</code> (case insensitive) then toogle every second case.</p>
<p><a href="http://sandbox.onlinephpfunctions.com/code/206f5b4a49de3f1343b2b10f0a07614a79caa3b1" rel="nofollow noreferrer">Try it out here</a>.</p>
<hr />
<p>Old version</p>
<pre><code>for(;a&amp;$c=$argn[$i++];)trim($c,aA)?print($c^chr($f*ctype_alpha($c))):$f^=32;
</code></pre>
<p>walks over the string and toogles a flag if the current char is <code>a</code> or <code>A</code> else the char gets toogled depending on the flag and echoed.</p>
</div>
<div id="pu42" class="pu"><h1><a href="http://www.yabasic.de" rel="nofollow noreferrer">Yabasic</a>, 121 bytes</h1>



<p>An anonymous function that takes input as a line of text from STDIN and outputs to STDOUT.</p>

<pre class="lang-vb prettyprint-override"><code>Line Input""s$
For i=1To Len(s$)
c$=Mid$(s$,i,1)
u$=Upper$(c$)
If u$="A"Then
d=!d
ElsIf d Then?u$;Else?Lower$(c$);Fi
Next
</code></pre>

<p><a href="https://tio.run/##VVHNbtswDL77KbjAhxYwCvS6Iih2aIECWU/tAzAWHbOVKU2kk/rpM6r2DrtJ1MfvTwseUbm/Xg8sBC@SZ9vttG2eUwHe378lOJDcaHvb9O3@N4fWzx1397fN3O7fc6bS3vT@@jKAD3a/dm8jSRP2P0LzFNWnAerkcW4f/E6Ph3TZVh6euXmlL7teHQAkAdIA5kcWNbbZOEkHE7IYCUpPHaCDMEwsrFawAurOKZ2pyERiHbCCJVDq50LfZPTlWPLtf@zHFBbIKbJx31VwLsmoN2BbBXw0zMUlxs1N4DOHGaPCZUzQpykn9bnBhW3F5BqqCpB8pIXl5FugOJAtK2VB@TNzdNGlLnABQZsLRih8Gk035WovkqozaKWLPNDP76eLd0ges2Jc/FQIDdLxw40roGeVVO/mbVHoVlOUciQY8UyAq07NhtFWmv9624IbfhJMhOr1KQj1bgbLAkMqm@81VVdbU/983hKOmLNLq979BQ" rel="nofollow noreferrer" title="Yabasic – Try It Online">Try it online!</a></p>
</div>
<div id="pu43" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 70 bytes</h1>

<pre><code>#//.{x___,"a"|"A",y___}:&gt;Join[{x},ToUpperCase@#+ToLowerCase@#-#&amp;@{y}]&amp;
</code></pre>

<p><a href="https://tio.run/##NY69DoIwFEZf5aYkOIi6G38wbMbBQeNAGnLFmjaEe0lbBYI8e8XB7TvDd3Jq9FrV6E2J4fmibYhWq@XQFUWRCBQfcRBJP8G43h3ZUD50Y3Lha9Mom6FTaTS/8InbPy2iOB36UcbhbA35XAjY7GDy5plGi6VX1uXiptGDxklCDlqtCKYGyLBxJy4rqFQPTNDzy/72ndE@4MHK0ex3eytAIPalBkNg/F5IKcMX" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>

<p>Takes input and output as a list of characters. For convenience I've added code in the footer to convert this from and back to a string.</p>

<h1>How it works</h1>

<p>The <code>#//.{x___,"a"|"A",y___}:&gt;Join[{x},</code>...<code>{y}]&amp;</code> part is standard: we find the first <code>A</code> (uppercase or lowercase), reverse case of that comes after the <code>A</code>, and repeat until there are no more <code>A</code>'s to be found.</p>

<p>The interesting part is how we reverse case: the function <code>ToUpperCase@# + ToLowerCase@# - #&amp;</code>. We add together the upper-cased version of the input and the lower-cased version of the input, then subtract the actual input. For example, given the list <code>{"I","n","P","u","T"}</code> this computes</p>

<pre><code>{"I","N","P","U","T"}+{"i","n","p","u","t"}-{"I","n","P","u","T"}
</code></pre>

<p>which threads over lists as</p>

<pre><code>{"I"+"i"-"I","N"+"n"-"n","P"+"p"-"P","U"+"u"-"u","T"+"t"-"T"}
</code></pre>

<p>and although Mathematica doesn't have any particular way of adding two strings, it's smart enough to simplify <code>a+b-a</code> to <code>b</code> for any values of <code>a</code> and <code>b</code>, including string values, so this simplifies to <code>{"i","N","p","U","t"}</code>.</p>
</div>
<div id="pu44" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 92 bytes</h1>



<pre class="lang-r prettyprint-override"><code>cat(`[&lt;-`(v&lt;-el(strsplit(scan(,""),"a|A")),w&lt;-c(F,T),chartr("a-zA-Z","A-Za-z",v)[w]),sep="")
</code></pre>

<p>Thank @Giuseppe for fixing the answer.</p>

<p><strong>Explanation</strong></p>

<pre class="lang-r prettyprint-override"><code># Write
cat(
  # Replace and return, this is the function that powers
  # the R store at index operations, a[i]&lt;-b
  `[&lt;-`(
    # First arg - what to replace = extract first list element
    # of a string input after splitting at a or A
    v&lt;-el(strsplit(scan(,""),"a|A")),
    # Second arg - index to replace = abuse vector recycling
    # to create infinite F, T, F, T, F, etc series
    w&lt;-c(F,T),
    # Third arg - replacement values = replace with case toggled letters
    chartr("a-zA-Z","A-Za-z",v)[w]),
  # Write without separation
  sep="")
</code></pre>

<p><a href="https://tio.run/##VVJLbtwwDL0KoZUNyD1AMVlk0xNk1aBAODI9ZipLqkjbddC7T6l4uuhG0Od9CdV75GvFenQL6ZxH6e8BtXt7vQxv3XYZKHaiVUpk7SRg6rxzvXf459n1vd8vQ@i@@Zfehxmr1s7h8PE8fHfe2Wp757f@df/Re6HyZMy7e5kJKI2QJ1DbchJlXZVz8rAgJ6WEKZAHNBCOCye2ANgAjXPLG9W0UFIPLKAZhMJa6VOMfhuWjP1P/ZrHA0q28Bx8A5ealYIC62lgV9NazWJ@pBl543HFKLDPGUJeSha7V9hZT0zJO9VmQOk9H5xuxgLBifQ4JSumXytHMz0agSsk1LVihMq3WeXh3OJFEjEFaXKRJ/r6@bTPlMhqNoyZ3yqhQr6@W3ABtK4pt7PatGj0ZyjKJRLMuBHg6dO6YdRT5r@5PYor/iRYCMXGJ5AoWBj7CDDl@sh9tvJtalKo8qPhjKWYtcgXd/8L" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>
</div>
<div id="pu45" class="pu"><h1><a href="https://www.dyalog.com/" rel="nofollow noreferrer">APL (Dyalog Classic)</a>, <s>46</s> <s>41</s> 40 bytes</h1>

<pre class="lang-apl prettyprint-override"><code>'aA'~⍨⊢819⌶⍨¨2|(⊢≠819⌶¨)+≠\∘(∨⌿'aA'∘.=⊢)
</code></pre>
<p><a href="https://tio.run/##rYy9TgJBEMd7nmK6hRhIsMLCGGJCZUlCQzPcrezJsbPe3odHjKVBg8aGhNJY3RPYkvAo8yLnHBa8AN3/84cu7oYlxjTvBjF6HwV1rXCoXvij4vefQf@KN7@iD9Xlc1sCfvv@zw5V50LMlNe7Nq8r3uybm7jetcw69Yhfv84BavHnVlAjUGOj4TGLggXMEios3NMTPGRL54FynUAqdYyrEkKa99TpNjGYgkHntPVQGG2Py1t0/o6EtdAlkIWSsqTRM8IkFIT2Vqnml2tAsJQGBiILUXqj6j8" rel="nofollow noreferrer" title="APL (Dyalog Classic) – Try It Online">Try it online!</a></p>
<h2>How??</h2>
<ul>
<li><code>'aA'~⍨</code> - Remove all <code>a</code>'s from ...</li>
<li><code>⊢819⌶⍨¨2|(⊢≠819⌶¨)</code> - ... the alternating upper-and-lower-case of the argument ...</li>
<li><code>+≠\∘</code> ... based upon ...</li>
<li><code>(∨⌿'aA'∘.=⊢)</code> ... the position of <code>a</code> and/or <code>A</code>.</li>
</ul>
</div>
<div id="pu46" class="pu"><h1><a href="https://github.com/ETHproductions/japt" rel="nofollow noreferrer">Japt</a> v2.0a0, 16 bytes</h1>
<pre><code>e/a.*/i_År\l_c^H
</code></pre>
<p><a href="https://ethproductions.github.io/japt/?v=2.0a0&amp;code=ZS9hLiovaV/FclxsX2NeSA==&amp;input=IldoYXQgaGFwcGVucyB3aGVuIHRoZSBDYXBzTG9jayBrZXkgb24geW91ciBrZXlib2FyZCBkb2Vzbid0IGhhdmUgYSBub3RjaCBpbiBpdD8i" rel="nofollow noreferrer">Try it</a></p>
<hr />
<h2>Explanation</h2>
<pre><code>e                   :Recursively replace
 /a.*/i             :RegEx /a.*/gi
       _            :Pass each match through a function
        Å           :  Slice off the first character
         r          :  Replace
          \l        :  RegEx /[A-Za-z]/g
            _       :  Pass each match though a function
             c^     :    Bitwise XOR the character code
               H    :    With 32
</code></pre>
</div>
<div id="pu47" class="pu"><h1><a href="https://github.com/m-ender/retina/wiki/The-Language" rel="noreferrer">Retina</a>, <s>33</s> <s>21</s> 17 bytes</h1>
<pre><code>i(Tv`lL`Ll`a.*
a

</code></pre>
<p><a href="https://tio.run/##TVK9jtswDN79FFyKOxRGgK5diuDWjAfcGsambSayqIpUcr6XTynbB9SDLUvk90dlMo746/nj9dw8@fX9fg6n8ymc8fCzweb5fJ8I/hbubnDJ8ogwyCdcy5wU5E4ZzI8Dfi3Qy3ho3mROHNBYvJAj60Q9aOk6Uh1KCMuh@ZjQYMKUKCo8JoorxBsmPYmT3GgBb16k5Lq@CObesUnjS227EyBEsW4CjsD2p6n6KPYgwwrEUY2tVAUtzMjRKGLsqAX0IuznqsryJtF7xuoizhStBVYwAaWuZFrB6NNrybu/0S/SL5AksHHX1uKUxagzV7IR@NZQcjW@q@n5zn3BUL0KdJ6PqO8bPNi2miQPz9EJKF5l4ThWZ4oD2bJBZow@gOCkS23gDBGtZAyQeZxMd@YqL3jOjqAVLvBAv9ejmjLtw3LyMZOPQC5XF66A7tUD9X/ztKhvN1EkKdB34CtP9YbB9pn/n9tu3PBGMBOqx6cQqQ4d8@I3Ju@6N1dtTU0TZd4d1tvg1KqHBo/oT30dj/75Bw" rel="noreferrer"><strong>Try it online</strong></a></p>
<p><strong>Explanation:</strong></p>
<pre><code>i(              i is for case-insensitive, the paren makes it modify both stages
  Tv`           Transliteration, with simple overlaps (v) - 1 match at every start pos
     lL`Ll`     Replace lowercase with uppercase, and vice versa
           a.*  Every 'a' will match, overlapping to the end of the string
                This swaps the case on all letters after each 'a'
a               Replace all 'a's with nothing

</code></pre>
<p><em>-12 bytes thanks to Martin</em><br />
<em>-4 bytes thanks to Leo</em></p>
</div>
<div id="pu48" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <strike>114</strike>, <strike>101</strike>, 97 bytes</h1>

<pre><code>import re
print(''.join(i.swapcase()if j%2else i for j,i in enumerate(re.split('a|A',input()))))
</code></pre>

<p>Split on all a's and toggle the case on the odd parts</p>

<p>Thanks @ElPedro !</p>
</div>
<div id="pu49" class="pu"><h1>Python, 63 bytes</h1>

<pre><code>f=lambda s:s and[s[0]+f(s[1:]),f(s[1:]).swapcase()][s[0]in"aA"]
</code></pre>

<p>Another Python solution, works in Python 2 and 3.
Takes a very long time for all but small inputs.</p>
</div>
<div id="pu50" class="pu"><h1>Rust, 330 bytes</h1>
<pre><code>fn main(){let mut i=String::new();std::io::stdin().read_line(&amp;mut i);let mut o=vec![];let mut c=false;for l in i.trim().as_bytes(){if*l==65||*l==97{c=!c;}else if c{if l.is_ascii_uppercase(){o.push((*l).to_ascii_lowercase());}else{o.push((*l).to_ascii_uppercase());}}else{o.push(*l);}}println!(&quot;{}&quot;,String::from_utf8(o).unwrap());}
</code></pre>
<p>Ungolfed</p>
<pre><code>fn main() {
    let mut input = String::new();
    std::io::stdin().read_line(&amp;mut input);
    let mut output_chars = vec![];
    let mut capslock = false;
    for letter in input.trim().as_bytes() {
        if *letter == 65 || *letter == 97 {
            capslock = !capslock;
        } else if capslock {
            if letter.is_ascii_uppercase() {
                output_chars.push((*letter).to_ascii_lowercase());
            } else {
                output_chars.push((*letter).to_ascii_uppercase());
            }
        } else {
            output_chars.push(*letter);
        }
    }
    println!(&quot;{}&quot;, String::from_utf8(output_chars).unwrap());
}
</code></pre>
<p>Since this uses bytes instead of chars in the loop, 65 and 97 are the byte values for 'A' and 'a'.</p>
<p>I'm new to Rust, so this might be golfable further.</p>
</div>
<div id="pu51" class="pu"><h1>Python 2, <strike>103</strike>, 97 bytes</h1>
<pre><code>import re
def f(s):print&quot;&quot;.join(j.swapcase()if i%2else j for i,j in enumerate(re.split('a|A',s)))
</code></pre>
</div>
<div id="pu52" class="pu"><h1><a href="https://autohotkey.com" rel="noreferrer">AutoHotKey</a>, 7 bytes</h1>

<pre><code>a::vk14
</code></pre>

<p>// Is this valid? This really do what OP want -- replace <kbd>a</kbd> by <kbd>CapsLock (vk14)</kbd>.</p>

<p>Run this program, and type the input from keyboard..</p>
</div>
<div id="pu53" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="noreferrer">Husk</a>, 11 bytes</h1>

<pre><code>Γ·§?m\:€"Aa
</code></pre>

<p><a href="https://tio.run/##yygtzv7//9zkQ9sPLbfPjbF61LRGyTHx////SuUejiEKnm4KyY4BwTn@zt4KnsEKjj5Bro4ukQr@fvZKAA" rel="noreferrer" title="Husk – Try It Online">Try it online!</a></p>

<h2>Explanation</h2>

<p>I'm using the somewhat obscure overloading of <code>Γ</code> called <code>listNF</code>, which constructs recursive functions that operate on lists.
It corresponds to the following Haskell pattern:</p>

<pre><code>listNF f = g
  where g (x : xs) = f g x xs
        g [] = []
</code></pre>

<p>The idea is that <code>listNF</code> takes a helper function <code>f</code> and returns a new function <code>g</code>, which takes a list.
The function <code>f</code> takes a function, which will always be <code>g</code>, and the head <code>x</code> and tail <code>xs</code> of the list, and does something with them.
In our application, <code>f</code> calls <code>g</code> recursively on <code>xs</code>.
The program is interpreted like this:</p>

<pre><code>Γ (· (§ (?m\) : (€"Aa")))
Γ (                     )  Create a function g that takes a list (x:xs) and applies a function on x and xs.
   · (                 )   Compose g with second argument of function in parentheses.
                           Instead of x and xs, the function is called on x and the result of a recursive call of g on xs.
                (€"Aa")    Check if x is 'A' or 'a'.
        (?m\)              If it is, then swap the case of every char in g(xs).
      §       :            Otherwise, prepend x to g(xs).
</code></pre>
</div>
<div id="pu54" class="pu"><h1><a href="https://sourceforge.net/p/cjam" rel="nofollow noreferrer">CJam</a>, 31 bytes</h1>

<pre><code>q{_eu'A={;T!:T;}{_el_eu+|T=}?}%
</code></pre>

<p><strong>Explanation</strong></p>

<p>Loops through searching for a and non-a</p>

<p><a href="https://tio.run/##S85KzP3/v7A6PrVU3dG22jpE0SrEuhbIzQGKaNeE2Nba16r@/1/u4Rii4OmmkOwYEJzj7@yt4Bms4OgT5OroEqng72cPAA" rel="nofollow noreferrer" title="CJam – Try It Online">Try it online!</a></p>

<hr/>

<h1><a href="https://sourceforge.net/p/cjam" rel="nofollow noreferrer">CJam</a>, 47 bytes</h1>

<p>Slightly more fun version</p>

<pre><code>[q'a'Aer'A/_2%\2/z)\;{_[el_eu]z{\(@|1=\}%e_}%]z
</code></pre>

<p><a href="https://tio.run/##S85KzP3/P7pQPVHdMbVI3VE/3kg1xki/SjPGujo@OjUnPrU0tqo6RsOhxtA2plY1Nb5WNbbq//9yD8cQBU83hWTHgOAcf2dvBc9gBUefIFdHl0gFfz97AA" rel="nofollow noreferrer" title="CJam – Try It Online">Try it online!</a></p>

<p><strong>Explanation</strong></p>

<p>This code has two parts.</p>

<pre><code>[
               Part 1
 q                          -&gt; Read all input as a single string
 'a'Aer                     -&gt; Replace 'a' in string with 'A'
 'A/                        -&gt; Split by 'A' leaving empty sets
 _                          -&gt; Duplicate
 2%                         -&gt; Get all rows where i%2 is 0
 \                          -&gt; Swap top two elements of stack
 2/                         -&gt; Split into array with groups of length 2
 z                          -&gt; Zip/Transpose
 )\;                        -&gt; Right uncons, swap and pop.

               Part 2
 {
  _[el_eu]                  -&gt; Create an array containing the lower case and upper case version
  z                         -&gt; Zip/Transpose
  {
   \                        -&gt; Swap top two
   (                        -&gt; Uncons left
   @                        -&gt; Rotate top three elements of stack
   |                        -&gt; Set union
   1=                       -&gt; Get element at array indice 1 (Wraps)
   \                        -&gt; Swap top two
  }%                        -&gt; Map onto every element of string
  e_                        -&gt; Flatten
 }%                         -&gt; Map onto every element of array
]z                          -&gt; Zip/Transpose
</code></pre>

<p>The first part splits the string by 'A' leaving any empty sets behind. For the string "baacadE" that will give the following array.</p>

<pre><code>["b", "", "c", "dE"]
</code></pre>

<p>That way, all normal case elements are at even indices and reverse case are odd. Which After executing the rest of the first part gives the following.</p>

<pre><code>[["b", "c"], ["", "dE"]]
</code></pre>

<p>The second part will take the odd half and reverse the case of every string. This is done with the set union operator <code>|</code>. So for the element <code>"dE"</code> It will do the following. Since the set union operator preserves the order of the elements found in the first string/array we can always assume the reverse case element will be the second one in the string/array.</p>

<pre><code>["dE", "dD"]
["dD", "dE"]
["dD", "E", "d"]
["E", "d", "dD"]
["E", "dD"]
["E", "D"]
...
["D", "E", "eE"]
["D", "Ee"]
["D", "e"]
</code></pre>

<p>All That is left to do is zip up the two halves.</p>
</div>
<div id="pu55" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 21 bytes</h1>

<pre><code>ＦＳ¿⁼a↧ι≦¬κ¿κι¿№αι↧ι↥ι
</code></pre>

<p><a href="https://tio.run/##VYzBagIxFEXX@hUXNyYw/YIuSpEuBJVCKV0/49OEGd6LSUbx69MMWrC7y733HOcpOaWh1qMmmLXEsXyVFORkrJ3PwhHm4zzSkM2CFh02euXkKLMJ1lpsKb7nHE5idlo69I3gITMmrLf4bJ7Snq9P9UrH1lGHJngc/kn/vvfpO8anqdYfTwWeWisZV8@C4hkrinmjrkfPN6jgpmOa8l4pHXBQzrKcsAuDIFqcRxCE8javL5fhFw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>

<pre><code>ＦＳ
</code></pre>

<p>Loop through each character in the line of input.</p>

<pre><code>¿⁼a↧ι
</code></pre>

<p>Test whether it equals <code>a</code> in lower case.</p>

<pre><code>≦¬κ
</code></pre>

<p>If so then logically negate <code>k</code>. (Note that for some reason Charcoal considers <code>k</code>'s default value <code>None</code> to be truthy.)</p>

<pre><code>¿κ
</code></pre>

<p>Otherwise check whether <code>k</code> is currently truthy.</p>

<pre><code>ι
</code></pre>

<p>If so then just print the character.</p>

<pre><code>¿№αι
</code></pre>

<p>Otherwise check whether the current character is an upper case letter.</p>

<pre><code>↧ι
</code></pre>

<p>If it is then print it in lower case.</p>

<pre><code>↥ι
</code></pre>

<p>Otherwise print it in upper case.</p>
</div>
<div id="pu56" class="pu"><h1>Python 3, <s>78</s> 72 bytes</h1>
<pre><code>import re
lambda x:re.sub(&quot;[Aa](.*?)(a|A|$)&quot;,lambda m:m[1].swapcase(),x)
</code></pre>
</div>
<div id="pu57" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E" rel="nofollow noreferrer">05AB1E</a>, 12 bytes</h1>

<pre><code>õ?„AaS¡Dvć?š
</code></pre>

<p><a href="https://tio.run/##MzBNTDJM/f//8Fb7Rw3zHBODDy10KTvSbn904f//4RmJJQoZiQUFqXnFCuUZqXkKJRmpCs6JBcU@@cnZCtmplQr5eQqV@aVFIHZSfmJRikJKfmpxnjpIW1mqQqJCXn5JcoZCZp5CZok9AA" rel="nofollow noreferrer" title="05AB1E – Try It Online">Try it online!</a></p>

<p><strong>Explanation</strong></p>

<pre><code>õ?             # print an empty string (to account for the special case of only A's)
  „AaS¡        # split on occurrences of "A" or "a"
       D       # duplicate
        v      # for each element in the top copy
         ć?    # extract and print the head of the other copy
           š   # switch the case of the rest of the other copy
</code></pre>
</div>
<div id="pu58" class="pu"><h1>C, 72 bytes</h1>

<p><em>Thanks to @Ton Hospel for helping to save 16 bytes!</em></p>



<pre class="lang-c prettyprint-override"><code>t,c;f(char*s){for(t=0;c=*s++;6305%c?putchar(isalpha(c)?c^t:c):(t^=32));}
</code></pre>

<p><a href="https://tio.run/##bVLNbtswDL73KYgCw@zWG4oV2yFBEAS97rYCuxVgZNpWIkuaSCf1ij57RjkO0AHRQZYlkt8Pab60xpxOUpllU5gO0x2Xb01IhawelmZ1x/f3yx@PD98/mXUcJAcUltHFDgtTrs2LLEy5KORl9fitLJfvJ@sFerS@KG/ebkBXU9w@dwR/Bmv2sE3h6KEJr7Ab@sgQDpRA9Nnh3xHq0H69LZegQFzc6ulS4Cn00ToUGzTZessd1cCDMcTcDM6N19N@dyjQYYzkGY4d@QnqCSP/DEpmTyNowTEMKZ@3AVOtHIj955x2IEDwQTWD9WBlfRUjayNfQ2im4tazWBky02ryQcijN1QBahDWfWYv6SxFc9rsgO/JSwWWQQIwmSHRVIxeNZY0@1J9G@oRYnBWrKlycExByIiyOwPoVTOkbNDMprYHWw/osv4ARn0MrPcCRyvnmBiO2gMFIL8Lo/VtVsvYkIznkgm9Ns8p6JgTbAKPMiR0kGzbCc/ImZ7TfmgFzuWcbWgxPWXnaW60greJtC1hu1PiDKha1WT9F3WL6upMikJ0dGnChJO1oZN5Xj76NgsX3BP0hKz2MXjKw4Fp1GlLM@@zqiq7xpGSnRXmCVFo5utThBvUlbfNRj9XY4R@PeP/W359P/0D" rel="noreferrer">Try it online!</a></p>
</div>
<div id="pu59" class="pu"><h1>Vim, 16 bytes</h1>

<pre><code>qq/\ca
xg~$@qq@q
</code></pre>

<p>Assumes the input is on a single line</p>

<h2>Explanation</h2>

<pre><code>qq            Start a loop
 /\ca␊         Find the first occurence of an a, end the loop if there are none left
 xg~$          Remove it and invert the case of the rest of the file
@qq@q         End the loop 
</code></pre>
</div>
<div id="pu60" class="pu"><h1><a href="https://github.com/barbuz/Husk" rel="nofollow noreferrer">Husk</a>, 15 bytes</h1>

<pre><code>ω(F·+otm\↕·≠_'a
</code></pre>

<p><a href="https://tio.run/##yygtzv7//3ynhtuh7dr5Jbkxj9qmHtr@qHNBvHri////QzJSFQpLM5OzFZKK8svzFNLyKxSySnMLihXyy1KLFEqA0jmJVZUKKfnpegA" rel="nofollow noreferrer" title="Husk – Try It Online">Try it online!</a></p>

<h3>Explanation</h3>

<pre><code>ω(F·+(tm\)↕·≠_'a) -- example input: "Bar, baz and Foo."
ω(              ) -- apply the following, until fixpoint is reached:
          ↕       -- | split string with predicate
           · _    -- | | the lower-cased character
            ≠ 'a  -- | | is not 'a'
                  -- | : ("B","ar, baz and Foo.")
  F               -- | apply the following to the tuple
    +             -- | | join the elements with..
   · (   )        -- | | ..the second element: "ar, baz and Foo."
       m\         -- | | | swap case: "AR, BAZ AND fOO."
      t           -- | | | tail: "R, BAZ AND fOO."
                  -- | : "BR, BAZ AND fOO."
                  -- : "BR, Bz ND fOO."
</code></pre>
</div>
<div id="pu61" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, 92 bytes</h1>



<pre class="lang-hs prettyprint-override"><code>import Data.Char
g x|x&lt;'['=toLower x|1&gt;0=toUpper x
f(a:b)|elem a"aA"=f$g&lt;$&gt;b|1&gt;0=a:f b
f x=x
</code></pre>

<p><a href="https://tio.run/##HcpBC8IgGAbgu7/iQ4TVJeo65iDWra6dOr2WbpJOMSGD/XdbHR94Jrye2rlarY8hZTohYzdMSGykspSuuTUyh0t467T60O9XXWP8iZkNWrVdtNOewHHk0oixE736P7SGFDNUZKkedpYx2TkLw8/6owLSg@7IvH4B" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>

<h2>Explanation</h2>

<p>First we declare <code>g</code> to be the function that maps lowercase to upper case and uppercase to lowercase.  This is actually the majority of our bytecount.  Then we define the function <code>f</code>.  If the input to <code>f</code> is of the form <code>a:b</code> we do</p>

<pre class="lang-hs prettyprint-override"><code>f(a:b)
 |elem a"aA"=f$g&lt;$&gt;b
 |1&gt;0=a:f b
</code></pre>

<p><code>a</code> and <code>A</code> match the first pattern and thus we apply <code>f</code> to the input with it's case inverted.  Otherwise we move <code>a</code> out front and apply <code>f</code> to <code>b</code>.</p>
</div>
<div id="pu62" class="pu"><h1><a href="https://pyth.readthedocs.io" rel="nofollow noreferrer">Pyth</a>, 19 bytes</h1>
<pre><code>s.e?%k2rb2b:Q&quot;a|A&quot;3
</code></pre>
<p><a href="https://pyth.herokuapp.com/?code=s.e%3F%25k2rb2b%3AQ%22a%7CA%223&amp;input=%22The+end+of+the+institution%2C+maintenance%2C+and+administration+of+government%2C+is+to+secure+the+existence+of+the+body+politic%2C+to+protect+it%2C+and+to+furnish+the+individuals+who+compose+it+with+the+power+of+enjoying+in+safety+and+tranquillity+their+natural+rights%2C+and+the+blessings+of+life%3A+and+whenever+these+great+objects+are+not+obtained%2C+the+people+have+a+right+to+alter+the+government%2C+and+to+take+measures+necessary+for+their+safety%2C+prosperity+and+happiness.%22&amp;debug=0" rel="nofollow noreferrer">Try it here.</a></p>
<p>Saved one byte thanks to mnemonic.</p>
</div>
<div id="pu63" class="pu"><h1>Pyth, 21 bytes</h1>

<pre><code>ssm+Pdr2edcscR\AcQ\a2
</code></pre>

<p><a href="http://pyth.herokuapp.com/?code=ssm%2BPdr2edcscR%5CAcQ%5Ca2&amp;input=%22What+happens+when+the+CapsLock+key+on+your+keyboard+doesn%27t+have+a+notch+in+it%3F%22&amp;debug=0" rel="nofollow noreferrer">Try it here</a></p>

<h3>Explanation</h3>

<pre><code>ssm+Pdr2edcscR\AcQ\a2
           scR\AcQ\a   Split the input on 'a' and 'A'
          c         2  Split the blocks into pairs.
  m  d   d             For each pair...
   +P r2e              ... cAPSlOCK the second block.
ss                     Join the blocks together.
</code></pre>
</div>
<div id="pu64" class="pu"><h1><a href="https://github.com/DJMcMayhem/V" rel="noreferrer">V</a>, 9 bytes</h1>

<pre><code>ò/ãa
xg~$
</code></pre>

<p><a href="https://tio.run/##VVA7WoRADO49RQpLPu09hxfIQoCsQzJOAiyNl/EGXmEPhpkFC7t5/O9l3@8/r/dvfLoNX8/7/j4SkHSgPXgcWczZZ2eVBiZkcRKUlhrAAGE3sbB5wQqonEEXKjKReANs4ApG7VzoIUa3wFKw/9Qv2m2QNbFz21RwLurUOrAfBvHUzyUsxjNNxwt3MyaDdVRodcpq8e6wsh@YrCuVakBy1Y1lCBYY9uTbIVlQPmdOYbpVAhcQ9LlggsLD6HY613iJzELBqlzint4eX@tIQlGzYsJ8KIQOerlGcAOMrqL17rEWdc0RijQnghEXAjx8ajdMfsj82@0s7vhBMBFazGcg1EYYLBv0Ws7cR6umrmaZCp8NR8w5rM1efgE" rel="noreferrer" title="V – Try It Online">Try it online!</a></p>

<p>Hexdump:</p>

<pre><code>00000000: f22f e361 0a78 677e 24                   ./.a.xg~$
</code></pre>

<p>Explanation:</p>

<pre><code>ò       " Recursively:
 /ãa    "   Move forward to the next 'a' (upper or lowercase)
        "   This will break the loop when there are no more 'a's
x       "   Delete the 'a'
 g~$    "   Toggle the case of every character after the cursor's position.
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/158132/">158132</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




