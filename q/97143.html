<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::97143</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>062</td><td>Jelly</td><td>240404T165921Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/272335#272335">Aaron</a></td></tr>
<tr d-ix="1"><td>052</td><td>Uiua</td><td>240417T162359Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/272644#272644">Aaron</a></td></tr>
<tr d-ix="2"><td>011</td><td>Vyxal 3 j</td><td>240115T050749Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/269246#269246">pacman25</a></td></tr>
<tr d-ix="3"><td>024</td><td>APL Dyalog Unicode</td><td>201214T164743Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/216341#216341">Razetime</a></td></tr>
<tr d-ix="4"><td>017</td><td>MATL</td><td>161023T103636Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97171#97171">Luis Men</a></td></tr>
<tr d-ix="5"><td>183</td><td>Python 2</td><td>161025T152924Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97397#97397">Skyler</a></td></tr>
<tr d-ix="6"><td>341</td><td>C#</td><td>161025T123453Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97371#97371">TheLetha</a></td></tr>
<tr d-ix="7"><td>112</td><td>R</td><td>161024T091810Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97234#97234">JDL</a></td></tr>
<tr d-ix="8"><td>099</td><td>Turtlèd</td><td>161024T223342Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97293#97293">Destruct</a></td></tr>
<tr d-ix="9"><td>145</td><td>C</td><td>161024T210739Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97289#97289">Chris Bo</a></td></tr>
<tr d-ix="10"><td>127</td><td>PHP</td><td>161024T161344Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97266#97266">Titus</a></td></tr>
<tr d-ix="11"><td>152</td><td>JavaScript ES6</td><td>161023T054658Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97151#97151">sbisit</a></td></tr>
<tr d-ix="12"><td>291</td><td>TSQL</td><td>161024T120059Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97245#97245">t-clause</a></td></tr>
<tr d-ix="13"><td>190</td><td>Java</td><td>161023T065648Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97159#97159">Linnea G</a></td></tr>
<tr d-ix="14"><td>096</td><td>JavaScript ES6</td><td>161023T100727Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97166#97166">Neil</a></td></tr>
<tr d-ix="15"><td>115</td><td>Haskell</td><td>161023T174114Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97192#97192">dianne</a></td></tr>
<tr d-ix="16"><td>112</td><td>Ruby</td><td>161023T173739Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97191#97191">Level Ri</a></td></tr>
<tr d-ix="17"><td>138</td><td>Python 2</td><td>161023T133327Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97177#97177">Lynn</a></td></tr>
<tr d-ix="18"><td>107</td><td>JavaScript ES6</td><td>161023T141347Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97179#97179">edc65</a></td></tr>
<tr d-ix="19"><td>192</td><td>Python 2</td><td>161023T110342Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97172#97172">Karl Nap</a></td></tr>
<tr d-ix="20"><td>415</td><td>Racket</td><td>161023T074751Z</td><td><a href="https://codegolf.stackexchange.com/questions/97143/fill-in-the-minesweeper-clues/97160#97160">rnso</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Jelly, <s>100</s> 62 bytes</h1>
<pre><code>¹3Ƥz0$€z0$3Ƥ€
=”*×56
F=”*+/+48
;” ṭ” FƊ€
Çz0Çz0Ñ3Ŀ€€_³2Ŀ¤»42Ọ
</code></pre>
<p>Called with and returns a 2D array of strings.
Golfed this down significantly after realizing I was wasting a lot of bytes converting to and from numbers and that a 2D convolution is actually a little overkill.  Just summing '*' in 3x3 windows gets the job done just as well.</p>
<p>Explanation:</p>
<pre><code>¹3Ƥz0$€z0$3Ƥ€    # Creates the 3x3 windows
¹3Ƥ              # Breaks the input into rows of three
   z0$€          # Transposes each of those long windows
       z0$3Ƥ€    # and breaks into columns of three

=”*×56           # Helper link to find '*' in input
                 # Multiplies each finding by 56 (ascii '8') to guarantee it's as large as the largest possible element in the minesweeper grid

F=”*+/+48        # Sum each window
F                # Flatten
 =”*             # Find all '*', i.e. turn them in to 1
    +/           # Count them up
      +48        # and add to '0' for converting to char later

;” ṭ” FƊ€        # Pads an array with spaces
;”               # Append a space
   ṭ” F          # Prepend a space
       Ɗ€        # All that on each row of the input

Çz0Çz0Ñ3Ŀ€€_³2Ŀ¤»42Ọ
Ç                       # Call previous helper link to pad rows
 z0Ç                    # Transpose and call again to pad columns
    z0                  # Transpose back to original
      Ñ                 # Call first helper link to create windows
       3Ŀ€€             # Sum each window (the 3rd helper link)
           _            # Subtract
            ³2Ŀ¤        # from the second helper link (the original mine locations)
                »42     # Take each element with the maximum with '*'
                   Ọ    # Convert into characters
                        # Numbers have been bumped up to their ascii equivalents and '*' (42) put in place
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://uiua.org/pad?src=0_11_0-dev_1__IiAgICoiXyIgKiogIl8iKiAgICJfIioqKioiXyIgICAgIgouCkYg4oaQIOKJoSjiioLiioJAIDpAICkK4o2c4o2JRiBGCuKXqzNfMwrijZwo4piHMiniiaEoKysxNkAgLys9QCrima0pCi3DlzU2PUAqOgriiaHihqVAKgo=" rel="nofollow noreferrer">Uiua</a>, 52 bytes</h1>
<pre><code>F←≡(⊂⊂⟜:@ )
≡↥@*-×56=@*:⍜(☇2)≡(+@0/+=@*♭)◫3_3⍜⍉F F.
</code></pre>
<p>As I learned Uiua I realized some pretty foolish inefficiencies in my Jelly answer, so I'll be going back to that one to reduce it some.  I was attempting a 2D convolution with a neighborhood kernel but finally realized the significance of the kernel was to zero out the center element -- the mine -- but this is unnecessary because the answer for that element gets overwritten by the '*' in the end anyway.</p>
<p>This takes a 2D array of strings as input and outputs a 2D array of strings.</p>
<pre><code>F←≡(⊂⊂⟜:@ )    # Helper function to pad a row with spaces
  ≡(       )    # For each row
     ⊂⟜:       # Join on space (prepend)
    ⊂    @      # Join on space (append)

≡↥@*-×56=@*:⍜(☇2)≡(+@0/+=@*♭)◫3_3⍜⍉F F.
                                     F. # Duplicate input and pad each row with spaces
                                 ⍜⍉     # Under transpose
                                   F    #   Pad again (so this pads columns now)
                             ◫3_3       # Get 3x3 sliding window
            ⍜(☇2)                       # Under rerank2 (window returns an array for each row of windows;
                                        #     this puts all the windows in one array)
                 ≡(         )           #   For each window
                           ♭            #     Deshape (flatten)
                      /+=@*             #     Count how many '*'s appear
                   +@0                  #     Add to '0'
           :                            # Flip; put the original input back on top
        =@*                             # Mask of original '*'s
     ×56                                # Multiply by 56 (ascii for '8', the largest possible value in the previous matrix
    -                                   # Subtract this from previous matrix
                                        # This guarantees every item that was an '*' is now '\0', leaving the rest alone
≡↥@*                                    # Take the minimum of each element with '*' (i.e. '\0'-&gt;'*' and others are untouched)
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/Vyxal/Vyxal/tree/version-3" rel="nofollow noreferrer">Vyxal 3</a> <code>j</code>, 11 bytes</h1>
<pre><code>Þȯᵛᵛ•CZᵗᶻg“
</code></pre>
<p><a href="https://vyxal.github.io/latest.html#WyJqIiwiIiwiw57Ir+G1m+G1m+KAokNa4bWX4ba7Z+KAnCIsIiIsIltcIj8/Pz8/Kj8/Pz9cIiwgXCI/Pz8/Pz8/Pyo/XCIsIFwiPz8/Pz8qPz8/P1wiLCBcIioqPz8/KioqPz9cIiwgXCI/Pz8/Pz8qKio/XCIsIFwiPz8/Pz8/Pz8/P1wiLCBcIj8/Pz8/Pz8qKj9cIiwgXCI/Pyo/Kj8/Pz8/XCIsIFwiKj8/Pz8/PyoqP1wiLCBcIj8/Pz8/Pz8qKj9cIl1cbiIsIjMuNC4yIl0=" rel="nofollow noreferrer">Try it Online!</a></p>
<p>get insanely golfed</p>
<p>input is a list of strings with ? instead of spaces because the parser breaks</p>
<pre><code>Þȯᵛᵛ•CZᵗᶻg“­⁡​‎‎⁪⁡⁪⁠⁪⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁪‏⁠‎⁪⁡⁪⁠⁪⁤⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁢⁢⁪‏‏​⁡⁠⁡‌⁢​‎‎⁪⁡⁪⁠⁪⁢⁣⁪‏‏​⁡⁠⁡‌⁣​‎‎⁪⁡⁪⁠⁪⁢⁤⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁡⁪‏⁠‎⁪⁡⁪⁠⁪⁣⁢⁪‏‏​⁡⁠⁡‌⁤​‎‎⁪⁡⁪⁠⁪⁣⁣⁪‏‏​⁡⁠⁡‌­
Þȯᵛᵛ•C       # ‎⁡number of adjacent mines
      Z      # ‎⁢zip with input
       ᵗᶻg   # ‎⁣dump, map, zip and reduce by minimum 
          “  # ‎⁤join on nothing
💎
</code></pre>
<p>Created with the help of <a href="https://vyxal.github.io/Luminespire" rel="nofollow noreferrer">Luminespire</a>.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.dyalog.com/" rel="nofollow noreferrer">APL (Dyalog Unicode)</a>, 24 bytes</h1>

<pre class="lang-apl prettyprint-override"><code>{4⌷x←'*'=,⍵:'*'⋄+/x}⌺3 3
</code></pre>
<p><a href="https://tio.run/##SyzI0U2pTMzJT///qG@qp/@jtgkG/6tNHvVsrwAy1bXUbXUe9W61AjIedbdo61fUPurZZaxg/D8NKPuot@9RV/Oj3jWPerccWm/8qG0i0IjgIGcgGeLhGfw/TQEopK4ABFoK6grqWiAWiKGAhaGlBWFogRVzAY0AWa/OBTFDCwhAJoAodDm4USgkhgkQKZg1cIVaWOyCyoJpLYjr0NwL9wrIRVhsU4B4GlkXNBBQZMBWaSG5CcJD0oNsAExGS0EL1R0KKHpAHC4A" rel="nofollow noreferrer" title="APL (Dyalog Unicode) – Try It Online">Try it online!</a></p>
<p>A direct stencil operation.</p>
<p>Input as a character matrix, output as a hybrid matrix.</p>
<p><a href="https://tio.run/##K8gs@P9f6VHf1EdtE9TVlfTy9JTSFB61TVTS00gMUo9WVw9SjwUSecWa////j1YAAS0QEcsF4YD5MA5MRgvE0AKRcGUgHpIeZANgMloQ/WADUGXgHAA" rel="nofollow noreferrer" title="Pip – Try It Online">Testcase converter</a></p>
</div>
<div id="pu4" class="pu"><h1><a href="http://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, <s>18</s> 17 bytes</h1>

<p><em>Thanks to <a href="https://codegolf.stackexchange.com/users/34718/mbomb007">@mbomb007</a> for a correction in the input of test case 6</em></p>

<pre><code>32&gt;t3Y6Z+-6b(48+c
</code></pre>

<p>Input is a 2D char array, in the format</p>

<pre><code>[' *   '; '*  * '; '  *  '; '    *']
</code></pre>

<p><a href="http://matl.tryitonline.net/#code=MzI-dDNZNlorLTZiKDQ4K2M&amp;input=WycgKiAgICc7ICcqICAqICc7ICcgICogICc7ICcgICAgKidd" rel="nofollow noreferrer">Try it online!</a></p>

<p>Test cases: <a href="http://matl.tryitonline.net/#code=MzI-dDNZNlorLTZiKDQ4K2M&amp;input=WycgICAgKiAnOyAnKiAgICAgJzsgJyAgICAgICc7ICcgICAgICAnOyAnICAqKiAgJzsgJyAqICAqICdd" rel="nofollow noreferrer">1</a>,
 <a href="http://matl.tryitonline.net/#code=MzI-dDNZNlorLTZiKDQ4K2M&amp;input=WycqKionOyAnKioqJzsgJyoqKidd" rel="nofollow noreferrer">2</a>, <a href="http://matl.tryitonline.net/#code=MzI-dDNZNlorLTZiKDQ4K2M&amp;input=WycgICAnOyAnICAgJzsgJyAgICdd" rel="nofollow noreferrer">3</a>, <a href="http://matl.tryitonline.net/#code=MzI-dDNZNlorLTZiKDQ4K2M&amp;input=WycqICAgJzsgJyoqICAnOyAnICAgICc7ICcgICAqJ10" rel="nofollow noreferrer">4</a>, <a href="http://matl.tryitonline.net/#code=MzI-dDNZNlorLTZiKDQ4K2M&amp;input=WycqKiAgICAnOyAnKiAgICAqJzsgJyAgKiAgICc7ICcgICAgICAnOyAnKiAgICAgJzsgJyoqKiogICdd" rel="nofollow noreferrer">5</a>, <a href="http://matl.tryitonline.net/#code=MzI-dDNZNlorLTZiKDQ4K2M&amp;input=WycgICAgICogICAgJzsgJyAgICAgICAgKiAnOyAnICAgICAqICAgICc7ICcqKiAgICoqKiAgJzsgJyAgICAgICoqKiAnOyAnICAgICAgICAgICc7ICcgICAgICAgKiogJzsgJyAgKiAqICAgICAnOyAnKiAgICAgICoqICc7ICcgICAgICAgKiogJ10" rel="nofollow noreferrer">6</a>.</p>

<h3>Explanation</h3>

<pre><code>32&gt;      % Input 2D char array implicitly. Transform it into a 2D logical
         % array with asterisk replaced by true and space by false
t        % Duplicate
3Y6      % Push [1 1 1; 1 0 1; 1 1 1]. This defines the neighbourhood
Z+       % 2D convolution, keeping size. Gives the number of neighbouring
         % mines for each position
-6       % Push -6
b        % Bubble up in stack
(        % Assign -6 to the entries indicated by the logical array, i.e.
         % to the positions that originally contained asterisks 
48+      % Add 48. This transforms each number of neighbouring mines
         % into its ASCII code, and -6 into 42 (ASCII code of asterisk)
c        % Convert to char. Display implicitly
</code></pre>
</div>
<div id="pu5" class="pu"><h1>Python 2, 183 bytes</h1>

<pre><code>def s(m):
 j=m.find('\n')+1;q='q'*j*2;m=list(q+m+q)
 for i in range(len(m)):
  if m[i]==' ':m[i]=`sum([m[k+i]=='*'for k in [-j-1,-j,-j+1,-1,1,j-1,j,j+1]])`
 return''.join(m)[j*2:-j*2]
</code></pre>
</div>
<div id="pu6" class="pu"><h2>C#, 341 Bytes</h2>

<p>A naïve implementation that can definitely be shortened.</p>

<pre><code>s=&gt;s=="*"?1:0;s=&gt;{for(int i=0,j,n,l=s.Length,c=s[i].Length;i&lt;l;++i)for(j=0;j&lt;c;++j)if(s[i][j]!="*"){n=0;if(i&gt;0){n+=a(s[i-1][j]);n+=j&gt;0?a(s[i-1][j-1]):0;n+=j+1&lt;c?a(s[i-1][j+1]):0;}n+=a(s[i][j]);n+=j&gt;0?a(s[i][j-1]):0;n+=j+1&lt;c?a(s[i][j+1]):0;if(i+1&lt;l){n+=a(s[i+1][j]);n+=j&gt;0?a(s[i+1][j-1]):0;n+=j+1&lt;c?a(s[i+1][j+1]):0;}s[i][j]=n+"";}return s;};
</code></pre>
</div>
<div id="pu7" class="pu"><h1>R, <s>127</s> 112 bytes</h1>

<pre><code>function(M){a=nrow(M);for(i in seq(M))if(M[i]!="*")M[i]=sum(M[pmax(i+c(-1,1,-a+-1:1,a+-1:1),0)]=="*",na.rm=T);M}
</code></pre>

<p>thanks to @gtwebb and @sebastian-c for improvements.</p>

<p>Notable points:</p>

<p>Matrices are vectors in R. You don't need 2-D indexing to get elements out.</p>

<p><code>seq(M)</code> will return a sequence of the same "length" (rows x columns) as <code>M</code>.</p>

<p>You can't mix positive and negative extraction indices in R. <code>M[-3]</code> is legitimate R code, but not what is desired.</p>

<p>Input is in the form of an R matrix. Some examples:</p>

<pre><code>&gt; M &lt;- matrix("",5,5)
&gt; M[3,3] &lt;- "*"
&gt; f(M)
     [,1] [,2] [,3] [,4] [,5]
[1,] "0"  "0"  "0"  "0"  "0" 
[2,] "0"  "1"  "1"  "1"  "0" 
[3,] "0"  "1"  "*"  "1"  "0" 
[4,] "0"  "1"  "1"  "1"  "0" 
[5,] "0"  "0"  "0"  "0"  "0" 
&gt; M[2,2] &lt;- "*"
&gt; f(M)
     [,1] [,2] [,3] [,4] [,5]
[1,] "1"  "1"  "1"  "0"  "0" 
[2,] "1"  "*"  "2"  "1"  "0" 
[3,] "1"  "2"  "*"  "1"  "0" 
[4,] "0"  "1"  "1"  "1"  "0" 
[5,] "0"  "0"  "0"  "0"  "0" 
&gt; M[3,2] &lt;- "*"
&gt; f(M)
     [,1] [,2] [,3] [,4] [,5]
[1,] "1"  "1"  "1"  "0"  "0" 
[2,] "2"  "*"  "3"  "1"  "0" 
[3,] "2"  "*"  "*"  "1"  "0" 
[4,] "1"  "2"  "2"  "1"  "0" 
[5,] "0"  "0"  "0"  "0"  "0" 
&gt; 
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/Destructible-Watermelon/turtl-d/" rel="nofollow">Turtlèd</a>, 99 bytes</h1>

<p>(whoops I keep forgetting the link :| )</p>

<p>Takes inputs with brackets around each line</p>

<p>Turtlèd cannot take multi-line input, so after the last line, write <code>|</code> to signal end of input</p>

<p>Note the mismatched brackets are because open brackets parse the next char as part of the bracket command</p>

<pre><code>[|!.([[]r+.][[l]d)][ u]d[|[]r( #012345678#l(*+)u(*+)r(*+)r(*+)d(*+)d(*+)l(*+)l(*+)ur.)]' [[l]' d]' 
</code></pre>

<h3><a href="http://turtled.tryitonline.net/#code=W3whLihbW11yKy5dW1tsXWQpXVsgdV1kW3xbXXIoICMwMTIzNDU2NzgjbCgqKyl1KCorKXIoKispcigqKylkKCorKWQoKispbCgqKylsKCorKXVyLildJyBbW2xdJyBkXScg&amp;input=WyAgICAgKiAgICBdClsgICAgICAgICogXQpbICAgICAqICAgIF0KWyoqICAgKioqICBdClsgICAgICAqKiogXQpbICAgICAgICAgIF0KWyAgICAgICAqKiBdClsgICogKiAgICAgXQpbKiAgICAgICoqIF0KWyAgICAgICAqKiBdCnw" rel="nofollow">Try it online!</a></h3>

<h2>How it works (general description):</h2>

<p>Until <code>|</code> is entered, it writes out the input on each line, with brackets to help it recognise the end of each line.
After that has happened, it goes back up to the top of input. It goes through each character in input. If it is a space, it looks around the space, adding one to the counter for each bomb it finds. after each line, it deletes the brackets. When it gets to the last line, with the | in it, it stops, and deletes the |. the grid is implicitly printed.</p>
</div>
<div id="pu9" class="pu"><h2>C, <s>152</s> <s>150</s> <s>147</s> 145 bytes</h2>



<pre class="lang-c prettyprint-override"><code>i,j,r,c;f(B,R,C)char**B;{for(i=R*C;i--;)for(j=9;j--;){char*b=B[i/C]+i%C;r=i/C+j/3-1;c=i%C+j%3-1;r&lt;0|c&lt;0|r/R|c/C|*b&amp;8||(*b=16|*b+(B[r][c]==42));}}
</code></pre>

<p>Input is in the form of a two-dimensional array of characters, followed by the numbers of rows and columns. The result will be returned in-place.</p>

<p>(Mostly) Ungolfed:</p>

<pre class="lang-c prettyprint-override"><code>i, j, r, c;
f(B, R, C) char **B; {
    for (i = R*C; i--;)
        for (j = 9; j--;) {
            char *b = B[i/C] + i%C;
            r = i/C + j/3 - 1;
            c = i%C + j%3 - 1;
            r &lt; 0 | c &lt; 0 | r / R | c / C | *b &amp; 8 ||
                (*b = 16 | *b + (B[r][c] == 42));
        }
}
</code></pre>

<p>The approach is straight-forward &mdash; loop over each position, loop over its neighbors, and add up all the asterisks. There are two bit-level tricks:</p>

<ul>
<li><p>When we're deciding if a cell is an asterisk or not, we can just check if the eights-place bit is set, because the number in the cell must be less than 8 (the maximum cell value).</p></li>
<li><p>We can turn a space character into a zero character by OR-ing 16.</p></li>
</ul>

<p>Edit: Golfed off two bytes by using <code>/</code> in place of <code>&gt;=</code>.</p>

<p>Edit: Another five bytes by reversing the direction of the loops.</p>
</div>
<div id="pu10" class="pu"><h1>PHP, <s>145</s> <s>133</s> <s>132</s> 127 bytes</h1>

<pre><code>for($s=$argv[1];$s[$p];print$c)if(" "==$c=$s[$p++])for($y=-2;$y++&lt;1;)for($x=$p-3;$x++&lt;$p;)$c+="!"&lt;$s[$x+$y*strpos($s,"\n")+$y];
</code></pre>

<p>takes input as single string, newline separated. Run with <code>-r</code>.</p>

<p><strong>breakdown</strong></p>

<pre><code>for($s=$argv[1];$s[$p]; // loop through all characters (including newlines)
    print$c                     // 3. print result
)
    if(" "==$c=$s[$p++])        // 1. if character is space
        for($y=-2;$y++&lt;1;)      // 2. count surrounding asterisk characters
            for($x=$p-3;$x++&lt;$p;)
                $c+="!"&lt;$s[$x+$y*strpos($s,"\n")+$y];
</code></pre>
</div>
<div id="pu11" class="pu"><h1>JavaScript (ES6) <s>186</s> <s>182</s> <s>177</s> <s>161</s> 152 bytes</h1>

<pre><code>f=a=&gt;{for(s='',y=a[0].length;y--;)for(s=`
`+s,x=a.length;x--;)(k=&gt;{for(t=0,i=9;i--;)t+=(a[x+i%3-1]||[])[y+i/3-1|0]==k;s=(a[x][y]&lt;k?t:k)+s})`*`;return s}
</code></pre>

<h1>Update</h1>

<p>The above code for <code>" *"</code> returns <code>"2*"</code>. This is fixed in the following script.</p>

<h1><s>168</s> 167 bytes</h1>

<pre><code>f=a=&gt;{for(s='',y=a[0].length;y--;)for(s=`
`+s,x=a.length;x--;)a[x][y]=='*'?s='*'+s:(k=&gt;{for(t=0,j=3;j--;)for(i=3;i--;)t+=(a[x+i-1]||1)[y+j-1]=='*';s=t+s})`*`;return s}
</code></pre>

<h1><a href="https://jsfiddle.net/0wcx71mo/9" rel="nofollow">Try it here.</a></h1>
</div>
<div id="pu12" class="pu"><h1>TSQL <s>292</s> 291 bytes</h1>
<p><strong>Golfed:</strong></p>
<pre><code>DECLARE @ varchar(max)=
' *   
*  * 
  *  
    *';
WITH C as(SELECT x+1i,substring(@,x+1,1)v,x/z r,x%z c FROM master..spt_values CROSS APPLY(SELECT number x,charindex(char(10),@)z)z WHERE type='P'and x&lt;len(@))SELECT @=stuff(@,i,1,z)FROM(SELECT i,(SELECT count(*)FROM C WHERE abs(D.c-c)&lt;2and abs(D.r-r)&lt;2and'*'=v)z FROM C D WHERE''=v)h PRINT @
</code></pre>
<p><strong>Ungolfed:</strong></p>
<pre><code>DECLARE @ varchar(max)=
' *   
*  * 
  *  
    *';
WITH C as
(
  SELECT x+1i,substring(@,x+1,1)v,x/z r,x%z c
  FROM master..spt_values
  CROSS APPLY(SELECT number x,charindex(char(10),@)z)z
  WHERE type='P'and x&lt;len(@)
)
SELECT @=stuff(@,i,1,z)
FROM
(
  SELECT
    i,
    (
      SELECT count(*)
      FROM C
      WHERE 
       abs(D.c-c)&lt;2and abs(D.r-r)&lt;2and'*'=v
    )z
  FROM C D
  WHERE''=v
)h
PRINT @
</code></pre>
<p><strong><a href="https://data.stackexchange.com/stackoverflow/query/562144/fill-in-the-minesweeper-clues" rel="nofollow noreferrer">Fiddle</a></strong></p>
</div>
<div id="pu13" class="pu"><h2>Java, 190 bytes</h2>
<p>Edit:</p>
<ul>
<li><em><strong>-6</strong> bytes off. Thanks to @Frozn</em></li>
<li><em><strong>-1</strong> byte off. Thanks to myself :)</em></li>
<li><em><strong>-1</strong> byte off. Also spotted some mistakes. Thanks to @Kevin Cruijssen</em></li>
</ul>
<p>Snipet</p>
<pre><code>c-&gt;{for(int x,y,j,i=-1;++i&lt;c.length;)for(j=-1;++j&lt;c[0].length;){if(c[i][j]&lt;33){c[i][j]=48;for(x=i-2;++x&lt;i+2;)for(y=j-2;++y&lt;j+2;)try{if(c[x][y]==43)c[i][j]++;}catch(Exception e){}}}return c;}
</code></pre>
<p>Ungolfed:</p>
<pre><code>public class Main{
  public static char[][] minesweeper(char[][] woclues){
    for(int i = 0; i &lt; woclues.length ; i++){
      for(int j = 0; j &lt; woclues[0].length ; j++){
        if( woclues[i][j] == ' '){
          woclues[i][j] = '0';
          for(int x = i - 1; x &lt; i + 2 ; x++){
            for(int y = j - 1; y &lt; j + 2 ; y++){
              try{
                if(woclues[x][y] == '*'){
                  woclues[i][j]++;
                }
              }catch( ArrayIndexOutOfBoundsException e){}
            }
          }
        }
      }
    }
    return woclues;
  }
  public static void main(String[]args){
    char[][] in = new char[args.length][args[0].length()];
    for(int i = 0; i &lt; args.length;i++){
      in[i]=args[i].toCharArray();
    }
    for(char[] c:minesweeper(in)){
      System.out.println(new String(c));
    }
  }
}
</code></pre>
<p><a href="http://ideone.com/sWiNzK" rel="nofollow noreferrer">Ideone it.</a></p>
</div>
<div id="pu14" class="pu"><h2>JavaScript (ES6), <s>114</s> 96 bytes</h2>

<pre><code>a=&gt;a.map((s,i)=&gt;s.replace(/ /g,(_,j)=&gt;g(k=&gt;(s=a[i+k])?g(k=&gt;s[j+k]&gt;' '):0)),g=f=&gt;f(-1)+f(0)+f(1))
</code></pre>

<p>Edit: Saved 18 bytes thanks to an idea by @ETHproductions.</p>
</div>
<div id="pu15" class="pu"><h1>Haskell, 115 bytes</h1>

<pre class="lang-hs prettyprint-override"><code>z=zip[1..]
x%i=[a|(j,a)&lt;-z x,abs(i-j)&lt;2]
f x=[[head$[c|c&gt;' ']++show(sum[1|'*'&lt;-(%j)=&lt;&lt;x%i])|(j,c)&lt;-z r]|(i,r)&lt;-z x]
</code></pre>

<p>Defines a function <code>f</code> on lists of strings</p>
</div>
<div id="pu16" class="pu"><h1>Ruby, 112</h1>
<p>Takes and returns a string. String must be newline separated and newline terminated.</p>
<pre><code>-&gt;s{w=1+s=~/\n/
s.size.times{|i|s[i]==' '&amp;&amp;(n=0;9.times{|j|(s+$/*w)[i+j%3-1+j/3*w-w]==?*&amp;&amp;n+=1};s[i])=n.to_s}
s}
</code></pre>
<p><strong>in test program</strong></p>
<pre><code>f=-&gt;s{
  w=(s=~/\n/)+1                              #Calculate width.
  s.size.times{|i|                           #For each char in s
    s[i]==' '&amp;&amp;(                             #If it is a space
      n=0                                    #set counter n to 0 and visit
      9.times{|j|                            #a 3x3 square of chars.
        (s+$/*w)[i+j%3-1+j/3*w-w]==?*&amp;&amp;n+=1  #If *, increment n.
      }                                      #(Pad s with w newlines to avoid *'s detected by wraparound.)
      s[i]=n.to_s                            #Write n back to s in string format
    )
  }
s}                                           #Return s.

puts f[
&quot; *   
*  * 
  *  
    *
&quot;]
</code></pre>
</div>
<div id="pu17" class="pu"><h1>Python 2, 138 bytes</h1>

<pre><code>def f(s):w=s.find('\n')+1;print''.join([c,`(s[i-(i&gt;0):i+2]+(w*' '+s)[i-1:i+2]+s[i-1+w:i+2+w]).count('*')`][c==' ']for i,c in enumerate(s))
</code></pre>

<p>Defines a function <code>f</code> that accepts an input string like</p>

<pre><code>"  *\n** \n*  \n"
</code></pre>

<p>and prints a string to STDOUT:</p>

<pre><code>23*
**2
*31
</code></pre>
</div>
<div id="pu18" class="pu"><h1>JavaScript (ES6), 107</h1>
<p>Input/output as an array of strings</p>
<pre><code>f=l=&gt;l.map((r,i)=&gt;r.replace(/ /g,(c,j)=&gt;(s=r=&gt;(c+r).substr(j,3).split`*`.length,s(l[i-1])+s(l[i+1])+s(r)-3)))
</code></pre>
<p><em>note</em> when the function s is called with an element of the list l out of the bounds, the parameter <code>a</code> is <code>undefined</code> and <code>c+a</code> will result in <code>&quot; undefined&quot;</code> thanks to the quirky conversion rules of javascript</p>
<p><strong>More readable</strong></p>
<pre><code>l=&gt;
  l.map(
    (r,i) =&gt;
      r.replace(/ /g, (c,j) =&gt;
        (
          s = a =&gt; (c+a).substr(j,3).split`*`.length,
          s(l[i-1])+s(l[i+1])+s(r)-3
        )
      )
  )
</code></pre>
</div>
<div id="pu19" class="pu"><h1>Python 2, 192 bytes</h1>



<p>-3 bytes thanks to Copper, -10 bytes if modifying the input grid is allowed, another -11 bytes by getting rid of <code>continue</code> and another -12 bytes for eliminating the counter variable</p>

<pre class="lang-python prettyprint-override"><code>def f(L):
 n,S,s=len(L[0]),[0,1,2],[' '];P=[s*(n+2)];K=P+[s+x+s for x in L]+P
 for y in range(len(L)):
    for x in range(n):
     if'*'!=L[y][x]:L[y][x]=`sum(K[y+d][x+e]=='*'for d in S for e in S)`
</code></pre>

<p>Uses a list of list of characters <code>L</code> and creates a padded version <code>K</code>, so no problem at boundaries. Indentation is </p>

<ol>
<li>Space</li>
<li>Tab</li>
<li>Tab+Space</li>
<li>Tab+Tab</li>
</ol>

<p>Usage:</p>

<pre class="lang-python prettyprint-override"><code>s=""" *   
*  * 
  *  
    *"""
print s
s=[[c for c in x] for x in s.split('\n')]
f(s)
s='\n'.join([ ''.join(x) for x in s])
print s
</code></pre>
</div>
<div id="pu20" class="pu"><h2>Racket 415 bytes</h2>

<pre><code>(let*((l(string-&gt;list s))(g (λ(r c)(if(or(&gt;= r n)(&gt;= c n)(&lt; r 0)(&lt; c 0))#f(list-ref l(+ c(* n r))))))(ng (λ(r c)(let*((h'(-1 0 1))(k(filter(λ(x)x)
(for*/list((i h)(j h)#:unless(= 0 i j))(g(+ r i)(+ c j))))))(count(λ(x)(equal? x #\*))k))))(k(for*/list((i n)(j n))(ng i j)))
(ol(map(λ(x y)(if(equal? x #\*)"*"(number-&gt;string y)))l k)))(for((i(* n n))(j ol))(display j)(when(= 0(modulo(add1 i)n))(displayln ""))))
</code></pre>

<p>Ungolfed:    </p>

<pre><code>(define (f s n)
  (let* ((l (string-&gt;list s))
         (get                            ; fn to get value at a (row, col)
          (lambda(r c)                   ; #f if invalid row or col
            (if (or (&gt;= r n)
                    (&gt;= c n)
                    (&lt; r 0)
                    (&lt; c 0))
                #f (list-ref l (+ c (* n r))))))

         (neighbors                      ; fn to count neighboring "*"
          (lambda(r c)
            (let* ((h '(-1 0 1))
                   (u (filter
                       (lambda(x) x)
                       (for*/list ((i h)(j h)
                                   #:unless (= 0 i j))
                         (get (+ r i) (+ c j))))))
              (count (lambda(x)(equal? x #\*)) u))))

         (k (for*/list ((i n) (j n))    ; for each row,col count neighboring "*"
              (neighbors i j)))
         (ol(map (lambda(x y)           ; get outlist- replace blanks with neighboring star count
                   (if(equal? x #\*) 
                      "*"
                      (number-&gt;string y)))
                 l k)))

    (for ((i (* n n))(j ol))            ; display outlist
      (display j)
      (when (= 0 (modulo (add1 i) n))
        (displayln "")))))
</code></pre>

<p>Testing (lists as a single string with column number specified; will also work with spaces): </p>

<pre><code>(f "----*-*-------------------**---*--*-" 6) 
</code></pre>

<p>Output: </p>

<pre><code>1101*1
*10111
110000
012210
12**21
1*33*1
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/97143/">97143</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




