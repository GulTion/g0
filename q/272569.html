<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::272569</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>144</td><td>Charcoal</td><td>240414T161820Z</td><td><a href="https://codegolf.stackexchange.com/questions/272569/print-all-legal-chess-moves/272575#272575">Neil</a></td></tr>
<tr d-ix="1"><td>263</td><td>JavaScript V8</td><td>240414T161721Z</td><td><a href="https://codegolf.stackexchange.com/questions/272569/print-all-legal-chess-moves/272573#272573">Arnauld</a></td></tr>
<tr d-ix="2"><td>140</td><td>Jelly</td><td>240415T021538Z</td><td><a href="https://codegolf.stackexchange.com/questions/272569/print-all-legal-chess-moves/272590#272590">Jonathan</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>166</s> 144 bytes</h1>
<pre><code>Ｅ35…O-ＩιＦ⁸Ｆ⁸Ｆ⁸Ｆ⁸«≔Ｘ⁻λι²θ≔Ｘ⁻μκ²η¿∨θη«≔§βιζＥ⎇⁼⁵⁺θηN⁺…K‹⁺θη³⭆⁺…B⁼θη…R¬∧θη⁺νQ⪫⟦νζ⊕κ-§βλ⊕μ⟧ω¿∧⁼μ⊕κ‹θ²¿κＥ⎇⁼μ⁷⁺=⪪NBRQ¹⟦ω⟧⪫⟦ζ⊕κ§-xθ§βλ⊕μν⟧ω¿¬θ⟦⪫⟦ω2-¦4⟧ζ
</code></pre>
<p><a href="https://tio.run/##hVLLbsIwEDzDV1g@rSVzKBS1UtUDoB5oy7s3lEMaDFg4DrFDA1R8e@oNSaEI1EhRtOvZ2ZlxgqVvgshXWTY0UifQ89dAG03KSWcXKNFZRq4e1LD2bQKSueepOo8MgUdGbn2/q5WWtXKhYRilwkBP6o0FxYlknNTdGzuSa5CQk1UBWSJEzgkMDMRY5rTlUCvp6pnYwueRc4/gysnChzDaNzt4iTe@stDkZKgc/ZGHE9qnRefM5ZvrvQtr4QTlpIHwSeKIF8h7OdN2M8WOkvvsdOxO@1ECLT0rjhGQc2gnYkSPjddIapi6zp6Trg6MCIVOxAwwCYrRn5lV7C8mZB4naX4plTwt3FUoCi/pWGEwxoRdnohfMXIzNkfwUAqmz07IZK1kArTfHo9cdYeE09T7tXBFfymd1rYUr/0fM5zo0g8RyopcIkYYs1Ln9LgrddnUMRx6Tz38ATyM4FA9ZFlW@1I/" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>Ｅ35…O-Ｉι
</code></pre>
<p>Output <code>O-O</code> and <code>O-O-O</code>.</p>
<pre><code>Ｆ⁸Ｆ⁸Ｆ⁸Ｆ⁸«
</code></pre>
<p>Loop over all pairs of starting and destination squares.</p>
<pre><code>≔Ｘ⁻λι²θ≔Ｘ⁻μκ²η¿∨θη«
</code></pre>
<p>Get the squared differences in the rows and columns, and check that at least one is non-zero.</p>
<pre><code>≔§βιζ
</code></pre>
<p>Get the source file as a letter.</p>
<pre><code>Ｅ⎇⁼⁵⁺θηN⁺…K‹⁺θη³⭆⁺…B⁼θη…R¬∧θη⁺νQ⪫⟦νζ⊕κ-§βλ⊕μ⟧ω
</code></pre>
<p>Check whether the knight, king, bishop, rook or queen can legally make that move, and if so output the move.</p>
<pre><code>¿∧⁼μ⊕κ‹θ²
</code></pre>
<p>Check whether this might be a legal pawn move. (At this point we haven't checked for the pawn being on the back rank.)</p>
<pre><code>¿κＥ⎇⁼μ⁷⁺=⪪NBRQ¹⟦ω⟧⪫⟦ζ⊕κ§-xθ§βλ⊕μν⟧ω
</code></pre>
<p>If the pawn is not on the back rank then output the pawn move, with any necessary promotion options.</p>
<pre><code>¿¬θ⟦⪫⟦ω2-¦4⟧ζ
</code></pre>
<p>Otherwise if this is a plain move then output a doubled pawn move for this file.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://v8.dev/" rel="nofollow noreferrer">JavaScript (V8)</a>, 263 bytes</h1>
<p>A full program that prints all possible white moves.</p>
<pre class="lang-javascript prettyprint-override"><code>s=&quot;NBRQK&quot;
g=(x,y)=&gt;&quot;abcdefgh&quot;[x]+-~y
for(n=4**8;n--;k=h=(X-x)**2,V=Y-y,k+=v=V*V,!k|[k-5,b=h-v,h*v,b*h*v,k&gt;2,y-1|V-2|h][i]||i&gt;5&amp;&amp;!y|h^i&amp;1|V-1|Y&gt;6^i&gt;7||print(m))m=[s[i=n&gt;&gt;12]]+g(x=n&gt;&gt;6&amp;7,y=n&gt;&gt;9&amp;7)+&quot;-x&quot;[i&amp;i&gt;6]+g(X=n&amp;7,Y=n/8&amp;7)+(i&gt;7?&quot;=&quot;+s[i/2&amp;3]:n-10?&quot;&quot;:`
O-O
O-O-O`)
</code></pre>
<p><a href="https://tio.run/##ZZDLasMwEEX3@QpVCyPZUtK4zaMxo0Chq0JDuzAJrkMedWzFjhwi19gg@uuplS67mOEOZ@bC3OO23ur9RZ4rXk@vRVKhQuoKAYriAJ0vUlmtEQik@/pcyIrgT4Vp/1BeXrb7jNyQPemfv3U3UhpcNeC354/3V9xLgTSspSDwdrf/Sg5phqMm9vhP2@sMiIJH150GivMghwzIkjfUdX0Wwoq3LPeghtAN2V1uopyP2A4yXrPMrdnOtT0XPmv50ITcN1kcydgYKUaOc9eabC0dC4ZmJcZrKSbG3J4hJ0pPEOlIghJi6Mexl5LG6rEzYa0VT86Eepg3OJKOFGO7sATV0RWowdRC0vnNMWCvsxn4zkM8U3x4P8d4tukt@MIWX2zodV8qXRZJvyhTcouoSFRaZchDGJ3KOtGYBr1/S8dSqr@Quyh/AQ" rel="nofollow noreferrer" title="JavaScript (V8) – Try It Online">Try it online!</a></p>
<p>(the test code redefines the <code>print</code> method in order to count the moves)</p>
<h2>Explanation</h2>
<h3>Encoding</h3>
<p>Each move candidate is encoded as a single 16-bit value:</p>
<pre><code>iiiiyyyxxxYYYXXX
\__/\____/\____/
  |    |     |
  |    |     +--&gt; coordinates of target square
  |    +--------&gt; coordinates of source square
  +-------------&gt; index of move type
</code></pre>
<h3>Move conditions</h3>
<p>For each source square at <span class="math-container">\$(x,y)\$</span> and each target square at <span class="math-container">\$(X,Y)\$</span>, we define:</p>
<p><span class="math-container">$$h=(X-x)^2$$</span>
<span class="math-container">$$\:V=Y-y$$</span>
<span class="math-container">$$v=V^2$$</span></p>
<p>For all moves, we must have <span class="math-container">\$h\neq0\$</span> or <span class="math-container">\$v\neq0\$</span>. For pawn moves, we must also have <span class="math-container">\$y\neq0\$</span>.</p>
<p>The other conditions depend on the pieces and move types:</p>
<div class="s-table-container"><table class="s-table">
<thead>
<tr>
<th style="text-align: center;">Index</th>
<th style="text-align: center;">Piece</th>
<th style="text-align: center;">Condition</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0</td>
<td style="text-align: center;">knight</td>
<td style="text-align: center;"><span class="math-container">\$h+v=5\$</span></td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">bishop</td>
<td style="text-align: center;"><span class="math-container">\$h=v\$</span></td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">rook</td>
<td style="text-align: center;"><span class="math-container">\$h=0\$</span> or <span class="math-container">\$v=0\$</span></td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">queen</td>
<td style="text-align: center;"><span class="math-container">\$h=v\$</span> or <span class="math-container">\$h=0\$</span> or <span class="math-container">\$v=0\$</span></td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">king</td>
<td style="text-align: center;"><span class="math-container">\$h+v\le2\$</span></td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">pawn / move 2 squares</td>
<td style="text-align: center;"><span class="math-container">\$y=1\$</span> and <span class="math-container">\$V=2\$</span> and <span class="math-container">\$h=0\$</span></td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">pawn / move 1 square</td>
<td style="text-align: center;"><span class="math-container">\$V=1\$</span> and <span class="math-container">\$h=0\$</span> and <span class="math-container">\$Y&lt;7\$</span></td>
</tr>
<tr>
<td style="text-align: center;">7</td>
<td style="text-align: center;">pawn / capture</td>
<td style="text-align: center;"><span class="math-container">\$V=1\$</span> and <span class="math-container">\$h=1\$</span> and <span class="math-container">\$Y&lt;7\$</span></td>
</tr>
<tr>
<td style="text-align: center;">8,10,12,14</td>
<td style="text-align: center;">pawn / promotion</td>
<td style="text-align: center;"><span class="math-container">\$V=1\$</span> and <span class="math-container">\$h=0\$</span> and <span class="math-container">\$Y=7\$</span></td>
</tr>
<tr>
<td style="text-align: center;">9,11,13,15</td>
<td style="text-align: center;">pawn / promotion + capture</td>
<td style="text-align: center;"><span class="math-container">\$V=1\$</span> and <span class="math-container">\$h=1\$</span> and <span class="math-container">\$Y=7\$</span></td>
</tr>
</tbody>
</table></div>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 140 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>_/µ¬S1⁼;AE$;Ẹ$;AṢJƑƊ;ỊẠ$
“ RBQNK”p⁾x-;€”=;þṖḊ$ZḢW;mʋ2
7Ḋ;€-µjþØ+Ẏ,j€0ṠḤḢṭƲ$
8p`⁺EÐḟµ_\FḊeⱮ¢+a¥FṪ⁼8Ʋ;ÑḤḣ€@&quot;2£ẎQ¹Ƈż€ị€1¦€Øa$)ẎF€t€⁶⁾O-ṁⱮ3,5¤;K
</code></pre>
<p>A full program that prints all of white's possible moves separated by space characters.</p>
<p><strong><a href="https://tio.run/##y0rNyan8/z9e/9DWQ2uCDR817rF2dFWxfrhrh4q148Odi7yOTTzWZf1wd9fDXQtUuB41zFEIcgr0837UMLfgUeO@Cl3rR01rgBxb68P7Hu6c9nBHl0rUwx2Lwq1zT3UbcZkD@SAFuoe2Zh3ed3iG9sNdfTpZQAGDhzsXPNyxBKjy4c61xzapcFkUJDxq3OV6eMLDHfMPbY2PcQPqTH20cd2hRdqJh5a6Pdy5Cugyi2ObrA9PBOtbDDTEQcno0GKgiYGHdh5rP7oHKPJwdzeQNDy0DEgenpGoogmUdQOyS0CObNwGdLC/7sOdjUBzjXVMDy2x9v7/HwA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>
<h4>How?</h4>
<p>For each pair of unequal locations form a list:</p>
<pre><code>[ PawnCanCapture + (PawnCanCapture AND EndsAtEighthRank),
  PawnCanPush + (PawnCanPush AND EndsAtEighthRank),
  RookCanMove,
  BishopCanMove,
  QueenCanMove,
  KnightCanMove,
  KingCanMove,
]
</code></pre>
<p>Then format these in the notation, using <code>2</code> to identify promotion, and prefix them with the two castle moves.</p>
<p>Note: execution starts at the Main Link, at the bottom.</p>
<pre><code>_/µ¬S1⁼;AE$;Ẹ$;AṢJƑƊ;ỊẠ$ - Link 1: [[StartFile, StartRank], [EndFile, EndRank]]
_/                       - reduce by subtraction -&gt; [FileDelta, RankDelta]
  µ                      - start a new monadic chain - f(that)
   ¬S1⁼                  - logical NOT, sum == 1? -&gt; R = 1 * isRookMove
        AE$              - absolute values all equal? -&gt; B = 1 * isBishMove
       ;                 - concatenate -&gt; [isR, isB]
           ;Ẹ$           - concatenate any {[isR, isB]} -&gt; [isR, isB, isQ]
               AṢJƑƊ     - absolute values sorted invariant under get indices?
                             -&gt; isHorseyMove?
              ;          - concatenate -&gt; [isR, isB, isQ, isN]
                     ỊẠ$ - all insignificant (abs(x)&lt;=1)? -&gt; isKingMove
                    ;    - concatenate -&gt; [isR, isB, isQ, isN, isK]

“ RBQNK”p⁾x-;€”=;þṖḊ$ZḢW;mʋ2 - Link 2: no arguments
“ RBQNK”                     - set left argument to &quot; RBQNK&quot;
        p⁾x-                 - Cartesian product &quot;x-&quot;
            ;€”=             - concatenate '=' to each
                  ṖḊ$        - pop &amp; dequeue {&quot; RBQNK&quot;} -&gt; &quot;RBQN&quot;
                ;þ           - concatenation table
                     Z       - transpose
                      ḢW;mʋ2 - head, wrap, concatenate with every other
                                 -&gt;  [[&quot; x=R&quot;,&quot; x=B&quot;,&quot; x=Q&quot;,&quot; x=N&quot;],
                                      [&quot; -=R&quot;,&quot; -=B&quot;,&quot; -=Q&quot;,&quot; -=N&quot;],
                                      [&quot;R-=R&quot;,&quot;R-=B&quot;,&quot;R-=Q&quot;,&quot;R-=N&quot;],
                                      [&quot;B-=R&quot;,&quot;B-=B&quot;,&quot;B-=Q&quot;,&quot;B-=N&quot;],
                                      [&quot;Q-=R&quot;,&quot;Q-=B&quot;,&quot;Q-=Q&quot;,&quot;Q-=N&quot;],
                                      [&quot;N-=R&quot;,&quot;N-=B&quot;,&quot;N-=Q&quot;,&quot;N-=N&quot;],
                                      [&quot;K-=R&quot;,&quot;K-=B&quot;,&quot;K-=Q&quot;,&quot;K-=N&quot;]] 

7Ḋ;€-µjþØ+Ẏ,j€0ṠḤḢṭƲ$ - Link 3: no arguments
7Ḋ                    - seven dequeued -&gt; [2,3,4,5,6,7]
  ;€-                 - concatenate -1 to each -&gt; PawnData = [[2,-1],...,[7,-1]]
     µ                - start a new monadic chain - f(that)
      jþØ+            - table of join with [1, -1]
          Ẏ           - tighten
                    $ - last two links as a monad - f(PawnData):
            j€0       -   join each with zero -&gt; [[2,0,-1],...,[7,0,-1]]
                   Ʋ  -   last four links as a monad - f(that):
               Ṡ      -     signs
                Ḥ     -     double
                 Ḣ    -     head
                  ṭ   -     tack
           ,          - pair
                          -&gt; [PawnCaptures, PawnPushes] each as
                               [StartRank, StartFile-EndFile, StartRank-EndRank]
                           = [[[2,1,-1],...,[7,1,-1],[2,-1,-1],...,[7,-1,-1]],
                             [[2,0,-1],...,[7,0,-1],[2,0,-2]]]

_\FḊeⱮ¢+a¥FṪ⁼8Ʋ;ÑḤḣ€@&quot;2£ẎQ¹Ƈż€ị€1¦€Øa$ - chain: [[StartFile, StartRank], [EndFile, EndRank]]:
_\                                     - cumulative reduce by subtraction -&gt; [[StartFile, StartRank], [StartFile-EndFile, StartRank-EndRank]]
  FḊ                                   - flatten, dequeue -&gt; [StartRank, StartFile-EndFile, StartRank-EndRank]
    eⱮ¢                                - exists in? map across: call Link 3
          FṪ⁼8Ʋ                        - EndRank = 8?
       +a¥                             - add AND -&gt; make 1 a 2 if so 
               ;Ñ                      - concatenate: call Link 1
                 Ḥ                     - double
                  ḣ€@&quot;2£               - call Link 2 and zip with head to {those} indices
                        ẎQ¹Ƈż€ị€1¦€Øa$
                        ẎQ¹Ƈ           - tighten, deduplicate, remove empties
                              ị€1¦€Øa$ - replace 1-8 with a-h for Files
                            ż€         - zip with each
         ^ 
8p`⁺EÐḟµ...)ẎF€t€⁶⁾O-ṁⱮ3,5¤;K - Main Link: no arguments
8p`                           - [1..8] Cartesian product [1..8]
   ⁺                          - repeat -&gt; all [[StartFile, StartRank], [EndFile, EndRank]]
    EÐḟ                       - remove if all equal
       µ...)                  - monadic chain (see above) for each
                                  -&gt; non-castling moves with ' ' as pawn
            ẎF€               - tighten; flatten each
               t€⁶            - trim spaces (pawns)
                  ⁾O-ṁⱮ3,5¤   - &quot;O-&quot; mould like [3,5] = [&quot;O-O&quot;, &quot;O-O-O&quot;]
                           ;  - concatenate
                            K - join with space characters
                              - implicit, smashing print
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/272569/">272569</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




