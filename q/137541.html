<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::137541</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>1081</td><td>Python3</td><td>231223T190632Z</td><td><a href="https://codegolf.stackexchange.com/questions/137541/stackin-boards/268716#268716">Ajax1234</a></td></tr>
<tr d-ix="1"><td>444</td><td>Python 3</td><td>170805T073203Z</td><td><a href="https://codegolf.stackexchange.com/questions/137541/stackin-boards/137711#137711">Halvard </a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 1081 bytes</h1>
<p>Rather long, but crunches every test case, including several additional ones, in ~0.184 seconds</p>
<pre class="lang-py prettyprint-override"><code>E=enumerate
R=range
from itertools import*
G=lambda l:[[j for j,_ in b]for a,b in groupby(E(l),key=lambda x:x[1]=='')if a] 
def C(l,L,H):
 q=[([a],[i])for i,a in E(l)if a&lt;=L]
 while q:
  A,I=q.pop(0)
  if sum(A)&lt;=L and(H==0 or sum(A)==L):yield(tuple(A),I)
  for i,a in E(l[max(I)+1:],max(I)+1):
   if sum(T:=A+[a])&lt;=L:q+=[(T,I+[i])]
def P(b,l,Q,t):
 for i,a in E(b):
  if''in a:
   F=0
   B,Y=eval(str(b)),[]
   for g in G(a):
    if(O:=[*C(l,len(g),t)]):
     F,d=1,{}
     for J,K in O:d[J]=K
     O=[*d.items()]
     M=max(sum(A)for A,_ in O)
     V,I=min([(o,p)for o,p in O if sum(o)==M],key=lambda x:len(x[0]));Y+=I
     for v in V:
      Q+=1
      for _ in R(v):B[i][g.pop(0)]=chr(Q)
   if F or t:return(B,[y for x,y in E(l)if x not in Y],Q)
def f(l):
 I,Q=1 if max(l)&lt;11 else max(l),96
 while I:
  q,S=[(B:=[[''for _ in R(I)]for _ in R(10)],[*l],96)],[B]
  while q:
   b,L,Q=q.pop(0)
   if[]==L:return b
   if(C:=P(b,L,Q,1))and C not in S:q+=[C];S+=[C]
   if(C:=P([*map(list,zip(*b))],L,Q,0)):
    B,L,Q=C;
    if(B:=[*map(list,zip(*B))])not in S:q+=[(B,L,Q)];S+=[B]
  I+=1
</code></pre>
<p><a href="https://tio.run/##dVPbbtpAEH3nK/aNXRhFOEQVdbIPGOXilIiSRJGi1aqyy0Kcri8Yk0KrfjudWZsUqlaLsGdnzpkzFxfb6iXP@oOi3O0upcnWqSmjyrTuZRllC9Oal3nKksqUVZ7bFUvSIi@rTuta2iiNZxGzvlKvbJ6X7BW@sCRjsSYjgpiMRZmvi3jLL7kV8M1s96iNv1GelrLdFsmcRZq1ZmbORtzCGG6E32JLqbiKNKhEC@JLICI@4iHAhRzrFvv@kljDlhjOhhDK5UmRF7wn0MSY1TrlQ4GBLMpm/EbKHkOe@lbKsfC3ibEzXq0La/AKQsIdp1JptOGh6Hq@hv0riXvnf/TlsIsyKY2/7KLmRwi7pFm7gj7zGCxMoSLUEXfseJJ5u41m5DivZI8eATxL8xZZvqpKDBOgNF0TekHYax7VGhDNJ75UHWqbNRlfCEykGye7gpn04Oev2iL4LXwigok/U7dafqodEySYneCA0xUXur67k1Rt3SoCDuvJTkTtfsJep0nGFc@hcAH4dAH7vuTY4Tt9PHBSuFE9LcT5c1eGf2S9EfSpUc2mXek1r@R0ie/5m/ADbKtaNCPW8utLyaeimcUVjbbyS1Oty4wHoLYOvIHtwdJsWJZXZD9rQCTNZ44eTBzCVHrEQ2VbceF5zNiVaUz4@GG/aiGpXMIDDjrAzqt2@0BjKPSB5aFIUB2rEU5vAfX2YGFZjKs@PdxZFKDwkxg3ZbC4vuMjX9IeYTR4QuAys9G@kge3dCN9/uAehwDVSaOC22RVwY@k4B3cJO04eqLZkMAJGJ3vd4kq@gsUIEgc5eIOJeqMrqYQB7YryiSr@JyrAbD618dBt96vT@EUzqD@x3Pk806hPn3nHMDgyH0G/zz/jem7UzN6GLX7DQ" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://docs.python.org/3.6/" rel="nofollow noreferrer">Python 3</a>, <strike>513</strike> <strike>512</strike> <strike>511</strike> <strike>509</strike> <strike>499</strike> <strike>497</strike> <strike>485</strike> <strike>465</strike> <strike>459</strike> <strike>458</strike> 444 bytes</h1>

<p>Incredibly bad runtime, will finish at some point
</p>

<pre class="lang-python prettyprint-override"><code>e,j,c=enumerate,len,range
def f(n,p=[],o=97):
    r,l,m=lambda x:min(b,f(n[:i]+n[i+1:],x,o+1),key=j),chr(o),j(p)
    b=[p,l*(sum(n)*2+m)][n&gt;[]]
    for i,a in e(n):
        for h,d in e(p):
            if a&lt;11-j(d):b=r([p[f]+l*a*(f==h)for f in c(m)])
            if(j(d)&lt;10)*all(j(x)==j(d)for x in p[h:h+a])*(a&lt;=m-h):b=r([p[f]+l*(h&lt;=f&lt;h+a)for f in c(m)])
        if a&lt;11:b=r(p+[l*a])
        b=r(p+[l]*a)
    return["\n".join("".join(9-u&lt;j(x)and x[9-u]or" "for x in b)for u in c(10)),b][o&gt;97]
</code></pre>

<p><a href="https://tio.run/##bVDBjoMgFDzXryCeQF83a3vo1kh/hOWACouuAqGa2K93QdtNNtkTmXkzb4bnHpO25ryuEnpoqDTzKL2YJAzSgBfmSyatVEhhA44yDpZeL6RMDh4GGOkgxroVaCnHzuAagoqVHc8N6/Ki5LCAzQsC3/JBewKN9tgS6LEjyaGmzMGQ4fs8YkOyUz4SzsyNcZ4clPWoA4E6g2QYhrSN0tDulNuoQ6eQqIri2OOWlDX1mDmmeD5kIsOKUk2iSUVLg8N2sntwlFfFO8nEMASwEEojFcVLFDumS50LTjIsKjoe9d/lWFdUVUHwz/pno03vchaabPQL8kwE6OU0e8PST5O@9TbcLX2@1@NcxT7CtGhhAXHrU5T@Fqu3xHlPDB8gUHNmb9cLXxtxl3dEEWYFnDiw4gRn@Ajh0RGHmymKwuWc78yEIyIvoHZI1h8" rel="nofollow noreferrer">Try it online!</a></p>

<p>Edit: -<strike>2</strike> -8 bytes thanks to <a href="https://codegolf.stackexchange.com/users/59487/mr-xcoder">@Mr. Xcoder</a>
Edit: -8 bytes thanks to <a href="https://codegolf.stackexchange.com/users/63641/notjagan">@notjagan</a></p>

<h2>Explanation</h2>

<pre class="lang-python prettyprint-override"><code>e,j,c=enumerate,len,range      
         # These built-ins are used a lot
def f(n,p=[],o=97):
         # n is the remaining blocks
         # p is the current stack
         # o is the ASCI code for the next letter to use
    r,l,m=lambda x:min(b,f(n[:i]+n[i+1:],x,o+1),key=j),chr(o),j(p)
         # r is the recursive call, that also selects the smallest stack found
         # l is the letter to use next
         # m is the length of the current stack
    b=[p,l*(sum(n)*2+m)][n&gt;[]]
         # Sets the current best, if there are no remaining blocks, select the found stack, else we set it to be worse than the possible worst case
    for i,a in e(n):
         # Loop through all the remaining blocks
        for h,d in e(p):
         # Loop through all the columns in the current stack
            if a&lt;11-j(d):b=r([p[f]+l*a*(f==h)for f in c(m)])
         # If we can place the current block vertically in the current column, try it
            if(j(d)&lt;10)*all(j(x)==j(d)for x in p[h:h+a])*(a&lt;=m-h):b=r([p[f]+l*(h&lt;=f&lt;h+a)for f in c(m)])
         # If we can place the current block horizontally starting in the current column, try it
        if a&lt;11:b=r(p+[l*a])
         # If the current block is lower than 10, try place it vertically to the right of the current stack
        b=r(p+[l]*a)
         # Try to place the current horizontally to the right of the current stack
    return["\n".join("".join(9-u&lt;j(x)and x[9-u]or" "for x in b)for u in c(10)),b][o&gt;97]
         # Return the best choice if we aren't in the first call to the function, that is the next letter is a. Else return the found best option formatted as a string
</code></pre>

<h1><a href="https://docs.python.org/3.6/" rel="nofollow noreferrer">Python 3</a>, 587 bytes</h1>

<p>Actually runnable on TIO for some of the test cases</p>

<pre class="lang-python prettyprint-override"><code>e,j,c=enumerate,len,range
def f(n,p=[],o=97,b=[]):
    if(not n):return p
    if not b:b="a"*sum(n)*2
    r,q,s,l,m=lambda x:q(f(n[:i]+n[i+1:],x,o+1,b)),lambda x:[b,x][j(b)&gt;j(x)],b,chr(o),j(p)
    if j(b)&lt;=m:return b
    for i,a in e(n):
        for h,d in e(p):
            if a&lt;11-j(d):b=r([p[f]+l*a*(f==h)for f in c(m)])
            if j(d)&lt;10 and a&lt;=m-h and all(map(lambda x:j(x)==j(d),p[h:h+a])):b=r([p[f]+l*(h&lt;=f&lt;h+a)for f in c(m)])
        if s==b:
            if a&lt;11and m+1&lt;j(b):b=r(p[:]+[l*a])
            if m+a&lt;j(b):b=r(p[:]+[l for r in c(a)])
    return["\n".join("".join(map(lambda x:" "if u&gt;=j(x)else x[u],b))for u in c(9,-1,-1)),b][o&gt;97]
</code></pre>

<p><a href="https://tio.run/##bVHdbrQgEL3efQriFayzTXWbtGtkX4SPC1ixagQpamKffj9G203/MkbgzMw5Z8C/T83gTrebgQ6u3LjZmqAmA71xEJR7NfvK1KSmDjwXEgZ@fgYdd6zY79oIDxNxrAhmmoMjHjGCmC40T1RyGGdLHTvk@12ANxihB8t7ZXWlyFK80UggilamTrRpVkhYYEgz0IzBvUhoWKToqGaXji5MgoZrE@jAoKOerYKYLLn9dKH3u3oIpAVFWkdM1I9eV6iBaoP8CmGvKrPs2NGKRcOBCi9qmfYHdaA15w3DphpbrtQyyT56sLzMHolyVezn9ths276nVnl6t45@Ocdq8KIpmlRJ9l2HNiWvy5j4QykKjZzrr0ZRxaZZiQOvPF4UMhXR792bTdWvNEHysJGrlXy7KZH8c8lDN7SOJh/rN/8JSSLjfOE4iOlHQxYxS3weJJw3wjMcs/jFJ9NSDJfzs7xd1WhGwgkVOeTwBNs/hgSR5bDFaYVe4CWCT/Bn/Mic1ti6szgFmkCp1QdKiiKX8bp8aN1EEWGfh3o7stt/" rel="nofollow noreferrer">Try it online!</a></p>

<p>Both solutions could probably be golfed quite a bit.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/137541/">137541</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




