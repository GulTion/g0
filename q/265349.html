<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::265349</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>109</td><td>JavaScript Node.js</td><td>230920T164804Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265402#265402">l4m2</a></td></tr>
<tr d-ix="1"><td>037</td><td>APL Dyalog APL</td><td>230920T162405Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265400#265400">ovs</a></td></tr>
<tr d-ix="2"><td>nan</td><td></td><td>230919T093233Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265367#265367">Dominic </a></td></tr>
<tr d-ix="3"><td>120</td><td>Ruby</td><td>230919T110109Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265368#265368">G B</a></td></tr>
<tr d-ix="4"><td>137</td><td>JavaScript ES7</td><td>230918T221756Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265350#265350">Arnauld</a></td></tr>
<tr d-ix="5"><td>026</td><td>Jelly</td><td>230919T005727Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265358#265358">Jonathan</a></td></tr>
<tr d-ix="6"><td>127</td><td>Python 3.8</td><td>230919T000629Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265356#265356">Jonathan</a></td></tr>
<tr d-ix="7"><td>055</td><td>Charcoal</td><td>230918T225825Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265352#265352">Neil</a></td></tr>
<tr d-ix="8"><td>238</td><td>Python3</td><td>230918T225252Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265351#265351">Ajax1234</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 109 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(n,s=[[]],t=[])=&gt;s.map(x=&gt;(g=n=&gt;n&amp;&amp;g(n-1,(n+x[0])**.5%1||x.includes(n)||t.push([n,...x])))(n))|t&lt;f?s:f(n,t)
</code></pre>
<p><a href="https://tio.run/##HY1BT8MwDIXv/Ipo0qZ4bSOKNCHRpdw5wIFj6aHqkqxTcKo4gyLKby/uTs9@33v2pfvqqI/DmAoMJ7MsVkvMSTdN2@ZJNy3omtRnN8pJ19Jp1DXudk5iUeYSs6m5b2G/V4dtOc@TGrD315MhiTDPSY1XOssGc6XU1AIA2zCno32mJ8tfEiyVDVF6kwQKLcqK5ajFwyMPWQbi906IFUZDjLkCFTt9QAreKB@c3Ky9jci4mLEW9W3hvPIGXTrf3A7p20T6wJW9vL@9KkpxQDfYH8lRWEMM@fjf8g8" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 106 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>n=&gt;f=(s=[[]],t=[],i=n)=&gt;i?s.map(x=&gt;(i+x[0])**.5%1||x.includes(i)||t.push([i,...x]))&amp;&amp;f(s,t,--i):t&lt;f?s:f(t)
</code></pre>
<p><a href="https://tio.run/##HYzBTsMwEETvfIVViWq3cSyKVCE1dXrrgQMcOJocotROjcwmyroQRPj24PQ0u/Nm5qP@qrkZfB9z6s52PumZdOk0sDamqmTUppJeE@rSH1l91j2MugSfjeahws1G7e630zQqT024ni2Dx2mKqr/yBYyXSqmxQlyvHbCMMs897uPBHXnvIOJcuG6AYKMgocW2SHLQ4vEpHVmG4vdOiAUOlhM@ASFgkbymI@6CVaFrYbU0VyJL1SxpXt6e1FDBUhsvN7cm/rYDv9PCnt9eXxTHwVPr3Q@kKC6hBNP43/wP" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.dyalog.com/products.htm" rel="nofollow noreferrer">APL (Dyalog APL)</a>, 37 <a href="https://github.com/abrudz/SBCS" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>{×≢n←⊃,/(⊂,¨⍺∩⊢~⍨(×⍨⍺)-⊢/)¨⍵:⍺∇n⋄⍵}⍨⍳
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m70qpTIxJz89PrEgZ8GCpaUlaboWNwPdHrVNqD48_VHnojwg61FXs46-xqOuJp1DKx717nrUsfJR16K6R70rNIBKekFCmrpAEX1NkPRWK7CS9rxH3S1AXi1YwWaowa6P-qaCDGybWF0EpN2AChSA6hSAtLrCo7ZJCupAa5qLNNU1FLTVNQ6tN9QGOgHI1VSvPbTC6FHbZKBRRuYQw2CuBQA" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p>Recursive approach, generates all results from 3 to 27 in a second.</p>
</div>
<div id="pu2" class="pu">
<h1><a href="https://www.r-project.org" rel="nofollow noreferrer">R</a>, 139 bytes</h1>
<pre class="lang-r prettyprint-override"><code>\(n,f=\(a,b,i=which(!(a+b[1])^.5%%1))`if`(sum(i),unlist(Map(\(i)f(a[-i],c(a[i],b)),i),F),list(b)))(a=f(1:n,{},1:n))[(l=lengths(a))==max(l)]
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=jY9BasMwEEXPkoXJTDoOOBAoBW276wlsVx47kq0iq4kl40LpCXKEbJxFD5XbVMQ5QFePB__D_5frMN_W9tO1ygd5VEMvJxM6ydZKPnxwo1yQ_jTyoLz4HYNOn2_nAhxpUQBTTUZMnWk6WAE_1XlW4vt2nyQZYmV0BX7swSCNzhof4I2PUETXwHlqSmoiI2pEiqFXpHsqKgILDdmLo-8fikDMwQqrXBs6D4woRM9fYLF8TNr87wHs9rg05nnhHw" rel="nofollow noreferrer">Attempt This Online!</a></p>
<p><strong>Ungolfed</strong></p>
<pre class="lang-r prettyprint-override"><code>longest_perm_with_all_adjacent_squares=
function(n){

    # first define the recursive helper function f:
    f=function(a,b={}){
        # a is a vector of values that haven't been used yet, to choose the next value from;
        # b is the (initially empty) growing result containing only adjacent values that sum to squares 

        if(length(b)==0)i=seq(along=a) else i=which(sqrt(a+b[1])%%1==0)
        # i is the vector of indices of a that we can use at each step

        if(length(i)==0)return(list(b)) 
        # if we can't use any more values from a, then just return the result-so-far

        else return(unlist(lapply(i,function(i)f(a[-i],c(a[i],b))),recursive=F))
        # otherwise, prepent each valid value from a to b, and perform a recursive call
    }

    # launch the helper function with the sequence 1..n in a, and leaving b empty by default:
    ans=f(1:n)

    # finally, select only the results with maximum length:
    ans[lengths(ans)==max(lengths(ans))]
}
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, 120 bytes</h1>

<pre class="lang-ruby prettyprint-override"><code>-&gt;n{r=z=w=[*1..n];r,w=w,r.flat_map{|b|(z-[*b]).map{|a|[a,*b]}}.reject{|a|b=0;a.any?{|a|b*(b+b=a)**0.5%1&gt;0}}while w[0];r}
</code></pre>
<p><a href="https://tio.run/##Lc3LCoMwEIXhV3FT0FSHKJQuZOyDBCmTEmmLDRKUeMk8e2qly@9fnOMmvcQOY9HYzeGKHpUoAWxbu9yjzx10PY33Dw1b0CFdCyV0m8FhCorynczgzNs8xl/SKGsCssvtkEj1WSNlQki4nMpGMvvnqzeJV3L/4JhWANX1vziHIenU3HL8Ag" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
<h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, 96 bytes</h1>

<pre class="lang-ruby prettyprint-override"><code>f=-&gt;n,z=n{w=[*1..n].permutation(z).reject{|a|b=0;a.any?{|a|b*(b+b=a)**0.5%1&gt;0}};w[0]?w:f[n,z-1]}
</code></pre>
<p><a href="https://tio.run/##HczRCoMgGEDhV9nNQN360WAMFtaDiBc6FDbIiRhW6rNb7PJ8FycsemvN8m509527nLggDMBJ8CbMS1Tx83NoxxDM17xjLqpoTgcFym3TvwjSN80VJoTC48pGWuuQBJVTellxTjsma0M9QP/EMCufy1r8xYr15AM" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
<p>Super-slow, times out for n=11.</p>
</div>
<div id="pu4" class="pu"><h1>JavaScript (ES7), 137 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(n,k=n)=&gt;(P=(a,...p)=&gt;o=p[a.map(v=&gt;(++v+p[0])**.5%1||P(a.filter(x=&gt;v+~x),v,...p)),k]?[...o,p]:o)([...Array(n).keys(o=[])])+o?o:f(n,k-1)
</code></pre>
<p><a href="https://tio.run/##JY1BT8MwDIXv/Ipo0iR7aSMGQkgb6cSVA0ziWHqIRtqVljhKqrKKwV8vzji9Z3/v2R9mNPEQWj/kjt7tPNcaXNZph7qAvQaTKaU8D6R9adSn8TAykXKUvryucLVSd8v1@bwHo@q2H2yAky5G@XvCbPzvYtZVu5ItZb7aEELyjyGYCRyqzk4RSJcVVihpR5s6/c/XONcUoLeDcEKL2y3LgxY392ykRPF9JUSCwUbG3MEtbw7kIvVW9dTAIvUWQnJRsubFZeC86q1rhuNla1z8siG@ucSeXl@eVRxC65q2noCjmEIM@fjP/Ac" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>f = (                 // f is a recursive function taking:
  n,                  //   n = input
  k = n               //   k = target permutation length (+1)
) =&gt; (                //
  P =                 // P is a recursive function taking:
      (a,             //   a[] = source array
          ...p) =&gt;    //   p[] = permutation of a[]
  o = p[              //
    a.map(v =&gt;        // for each value v in a[]:
      (++v +          //   increment v ([0..n-1] -&gt; [1..n])
             p[0])    //   abort if v + p[0] ...
      ** .5 % 1 ||    //   ... is not a perfect square
      P(              //   otherwise, do a recursive call to P:
        a.filter(x =&gt; //     pass a copy of a[] ...
          v + ~x      //     ... where v is removed
        ),            //
        v, ...p       //     insert v at the beginning of p[]
      )               //   end of recursive call
    ),                // end of map()
    k                 // test p[k]
  ] ?                 // if it's defined:
    [...o, p]         //   append p[] to o[]
  :                   // else:
    o                 //   leave o[] unchanged
)([...Array(n).keys(  // initial call to P with a[] = [0..n-1]
  o = []              // and o[] initialized to an empty array
)]) + o ?             // if o[] is non-empty:
  o                   //   return it
:                     // else:
  f(n, k - 1)         //   try again with k - 1
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s> 29 </s> 26 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>0ịịḟ⁸⁸;Ɱ
²€_Ɱf€RɓW€ç€Ẏ¥ƬṖṪ
</code></pre>
<p>A monadic Link that accepts a positive integer greater than <span class="math-container">\$2\$</span> and yields all possible sequences of maximal length.</p>
<p><strong><a href="https://tio.run/##y0rNyan8/9/g4e5uENox/1HjDiCyfrRxHdehTY@a1sQDWWlAOujk5HAgdXg5kHi4q@/Q0mNrHu6c9nDnqv///xuZAwA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>
<h3>How?</h3>
<pre><code>0ịịḟ⁸⁸;Ɱ - Link 1: list of ints, Sequence; list of lists of ints, Continuations
0ị       - last element of {Sequence}
  ị      - index into {Continuations} -&gt; ints that will sum to a square
   ḟ⁸    - filter out elements of left argument (Sequence)
             -&gt; removes those that would cause duplicates
     ⁸;Ɱ - concatenate each to left argument
             -&gt; list of new, longer sequences (empty if none possible)

²€_Ɱf€RɓW€ç€Ẏ¥ƬṖṪ - Main Link: integer, k &gt; 2
²€                - square each {[1..k]} -&gt; [1, 4, 9, 16, ..., k²]
  _Ɱ              - subtract mapped across {[1..k]}
    f€R           - filter each keeping those in [1..k]
                      -&gt; Continuations by current value:
                         [[3, 8, 15, ...], [2, 7, 14, ...], [1, 6, 13, ...], ...]
       ɓ          - start a new dyadic chain - f(k, ValidContinuations)
        W€        - wrap each of {[1..k]} -&gt; [[1], [2], [3], ...]
              Ƭ   - start with Seqs=that and collect while distinct, applying:
             ¥    -   last two links as a dyad - f(Seqs, Continuations):
          ç€      -     call Link 1 as a dyad - f(Sequence, Continuations)
            Ẏ     -     tighten back to a list of sequences
               Ṗ  - pop -&gt; removes the empty list found last 
                Ṫ - tail -&gt; maximal length sequences
</code></pre>
<hr />
<h4>21 bytes (k=25)</h4>
<p>Not brute force, but still times out for <span class="math-container">\$k=26\$</span>:</p>
<pre><code>W€;þẎ-.ịSÆ²ƲƇQƑƇʋƬRṖṪ
</code></pre>
<p><a href="https://tio.run/##ATQAy/9qZWxsef//V@KCrDvDvuG6ji0u4buLU8OGwrLGssaHUcaRxofKi8asUuG5luG5qv///zE2" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8</a>, 127 bytes</h1>

<pre class="lang-python prettyprint-override"><code>f=lambda k,p=0:(r:=range(1,k+1))and(c:=[l+[v]for l in p or[[i]for i in r]for v in r if(l[-1]+v)**.5%1==(v in l)])and f(k,c)or p
</code></pre>
<p><strong><a href="https://tio.run/##XY1BCsIwEEX3nmIQhIyt0ipCCUS8R@ii1kRDYhqjFkR69tqkVMRZDe/Pn@dej0tjt4XzfS@Zqa7HUwU6dSyjxFPmK3sWJE91kiNW9kRqyrhJeFvKxoMBZcFB4zlXEagAfFzbuIKSxPBVXiYtLpfr3SJnjMTIYBkegiQ6rXEouD7UdKxF6zaFTYF0BsPcxe0pbC3uwEIDI3Re2QeRcz3At@5gtYe3EZZ8j7GDwx/iWYkdnY8PgnBKgvd7NUonw4R/rdh/AA" rel="nofollow noreferrer" title="Python 3.8 – Try It Online">Try it online!</a></strong></p>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 55 bytes</h1>
<pre><code>≔…·¹Ｎθ≔ＥθΦ⁻Ｘθ²ι№θληＵＭθ⟦ι⟧ＦθＦ⁻§η⊖↨ι⁰ι⊞θ⁺ι⟦κ⟧⪫Φθ⁼ＬιＬ§θ±¹¶
</code></pre>
<p><a href="https://tio.run/##NU87T8MwEN75FVans2Qk6MLAVAqVgmgVsZYOJjliq8658aPw7805hMHy6bvvdZ3RofPalbKJ0Q4EDXUuR3vFd00Dwr0SDV1yOuTxEwNIqcQkH28W8l5fYFJiZ13i5d5SjtD6b54ZXTPX8tv6TKkCTla5YTnrtn4cNfUVP9oTY18@CJikmP8/q01qqMcfMEo8YxdwRErYw5OOCFaJu9nPSinaHE11arl63RzPJ8mWbbCc/OotwVKROS9T1i7CG9KQDNSCy/ifxpwDDjrx8VLOEasPWrFfKeuHcnt1vw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Program was originally more efficient but I slowed it down slightly in the name of code golf, but not so much that it can't easily solve <code>n=27</code> on TIO. Explanation:</p>
<pre><code>≔…·¹Ｎθ
</code></pre>
<p>Make a range from <code>1</code> to <code>n</code>.</p>
<pre><code>≔ＥθΦ⁻Ｘθ²ι№θλη
</code></pre>
<p>For each element of that range, make a list of all valid adjacent numbers.</p>
<pre><code>ＵＭθ⟦ι⟧
</code></pre>
<p>Wrap each element of that range in a list so that it can be the first element of a potential permutation.</p>
<pre><code>Ｆθ
</code></pre>
<p>Loop over all potential permutations.</p>
<pre><code>Ｆ⁻§η⊖↨ι⁰ι
</code></pre>
<p>Loop over all remaining next valid adjacent numbers.</p>
<pre><code>⊞θ⁺ι⟦κ⟧
</code></pre>
<p>Add the new permutation to the list.</p>
<pre><code>⪫Φθ⁼ＬιＬ§θ±¹¶
</code></pre>
<p>Output all permutations of maximal length.</p>
</div>
<div id="pu8" class="pu"><h1>Python3, 238 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>def f(k):
 q=[([i],{*range(1,k+1)}-{i})for i in range(1,k+1)]
 D={}
 while q:
  s,r=q.pop(0)
  if len(s)&gt;1:D[len(s)]=D.get(len(s),[])+[s]
  for i in range(1,int((2*k)**0.5)+1):
   if(K:=i**2-s[-1])in r:q+=[(s+[K],r-{K})]
 return D[max(D)]
</code></pre>
<p><a href="https://tio.run/##ZY5BasMwEEXX9SlmOSPLJnZoKAZlpZ2PILQIVEqEU1mWHNpifHZXJpvS7uYz/Pd@@J5voz@@hbht78aCxYG6AiahUDnNFxYv/mqw4UPZ0FotbiU7RnDgPPx@6QKkWNYCPm/ubmDKDEg8iqkOY8AD5egs3I3HROemk@p5aiHrq5nxmbjSVKqUWfBP4vyM2LKBGDvUr5SVuyJDse@EY6ytkqoaTXulm8q8P5Wq1zxWS7/u86KZH9GDVB@XL5Sktz@KI29PmfkS4q6y6Ii2Hw" rel="nofollow noreferrer">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/265349/">265349</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




