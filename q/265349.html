<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::265349</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>127</td><td>Python 3.8</td><td>230919T000629Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265356#265356">Jonathan</a></td></tr>
<tr d-ix="1"><td>137</td><td>JavaScript ES7</td><td>230918T221756Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265350#265350">Arnauld</a></td></tr>
<tr d-ix="2"><td>055</td><td>Charcoal</td><td>230918T225825Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265352#265352">Neil</a></td></tr>
<tr d-ix="3"><td>238</td><td>Python3</td><td>230918T225252Z</td><td><a href="https://codegolf.stackexchange.com/questions/265349/find-the-longest-permutations-of-integers-from-1-k-such-that-all-neighbouring-p/265351#265351">Ajax1234</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8</a>, 127 bytes</h1>

<pre class="lang-python prettyprint-override"><code>f=lambda k,p=0:(r:=range(1,k+1))and(c:=[l+[v]for l in p or[[i]for i in r]for v in r if(l[-1]+v)**.5%1==(v in l)])and f(k,c)or p
</code></pre>
<p><strong><a href="https://tio.run/##XY1BCsIwEEX3nmIQhIyt0ipCCUS8R@ii1kRDYhqjFkR69tqkVMRZDe/Pn@dej0tjt4XzfS@Zqa7HUwU6dSyjxFPmK3sWJE91kiNW9kRqyrhJeFvKxoMBZcFB4zlXEagAfFzbuIKSxPBVXiYtLpfr3SJnjMTIYBkegiQ6rXEouD7UdKxF6zaFTYF0BsPcxe0pbC3uwEIDI3Re2QeRcz3At@5gtYe3EZZ8j7GDwx/iWYkdnY8PgnBKgvd7NUonw4R/rdh/AA" rel="nofollow noreferrer" title="Python 3.8 – Try It Online">Try it online!</a></strong></p>
</div>
<div id="pu1" class="pu"><h1>JavaScript (ES7), 137 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(n,k=n)=&gt;(P=(a,...p)=&gt;o=p[a.map(v=&gt;(++v+p[0])**.5%1||P(a.filter(x=&gt;v+~x),v,...p)),k]?[...o,p]:o)([...Array(n).keys(o=[])])+o?o:f(n,k-1)
</code></pre>
<p><a href="https://tio.run/##JY1BT8MwDIXv/Ipo0iR7aSMGQkgb6cSVA0ziWHqIRtqVljhKqrKKwV8vzji9Z3/v2R9mNPEQWj/kjt7tPNcaXNZph7qAvQaTKaU8D6R9adSn8TAykXKUvryucLVSd8v1@bwHo@q2H2yAky5G@XvCbPzvYtZVu5ItZb7aEELyjyGYCRyqzk4RSJcVVihpR5s6/c/XONcUoLeDcEKL2y3LgxY392ykRPF9JUSCwUbG3MEtbw7kIvVW9dTAIvUWQnJRsubFZeC86q1rhuNla1z8siG@ucSeXl@eVRxC65q2noCjmEIM@fjP/Ac" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>f = (                 // f is a recursive function taking:
  n,                  //   n = input
  k = n               //   k = target length (+1)
) =&gt; (                //
  P =                 // P is a recursive function taking:
      (a,             //   a[] = source array
          ...p) =&gt;    //   p[] = permutation of a[]
  o = p[              //
    a.map(v =&gt;        // for each value v in a[]:
      (++v + p[0])    //   increment v; abort if v + p[0] ...
      ** .5 % 1 ||    //   ... is not a perfect square
      P(              //   otherwise, do a recursive call to P:
        a.filter(x =&gt; //     pass a copy of a[] ...
          v + ~x      //     ... where v is removed
        ),            //
        v, ...p       //     insert v at the beginning of p[]
      )               //   end of recursive call
    ),                // end of map()
    k                 // test p[k]
  ] ?                 // if it's defined:
    [...o, p]         //   append p[] to o[]
  :                   // else:
    o                 //   leave o[] unchanged
)([...Array(n).keys(  // initial call to P with a[] = [0..n-1]
  o = []              // and o[] initialized to an empty array
)]) + o ?             // if o[] is non-empty:
  o                   //   return it
:                     // else:
  f(n, k - 1)         //   try again with k - 1
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 55 bytes</h1>
<pre><code>≔…·¹Ｎθ≔ＥθΦ⁻Ｘθ²ι№θληＵＭθ⟦ι⟧ＦθＦ⁻§η⊖↨ι⁰ι⊞θ⁺ι⟦κ⟧⪫Φθ⁼ＬιＬ§θ±¹¶
</code></pre>
<p><a href="https://tio.run/##NU87T8MwEN75FVans2Qk6MLAVAqVgmgVsZYOJjliq8658aPw7805hMHy6bvvdZ3RofPalbKJ0Q4EDXUuR3vFd00Dwr0SDV1yOuTxEwNIqcQkH28W8l5fYFJiZ13i5d5SjtD6b54ZXTPX8tv6TKkCTla5YTnrtn4cNfUVP9oTY18@CJikmP8/q01qqMcfMEo8YxdwRErYw5OOCFaJu9nPSinaHE11arl63RzPJ8mWbbCc/OotwVKROS9T1i7CG9KQDNSCy/ifxpwDDjrx8VLOEasPWrFfKeuHcnt1vw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Program was originally more efficient but I slowed it down slightly in the name of code golf, but not so much that it can't easily solve <code>n=27</code> on TIO. Explanation:</p>
<pre><code>≔…·¹Ｎθ
</code></pre>
<p>Make a range from <code>1</code> to <code>n</code>.</p>
<pre><code>≔ＥθΦ⁻Ｘθ²ι№θλη
</code></pre>
<p>For each element of that range, make a list of all valid adjacent numbers.</p>
<pre><code>ＵＭθ⟦ι⟧
</code></pre>
<p>Wrap each element of that range in a list so that it can be the first element of a potential permutation.</p>
<pre><code>Ｆθ
</code></pre>
<p>Loop over all potential permutations.</p>
<pre><code>Ｆ⁻§η⊖↨ι⁰ι
</code></pre>
<p>Loop over all remaining next valid adjacent numbers.</p>
<pre><code>⊞θ⁺ι⟦κ⟧
</code></pre>
<p>Add the new permutation to the list.</p>
<pre><code>⪫Φθ⁼ＬιＬ§θ±¹¶
</code></pre>
<p>Output all permutations of maximal length.</p>
</div>
<div id="pu3" class="pu"><h1>Python3, 238 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>def f(k):
 q=[([i],{*range(1,k+1)}-{i})for i in range(1,k+1)]
 D={}
 while q:
  s,r=q.pop(0)
  if len(s)&gt;1:D[len(s)]=D.get(len(s),[])+[s]
  for i in range(1,int((2*k)**0.5)+1):
   if(K:=i**2-s[-1])in r:q+=[(s+[K],r-{K})]
 return D[max(D)]
</code></pre>
<p><a href="https://tio.run/##ZY5BasMwEEXX9SlmOSPLJnZoKAZlpZ2PILQIVEqEU1mWHNpifHZXJpvS7uYz/Pd@@J5voz@@hbht78aCxYG6AiahUDnNFxYv/mqw4UPZ0FotbiU7RnDgPPx@6QKkWNYCPm/ubmDKDEg8iqkOY8AD5egs3I3HROemk@p5aiHrq5nxmbjSVKqUWfBP4vyM2LKBGDvUr5SVuyJDse@EY6ytkqoaTXulm8q8P5Wq1zxWS7/u86KZH9GDVB@XL5Sktz@KI29PmfkS4q6y6Ii2Hw" rel="nofollow noreferrer">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/265349/">265349</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




