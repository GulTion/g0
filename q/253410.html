<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::253410</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>212</td><td>Java 10</td><td>221019T131110Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253443#253443">Kevin Cr</a></td></tr>
<tr d-ix="1"><td>122</td><td>Raku</td><td>221020T184826Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253508#253508">Sean</a></td></tr>
<tr d-ix="2"><td>091</td><td>Japt</td><td>221020T184248Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253507#253507">Kamil Dr</a></td></tr>
<tr d-ix="3"><td>030</td><td>Jelly</td><td>221019T233821Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253472#253472">Jonathan</a></td></tr>
<tr d-ix="4"><td>8271</td><td>J</td><td>221020T030951Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253480#253480">Jonah</a></td></tr>
<tr d-ix="5"><td>157</td><td>JavaScript ES6</td><td>221018T231955Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253415#253415">Arnauld</a></td></tr>
<tr d-ix="6"><td>070</td><td>Charcoal</td><td>221019T071625Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253434#253434">Neil</a></td></tr>
<tr d-ix="7"><td>301</td><td>Python3</td><td>221018T235413Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253417#253417">Ajax1234</a></td></tr>
<tr d-ix="8"><td>256</td><td>C gcc</td><td>221018T235036Z</td><td><a href="https://codegolf.stackexchange.com/questions/253410/a-pieceful-standoff/253416#253416">matteo_c</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Java 10, <s>248</s> <s>246</s> <s>241</s> <s>239</s> <s>237</s> <s>219</s> <s>217</s> 212 bytes</h1>

<pre class="lang-java prettyprint-override"><code>b-&gt;{boolean r=1&gt;1,B;for(int m[]=new int[64],f=128,i,d,X,Y;f--&gt;0;)for(d=9;b[i=f%64]&amp;d--&gt;0;m[i]+=B&amp;&amp;b[Y+=X*8]?f/64:0,r|=f&lt;64&amp;B&amp;&amp;m[i]!=m[Y])for(X=i/8,Y=f%8;(B=~(X+=d/3-1)%9&lt;0&amp;~(Y+=d%3-1)%9&lt;0)&amp;&amp;!b[X*8+Y];);return!r;}
</code></pre>
<p>Inspired by <a href="https://codegolf.stackexchange.com/a/253415/52210"><em>@Arnauld</em>'s JavaScript answer</a>.<br />
-25 bytes thanks to <em>@ceilingcat</em>.</p>
<p>Input as a flat boolean-array.</p>
<p><a href="https://tio.run/##7Vhdb9owFH3nVxgkoqRJCGwIpRhTiYdJe1inqXsgsvKQz80dOMhxOlUs/evM@YChtZkY0A665CGKc5zje65PnPjeOneOfut/W3kzJ47BB4fQZQMAQnnAQscLwHXWBMCNolngUODJ5RW2XQUKKG2IU8wdTjxwDShaufp4ue7NUG/c0yYwjJgsKMEc24gG3zN6POjbWoh6b0yNaL421SwY6vq4C5Wss48uoYsJCtuim@TnwBwTW0UTSXKxpaLphWlfhcagP@xq7AcKR4O@JLCsUxPNsWXnPFNEDFOzBI8J5Ql6kKcq8o23ek9pX4660oMsmPz2uq1IUtPFglm1bKhAFvCE0SaD6QpmKheJOxMqS7F3EfHBXORLvuGM0C/YdpQiV4YB3jmzOLgf5k0exFzOVG8ytwwzWNv9nPM8cTwfD@AsOaV4DuHZ1vJY1/ad3XmeW1c@Vpq/YS/goKoMPVZ8XjP/3/OsHSSWpM8s4V/PeUmqeU7IULWDjsZT9VmpHVT/zvzr35DaQcfjKebtNTmxdtBpbGFe69bsPB20@/pc9DyFr8bum@B6Dari@ct5f2EH/bnwsZ@Dqt7e/eI51owdouuQ8tDhed7LQdsF2LwmmRtqYyZA6CLhZWXy5j7mwbwTJbyzYITyGZVb7zN8CFqlHdelWg91oTcyoaeq5cO/MCYwJjAmsI2W37nlfGDsXZgqs69an1rDVmc9yJORlFhaGenHhBehAhXQjlcMoJSPVRGmjXT1Ew" rel="nofollow noreferrer">Try it online.</a></p>
<p><strong>Explanation:</strong></p>
<pre class="lang-java prettyprint-override"><code>b-&gt;{                       // Method with boolean-array parameter &amp; boolean return
  boolean r=0&gt;1,           //  Result-boolean, starting at false
          B;               //  Flag whether we're still in boundary
  for(int m[]=new int[64], //  Array to keep track of queen's thread levels
      f=128,               //  Flag-integer
      i,                   //  Index-integer
      d,                   //  Direction-integer
      X,Y;                 //  X,Y-coordinate integers of a taken direction of a queen
      f--&gt;0;)              //  Loop `f` in the range (128,0]:
    for(d=9;b[i=f%64       //   Set `i` to `f` modulo-64
                    ]&amp;     //   If the `i`'th cell contains a queen:
             d--&gt;0         //    Inner loop `d` in the range (9,0]:
        ;                  //      After every iteration of loop `d`:
         m[i]+=            //       Increase the current `i`'th threat value by:
          B                //        If we're still in bounds,
          &amp;&amp;b[Y+=X*8]?     //        and `X,Y` contains a threatening† queen:
           f/64            //         Increase it by `f` integer-divided by 64
                           //         (1 in the first 64 iterations, 0 in the second 64)
          :                //        Else:
           0,              //         Leave it unchanged by increasing with 0
         r|=               //        Also update the result to:
            f&lt;64           //         If this is within the first 64 iterations
            &amp;B             //         And we're still in bounds:
            &amp;&amp;m[i]!=m[Y])  //          Check whether the `i` and `X,Y` threat-levels
                           //          are NOT the same
      for(X=i/8,Y=f%8;     //     (Re)set `X,Y` based on `i` and `f`
          (B=~(X+=d/3-1)   //     Go to the next `X`-coordinate based on `d`
               %9&lt;0        //     And check if it's still in bounds
          &amp;~(Y+=d%3-1)%9&lt;0)//     Do the same for the `Y`-coordinate
          &amp;&amp;               //     And if we're still in bound:
            !b[X*8+Y];);   //      Stop the inner-most loop if we've encountered a
                           //      threatening† queen
  return!r;}               //  Finally: return the inverse of result `r`
</code></pre>
<p><em>†</em>: Because we don't skip direction <code>d=4</code> (which means <code>x,y==X,Y</code>), every queen will have a tread-level one higher than in the challenge description, because it'll increase for its own position (a.k.a. every queen 'threatens' itself). But since this is done for <em>each</em> individual queen, it won't matter for the final output.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://raku.org/" rel="nofollow noreferrer">Raku</a>, 122 bytes</h1>
<pre><code>{my%x=@^q.map:{$^q=&gt;map {first(@q.any,($q,*+$^d...*)[1..7])//|()},((-1,0,1)X+(-i,0,i))};[&amp;&amp;] %x{*}.map:{[==] @^v,|%x{@v}}}
</code></pre>
<p><a href="https://tio.run/##bVBdj4IwEHz3V2yMSmtLBRS4nAfhL9ybCYGEi5A0OVTwIxjsb@e6FN/uoZPNzOzsdi9l@xsM9RNWFURDXz@XXZTkjaiLy2e/yJso1hX0lWyvN5I0ojg9OVk0fM0W@VEIsaapK0SY0c3mRajihNgud7hLD4zYUleSUrVPV6sMll2/ViY4jaIMkvzBX5pMHkqpoTq38OUyV4LLPAlbA76EAKuQOTLmaAiQ1uBr0Ayh@vlsKzkd5a2R0ethN0aYRg@TJ2aMR9rRueCwECeEZoxxBVPf/4Z3lvfeZPSbVX38g4cw/sFjOwk7VHHLGOwYkuZelqcr9DMAffnk51y0R4ggtYQFXQcf2Yh7LRstDcEGIessFW2Zaaf1bQEebEpCp7jcbyP3Mj0cKjLJ@jLz@X6mZsMf" rel="nofollow noreferrer" title="Perl 6 – Try It Online">Try it online!</a></p>
<p>Input is a list of complex numbers, the queen coordinates.</p>
<ul>
<li><code>my %x = @^q.map: { $^q =&gt; ... }</code> generates a hash from each queen to a list of the other queens that it threatens, storing it in the variable <code>%x</code>.</li>
<li><code>(-1, 0, 1) X+ (-i, 0, i)</code> crosses the real numbers -1, 0, and 1 with the complex numbers -i, 0, and i with addition, producing the nine complex numbers -1-i, -1, -1+i, -i, 0, i, 1-i, 1, and 1+i.  These are the steps that will be followed from each queen, looking for another queen that it threatens.  For brevity, we don't omit the step 0, so each queen will count as attacking itself.  That doesn't change the final boolean answer.</li>
<li><code>first(@q.any, ($q, * + $^d ... *)[1..7]) // |()</code> takes up to seven steps from each queen, stopping when it encounters one of the other queens.  <code>first</code> returns <code>Nil</code> if it doesn't find anything, so the <code>// |()</code> converts that into a Slip object, which doesn't leave anything in the output list.</li>
<li><code>[&amp;&amp;] %x{*}.map: { [==] @^v, |%x{@v} }</code> checks that each hash value <code>@^v</code> (that is, each list of threatened queens) satisfies the condition that its size is equal to the sizes of every other list of queens threatened by those queens.</li>
</ul>
</div>
<div id="pu2" class="pu"><h1><a href="https://github.com/ETHproductions/japt" rel="nofollow noreferrer">Japt</a>, 91 <a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>Jõ ïJõ
@VmA{8õ@Am*XÃ®íX'+Ãfe_&gt;J©Z&lt;8Ã£g$...$X
U=Ë£X©[EY]gW md x
Ëe@!Xª[EY]gW me_¥XªZ¥0Ãe}Ãe
</code></pre>
<p><a href="https://petershaggynoble.github.io/Japt-Interpreter/?v=1.4.6&amp;code=Ckr1IO9K9QpAVm1Bezj1QEFtKljDru1YJyvDZmVfPkqpWjw4w6NnJC4uLiRYClU9y6NYqVtFWV1nVyBtZCB4CstlQCFYqltFWV1nVyBtZV%2blWKpapTDDZX3DZQ&amp;input=WwpbMSwwLDAsMCwwLDAsMCwxXQpbMCwwLDAsMCwwLDAsMCwwXQpbMCwwLDAsMCwwLDAsMCwwXQpbMCwwLDAsMCwwLDAsMCwwXQpbMCwwLDAsMCwwLDAsMCwwXQpbMCwwLDAsMCwwLDAsMCwwXQpbMCwwLDAsMCwwLDAsMCwwXQpbMSwwLDAsMCwwLDAsMCwxXQpdLVE" rel="nofollow noreferrer">Try it</a></p>
<p>Note that there should be an additional empty line in front of the code, but it's not displaying here. Takes input as a 2D array with Queens as <code>1</code> and empty spaces as <code>0</code>.</p>
<p>This is probably the worst Japt code I've ever written and I am certain there are a lot of improvements to make.</p>
<h3>Explanation</h3>
<p>The first line is blank, because Japt automatically stores the result of each line in a variable. If the first line is not blank then its result would overwrite the input</p>
<pre><code>            # Implicitly store input as U
</code></pre>
<p>The second line generates the 8 direction vectors a queen can move in, as well as <code>[0,0]</code> i.e. &quot;not moving&quot; which is unnecessary but ends up not mattering</p>
<pre><code>Jõ ïJõ
Jõ     # The range [-1...1]
   ï   # Get every possible pair with:
    Jõ #  The range [-1...1] again
       # Store as V
</code></pre>
<p>The third line does the bulk of the work here. It declares a function which takes a pair of coordinates as input, and returns an array indicating the cells in U which are in each of the 9 &quot;directions&quot; relative to those coordinates.</p>
<pre><code>@VmA{8õ@Am*XÃ®íX'+Ãfe_&gt;J©Z&lt;8Ã£g$...$X
@                                     # Declare a function:
 VmA{             Ã                   #  For each direction:
     8õ@Am*XÃ®íX'+                    #  (Get the coordinates for 8 cells in that direction) 
     8õ@    Ã                         #   For each value X in the range [1...8]
        Am*X                          #    Multiply the direction vector by X
             ®                        #   For each resulting pair:
              íX'+                    #    Add the input coordinates
                   fe_&gt;J©Z&lt;8Ã         #  (Remove out-of-bounds coordinates)
                   f                  #   Keep only coordinates which where:
                    e_      Ã         #    Both parts:
                      &gt;J              #     Are greater than -1
                        ©             #     And
                         Z&lt;8          #     Are less than 8
                             £g$...$X #  (Get the values from U at those coordinates)
                             £        #   For each remaining coordinates X:
                              g       #    Get the value from U at:
                               $...$X #     Multi-dimensional coordinates X
</code></pre>
<p>The fourth line calls V on every pair of coordinates that has a queen, counts the number of directions which see another queen, then saves that count back in the same cell of U. Technically the number saved is 1 higher than the threat number since one of the directions is &quot;don't move&quot; but it doesn't affect anything.</p>
<pre><code>U=Ë£X©[EY]gW md x
  Ë£              # For every cell X in U:
    X©            #  Return 0 if X is 0
      [EY]gW      #  Otherwise call W on the coordinates of X
             m    #  For each direction:
              d   #   True if there are any queens
                x #  Count the number of true directions
U=                # Save the results back into U
</code></pre>
<p>The fifth line uses W again to get the sightlines, then checks that every cell's sightlines only contain empty spaces and other queens with the same threat number.</p>
<pre><code>Ëe@!Xª[EY]gW me_¥XªZ¥0Ãe}Ãe
Ë                        Ã  # For every row D of U:
 e@                     }   #  True if every cell X in that row returns true:
   !Xª                      #   Return true if X is 0
      [EY]gW                #   Otherwise call W on the coordinates of X
             m              #   For each direction:
              e_      Ã     #    True if every cell Z in that direction returns true: 
                ¥X          #     Z == X
                  ª         #     Or
                   Z¥0      #     Z == 0
                       e    #   Return true if every direction returned true
                          e # Output true if every row returned true
</code></pre>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 30 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<p>-4 thanks to <a href="https://codegolf.stackexchange.com/users/52210/kevin-cruijssen">Kevin Cruijssen</a> (remove an effectively redundant filter of the &quot;direction&quot; <code>[0,0]</code>, which also means there's no need to get the threatening queen separately.)</p>
<pre><code>+8RĖ×Ɱ2Ż’p`¤¤f€ZḢ
ŒṪç€iƇẈEɗⱮ$Ạ
</code></pre>
<p>A monadic Link that accepts a list of lists of <code>1</code>s (queens) and <code>0</code>s (not queens) that yields <code>1</code> if there is a peaceful standoff or <code>0</code> if not.</p>
<p><strong><a href="https://tio.run/##y0rNyan8/1/bIujItMPTH21cZ3R096OGmQUJh5YcWpL2qGlN1MMdi7iOTnq4c9Xh5UBu5rH2h7s6XE@ClKo83LXg////0dEGOigwlksHm5AhNlWG2DQaYmo0xGe8IbqQIUhVLAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> Or see the <a href="https://tio.run/##y0rNyan8/1/bIujItMPTH21cZ3R096OGmQUJh5YcWpL2qGlN1MMdi7iOTnq4c9Xh5UBu5rH2h7s6XE@ClKo83LXg/8PdWx7u2ASUcQNi/4c7mg63cx2d/HDn4keN@w5tO7TtcDtQ/P9/PQUUyIWdH0hAHpkfCFcfCOfjUh/IhceAQCItpIxPcwvo5oBA6jqA1DincQgEkuQgqjsgkOxcQJQDAtGyBb4gDqSCj9Htw@qAQEQ64ELmBcKjBJsFgTjKAVTz0OwDAA" rel="nofollow noreferrer" title="Jelly – Try It Online">test-suite</a>.</p>
<h3>How?</h3>
<pre><code>+8RĖ×Ɱ2Ż’p`¤¤f€ZḢ - Helper Link = get queen &amp; threatened queens(
                      queen coordinate, Q;
                      all queen coordinates, A
                    ):
            ¤     - nilad followed by links as a nilad:
 8                -   eight
  R               -   range -&gt; [1,...,7,8]
   Ė              -   enumerate -&gt; [[1,1],...,[7,7],[8,8]]
           ¤      -   nilad followed by links as a nilad:
      2           -     two
       Ż          -     zero-range -&gt; [0,1,2]
        ’         -     decrement -&gt; [-1,0,1]
          `       -     use as both arguments of:
         p        -       Cartesian product -&gt; [[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]]
     Ɱ            -   map with:
    ×             -     multiply -&gt; [[[-1,-1],...,[-7,-7],[-8,-8]],[[-1,0],...,[-7,0],[-8,0]],[[-1,1],...,[-7,7],[-8,8]], ... ... ... ,[[1,1],...,[7,7],[8,8]]]
+                 - (Q) add (vectorises) -&gt; nine lists of potential locations in
                                            each of the eight lines of sight
                                            in proximity order plus the direction
                                            [0,0] which will all be Q
                                            (includes off-board locations)
             f€   - for each: filter keep (A) -&gt; nine lists (eight are possibly empty)
               Z  - transpose
                Ḣ - head -&gt; list of threatened queens and Q herself.

ŒṪç€iƇẈEɗⱮ$Ạ - Link = is peaceful?(board):
ŒṪ           - truthy multidimensional indices -&gt; all queen coordinates
          $  - last two links as a monad - f(all queens):
  ç€         -   call the Helper link for each queen with all queens on the right
         Ɱ   -   map (across Q in all queens) with:
        ɗ    -     last three links as a dyad - f(Helper results, Q):
     Ƈ       -       keep those for which:
    i        -         first 1-indexed index of Q or 0 if not found
      Ẉ      -       length of each
       E     -       all equal?
           Ạ - all?
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="http://jsoftware.com/" rel="nofollow noreferrer">J</a>, <sup>82</sup> 71 bytes</h1>
<pre><code>[:(-:|:)@(*+/)@(=[:+/@(*]=&amp;|[:&lt;./&quot;1|+_*0&amp;=)]*&quot;2(%|)=/~(%|)@1j1^i.@8)-/~
</code></pre>
<p><a href="https://tio.run/##tZNdS8MwFIbv8yvOqjZNuybtLsQdDQSEgeDNEe9KHSIrswiCqxdC6V@v7dC66draTQn5eMlJ8vCek7ScjjCMT0c45ZxZkiegETiMIQCsui/h8uZ6Vkbo@JijMI7rqWrUEXqqErG28wgvpLLC3Ju7ga1F7FoT5yQXWhX1ZMI0vHuU5kz4qigFyxarTEuIEBYPy2eT1CvnOJXKHOGVNGMBXPICfWlz4OdyPmGsDgQ@u39avfH1@RouYBK2Woumnv1NTU08NbotnpjoZPm8i3759mFafJh0@/KaLSuX1iqBKqeDDevXtDdkH8vQZB1i2DBfaBDbf7LQ3kU9lIW@FXxXDugPfKCOD7aLhb5qhm0qanK26y1q@ezb9/1gKd8B" rel="nofollow noreferrer" title="J – Try It Online">Try it online!</a></p>
<p>Takes input as a list of complex numbers.</p>
<p>We'll consider this example:</p>
<pre><code>3 . . . . . . 3
. . . . . . . .
. 1 . . . . 1 .
. . . . . . . .
. . . . . . . .
. . . . . . . .
. . . . . . . .
3 . . . . . . 3
</code></pre>
<p>which in complex numbers is <code>0j0 0j7 7j0 7j7 2j1 2j6</code>.</p>
<ul>
<li><p><code>-/~</code> Table of differences:</p>
<pre><code>  0 0j_7   _7 _7j_7 _2j_1 _2j_6
0j7    0 _7j7    _7  _2j6  _2j1
  7 7j_7    0  0j_7  5j_1  5j_6
7j7    7  0j7     0   5j6   5j1
2j1 2j_6 _5j1 _5j_6     0  0j_5
2j6 2j_1 _5j6 _5j_1   0j5     0
</code></pre>
</li>
<li><p><code>(%|)</code> Each of these differences divided by their magnitude, ie, as unit lengths.  Pieces can attack each other only if these normalized vectors are equal to one of the 8 evenly spaced unit vectors:</p>
<p><a href="https://i.stack.imgur.com/925Uk.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/925Uk.png" alt="unit vectors" /></a></p>
</li>
<li><p><code>=/~(%|)@1j1^i.@8</code> So, create a 3d table showing where each of the normalized vectors of the difference table is equal to each of the 8 &quot;compass&quot; unit vectors:</p>
<pre><code>0 0 0 0 0 0
0 0 0 0 0 0
1 0 0 0 0 0   Differences that point E
0 1 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0  NE
1 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

0 0 0 0 0 0
1 0 0 0 0 0
0 0 0 0 0 0  N
0 0 1 0 0 0
0 0 0 0 0 0
0 0 0 0 1 0

0 0 0 0 0 0
0 0 1 0 0 0
0 0 0 0 0 0  NW
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

0 0 1 0 0 0
0 0 0 1 0 0
0 0 0 0 0 0  W
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

0 0 0 1 0 0
0 0 0 0 0 0
0 0 0 0 0 0  SW
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

0 1 0 0 0 0
0 0 0 0 0 0
0 0 0 1 0 0  S
0 0 0 0 0 0
0 0 0 0 0 1
0 0 0 0 0 0

0 0 0 0 0 0
0 0 0 0 0 0
0 1 0 0 0 0  SE
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
</code></pre>
</li>
<li><p><code>]*&quot;2</code> Use these as as filters for the original input:</p>
<pre><code>0    0    0     0   0    0
0    0    0     0   0    0
7    0    0     0   0    0
0    7    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0

0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
7j7  0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0

0    0    0     0   0    0
0j7  0    0     0   0    0
0    0    0     0   0    0
0    0  0j7     0   0    0
0    0    0     0   0    0
0    0    0     0 0j5    0

0    0    0     0   0    0
0    0 _7j7     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0

0    0   _7     0   0    0
0    0    0    _7   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0

0    0    0 _7j_7   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0

0 0j_7    0     0   0    0
0    0    0     0   0    0
0    0    0  0j_7   0    0
0    0    0     0   0    0
0    0    0     0   0 0j_5
0    0    0     0   0    0

0    0    0     0   0    0
0    0    0     0   0    0
0 7j_7    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
0    0    0     0   0    0
</code></pre>
</li>
<li><p>The problem now is that only the shortest positive distance in each
direction counts, because the others are blocked by the first piece. The
next series of steps filters these blocked pieces.</p>
</li>
<li><p><code>(=[:+/@(*]=&amp;|[:&lt;./&quot;1|+_*0&amp;=)</code> Ignoring zeros, take the min of each row (using norm for comparison), and keep only entries equal to that min.  These are attackable queens. Then sum the planes, which are guaranteed not to overlap, and check where those equal the normalized differences.  This is adjanceny matrix of connected queens:</p>
<pre><code>1 1 0 0 1 1
1 1 0 0 1 1
0 0 1 1 0 0
0 0 1 1 0 0
1 1 0 0 1 1
1 1 0 0 1 1
</code></pre>
</li>
<li><p><code>(-:|:)@(*+/)@</code> Multiply the rows by the column sums, and check if the matrix is symmetric around the main diagonal:</p>
<pre><code>4 4 0 0 4 4
4 4 0 0 4 4
0 0 2 2 0 0
0 0 2 2 0 0
4 4 0 0 4 4
4 4 0 0 4 4
</code></pre>
</li>
</ul>
</div>
<div id="pu5" class="pu"><h1>JavaScript (ES6), 157 bytes</h1>
<p>Expects a binary matrix. Returns an inverted Boolean value.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;(F=p=&gt;m.some((r,y)=&gt;r.some((v,x)=&gt;!p*([s=0,...&quot;1235678&quot;].map(d=&gt;(g=X=&gt;((X+=d%3-1)|(Y+=~-(d/3)))&amp;8?0:v*(V=m[Y][X])?s+=p|V!=v:g(X))(x,Y=y)),r[x]=s))))(F(1))
</code></pre>
<p><a href="https://tio.run/##vVTbTgIxEH3frygkygwsFSQqwQw8yXtDQiDAw2a34Jq92a4EIvrr62IItwCCgmnS5kzPzDm9vlhjS9vKjeJiEDoyGVLiUx2aFFHd5zr0JYAyp0h1tUBjc5KiTJSHnqaSyTnPlm8rd/cP1eyA@1YETpo/ok7aQ6dAzlWlWMYZdAv0WQTnpoKI19VGqTbOQ5v8XnfQ6wywoQsUzdoZGtdG0EGEidmlKaKpepMB6TQHoQllxETJ1zdXScgNdQ65kpbTdD3ZmgY2lJDHYStWbjAC5Dry3Biy/aAfZJEPQ/Vk2c@gGdXZu8GYJ2PmM2J6RUxpc//flGWYLaL2PFqYD8RyIpcaekyr2GGgQ09yLxzBEPx58AMTzjaasRuLH@bXsVjyxRLv4wvjQAFxpODf8MUF/s2AOK@BU8/8wjsgTjJ0dgPi16/gKANi61kc2mJxhhVv6@00IFb3wFhHYnkkuwTEnn9gs96W3hc" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h2>How?</h2>
<p>This code solves the puzzle in two passes:</p>
<ul>
<li><p>When called with <span class="math-container">\$p=1\$</span>, <span class="math-container">\$F\$</span> computes the number of queens that interact with each queen, updates the matrix accordingly and returns <span class="math-container">\$\text{false}\$</span>.</p>
</li>
<li><p>When called with <span class="math-container">\$p=\text{false}\$</span>, <span class="math-container">\$F\$</span> tests whether at least one queen interacts with a queen that interacts with a different number of queens.</p>
</li>
</ul>
<h2>Commented</h2>
<h3>Main wrapper</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt; F(F(1))         // call F(1), then call F(false)
</code></pre>
<h3>Helper function F</h3>
<pre class="lang-javascript prettyprint-override"><code>F = p =&gt;             // p = pass
m.some((r, y) =&gt;     // for each row r[] at position y in m[]:
  r.some((v, x) =&gt;   //   for each value v at position x in r[]:
    !p * (           //     do not trigger some() during the 1st pass
      [ s = 0,       //     initialize s to 0 and build the list
        ...&quot;1235678&quot; //     [ 0..3, 5..8 ]
      ].map(d =&gt;     //     for each direction d in this list:
        g(x, Y = y)  //       invoke g with (X, Y) = (x, y)
      ),             //     end of map()
      r[x] = s       //     update m[y][x] to s
    )                //
  )                  //   end of inner some()
)                    // end of outer some()
</code></pre>
<h3>Helper function g</h3>
<pre class="lang-javascript prettyprint-override"><code>g = X =&gt;             // X is passed explicitly,
                     // Y is passed implicitly
(                    //
  (X += d % 3 - 1) | // add dx = (d mod 3) - 1 to X
  (Y += ~-(d / 3))   // add dy = floor(d / 3) - 1 to Y
)                    //
&amp; 8 ?                // if the resulting position is out of bounds:
  0                  //   stop the recursion
:                    // else:
  v *                //   force the test to fail if there's no queen
                     //   on the source square
  (V = m[Y][X])      //   let V be the value stored at (X, Y)
  ?                  //   if there's a queen there:
    s +=             //     increment s if:
      p |            //       this is the first pass
      V != v         //       or V is not equal to v
  :                  //   else:
    g(X)             //     keep testing this ray
</code></pre>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 70 bytes</h1>
<pre><code>Ｅ⁸Ｓ≔Ｅ⁸Ｅ⁸⟦⟧ηＦ⁸Ｆ⁸Ｆ⁸«Ｊικ≔⌕ＡＫＤ⁸✳λQθ¿∧№θ⁰⌈θ«Ｍ§θ¹✳λ⊞§§ηⅈⅉ§§ηικ»»⎚⬤η⬤ι⬤λ⁼ＬνＬλ
</code></pre>
<p><a href="https://tio.run/##bVDLasMwEDxbXyFyWoFq2lsgJ5O2kNKATXtoKT0YW7FFZMkvhUDJt7u7fjQQKqQdaWd2tFJWpm3mUjMMcattD/u0hrXkO1v7/q3HVAFCiA2Luk4XdqFn@PoWQvIS6YNrOawFv8UfFrz4qn53oCU/ojCYjZ61zSNjIFbq@KhblfXaWfK8HgyZr5IVxoYq9YFDZHPYOo@NNpLfC@rkrCtfQYNd0m3B3p0URP3O5upMogdx44lOQey78k@0YCn5B9Cdn2P8h9aCHkEOF3ZhW6PSFvA0/Ry9BjUEegIj@VPjU9PBq7JFX4LF@nmLjdDYDEMSjiNhuMbJJkzCKRNSZlRM1EhexUv5cHcyvw" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Takes input as a list of 8 strings of 8 <code>Q</code>s and <code>.</code>s. Explanation:</p>
<pre><code>Ｅ⁸Ｓ
</code></pre>
<p>Input the board and print it to the canvas.</p>
<pre><code>≔Ｅ⁸Ｅ⁸⟦⟧η
</code></pre>
<p>Start with no Queens being attacked.</p>
<pre><code>Ｆ⁸Ｆ⁸Ｆ⁸«
</code></pre>
<p>Loop over each possible direction for each possible Queen.</p>
<pre><code>Ｊικ≔⌕ＡＫＤ⁸✳λQθ
</code></pre>
<p>Look at the pieces at the current position in the current direction.</p>
<pre><code>¿∧№θ⁰⌈θ«
</code></pre>
<p>If there is a Queen at the current position and at least one more Queen in the current direction, then...</p>
<pre><code>Ｍ§θ¹✳λ⊞§§ηⅈⅉ§§ηικ
</code></pre>
<p>... move to the next Queen in the current direction, and add the current Queen to the list of Queens that are attacking it.</p>
<pre><code>»»⎚⬤η⬤ι⬤λ⁼ＬνＬλ
</code></pre>
<p>Check that all lists of Queens have elements of the same length. Example: If there are Queens at a1, a8, h1 and h8, then let the lists at those positions be denoted by <code>a1</code>, <code>a8</code>, <code>h1</code> and <code>h8</code>, then we have <code>a1 = [a8, h1, h8]</code>, <code>a8 = [a1, h1, h8]</code>, <code>h1 = [a1, a8, h8]</code> and <code>h8 = [a1, a8, h1]</code>; each list <code>a1</code>, <code>h8</code>, <code>h1</code> and <code>h8</code> contains three elements and those three elements are also all lists of three elements. (Conveniently this is also vacuously true for the squares that don't contain Queens and are therefore empty lists.)</p>
</div>
<div id="pu7" class="pu"><h1>Python3, 301 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>lambda b:all(all(len([*t(b,x,y)])==len([*t(b,X,Y)])for X,Y in t(b,x,y))for x in R(8)for y in R(8)if b[x][y])
R=range
def t(b,x,y):
 q=[(x,y,X,Y)for X in[-1,0,1]for Y in[-1,0,1]if X or Y]
 while q:
  x,y,X,Y=q.pop(0)
  A,B=x+X,y+Y
  if 0&lt;=A&lt;8 and 0&lt;=B&lt;8:
   if b[A][B]:yield(A,B)
   else:q+=[(A,B,X,Y)]
</code></pre>
<p><a href="https://tio.run/##tZTRTsIwFIav7VOccEMrk4CITkIv4AFM6hVkLmbLOq2p3ZgzsqfHtsCApCCIZlnS/2vP6b/T9eRV@Zqpnp8Xi5Q@LWT0HicRxINISmxeyRUOLksce3OvIiGhdEMm3lSTNCtAj0AoWC@zbG7II/atqNZCpBAH8zCoQoIeaRGpF44SntahAwQzGmA9tOltch0bXHW9jtcNjZ5uaZ1uAoaFCL5eheQw0xlgFU5n7TzLcYdoNPLGdN6aeFVrqpWO6wzpaOhDpBIzHA99EwjW3ygMxuGgElwmWMeZcODygw9mLe1Nk@WnL@IuUGg0Gm3YeZBbsx/mtzWr17Na71vPtAMUX@@zsk7Fjtz6LG2t9E6pyv9auflbK@wMK/1DVk79N86ryu3xVWEnWTtNWy93x3phv75Cx5bFX1phu7fr4AmwPygDc9zm@/1W2OaHQduK1Sfm2ortaSy7@RxWbHPOnuMsKhKc6P58UfDys1AQBG@UNlnTtOQ3095F@yOXosTEdmlhUCpkyQv8kCnuQbKabz6pJiEhQnkhVIlTXKePu4QQB752454b37hx341v3fjOjX03vtd48Q0" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, 256 bytes</h1>

<pre class="lang-c prettyprint-override"><code>#define A(c)for(i=0;i&lt;64;++i)for(m=j=0;j&lt;64;++j)if(j-i&amp;&amp;b[i]&gt;0&amp;b[j]&gt;0){x=i/8-j/8,y=i%8-j%8;t=0;x||(t=(y&gt;0)+1);y||(t=(x&gt;0)*4+4);abs(x)-abs(y)||(t=16&lt;&lt;((x&gt;0)+(y&gt;0)*2));if(t&amp;&amp;!(m&amp;t)){c;}}
f(b,i,j,m,t,y,x)int*b;{A(b[i]++;m|=t)A(if(b[i]-b[j])return 0)return 1;}
</code></pre>
<p><a href="https://tio.run/##1ZVRb4IwEMef4VPcXCQ9W6IsxpjULvFzOB8EZWkTcGFdAkE@Ozswe9lcJm46TS659uj/7n5tgch/jqK6vl9vYp1uYM4ijLcZ02ok9WwylpzrNpAoQyGzDxnUMTO@9rxwoZePI3KGHJa50sOpb4ZTUSjdp1F/Ki3p8t2OWcUKWsMDlMV@mtN0MOZjlKvwleXoN67A9mEwmc1Yu4K3ssEDoqSq1vPuWOJZxDKSVeXGLBRaGJEIKwqRo07tIJTlnDWdcS6TnbI4Z6RsAn7TKGYb@5alMPoYBLKqSQfJSqcMS9d1Stdxmki4XWXrxRIUlH4gTjM4VfgpA3xJCB0yVJKQXjKCilmvv4antCeANqUBpJ11naorNRzq7crs76lvwW6AGm6HGq4R9n/OGq7lTb8cNZznG35Jauh@J@FyF/iHKnAe6oP/UPj@sKBL83B0iV9Ru5VbvwM" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/253410/">253410</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




