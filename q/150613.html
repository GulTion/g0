<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::150613</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>476</td><td>Python 3 and my dronery library</td><td>230828T132609Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/264701#264701">DroneBet</a></td></tr>
<tr d-ix="1"><td>048</td><td>CJam</td><td>181129T113438Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/176789#176789">Peter Ta</a></td></tr>
<tr d-ix="2"><td>222</td><td>Haskell</td><td>171216T041826Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150769#150769">ბიმო</a></td></tr>
<tr d-ix="3"><td>004</td><td>MATL</td><td>171214T175800Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150639#150639">Giuseppe</a></td></tr>
<tr d-ix="4"><td>023</td><td>Python 2 + numpy</td><td>171214T132047Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150620#150620">Mr. Xcod</a></td></tr>
<tr d-ix="5"><td>022</td><td>Mathematica</td><td>171214T125419Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150614#150614">ZaMoC</a></td></tr>
<tr d-ix="6"><td>053</td><td>R</td><td>171214T130614Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150618#150618">Giuseppe</a></td></tr>
<tr d-ix="7"><td>003</td><td>SageMath</td><td>171214T130439Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150617#150617">Uriel</a></td></tr>
<tr d-ix="8"><td>004</td><td>Octave</td><td>171214T125959Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150615#150615">flawr</a></td></tr>
<tr d-ix="9"><td>008</td><td>Pari/GP</td><td>171214T130152Z</td><td><a href="https://codegolf.stackexchange.com/questions/150613/characteristic-polynomial/150616#150616">alephalp</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://docs.python.org/3" rel="nofollow noreferrer">Python 3</a> and my <a href="https://github.com/DroneBetter/dronery/blob/main/dronery.py" rel="nofollow noreferrer">dronery</a> library, 476 bytes</h1>
<pre class="lang-python prettyprint-override"><code>λ M: C(λ f: λ t,m: t if len(t)==len(M) else f(f)(t+[n:=-sum(map(λ i: m[i][i],range(len(M))))/len(t)],matmul(M,lap(laph(__add__),m,lap(λ i: i*[0]+(n,)+(len(M)+~i)*[0],range(len(M)))))))([1],deepcopy(M))
</code></pre>
<p>(also using the <a href="https://en.wikipedia.org/wiki/Faddeev%E2%80%93LeVerrier_algorithm" rel="nofollow noreferrer">Faddeev-LaVerrier algorithm</a>)</p>
</div>
<div id="pu1" class="pu"><h2>CJam (48 bytes)</h2>

<pre><code>{[1\:A_,{1$_,,.=1b\~/A@zf{\f.*1fb}1$Aff*..+}/;]}
</code></pre>

<p><a href="http://cjam.aditsu.net/#code=qN%25%7B%22%20-%3E%20%22%25~~%3AE%3B%22%5B%5D%22-&#39;%3B%25%7B%5B~%5D%7D%25%0A%0A%7B%5B1%5C%3AA_%2C%7B1%24_%2C%2C.%3D1b%5C~%2FA%40zf%7B%5Cf.*1fb%7D1%24Aff*..%2B%7D%2F%3B%5D%7D%0A%0A~E%3D%7D%2F&amp;input=%5B0%5D%20-%3E%20%5B1%200%5D%0A%5B1%5D%20-%3E%20%5B1%20-1%5D%0A%5B1%201%3B%200%201%5D%20-%3E%20%5B1%20-2%201%5D%0A%5B80%2080%3B%2057%2071%5D%20-%3E%20%5B1%20-151%201120%5D%20%0A%5B1%202%200%3B%202%20-3%205%3B%200%201%201%5D%20-%3E%20%5B1%201%20-14%2012%5D%0A%5B4%202%201%203%3B%204%20-3%209%200%3B%20-1%201%200%203%3B%2020%20-4%205%2020%5D%20-%3E%20%5B1%20-21%20-83%20559%20-1987%5D%0A%5B0%205%200%2012%20-3%20-6%3B%206%203%207%2016%204%202%3B%204%200%205%201%2013%20-2%3B%2012%2010%2012%20-2%201%20-6%3B%2016%2013%2012%20-4%207%2010%3B%206%2017%200%203%203%20-1%5D%20-%3E%20%5B1%20-12%20-484%203249%20-7065%20-836601%20-44200%5D%0A%5B1%200%200%201%200%200%200%3B%201%201%200%200%201%200%201%3B%201%201%200%201%201%200%200%3B%201%201%200%201%201%200%200%3B%201%201%200%201%201%201%201%3B%201%201%201%200%201%201%201%3B%200%201%200%200%200%200%201%5D%20-%3E%20%5B1%20-6%2010%20-6%203%20-2%200%200%5D" rel="nofollow noreferrer">Online test suite</a></p>

<h3>Dissection</h3>

<p>This is quite similar to <a href="/a/174391/194">my answer to <em>Determinant of an integer matrix</em></a>. It has some tweaks because the signs are different, and because we want to keep all of the coefficients rather than just the last one.</p>

<pre><code>{[              e# Start a block which will return an array
  1\            e#   Push the leading coefficient under the input
  :A            e#   Store the input matrix in A
  _,            e#   Take the length of a copy
  {             e#     for i = 0 to n-1
                e#       Stack: ... AM_{i+1} i
    1$_,,.=1b   e#       Calculate tr(AM_{i+1})
    \~/         e#       Divide by -(i+1)
    A@          e#       Push a copy of A, bring AM_{i+1} to the top
    zf{\f.*1fb} e#       Matrix multiplication
    1$          e#       Get a copy of the coefficient
    Aff*        e#       Multiply by A
    ..+         e#       Matrix addition
  }/
  ;             e#   Pop AM_{n+1} (which incidentally is 0)
]}
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, <s>243 223</s> 222 bytes</h1>



<pre class="lang-hs prettyprint-override"><code>s=sum
(&amp;)=zip
z=zipWith
a#b=[[s$z(*)x y|y&lt;-foldr(z(:))([]&lt;$b)b]|x&lt;-a]
f a|let c=z pure[1..]a;g(u,d)k|m&lt;-[z(+)a b|(a,b)&lt;-a#u&amp;[[s[d|x==y]|y&lt;-c]|x&lt;-c]]=(m,-s[s[b|(n,b)&lt;-c&amp;a,n==m]|(a,m)&lt;-a#m&amp;c]`div`k)=snd&lt;$&gt;scanl g(0&lt;$c&lt;$c,1)c
</code></pre>

<p><a href="https://tio.run/##LYxBb4MwDIXv/ApLRSjZkgra7bAu6WWnnXfYIbK0EChFJWlFwtQi/jsLaJJt2X7ve2ftL3XXzbOXfrAJyagc21syLvO7DedEb0qplE9H8kTv8Jgegp@uXdWTkRwoJQpFWtISp7vgGpMT6KmrAxg5wm3oa1Vst6jfGzKwil4mK7gayTPVUE5Es5JGaDNkMV9V013KBy75Zk0ziJJYxn0Uo9utbpNp5qS0uOB2xW1m8Kdqf38uVHpXifTojXYdNCQXqYnFCmpmq1sHEm596wJs4RSb9LWu4HCArxC/DfAjKPXpAiIFKQQ0dfi4ulC74GelXhjsGBQM9shgufiewRuDfDl5sUr5v7qLC4@W18jkiH8" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>

<p>Thanks to @ØrjanJohansen for helping me golf this!</p>

<h3>Explanation</h3>

<p>This uses the <a href="https://en.wikipedia.org/wiki/Faddeev%E2%80%93LeVerrier_algorithm" rel="nofollow noreferrer">Faddeev–LeVerrier algorithm</a> to compute the coefficients. Here's an ungolfed version with more verbose names:</p>

<pre class="lang-hs prettyprint-override"><code>-- Transpose a matrix/list
transpose b = foldr (zipWith(:)) (replicate (length b) []) b

-- Matrix-matrix multiplication
(#) :: [[Int]] -&gt; [[Int]] -&gt; [[Int]]
a # b = [[sum $ zipWith (*) x y | y &lt;- transpose b]|x&lt;-a]


-- Faddeev-LeVerrier algorithm
faddeevLeVerrier :: [[Int]] -&gt; [Int]
faddeevLeVerrier a = snd &lt;$&gt; scanl go (zero,1) [1..n]
  where n = length a
        zero = replicate n (replicate n 0)
        trace m = sum [sum [b|(n,b)&lt;-zip [1..n] a,n==m]|(m,a)&lt;-zip [1..n] m]
        diag d = [[sum[d|x==y]|y&lt;-[1..n]]|x&lt;-[1..n]]
        add as bs = [[x+y | (x,y) &lt;- zip a b] | (b,a) &lt;- zip as bs]
        go (u,d) k = (m, -trace (a#m) `div` k)
          where m = add (diag d) (a#u)
</code></pre>

<p><sub><strong>Note:</strong> I took this straight from <a href="https://codegolf.stackexchange.com/a/150695/48198">this solution</a></sub></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, 4 bytes</h1>

<pre><code>1$Yn
</code></pre>

<p><a href="https://tio.run/##y00syfn/31AlMu///2gLAx0LA2tTcx1zw1gA" rel="nofollow noreferrer" title="MATL – Try It Online">Try it online!</a></p>

<p>This is merely a port of <a href="https://codegolf.stackexchange.com/a/150615/67312">flawr's Octave answer</a>, so it returns the coefficients in decreasing order, i.e., <code>[a_n, ..., a_1, a_0]</code></p>

<pre><code>1$Yn          # 1 input Yn is "poly"
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a> + <a href="http://www.numpy.org" rel="nofollow noreferrer">numpy</a>, 23 bytes</h1>



<pre class="lang-python prettyprint-override"><code>from numpy import*
poly
</code></pre>

<p><a href="https://tio.run/##K6gsycjPM/r/P60oP1chrzS3oFIhM7cgv6hEiyvNtiA/p/J/QVFmXolGmkZ0tIWBjoKFQayOQrSpuY6CuWFsrKbmfwA" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
</div>
<div id="pu5" class="pu"><h1>Mathematica, 22 bytes</h1>
<pre><code>Det[MatrixExp[0#]x-#]&amp;
</code></pre>
<p>-7 bytes from  alephalpha<br />
-3 bytes from Misha Lavrov</p>
<p><a href="https://tio.run/##y00syUjNTSzJTE78n2b73yW1JNo3saQos8K1oiDaQDm2Qlc5Vu1/QFFmXolDWnR1tYmOkY6hjnGtDpCla6xjqWMAZOoaAsUMwKJGBjq6JjqmOkYGtbWx/wE" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
<p>and... of course...</p>
<h1>Mathematica, 29 bytes</h1>
<pre><code>#~CharacteristicPolynomial~x&amp;
</code></pre>
<p><a href="https://tio.run/##y00syUjNTSzJTE78n2b7X7nOOSOxKDG5JLUosxgoGJCfU5mXn5uZmFNXofY/oCgzr8QhLbq62kTHSMdQx7hWB8jSNdax1DEAMnUNgWIGYFEjAx1dEx1THSOD2trY/wA" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
<p>both answers output a polynomial</p>
</div>
<div id="pu6" class="pu"><h1><a href="https://www.r-project.org/" rel="noreferrer">R</a>, 53 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(m){for(i in eigen(m)$va)T=c(0,T)-c(T,0)*i
T}
</code></pre>

<p><a href="https://tio.run/##K/qfpmCj@z@tNC@5JDM/TyNXszotv0gjUyEzTyE1Mz0VJKJSlqgZYpusYaAToqmbrBGiY6CplckVUvs/TSM3saQoswIoY6hjqKnJBRdI1jDUgQjqGOkYocpYGOiYmusASXOY7H8A" rel="noreferrer" title="R – Try It Online">Try it online!</a></p>

<p>Returns the coefficients in increasing order; i.e., <code>a_0, a_1, a_2, ..., a_n</code>.</p>

<p>Computes the polynomial by finding the eigenvalues of the matrix.</p>

<h1><a href="https://www.r-project.org/" rel="noreferrer">R</a> + <a href="https://cran.r-project.org/web/packages/pracma/pracma.pdf" rel="noreferrer">pracma</a>, 16 bytes</h1>

<pre class="lang-r prettyprint-override"><code>pracma::charpoly
</code></pre>

<p><code>pracma</code> is the "PRACtical MAth" library for R, and has quite a few handy functions.</p>
</div>
<div id="pu7" class="pu"><h1><a href="http://www.sagemath.org/" rel="noreferrer">SageMath</a>, 3 bytes</h1>

<p><em>5 bytes saved thanks to @Mego</em></p>

<pre><code>fcp
</code></pre>

<p><a href="http://sagecell.sagemath.org/?z=eJwrKMrMK9FISy7Q8E0sKcqs0IiONtRRMNJRMIjVUYgG0rrGOgqmILaBjgJQxjA2VlNTEwC44w37&amp;lang=sage" rel="noreferrer">Try it online!</a></p>

<p>Takes a <code>Matrix</code> as input.</p>

<p><a href="http://doc.sagemath.org/html/en/reference/matrices/sage/matrix/matrix_symbolic_dense.html#sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense.fcp" rel="noreferrer"><code>fcp</code></a> stands for <strong>f</strong>actorization of the <strong>c</strong>haracteristic <strong>p</strong>olynomial,</p>

<p>which is shorter than the normal builtin <a href="http://doc.sagemath.org/html/en/reference/matrices/sage/matrix/matrix_symbolic_dense.html#sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense.charpoly" rel="noreferrer"><code>charpoly</code></a>.</p>
</div>
<div id="pu8" class="pu"><h1><a href="https://www.gnu.org/software/octave/" rel="noreferrer">Octave</a>, <s>16</s>  4 bytes</h1>

<p>@BruteForce just told me that one of the functions I was using in my previous solution can actually do the whole work:</p>



<pre class="lang-matlab prettyprint-override"><code>poly
</code></pre>

<p><a href="https://tio.run/##y08uSSxL/Z9m66Cnp/e/ID@n8r91SmZxgUaaRrSFgYKFgbWCqbmCuWGspuZ/AA" rel="noreferrer" title="Octave – Try It Online">Try it online!</a></p>

<p><strong>16 Bytes:</strong> This solution computes the eigenvalues of the input matrix, and then proceeds building a polynomial from the given roots.</p>



<pre class="lang-matlab prettyprint-override"><code>@(x)poly(eig(x))
</code></pre>

<p>But of course there is also the boring </p>

<pre class="lang-matlab prettyprint-override"><code>charpoly
</code></pre>

<p>(needs a <code>symbolic</code> type matrix in Octave, but works with the usual matrices in MATLAB.)</p>

<p><a href="https://tio.run/##y08uSSxL/Z9mq6en999Bo0KzID@nUiM1Mx3I1PyfkllcoJGmEW1hoGBhYK1gaq5gbhgLFAcA" rel="noreferrer" title="Octave – Try It Online">Try it online!</a></p>
</div>
<div id="pu9" class="pu"><h1><a href="http://pari.math.u-bordeaux.fr/" rel="noreferrer">Pari/GP</a>, 8 bytes</h1>

<pre><code>charpoly
</code></pre>

<p><a href="https://tio.run/##K0gsytRNL/ifpmCr8D85I7GoID@n8n9BUWZeiUaaRrSJjpGOoY6xtYKJjq6xjqWOgbWCriFQxAAkZmSgo2uiY6pjZBCrqfkfAA" rel="noreferrer" title="Pari/GP – Try It Online">Try it online!</a></p>

<hr>

<h1><a href="http://pari.math.u-bordeaux.fr/" rel="noreferrer">Pari/GP</a>, 14 bytes</h1>

<pre><code>m-&gt;matdet(x-m)
</code></pre>

<p><a href="https://tio.run/##K0gsytRNL/ifpmCr8D9X1y43sSQltUSjQjdX839BUWZeiUaaRrSJjpGOoY6xtYKJjq6xjqWOgbWCriFQxAAkZmSgo2uiY6pjZBCrqfkfAA" rel="noreferrer" title="Pari/GP – Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/150613/">150613</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




