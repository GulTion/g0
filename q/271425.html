<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::271425</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>277</td><td>JavaScript ES6</td><td>240303T174617Z</td><td><a href="https://codegolf.stackexchange.com/questions/271425/%c2%b5unitdc-a-unit-aware-rpn-calculator/271504#271504">Arnauld</a></td></tr>
<tr d-ix="1"><td>116</td><td>Charcoal</td><td>240303T090238Z</td><td><a href="https://codegolf.stackexchange.com/questions/271425/%c2%b5unitdc-a-unit-aware-rpn-calculator/271495#271495">Neil</a></td></tr>
<tr d-ix="2"><td>795</td><td>JavaScript Node.js</td><td>240302T015918Z</td><td><a href="https://codegolf.stackexchange.com/questions/271425/%c2%b5unitdc-a-unit-aware-rpn-calculator/271474#271474">2pichar</a></td></tr>
<tr d-ix="3"><td>117</td><td>K ngn/k</td><td>240229T174254Z</td><td><a href="https://codegolf.stackexchange.com/questions/271425/%c2%b5unitdc-a-unit-aware-rpn-calculator/271426#271426">ovs</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript (ES6), 277 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;s.replace(/\d+|(\w)|\S/g,(v,u)=&gt;u?s[0][1]=[[v,1]]:s=[[(u=[])|v||([[y,q],[x,u],...s]=s,S=v&lt;&quot;/&quot;||-1,v+1|0?e|=u+''!=q:q.map(([U,e])=&gt;(o=u.find(o=&gt;o[0]==U))?o[1]+=e*S:u.push([U,e*S])),eval(x+v+y)),u.filter(o=&gt;o[1]).sort()],...s],e=s=[])|e?&quot;*&quot;:s.reverse().join` `.split`,`.join``
</code></pre>
<p><a href="https://tio.run/##bY/NcsIgFIX3fQqajZAgEZe2mFWfIOMKmUlG8W8SibkJ1RnePSWxP2plwVw4557v3kNuc1jV@6oZH81adxvRgZgDq3VV5CuN4@U6cnj5SdwyjbcUW9oSMW8TkBMluRJSWsqVmoGvcCukIs46h6W80JOi8kxbRRljoATQVNj3IA6cG3NqI@4miXaijUajV3GanViZVxjLBdXKE7ARLdvsj2tfzI2HCbEgJDGeGQkdprOWVS3sBn@YKkKotnmBz5GNLv7R9xaNrq/dXBEGpm4w@R6GagHDrDoJwmDWr2t1DRoTdjD7Y4YyBlWxbzKaXT@y7k2@IBTwgKJnJ44RH3QETx29Dj8ONEUlih583hFe9RL1Ht/wW/Ver09hzMubEEAhugcOpuktagj4j@LontVPNL1jldzT7lL8HT2w/kJKr0PwZGX1wjam/shXOwxIzNHKHMEUmhVmizcYCCHdFw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, <s>123</s> 116 bytes</h1>
<pre><code>Ｆ⪪Ｓ ¿Σι⊞υ⁺⟦Ｉι⟧Ｅβ⁰¿№βι§≔§υ±¹⊕⌕βι¹«≔⊟υζ≔⊟υη⊞υ∧∨⬤∧ζη∨¬λ⁼κ§ζλ⁻+ιＥ∧ζη⎇λ⁻κ×§ζλ⊖﹪℅ι³§⟦×κ§ζλ⁺κ§ζλ÷κ§ζλ⟧℅ι»Ｅυ⭆∨ι*⎇μ⎇λ⁺§β⊖μλωλ
</code></pre>
<p><a href="https://tio.run/##bVHBbsIwDD2vX2H15KydtrJjTwg2iQOsEtwQh0IDREtT1iRsY9q3d05JNypWqa3zbD@/52z2eb2pctk026oGnB@kMDhRB2vmphZqhyyGEELGQGwpbUsUFGdW79HGkEmrcTnKtSF4FcM0P@A6hgfGWApcat52jSqrjMNd61BrsVNDM1EF/8DuT1wzvssNx4TRxIna1LzkyvACn4UqfHMMScf7FdycmTCrDmgpdWLpFbZ3WCd2SDwvNQ6lRBeeXDoGQmaVQUnh05vNpcZXKvWyqEaSF8pNhSKrYRR6Ic7pBcuC1yqvP1F2lUSyECXX2KOKYcz/nE2rwsqKNBVC5ZI2GMPjeVrXtDxzXCnym/8HnygzFkdR8OvkypntRrVPGnwHGd2yQWeHVnS@c3egtQi6@dvwwlzZ89kq6Cas@85KJ8XZfWd@g2nTJJCAbt8BlBD5SMPtL35P39JHrmbQRlEvH/makk46aO6O8gc" rel="nofollow noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Since the whole stack is output, I've effectively included several test cases in the link. Explanation:</p>
<pre><code>Ｆ⪪Ｓ 
</code></pre>
<p>Split the input on spaces and loop over the resulting tokens.</p>
<pre><code>¿Σι⊞υ⁺⟦Ｉι⟧Ｅβ⁰
</code></pre>
<p>If this token is a positive integer, then push its value with zero exponents for all letters.</p>
<pre><code>¿№βι§≔§υ±¹⊕⌕βι¹
</code></pre>
<p>Otherwise, if this token is a letter, then set the exponent for that letter to <code>1</code> for the latest value.</p>
<pre><code>«
</code></pre>
<p>Otherwise:</p>
<pre><code>≔⊟υζ≔⊟υη
</code></pre>
<p>Retrieve the two arguments.</p>
<pre><code>⊞υ∧∨⬤∧ζη∨¬λ⁼κ§ζλ⁻+ιＥ∧ζη⎇λ⁻κ×§ζλ⊖﹪℅ι³§⟦×κ§ζλ⁺κ§ζλ÷κ§ζλ⟧℅ι
</code></pre>
<p>If the arguments are compatible or the operations is not sum, calculate the product, sum and quotient of the two arguments, selecting according to the ordinal of the token. (In the case of the exponents, the ordinal modulo <code>3</code> is decremented and multiplied by the second exponent, and this is subtracted from the first exponent.)</p>
<pre><code>»Ｅυ⭆∨ι*⎇μ⎇λ⁺§β⊖μλωλ
</code></pre>
<p>For each value on the stack, concatenate its value with any non-zero exponents, unless the value was invalid, in which case output a <code>*</code>.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, <s>797</s> 795 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>Z=require('util');O=Object;N=&quot;length&quot;;A=u=&gt;O.fromEntries([...u.matchAll(/([a-zA-Z])(-?\d+)/g)].map(_=&gt; _.slice(1)));B=u=&gt;{s=&quot;&quot;;e=O.entries(u);for(i=0;i&lt;e[N];i++){s+=e[i][0]+e[i][1]}return s};D=T=&gt;{S=[];U=[];p=/[+*\/]/;for(t of T){if(/\d+/.test(t[0])||/\d+/.test(t[1])&amp;&amp;(t[0]==&quot;-&quot;||t[0]==&quot;+&quot;)){S.push(t)}else if(p.test(t)){let[r,l]=[S.pop(),S.pop()];[h,H]=[U.pop(),U.pop()];if(H){f=A(h);g=A(H);m=1;if(t==&quot;+&quot;){if(Z.isDeepStrictEqual(g,f)){n=B(g)}else{return'*'}}if(t==&quot;/&quot;){m=-1}L=O.keys(g);P=O.keys(f);z={};for(i=0;i&lt;L[N];i++){k=L[i];if(k in f){y=+g[k]+m*+f[k];y!=0?(z[k]=y):0}else{z[k]=+g[k]}}for(i=0;i&lt;P[N];i++){k=P[i];if(!(k in z||k in g)){z[k]=m*+f[k]}}n=B(z);n!=&quot;&quot;?U.push(n):0}S.push(&quot;&quot;+eval(l+t+r))}else{if(t[N] &gt; 1){U.push(t)}else{U.push(t+1)}}}return S.map((E,I)=&gt; E+(U[I]||&quot;&quot;)).join(&quot; &quot;)}
</code></pre>
<p><a href="https://tio.run/##bVTLbts6EF3HX8FoUZORTVlZXpYJUiRAehEkBlJvogqBalMyE@pRkUrrB7/dd6hH4l50YXM4M@fwzHCol@Qt0ctaVmZalCtxCAI0L9UmlUpplJY1yqXWssiQNkmxSuoV@vcdgXJh1uVKjx5@vIiloSuRykLM67IStdngR1MDkFZ1aUqzqcQEeXlilusrpbwJ2o1O3hLVCFwLAvaJEgbV8OMoilm/N3nlzF9rqQSGDQRrQcVvscRmLTVpgSeAolWj1ziilEJWTBzIjtpIUxeOFjx2ZCHwd6mdd4LGaV3mNwUIF3p8pFF0rneh5Y8X0LKz7iBoEnY@CZ4Zg@Uz6tOpEkVm1uDz/U4q4KI@GMk4msUxgI4cYfw/6QAYpB@eeC1@NrIWeNwYqcaEPfBOOLvnXneWx654wy8e6FEhbV8aOvQeBzhKptur6VNM8PTy@8onQUZiiFf4mV@gZ6qVXAocEkLYF8e209zzmOAPtJeKG8Jc2ZLPmPwsovuYtSVqn4uuLl905di@Dm3ZNf8GVI8crnfh/ioeRP7Z9yAOWi5oaoq@kZ1McQCaAmqENtgAF9nv//CEMfn0qY1w7k29/b43fQ8G4rEbBUOsUFogYKt6HAThmqJ6omIeQVpZYTLp15hF68kt@Be9fzH4geCW7FJ@hdeEZbDcEpbz0PlNd6ZT/ESlvhaiciO/NDc/m0ThbJLCkQX/grNOzK7rxfhsbG0PDwCe82lo76C5r2KjIZfNBzslbMthyD5afffe6ld@Bx12Ml6RLFBKdhvuZ9Fr7Odnfgor25zy2SXegsk35J9ZJ6HdtnnWftDOj2jnPe1pR7zd79s1g1pacE9vratsS1hxCsNxuejaXriD@ivwPF/A68HKN35N@ha4uuEwdIFCslv8cVfvWz8k1g6D89jOJb6ZfCUwmzc@XkRf4/3eg7umL6UssIc8Yg/t16MqnkEpR/DFWQqtaVJnb/0wn8PT/8tD7SDDO@2f6bIsdKkEVWWGr3GXAk2hulLS4DEau4cxsodDeAiRdj90jnLkg5UjtwvQh@X3cY3O0JDdRo6yHfr8KHvgGBhz2On/AA" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a> Input is as an array of token strings passed to <code>D</code>. Output is to STDOUT. There's probably a shorter way, but this is what I've got (and JS is not a golfing language).</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://codeberg.org/ngn/k" rel="noreferrer">K (ngn/k)</a>, <s>134</s> <s>124</s> 117 bytes</h1>
<pre><code>{,//$x,(!y),'.y}.'|(){(,$[43=*y-*|&amp;/=/h;E;1=C;**x;^[_%;.y].|*'h],(&amp;~b)_b:(y!C;*|(1-3!*y)/h:C#x)2=C),(C:3!&quot;0a&quot;'*y)_x}/
</code></pre>
<p><a href="https://ngn.codeberg.page/k#eJxVTMEOgjAMvfMVpSpsc64CnraQmBDPJlwRUQ+Giyc9bAH8dkGMaJr29fX1vatuJNHcSuY7LkPlOhW2jDdMzotNkgq3Em1AKdVmZ6I0M0JYcyyqhVGuVK0I61Ky4Hnh1UUz5/d6y6JV4gvHqdbZzPI4zbhkmU58XJ8x7IXKduR5D92oAgHpujWyxwOitOa0y/N9XnbeAyMcBtw/ADHcYDmSGwwHgmlbTl93EPBje+v/tiEpnmwjHVv0FX9jCF+Q30J4" rel="noreferrer">Try it online!</a> Input and output as list of strings, <code>t</code> converts between that and space separated format.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/271425/">271425</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




