<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::79459</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>8917</td><td>Itr</td><td>230905T173739Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/264944#264944">bsoelch</a></td></tr>
<tr d-ix="1"><td>019</td><td>Julia</td><td>160506T003854Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79497#79497">Alex A.</a></td></tr>
<tr d-ix="2"><td>044</td><td>Sage</td><td>160507T043647Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79547#79547">user4594</a></td></tr>
<tr d-ix="3"><td>305</td><td>C++</td><td>160506T063727Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79510#79510">HSchmale</a></td></tr>
<tr d-ix="4"><td>028</td><td>Julia 0.4</td><td>160506T025501Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79505#79505">Dennis</a></td></tr>
<tr d-ix="5"><td>022</td><td>Jelly</td><td>160505T184740Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79469#79469">Dennis</a></td></tr>
<tr d-ix="6"><td>027</td><td>Mathematica</td><td>160505T172416Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79464#79464">miles</a></td></tr>
<tr d-ix="7"><td>037</td><td>Matlab</td><td>160505T204512Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79480#79480">Rainer P</a></td></tr>
<tr d-ix="8"><td>050</td><td>Matlab</td><td>160505T171346Z</td><td><a href="https://codegolf.stackexchange.com/questions/79459/matrix-trigonometry/79463#79463">flawr</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://github.com/bsoelch/OneChar.js/blob/main/ItrLang.md" rel="nofollow noreferrer">Itr</a>, 8+9=17 bytes</h1>
<p><a href="https://bsoelch.github.io/OneChar.js/?lang=Itr&amp;src=aeRl4H5lK70=&amp;in=KDAgMiwzIDUp" rel="nofollow noreferrer">cosine</a></p>
<pre><code>iäeà~e+½
</code></pre>
<p><a href="https://bsoelch.github.io/OneChar.js/?lang=Itr&amp;src=aeR-ZeBlLb1p&amp;in=KDAgMiwzIDUp" rel="nofollow noreferrer">sine</a>:</p>
<pre><code>iä~eàe-½i
</code></pre>
<p>Takes a matrix as input, also works for complex inputs</p>
<h2>Explanation</h2>
<p>implements the equations</p>
<p><span class="math-container">\$ \sin(x)= i*\frac{e^{-ix}-e^{ix}}{2}\$</span></p>
<p><span class="math-container">\$ \cos(x)= \frac{e^{ix}+e^{-ix}}{2}\$</span></p>
<pre><code>i         ; i times the implicit input
 ä        ; duplicate
  ~       ; negate
   e      ; exponential
    à     ; swap
     e    ; exponential
      -   ; subtract
       ½  ; half
        i ; times i
          ; implicit output
</code></pre>
</div>
<div id="pu1" class="pu"><h1>Julia, <s>33</s> 19 bytes</h1>



<pre class="lang-default prettyprint-override"><code>A-&gt;reim(expm(A*im))
</code></pre>

<p>This is a function that accepts a 2-dimensional array of floats and returns a tuple of such arrays correponding to the cosine and sine, respectively. Note that this is the reverse of the order given in the test cases, in which sine is listed first.</p>

<p>For a real-valued matrix <em>A</em>, we have</p>

<p><a href="https://i.stack.imgur.com/tYHRo.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/tYHRo.gif" alt="sine"></a></p>

<p>and</p>

<p><a href="https://i.stack.imgur.com/CvWDx.gif" rel="noreferrer"><img src="https://i.stack.imgur.com/CvWDx.gif" alt="cosine"></a></p>

<p>That is, the sine and cosine of <em>A</em> correspond to the imaginary and real parts of the matrix exponential <em>e</em><sup><em>iA</em></sup>. See <em>Functions of Matrices</em> (Higham, 2008).</p>

<p><a href="http://julia.tryitonline.net/#code=Zj1BLT5yZWltKGV4cG0oQSppbSkpCgpmb3IgdGVzdCBpbiAocmVzaGFwZShbMC5dLCAxLCAxKSwKICAgICAgICAgICAgIFswLiAyLjsgMy4gNS5dLAogICAgICAgICAgICAgWzEuIDAuIDEuOyAwLiAwLiAwLjsgMC4gMS4gMC5dLAogICAgICAgICAgICAgWzEuIDAuIDAuIDAuIDAuOyAwLiAxLiAwLiAwLiAwLjsgMC4gMC4gMS4gMC4gMC47IDAuIDAuIDAuIDEuIDAuOyAwLiAwLiAwLiAwLiAxLl0sCiAgICAgICAgICAgICBbLTMuIDIuIC02LjsgMy4gMC4gNC47IDQuIC0yLiA3Ll0pCiAgICBwcmludGxuKGYodGVzdCkpCmVuZA&amp;input=" rel="noreferrer">Try it online!</a> (includes all test cases)</p>

<p>Saved 14 bytes thanks to Dennis!</p>
</div>
<div id="pu2" class="pu"><h2>Sage, 44 bytes</h2>
<pre class="lang-py prettyprint-override"><code>lambda A:map(exp(I*A).apply_map,(imag,real))
</code></pre>
<p><a href="http://sagecell.sagemath.org/?z=eJxLs81JzE1KSVRwtMpNLNBIrSjQ8NRy1NRLLCjIqYwHCuloZOYmpusUpSbmaGrycvFypWnkJpYUZVZoREcb6igY6CgYxuooRBuAmQZQJkgiNlZTEwBd6xob&amp;lang=sage" rel="nofollow noreferrer">Try it online</a>.</p>
<p>This anonymous function returns a list of 2 matrices corresponding to <code>sin(A)</code> and <code>cos(A)</code>, respectively. <code>exp(I*A)</code> computes the matrix exponential for <code>I*A</code> (<code>A</code> with all elements multiplied by the imaginary unit), and <code>matrix.apply_map(f)</code> returns a matrix where <code>f</code> has been applied to all of its elements. By applying <code>imag</code> and <code>real</code> (the functions for getting the imaginary and real parts of a scalar value) to the matrices, we get the values of <code>sin(A)</code> and <code>cos(A)</code>, thanks to Euler's famous identity (referenced in the challenge text).</p>
</div>
<div id="pu3" class="pu"><h1>C++, 305 bytes</h1>

<pre class="lang-c++ prettyprint-override"><code>#include&lt;cmath&gt;
#include&lt;iostream&gt;
#include&lt;vector&gt;
int x,i=0, j;void p(std::vector&lt;double&gt; v){int x=sqrt(v.size());for(i=0;i&lt;x;i++){for(j=0;j&lt;x;j++) std::cout &lt;&lt; v[x] &lt;&lt; " ";std::cout &lt;&lt; "\n";}}int main(){std::vector&lt;double&gt; s, c;while(std::cin &gt;&gt; x){s.push_back(sin(x));c.push_back(cos(x));}p(s);p(c);}
</code></pre>

<p>Input is a list of numbers that are a perfect square on stdin. Output is a pretty printed 2d array on stdout</p>
</div>
<div id="pu4" class="pu"><h1>Julia 0.4, 28 bytes</h1>

<pre><code>A-&gt;imag({E=expm(im*A),im*E})
</code></pre>

<p>Input is a matrix of floats, output is an array of matrices. <a href="http://julia.tryitonline.net/#code=ZiA9IEEtPmltYWcoe0U9ZXhwbShpbSpBKSxpbSpFfSkKCmRpc3BsYXkoZihmbG9hdChyZXNoYXBlKFswXSwgMSwgMSkpKSkKcHJpbnQoIlxuXG4iKQpkaXNwbGF5KGYoZmxvYXQoWzAgMjsgMyA1XSkpKQpwcmludCgiXG5cbiIpCmRpc3BsYXkoZihmbG9hdChbMSAwIDE7IDAgMCAwOyAwIDEgMF0pKSkKcHJpbnQoIlxuXG4iKQpkaXNwbGF5KGYoZmxvYXQoWzEgMCAwIDAgMDsgMCAxIDAgMCAwOyAwIDAgMSAwIDA7IDAgMCAwIDEgMDsgMCAwIDAgMCAxXSkpKQpwcmludCgiXG5cbiIpCmRpc3BsYXkoZihmbG9hdChbLTMgMiAtNjsgMyAwIDQ7IDQgLTIgN10pKSk&amp;input=" rel="nofollow">Try it online!</a></p>
</div>
<div id="pu5" class="pu"><h1><a href="http://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, <s>23</s> 22 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>

<pre><code>³æ*÷!
®Ḥ‘©r0Ç€s2_@/µÐL
</code></pre>

<p><a href="http://jelly.tryitonline.net/#code=wrPDpirDtyEKwq7huKTigJjCqXIww4figqxzMl9AL8K1w5BM&amp;input=&amp;args=W1swLCAyXSwgWzMsIDVdXQ" rel="nofollow noreferrer">Try it online!</a></p>

<h3>Background</h3>

<p>This approach directly computes the Taylor series for <em>sine</em> and <em>cosine</em>, i.e.,</p>

<p><img src="https://i.stack.imgur.com/mqrAz.png" alt="formula"></p>

<p>It increases the number of initial terms of both series until the result no longer changes, so its accuracy is only limited by the precision of the floating point type.</p>

<h3>How it works</h3>

<pre><code>®Ḥ‘©r0Ç€s2_@/µÐL  Main link, Argument: A (matrix)

             µÐL  Loop; apply the chain until the results are no longer unique.
                  Return the last unique result.
®                   Yield the value of the register (initially zero).
 Ḥ                  Unhalve/double it.
  ‘©                Increment and copy the result (n) to the register.
    r0              Range; yield [n, ..., 0].
      Ç€            Apply the helper link to each k in the range.
        s2          Split the results into chunks of length 2. Since n is always
                    odd, this yields [[Ç(n), Ç(n-1)], ..., [Ç(1), Ç(0)]].
          _@/       Reduce the columns of the result by swapped subtraction,
                    yielding [Ç(1) - Ç(3) + ... Ç(n), Ç(0) - Ç(2) + ... Ç(n - 1)].


³æ*÷!             Helper link. Argument: k (integer)

³                 Yield the first command-line argument (A).
 æ*               Elevate A to the k-th power.
    !             Yield the factorial of k.
   ÷              Divide the left result by the right one.
</code></pre>
</div>
<div id="pu6" class="pu"><h1>Mathematica, 27 bytes</h1>

<pre><code>{Im@#,Re@#}&amp;@MatrixExp[I#]&amp;
</code></pre>

<p>Based on @<a href="https://codegolf.stackexchange.com/users/48165/rainer-p">Rainer P.</a>'s solution.</p>

<p>Takes the square matrix <code>A</code> as an argument and outputs a list containing <code>{sin(A), cos(A)}</code>.</p>

<p>The input is formatted with <code>N</code> to get a numerical value instead of a long exact formula and <code>Column</code> to display the results of <code>sin(A)</code> and <code>cos(A)</code> as separate matrices instead of a nested list.</p>

<p><a href="https://i.stack.imgur.com/mwipn.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/mwipn.png" alt="Example"></a></p>

<p>Calculating the values separately requires <strong>38</strong> bytes</p>

<pre><code>{(#2-#)I,+##}/2&amp;@@MatrixExp/@{I#,-I#}&amp;
</code></pre>
</div>
<div id="pu7" class="pu"><h1>Matlab, 37 bytes</h1>
<pre><code>@(A){imag(expm(i*A));real(expm(i*A))}
</code></pre>
</div>
<div id="pu8" class="pu"><h1>Matlab, <s>138 121 52</s> 50 bytes</h1>
<p>Since matrix exponentiation is allowed, (what I didnt notice first, d'oh) I do not need to define my helper funciton anymore, and the whole thing can be trivially solved:</p>
<pre><code>A=input('')*i;a=expm(A);b=expm(-A);[(b-a)*i,a+b]/2
</code></pre>
<p>The input should be a matrix e.g. <code>[1,2;4,5]</code> or alternatively <code>[[1,2];[3,4]]</code></p>
<p>An unexpected thing (in hindsight not so unexpected) is that the cosine and sine matrix still satisfy</p>
<pre><code>I = sin(A)^2+cos(A)^2
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/79459/">79459</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




