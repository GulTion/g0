<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::169506</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>145</td><td>Java 10</td><td>180730T082441Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169521#169521">Kevin Cr</a></td></tr>
<tr d-ix="1"><td>019</td><td>MATL</td><td>180731T180803Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169667#169667">Sundar R</a></td></tr>
<tr d-ix="2"><td>016</td><td>Apl Dyalog Unicode</td><td>180730T121537Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169537#169537">jslip</a></td></tr>
<tr d-ix="3"><td>100</td><td>R</td><td>180730T170103Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169550#169550">Giuseppe</a></td></tr>
<tr d-ix="4"><td>082</td><td>Mathematica</td><td>180731T100943Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169621#169621">LLlAMnYP</a></td></tr>
<tr d-ix="5"><td>058</td><td>R</td><td>180730T204141Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169571#169571">digEmAll</a></td></tr>
<tr d-ix="6"><td>072</td><td>Haskell</td><td>180730T214440Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169581#169581">nimi</a></td></tr>
<tr d-ix="7"><td>010</td><td>Jelly</td><td>180730T204550Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169572#169572">Jonathan</a></td></tr>
<tr d-ix="8"><td>066</td><td>C gcc</td><td>180730T110317Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169533#169533">ErikF</a></td></tr>
<tr d-ix="9"><td>057</td><td>Ruby</td><td>180730T143051Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169541#169541">Kirill L</a></td></tr>
<tr d-ix="10"><td>037</td><td>Brachylog</td><td>180730T084003Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169523#169523">Sundar R</a></td></tr>
<tr d-ix="11"><td>092</td><td>Clean</td><td>180730T063749Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169517#169517">Οurous</a></td></tr>
<tr d-ix="12"><td>069</td><td>JavaScript ES6</td><td>180730T062319Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169515#169515">Arnauld</a></td></tr>
<tr d-ix="13"><td>090</td><td>JavaScript Node.js</td><td>180730T062333Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169516#169516">tsh</a></td></tr>
<tr d-ix="14"><td>092</td><td>Python 2</td><td>180730T030840Z</td><td><a href="https://codegolf.stackexchange.com/questions/169506/split-a-list-into-sized-chunks-but-not-counting-items-failing-predicate/169513#169513">Chas Bro</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Java 10, <s>207</s> <s>186</s> <s>159</s> <s>148</s> 145 bytes</h1>

<pre class="lang-java prettyprint-override"><code>a-&gt;n-&gt;{var r=new java.util.Stack();for(int l=a.size(),c=0,j=0,i=-1;i++&lt;l;)if(i==l||f(a.get(i))&amp;&amp;++c&gt;n&amp;i&gt;0)r.add(a.subList(j,j=i*=c=1));return r;}
</code></pre>
<p>Java is definitely not the right language for this challenge (or any codegolf-challenge of course..)</p>
<p>-21 bytes thanks to <em>@O.O.Balance</em><br />
-3 bytes thanks to <em>@ceilingcat</em></p>
<p><a href="https://tio.run/##3VE9b9swEN39K26yyVom7HZUKNRLgQItMrhb0eFEUe4pDGWQlAs30W93SVlwHA@ZgqIpiOPHveOR770G97hoqrujMug9fEWyDxMALH1wqAL4gIEUnNBv2oeEApRtazRaqNlt2ehYR/wEADgdOmchuE7nQ6of5mHadaWJ3Zr4qOgCGVF3VgVqrfg0bm6esC/kQ/Zi7Wcb9Fa7y6J06apHURSgQB5xUdhF8bBHB05a/evi1iagumM8r1vHyAYwEoWn35rxTMll1sQguVjlNJ/fmJxTzUhK8/hYMxRbHRhxPp3O56qwUyqW3Amsqgj5rkwfYE3sQO@kkivO81Efl/fHJEnSKCk0OaszSr5vqYL76AfbBEd2@/0H4Cjy5uCDvhdtF8QuQsFYlvgke9jZh4@3e@0cVXo8v2DZ2bREnkcG@QicrOuFErjbmQN7rtraOTwMBDkfC95Hgv/mF69yXqAf8svsPPibprGK43@gMMSbJ7Icifx9V9RPdJxASpitZ69FKbbKZmWMy3V9dS6f5Z5IfziR7if98Q8" rel="nofollow noreferrer">Try it online.</a></p>
<p><strong>Explanation:</strong></p>
<pre class="lang-java prettyprint-override"><code>a-&gt;n-&gt;{                   // Method with List &amp; int parameters and List of Lists return
  var r=new java.util.Stack();
                          //  Result-list, starting empty
  for(int l=a.size(),     //  Size of the input-List
          c=0,            //  Count-integer, starting at 0
          j=0,            //  Range-integer, starting at 0
          i=-1;++i&lt;l;)    //  Loop `i` in the range (-1, `l`]:
    if(i==l||             //   If this is the last iteration
       f(a.get(i))        //   Or if the black-box function is true for the current item
       &amp;&amp;++c              //    Increase the counter by 1
         &gt;n&amp;              //    If the counter is now larger than the size
         &amp;i&gt;0)            //    and it's not the first item of the List
      a.subList(j,j=i     //     Add a sub-List to the result from range [`j`, `i`)
                          //     And set `j` to `i` at the same time
                  *=c=1));//     And reset `c` to 1 at the same time as well
  return r;}              //  Return the List of Lists as result
</code></pre>
<p><strong>Black box input format:</strong></p>
<p>Assumes a named function <code>boolean f(Object i)</code> is present, which is allowed <a href="https://codegolf.meta.stackexchange.com/a/13707/52210">according to this meta answer</a>.</p>
<p>I have an abstract class <code>Test</code> containing the default function <code>f(i)</code>, as well as the lambda above:</p>
<pre class="lang-java prettyprint-override"><code>abstract class Test{
  boolean f(Object i){
    return true;
  }

  public java.util.function.Function&lt;java.util.List, java.util.function.Function&lt;Integer, java.util.List&lt;java.util.List&gt;&gt;&gt; c =
    a-&gt;n-&gt;{var r=new java.util.Stack();for(int l=a.size(),c=0,j=0,i=-1;i++&lt;l;)if(i==l||f(a.get(i))&amp;&amp;++c&gt;n&amp;i&gt;0)r.add(a.subList(j,j=i*=c=1));return r;}
  ;
}
</code></pre>
<p>For the test cases, I overwrite this function <code>f</code>. For example, the last test case is called like this:</p>
<pre class="lang-java prettyprint-override"><code>System.out.println(new Test(){
  @Override
  boolean f(Object i){
    return (char)i == 'A';
  }
}.c.apply(new java.util.ArrayList(java.util.Arrays.asList('A','b','A','b','A','A','A','b','A','b','A','A','b'))).apply(3));
</code></pre>
</div>
<div id="pu1" class="pu"><h1>MATL, 19 bytes</h1>
<pre><code>HyX$Ysi/Xk1y&gt;+!w7XQ
</code></pre>
<p>Based on <a href="https://codegolf.stackexchange.com/a/169537/8774">jslip's excellent APL answer</a>.</p>
<p>MATL doesn't really have user-defined functions as such, but it does have a way to call out to the environment it's running on (MATLAB/Octave), so this uses that for the predicate function. Usage would be something like <a href="https://tio.run/##y00syfmvnllcWlCQWqQe4VHx36MyQiWyOFM/Ituw0k5bsdw8IvD//2h1xyQQTHKEkEnqsVzGAA" rel="nofollow noreferrer" title="MATL – Try It Online">this</a>, but that functionality is disabled online for security reasons, so here's a version that uses a hardcoded <code>isodd</code> predicate function instead: <a href="https://matl.io/?code=toYsi%2FXk1y%3E%2B%21w7XQ&amp;inputs=%5B0+1+1+0+1+0+0+1+0+0+1+0%5D%0A2&amp;version=20.9.2" rel="nofollow noreferrer">Try it on MATL Online</a>.</p>
<pre><code>H    % Push the function name to be called, assumed to be 
     %  stored in the H clipboard
y    % Take the first input, push copies of it both below and above the 
     %  function name
X$   % Call the function (say 'isupper') with the input as argument
     %  returns a boolean vector
Ys   % Cumulative sum
i/   % Take the chunk size and divide each element by it
Xk   % ceil
1y&gt;+ % Turn the (initial) 0s to 1s
!    % Transpose. Now we have a column vector specifying which chunk 
     %  each input element should go into
w    % Bring the other copy of the input on top 
7    % Code for this function: '@(x){x.'}'
     %  i.e. place each chunk in a row vector and enclose it in a cell
XQ   % 'accumarray' - split the input into chunks based on
     %   the given column vector, apply the given function to each chunk
     %   (which here just wraps it up as a cell), and accumulate the results
     %   in an array.
     % implicit output
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://dyalog.com" rel="noreferrer">Apl (Dyalog Unicode)</a> <strike>17</strike> 16 bytes <a href="https://github.com/abrudz/SBCS" rel="noreferrer">(SBCS)</a></h1>
<p>Thanks to Adám for saving me 1 byte.</p>
<pre><code>w⊆⍨⌈⎕÷⍨1⌈+\⎕¨w←⎕
</code></pre>
<p><a href="https://tio.run/##SyzI0U2pTMzJT/@v8ahvql/wo941mnogZrCrXqizr4t6Un6FQn6egm6aLYgssS0pSk1Vf9S1ODUvMSknNdjRJwTIAap3jlQvTswpUdfketTRnva//FFX26PeFY96OoByh7cDmYZAtnYMkHdoRfmjtglAxn@gyv8KYJDGBbRY4VHvXAXX3IKSSoWczOISrupHvVvtDGq5jLhgigwU4BCrrCEQ4pEBY1zyBlB5XGaoOyYBoSOETFIHq7BVd1Sv5TKGq9EwVDDS1DAGEUCWgjGY0lTQ0DGEC5jARLmqjWwfdS4CmgK0BQA" rel="noreferrer">Try it online!</a>
for explaination purposes I will leave up the 17 byte solution.</p>
<pre><code>{⍵⊆⍨⌈⍺÷⍨1⌈+\⍺⍺¨⍵}
</code></pre>
<p><code>⍺⍺¨⍵</code> aplies the predicate to the list returning a boolean vector<br />
<code>+\</code> generates a running total<br />
<code>1⌈</code> replaces leading <code>0</code>s with <code>1</code>s<br />
<code>⌈⍺÷⍨</code> divides each element by the chunk size and rounds up<br />
<code>⍵⊆⍨</code> partitions the original vector by this</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 100 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(L,K,P,s=sapply(L,P),y=cut(cumsum(s),seq(0,sum(s),K),,T))for(l in levels(y))cat(L[y==l],"
")
</code></pre>

<p><a href="https://tio.run/##bU27CsMwENvzFSbTHVzB7lz3B5IhQ7fSIRgbAs6jOTvEX@@6z6lICAkhtGYnTofs4mTCME/QUkMdseZ@WXwqsUNK2sQAJo4cR2AktneQ9AkNEl0Q3byCF8MkvN2sZ0iIpg/QXpPW/kZ1VWN2YMpOFUikI/0@d9zPEqt3LRQJ@aL66tP8GeQH" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>

<p>outgolfed handily by <a href="https://codegolf.stackexchange.com/a/169571/67312">digEmAll</a></p>
</div>
<div id="pu4" class="pu"><h1>Mathematica, 82 bytes</h1>

<pre><code>f[l_,s_,p_]:=Last@Reap[i=t=-1;Do[If[p@e,If[++i~Mod~s==0&amp;&amp;i&gt;0,t++]];e~Sow~t,{e,l}]]
</code></pre>

<p>Ungolfed:</p>

<pre><code>f[l_,s_,p_] :=                (* define a function that takes three    *)
                              (* arguments                             *)

  Last@Reap[                  (* collect and return results which were *)
                              (* gathered by the procedural loop below *)

    i=t=-1;                   (* initialize two counters               *)

    Do[                       (* start iterating over the list         *)

      If[p@e,                 (* if element passes predicate           *)
        If[                   (* then if preincremented i is 0 modulo  *)
          ++i~Mod~s==0&amp;&amp;i&gt;0,  (* chunk size and i &gt; 0                  *)
          t++                 (* increment t                           *)
        ]
      ];e~Sow~t,              (* finally sow the element tagged with   *)
                              (* the current value of t                *)

    {e,l}]                    (* e references current element of list  *)
                              (* l is the list itself                  *)
  ]
</code></pre>

<p><code>l</code> is the input list; <code>s</code> is chunk size; <code>p</code> is an unnamed/anonymous/pure/lambda function that returns true/false operating on elements of the list. </p>

<p><code>Last@Reap[...]</code> returns a list of lists of every element that was <code>Sow</code>-n inside of <code>...</code>. They are grouped into sublists by the second argument of <code>e~Sow~t</code> which is shorthand for <code>Sow[e, t]</code>.</p>

<p>I had to initialize counters to -1 to handle a chunk size of 1, otherwise I would need to check <code>Mod[i, s]</code> (<code>i~Mod~s</code>) equal to 1, which could never happen.</p>

<p>The rest of the code is explained in the ungolfed block.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 58 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(v,g,n,a=(cumsum(Map(g,v))-1)%/%n)split(v,a*(a&gt;0))
</code></pre>

<p><a href="https://tio.run/##tVJNb8IwDD2vvyIXFBuZrWw3tCLxA8ZluwGH0qVdpJJWjYuYpv32LkkHggp2W5tG8fPziz/adLl4nnR5azLWlYE9FWQoTSBrd7bdwUtaQ0F7xMkURw8jg7YuNTtaOoZ0HiN2rCxbpyFKbRkicfFow6pQDSANHBnEJC7Wdco0rL@dx/02Kz5j3VaUC0lCbv02OC2uYNuhAy8FMVqGtnjlRzq@TxjlumTVnLXs7u7U/gMe5jH9E5IkLtVB1S7NKK8a0G5UYjorlSn4A8JMEb882Z99rgFbrfRm41HjoaV1prf6kjz0W9yJ578sZZBj8eaFJGmSYiJWkrh65UabItyGJDckTCLd3@fa2cskjp6lNbeNuq9arluG2kUwbKv3T@g5iC50tjZrI8mqOpFuDv7SnpgHceqpZLD3hYRcgLO@o@4H" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>

<ul>
<li>-5 bytes thanks to @Giuseppe</li>
</ul>
</div>
<div id="pu6" class="pu"><h2>Haskell, 72 bytes</h2>

<pre><code>p#s|let l@(h:t)!a|sum[1|e&lt;-h:a,p e]&gt;s=a:l![]|n&lt;-a++[h]=t!n;_!a=[a]=(![])
</code></pre>

<p><a href="https://tio.run/##jYzNCsIwEITvPsW2FZrQFlq91abY5whBthhIMY3FxFvePVZFUPCPGeYw@@0otAepdQhTYr2WDvSWqNrRCL09j7zysilUjfkEUrSWYa0jLrxpCswyrgRzkdnsImQcBSPziYYRBwMM9scFwHQajIMlENKWFBJYUeDiQ1/m8OIvXHXzH8Qjf6DlE/p2m7G0S68/awpx18/q7tnH4QI" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>

<pre><code>p#s     = (![])         -- main function that takes a predicate function 'p',
                        -- a size 's' and a input list without a name that is
                        -- directly passed as the first argument to function '!'
  let  l@(h:t)!a        -- function '!' is a local function (so that 'p' and 's'
                        -- are in scope). Takes a list 'l' of at least one element
                        -- 'h' (and 't' being the rest of the list) and an
                        -- accumulator 'a'
   |sum[1|e&lt;-h:a,p e]&gt;s -- if 'p' holds for more than 's' elements in 'h' and 'a'
     =a:l![]            --   put 'a' in front of a recursive call with the same list
                        --   'l' and an empty accumulator
   |n&lt;-a++[h]           -- else bind 'n' to 'h' appended to 'a' and
     =t!n               --   call '!' again with 't' and 'n'
  _!a=[a]               -- base case for '!'. If the input list is empty, return
                        --   a singleton list with 'a' 
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 10 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>

<pre><code>vⱮTm⁵ḊœṖŒṘ
</code></pre>

<p>A full program taking the monadic black-box function as the first optional argument, the list as the second optional argument and the chunk size as the third optional argument which prints a Python representation of the resulting list of lists (to avoid Jelly's implicit smashing of lists containing characters).</p>

<p><strong><a href="https://tio.run/##y0rNyan8/7/s0cZ1IbmPGrc@3NF1dPLDndOOTnq4c8b///@VHjXuedQw11Hpv5JjEhA6Qsgkpf/GAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong> (note that a list of characters is passed to a Jelly program by formatting it as a Python quoted string)</p>

<h3>How?</h3>

<pre><code>vⱮTm⁵ḊœṖŒṘ - Main Link: B, L, S
 Ɱ         - map across second argument with (i.e. for X in L):
v          -   evaluate as a monad with input (i.e. B(X))
  T        - truthy indices (e.g. [0,0,1,0,1,1,1,0,0,0,1,0,0]T -&gt; [3,5,6,7,10])
    ⁵      - 3rd optional argument = S
   m       - modulo slice   (e.g. [3,4,7,9,12,15,16,18,19,20]m3 -&gt; [[3,4,7],[9,12,15],[16,18,19],[20]]
     Ḋ     - dequeue        (e.g. [[3,4,7],[9,12,15],[16,18,19],[20]]Ḋ -&gt; [[9,12,15],[16,18,19],[20]]
      œṖ   - partition right (L) at the indices in that
        ŒṘ - print Python representaion
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, <strike>70</strike> 66 bytes</h1>

<p>I use a structure to note the start of a sub-list, as C doesn't know about such things.</p>

<p>Thanks to ceilingcat for the suggestions.</p>



<pre class="lang-c prettyprint-override"><code>t;f(a,s,c)l*a;int(*c)();{for(;a-&gt;v;a++)(t+=c(a-&gt;v))&gt;s?t=++a-&gt;s:0;}
</code></pre>

<p><a href="https://tio.run/##tVBBTsMwELznFSsjiu24tIVbTVrlHVGEHDdpLUxTxY4lFOXtYZ0CEhJw42LvzO7s2KOXR62nG3PWtj/U8OT8wbT3p13yjbKmilzi3y71oW7A@a7XHiwMCUBozQF4kLDiEJTta@ArpM3Zg5tJ51XnoUVZX1njfOyPYOXkZUOVcEIzy5VEAeWaUSaHpu2oVMtdkCpNGfVppmmEjO3c3mdpisBt13KcbLR0RQnZ/JaB5ERsRoFFReYrJz@g/I9e9fvIekxGmSTzz17M5bmi@qQ64I7BAF3t@@6MIMvu8jsJ43XwVZkzjYXqjlrAVcARBDa/2MboPuPCpdkDOiDEZFCw27Arq3xrIhOKTcnmiUuHkoaSoiBMQkzM8pDFNGSIycVjsfiYQuD2pBQF2RJBGPtS3zoiQprGbCVceu8oKUtciAaowmUi2ovrd2f6n33HaXp8Bw" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
</div>
<div id="pu9" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, 57 bytes</h1>



<pre class="lang-ruby prettyprint-override"><code>-&gt;a,n,g{c=-1;a.group_by{|x|[0,c+=g[x]?1:0].max/n}.values}
</code></pre>

<p><a href="https://tio.run/##jZBBCsIwEEX3PcVspIppTHWnpNJzhCBJaOtCa6lUU5KcPYZqsa7q8Gf4DO8zMG0ne19Sn2QC1agyiibpQeCqvXXNSfbGassIUmtaMc2P6Z5wfBV6Uzv8EJeuuDvPIgjFGEewRUmmjYYMiOPosycIfhS4AMKUhC@aDvoPGuc8TSb07IXFc5mDhHfnMPVyFVK7MUUpxHnseMRxIdTZ2OGFtoGSDY47/wI" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>

<p>Anonymous lambda accepting input array <code>a</code>, chunk size <code>n</code>, and predicate <code>g</code>. Maintains a counter <code>c</code> of items matching predicate and groups items by the number of chunks already used up. Unfortunately, the initial value -1/n doesn't round up to 0, so we have to spend a few bytes to fix it.</p>
</div>
<div id="pu10" class="pu"><h1><a href="https://github.com/JCumin/Brachylog" rel="nofollow noreferrer">Brachylog</a>, 37 bytes</h1>

<pre><code>hW&amp;t~c.k{↰₂ˢl}ᵐ;WxĖ∧.bhᵐ↰₂ᵐ∧.t↰₂ˢl≤W∧
</code></pre>

<p><a href="https://tio.run/##SypKTM6ozMlPN/r/PyNcraQuWS@7@lHbhkdNTacX5dQ@3DrBOrziyLRHHcv1kjKAPIgUiAEUKYErfNS5JBwo8l/JUel/tLGOQjSQoaOglAQi0FiOWMSS0CViY/9HAQA" rel="nofollow noreferrer" title="Brachylog – Try It Online">Try it online!</a></p>

<p>I was pleasantly surprised to find that this - pretty much a restatement of the question - successfully terminates and produces correct output. </p>

<p>Assumes the predicate is present as predicate 2 below this code. Outputs a list of lists ("chunks"), or <code>false</code> for an empty input. </p>

<h3>Explanation:</h3>

<pre><code>hW&amp;               % First input is W, the expected "weight" of each chunk
                  %  (i.e. the number of items passing predicate in each chunk)

t                 % Take the second input, the list of items
 ~c.              % Output is a partition of this list
    k{    }ᵐ      % For each partition (chunk) except the last, 
      ↰₂ˢ         %   Select the items in the chunk that pass the predicate
         l        %   Get the length of that
                  % (So now we have the list of the "weights" of each chunk)
            ;Wx   % Remove the input expected weight from this list, and 
               Ė  %  the result of this should be empty.
                  %  This verifies that the list of weights is either 
                  %  composed of all W-values, or is empty (when input is [0 0 0] for eg.)

    ∧.bhᵐ↰₂ᵐ      % And, the first element of each chunk (except the first) should
                  %  pass the predicate. This is another way of saying:
                  %  "Items failing the predicate are allocated to the earliest chunk"

    ∧.t↰₂ˢl≤W     % And, the final chunk (which we haven't constrained so far)
                  %  should have weight ≤ the input expected weight
                  %  This disallows putting everything in the final chunk and calling it a day!

    ∧             % (no further constraints on output)
</code></pre>
</div>
<div id="pu11" class="pu"><h1><a href="https://github.com/Ourous/curated-clean-linux" rel="nofollow noreferrer">Clean</a>, <s>96</s> 92 bytes</h1>

<p>Uses a named function <code>f :: a -&gt; Bool</code> allowed according to meta consensus.</p>

<pre><code>import StdEnv,StdLib
$l n|l&gt;[]=last[[i: $t n]\\i&lt;-inits l&amp;t&lt;-tails l|n&gt;=sum[1\\e&lt;-i|f e]]=[]
</code></pre>

<p><a href="https://tio.run/##JU67CsMwENvzFTeETgkkHUucqR0K2TLaHtw8ysH5UupLaSHfXtc0CCEJgdBAk@Pol3GlCbxDjugfy1Ogl/HCryJJh7csJ@CNWm0VuSBa4wlyAbbGYFMiowSggzSlOKRkN25VWL2ujZlSv80wWau0jb24tK0gB10VdUL1Z2XhmM3wTk2igjp@h5ncPcTy2sXzh53HYQ/7oR8" rel="nofollow noreferrer" title="Clean – Try It Online">Try it online!</a></p>



<p>Expanded (with default highlighting to make comments show up):</p>

<pre class="lang-default prettyprint-override"><code>$ l n // define function $ on `l` and `n`
 | l &gt; [] // if `l` is not the empty list
  = last [ // the last element of ...
                   \\ i &lt;- inits l // prefixes of `l`
                    &amp; t &lt;- tails l // matching suffixes of `l`
                    | n &gt;= // where n is greater than or equal to
                           sum [1 \\ e &lt;- i | f e] // the number of matching elements in the prefix
          [i: $t n] // prepend that prefix to the application of $ to the rest of the list
         ]
 = [] // if `l` is empty, return empty
</code></pre>
</div>
<div id="pu12" class="pu"><h1>JavaScript (ES6), 69 bytes</h1>
<p><em>Saved 3 bytes thanks to @tsh</em></p>
<p>Takes input in currying syntax <code>(size)(predicate)(array)</code>.</p>

<pre class="lang-javascript prettyprint-override"><code>s=&gt;p=&gt;g=a=&gt;a.every(x=&gt;p(x)?k--:++j,j=k=s)?[a]:[a.splice(0,j),...g(a)]
</code></pre>
<p><a href="https://tio.run/##lY7LDsIgEEX3/YrZFSJF1J3JYPwOwgIr1j4iTTGmfn1F46PaJmoyQJiZe@4tzMn4tMnrY3JwW9vtsPMoa5QZGpSG25NtzqQNLdLSVZkky8mkYAWW6OlKGb1Uhvu6ylNLBCso45xnxFDdTadg8@PeNqA0uHArraPUHbyrLK9cRnZkTkkLKKEFCYISpSmNoqBTSjB4q6/SgaCPmt3qJ8hjdUzOQM1@j3NXPe4BUjyHd/AfEUUPPEgcr2MWb8J5vVeH2/d99NEemC@e5ogQloL/CJyNkPu9kKy7AA" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu13" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 90 bytes</h1>



<pre class="lang-javascript prettyprint-override"><code>(s,p,r=[l=[]],n=s+1)=&gt;g=a=&gt;0 in a?g(a,(n=(n||s)-p(v=a.shift()))||r.push(l=[]),l.push(v)):r
</code></pre>

<p><a href="https://tio.run/##jY3BCoJAEIbvPcXenKFVtG7FGF58CfGwmqkhq@yaePDdNzWCkiRh@JmZ//9m7qITOlVl09qyvmYmZGRA84YriiqK4phL0nsPyc9JkO@yUjJxyUFwkARyGDTaDXQkHF2UtxYQcRiU0zx0AROPvHoNHeJJmbSWuq4yp6pzCOHAe/J730UYg3jerbouZ1/1N@3NtTn31k2A@wGs/znOGJEVWCM5KmdWMsmiC37skqUx3TdP" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>

<p>Invoke as <code>F(2, x =&gt; x &gt; 0)([0, 1, 1, 0])</code></p>
</div>
<div id="pu14" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, 92 bytes</h1>



<pre class="lang-python prettyprint-override"><code>lambda a,c,p:reduce(lambda r,v:[r[:-1]+[r[-1]+[v]],r+[[v]]][sum(map(p,r[-1]+[v]))&gt;c],a,[[]])
</code></pre>

<p><a href="https://tio.run/##jY3NCoMwEITvfYrcTHAL0d4CCj7Hdg@JP7RQbUhV7NOnKtYWKVhYZpb5hl37bC/3JvZVcvY3XZtCMw05WOXKostLvmQOeoUO1TGicPTZeiJwIU5O@OhqXmvLLaxUiDQn0IBIJLx116ZlFUeCGJargxpSKQ4rksCieeRfpbfut@VXe/9DkAXAAjPJZst@ZGYLCNgJ2Od2koxEeP8C" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/169506/">169506</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




