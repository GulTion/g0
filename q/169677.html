<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::169677</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>025</td><td>Uiua SBCS</td><td>240213T093607Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/270048#270048">chunes</a></td></tr>
<tr d-ix="1"><td>173</td><td>Java 10</td><td>180801T071732Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169690#169690">Kevin Cr</a></td></tr>
<tr d-ix="2"><td>096</td><td>Python 3</td><td>180731T235507Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169678#169678">Aneesh D</a></td></tr>
<tr d-ix="3"><td>037</td><td>J</td><td>221228T035541Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/256097#256097">Jonah</a></td></tr>
<tr d-ix="4"><td>144</td><td>Haskell</td><td>221227T111242Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/256075#256075">Roman Cz</a></td></tr>
<tr d-ix="5"><td>093</td><td>JavaScript Node.js</td><td>221227T131704Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/256077#256077">l4m2</a></td></tr>
<tr d-ix="6"><td>274</td><td>Haskell</td><td>180801T143617Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169722#169722">AlexJ136</a></td></tr>
<tr d-ix="7"><td>115</td><td>C gcc</td><td>180807T164057Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/170156#170156">vazt</a></td></tr>
<tr d-ix="8"><td>081</td><td>Octave</td><td>180801T085645Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169696#169696">Sanchise</a></td></tr>
<tr d-ix="9"><td>022</td><td>MATL</td><td>180802T081335Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169804#169804">Sanchise</a></td></tr>
<tr d-ix="10"><td>108</td><td>Haskell</td><td>180802T101334Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169815#169815">Lynn</a></td></tr>
<tr d-ix="11"><td>093</td><td>MATLAB</td><td>180802T104615Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169816#169816">Jacob Wa</a></td></tr>
<tr d-ix="12"><td>072</td><td>Perl 6</td><td>180801T021303Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169685#169685">Jo King</a></td></tr>
<tr d-ix="13"><td>024</td><td>Jelly</td><td>180801T173043Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169747#169747">Erik the</a></td></tr>
<tr d-ix="14"><td>087</td><td>R</td><td>180801T130745Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169714#169714">digEmAll</a></td></tr>
<tr d-ix="15"><td>099</td><td>JavaScript ES6</td><td>180801T074057Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169693#169693">Arnauld</a></td></tr>
<tr d-ix="16"><td>038</td><td>K ngn/k</td><td>180801T084028Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169695#169695">ngn</a></td></tr>
<tr d-ix="17"><td>098</td><td>Python 2</td><td>180801T074050Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169692#169692">TFeld</a></td></tr>
<tr d-ix="18"><td>027</td><td>Jelly</td><td>180801T014651Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169682#169682">Lynn</a></td></tr>
<tr d-ix="19"><td>044</td><td>Charcoal</td><td>180801T001249Z</td><td><a href="https://codegolf.stackexchange.com/questions/169677/beware-of-the-matrix-tornado/169679#169679">Neil</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://uiua.org" rel="nofollow noreferrer">Uiua</a> <sup><a href="https://tinyurl.com/Uiua-SBCS-Jan-14" rel="nofollow noreferrer">SBCS</a></sup>, 25 bytes</h1>
<pre><code>∧(⍜(↘⊙↻|≡⇌⍉)×¯2.⊟.)⇡⌈÷2⧻.
</code></pre>
<p><a href="https://uiua.org/pad?src=0_9_0__ZiDihpAg4oinKOKNnCjihpjiipnihrt84omh4oeM4o2JKcOXwq8yLuKKny4p4oeh4oyIw7cy4qe7LgoKZiBbWzFdXQoKZiBbWzEgMl0KICAgWzUgMF1dCgpmIFsiQUJDREUiCiAgICJGR0hJSiIKICAgIjEyMzQ1IgogICAiNjc4OTAiCiAgICIrLS8qJSJdCg==" rel="nofollow noreferrer">Try it!</a></p>
<p>Fun problem.</p>
<pre><code>∧(⍜(↘⊙↻|≡⇌⍉)×¯2.⊟.)⇡⌈÷2⧻.
                   ⇡⌈÷2⧻.  # create range for each ring
∧(                )        # fold over range and matrix, using matrix as accumulator
                ⊟.         # create pair indicating how much to rotate matrix on each axis
            ×¯2.           # and another pair indicating how much to drop from each axis
  ⍜(   |   )               # call the left part, then the right, then the inverse of left
        ≡⇌⍉                # rotate matrix clockwise
    ↘⊙↻                    # but only the interior
</code></pre>
</div>
<div id="pu1" class="pu"><h1>Java 10, <s>198</s> <s>192</s> <s>181</s> <s>174</s> 173 bytes</h1>

<pre class="lang-java prettyprint-override"><code>m-&gt;{int d=m.length,b=-1,i,j;var r=new Object[d][d];for(;b&lt;d/2;){for(i=b++;++i&lt;d-b;)for(j=b;j&lt;d-b;)r[j][d+~i]=m[i][j++];for(i=d;i--&gt;0;)m[i]=r[i].clone();}return r;}
</code></pre>
<p>-25 bytes thanks to <em>@ceilingcat</em></p>
<p><a href="https://tio.run/##ndRrb5swFAbg7/sVR5WmwLg0ydbdXCp167bu0nRbdo/ywYCTmoLJjJOuithfz14ClVIJpKkSD5I5HNsc@ZDwFfeS@HITpbwo6IxLtb5HJJUResYjQaNqSHQeJiIyk@lkSpG1M8hshngJuArDjYxoRIoC2mTe0RrzUBxkfirU3Fy4YeANXOkmbMU16UCJq5uJ4ykuNsu1xcLDeH/I7HU1kEHoOMxx5GHshcyuHiVByJJ6qCcJ0py/chpkEzmdJI5TzyGDmEnPO@ozuwoEGjc/SnMlLJuVWpilVqRZuWH1xhfLMMXGm/2vchlThkpYY6OlmuMzuV2XwYjCWDvbRgnqANHu03XvuOf2XsBLOIFX8Bre9Eq3NeEUwbfwDt7DBziDUVfCOYIf4RN8hjF8ga9dCd8Q/A4/4Cf8Ag5hV0KEYAwCZjCHC5BdCQmCl5BCBgpyWHQl/EZQQwEGlrCCq165fb/cnq7/L/veqUjTfO9uyQN32L7NA7d/txlbTkFHIeqj4e6cgvYXiQYu0RAewiM46HrxMYJP4Ck8g37H0g6W82AfHsD9W7W/3dnbzth@/e4vgKNL/jQNUnXfTYw/V35kNWG7WXx8XRiR@fnS@As0l0mVleAf5C@NTP1jrfl14Zu8bjyL203FW7Ka7ZWbfw" rel="nofollow noreferrer">Try it online.</a></p>
<p><strong>Explanation:</strong></p>
<pre class="lang-java prettyprint-override"><code>m-&gt;{                      // Method with Object-matrix as both parameter &amp; return-type
  int d=m.length,         //  Dimensions of the matrix
      b=-1,               //  Boundaries-integer, starting at -1
      i,j;                //  Index-integers
  var r=new Object[d][d]; //  Result-matrix of size `d` by `d`
  for(;b&lt;d/2;){           //  Loop `b` in the range (-1,`d/2`]:
    for(i=b++;++i&lt;d-b;)   //   Inner loop `i` in the range [`b`,`d-b`):
      for(j=b;j&lt;d-b;)     //    Inner loop `j` in the range [`b`,`d-b`):
        r[j][d+~i]=       //     Set the `j,d-i-1`'th result-cell to:
          m[i][j++];      //      The `i,j`'th cell-value of the input-matrix
    for(i=d;i--&gt;0;)       //   Inner loop `i` in the range (`d`,0]:
      m[i]                //    Change the `i`'th row of the input-matrix
        =r[i].clone();}   //     to a copy of the `i`'th row of the result-matrix
  return r;}              //  Return the result-matrix
</code></pre>
<p><code>b</code> is basically used to indicate which ring we're at. And it will then rotate this ring (including everything inside it) once clockwise during every iteration.</p>
<p>The replacement of the input-matrix is done because Java is pass-by-reference, so simply setting <code>r=m</code> would mean both matrices are modified when copying from cells, causing incorrect results. We therefore instead have to copy the values in every cell one row at a time, without copying their reference (by using <code>.clone()</code>).</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>100</s> <s>97</s> 96 bytes</h1>
<p><sup>-3 bytes thanks to <a href="https://codegolf.stackexchange.com/users/55479/graipher">Graipher</a> by changing <code>rot90(a,axes=(1,0))</code> to <code>rot90(a,1,(1,0))</code><br />
-1 byte thanks to <a href="https://codegolf.stackexchange.com/users/52210/kevin-cruijssen">Kevin Cruijssen</a> by removing a space</sup></p>

<pre class="lang-python prettyprint-override"><code>import numpy
def f(a):
 if len(a):a=numpy.rot90(a,1,(1,0));a[1:-1,1:-1]=f(a[1:-1,1:-1]);return a
</code></pre>
<p><a href="https://tio.run/##jY9LU4MwFIX3@RXZOCGaKrRWLZ0ufNf3@8mwQAsWCwEj6PTX47ltFl246OL75t455M6hnFbjQneaJs3LwlRc13k5ZaM44YkTSZ/xNOFZrGmOBrNw3RRVz3Ui5SnHU66U/Sjw/JanSOEAzxZW2TdxVRvNoyYpDM94qnE4CMQwzrJChKH0S5Pqyskkmw@SsYUvWRB4irdDxXjQVdxd5oHYFYqLPdI@6YB0KGY3xBEtx6Qh6YR0ajOPljapQ9okdW22Rcs2aYfUI7k2W6OlRdogrZJWxLJVqSkVpZ6oqagiGs5PoyR1REUlzsA5uACXNr/CfA1uwC24A/fgweaPmJ/AM3gBryACbzZ/xzwCMUjABxiD1OafmCcgAznQoAClzb8wG/ANKlCDH/D77@83fw" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="http://jsoftware.com/" rel="nofollow noreferrer">J</a>, 37 bytes</h1>
<pre><code>&lt;./~@g`(|:@|.^:(1&lt;@+&gt;./@g=.#\.&lt;.#\))}
</code></pre>
<p><a href="https://tio.run/##JYnBCoJAFEX3fsW1FqOUz9wkThpDRato0boiy1Enwgm1QrB@3aQW95wD99oFJvcOU5MHjBkDYikiDoYxJuD9HMJyt1l3IbkfkZ2slouWjtzyQjGakyuyiIZ7CnvY9ruzje2CsFLV/RY3MkGlEolz8/dL1TkehVPrsogT3d9PWVZKF4a85BqWIh@@jRlS/LL7Ag" rel="nofollow noreferrer" title="J – Try It Online">Try it online!</a></p>
<p>Independently solved, but this approach is very similar to Lynn's.</p>
<p>It is also one of the most perfect problems for J's little used &quot;composite item&quot; <code>}</code> (in gerund form) that I have come across.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, 144 bytes</h1>

<pre class="lang-hs prettyprint-override"><code>import Data.List
k=transpose
v=init.tail
t[[o]]=[[o]]
t m=k.reverse.(head m:).(++[last m]).
 k.((v.head$k m):).(++[v.last$k m]).
 k.t.map(v).v$m
</code></pre>
<p><a href="https://tio.run/##LcpJTsQwEIXhvU9RamXhqKU6AJIXQDM3MzRDlEVBDDEesQv38QNBvXmL938jFaudmybjU8wMK2LCtSksrOJMoaRYtKjKBMPIZJzgrot9r/5XMHhlMeuqc9EoR00D@L0W5XLZOSp/uW9RgEUpK861seDbHag4k/nZIUZPSdYWa@MnTyaolE3ghpttzENZ7B8cro6OT@D07PxifXkF1ze3d/cPj7B5en55pTd4H/TH52jgyzofYoLvXPinbhfTLw" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>
<p><code>v</code> cuts out center (rows). <code>map v</code> cuts out center columns.
<code>t</code> recurses into the tornado. <code>k</code> exposes columns as rows.
<code>(++[v.last$k m])</code> appends center of last column.
<code>((v.head$k m):)</code> prepends center of first column.
<code>k</code> flips rows out again.
<code>(++[last m])</code> appends last row unprocessed.
<code>(head m:)</code> prepends last row unprocessed.
<code>k.reverse</code> rotates matrix.</p>
</div>
<div id="pu5" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 93 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=(a,k=0,L=a.length+~k)=&gt;L?f(a.map((b,x)=&gt;b.map((c,y)=&gt;x&lt;k|y&lt;k|x&gt;L|y&gt;L?c:a[k+L-y][x])),k+1):a
</code></pre>
<p><a href="https://tio.run/##ddHbboIwHAbwe56iN6YgRUDF04aL50N4g6YXlaHbYGCmWSAxe3X2AbK4uJH8Lkq/j39T3uSnPPkfr8ezESfPQZ7vXVWy0LWY58pWFMSH84v@FWru2Hvaq7L1Lo@qumMpXuyqhc8yLNLH8JJBOvYuGbL@SPJQ94xM8FRoGgt1WxvJ3E/iUxIFrSg5qHtVIYRzug6iKKFCkN@Pad5uKpr2oPzRthlpC0buHrSx6xBGbMGQJNxhxLobck0SbpHiQ/@OoRPK6BRmMIcFLaeWh9TR7RWTYAmT60S6RHAFa9jA9qdEuIHgEAbQh2ldshFsQwe64NyUTAS70ClOC7O61EOwDwMYgnVTaiK4gTWsYF6XdAQNMKEJjeonlKUGgsWdFDe4hUV1N/k3" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<pre class="lang-javascript prettyprint-override"><code>f=(
  a,             // Input
  k=0,           // Range Left
  L=a.length+~k  // Range Right
)=&gt;L?            // More than enough
  f(
    a.map((b,x)=&gt;b.map((c,y)=&gt;x&lt;k|y&lt;k|x&gt;L|y&gt;L?c:
      a[k+L-y][x]// k+L=a.length-1
  )),k+1)
:a
</code></pre>
</div>
<div id="pu6" class="pu"><h1>Haskell, 274 bytes</h1>

<p><code>w</code> is the main function, which has  the type <code>[[a]] -&gt; [[a]]</code> that you would expect.</p>

<p>I'm sure a more experienced Haskell golfer could improve on this.</p>

<pre><code>w m|t m==1=m|0&lt;1=let m'=p m in(\a b-&gt;[h a]++x(\(o,i)-&gt;[h o]++i++[f o])(zip(tail a)b)++[f a])m'(w(g m'))
p m|t m==1=m|0&lt;1=z(:)(f m)(z(\l-&gt;(l++).(:[]))(r(x h(i m)):(p(g m))++[r(x f(i m))])(h m))
t[]=1
t[[_]]=1
t _=0
h=head
f=last
x=map
i=tail.init
g=x i.i
z=zipWith
r=reverse
</code></pre>
</div>
<div id="pu7" class="pu"><h1><a href="https://gcc.gnu.org/" rel="nofollow noreferrer">C (gcc)</a>, <strike>128</strike> <strike>118</strike> 115 bytes</h1>

<p>-15 bytes from @ceilingcat</p>



<pre class="lang-c prettyprint-override"><code>j,i;f(a,b,w,s)int*a,*b;{for(j=s;j&lt;w-s;j++)for(i=s;i&lt;w-s;)b[~i++-~j*w]=a[i*w+j];wmemcpy(a,b,w*w);++s&lt;w&amp;&amp;f(a,b,w,s);}
</code></pre>

<p><a href="https://tio.run/##dVLbrpswEHyGr7CQesRlI@Hl0lYkX0J5wLRpQUoahVQkQpxfT8eGgzm9SN5E3p3ZmXHS7L43zfPZUVsc/ZoUDdQH7fkW1hSqYjz@vPrdoS@6/bDDZxQFutOi05pOoMrXNop2r104VIe6bMMh6qpiOH07NZfHvDAcgiKK@v3w8mIliul5wWVVK5of9TXsC3d0ncsVraPvfegPX86eBruOkT3fxEMcRFzgay@GQkTRI3AdUNb5fZ7f3@Z3zA3AbuWvwiMR@nX0gNt7oNc7E@ry69b7nqfvuNrb5Lqnuj37gTanRWpZygoHWuMopJgmUBBHkiSvlmaDxqkFp/3rqdKAmOLAwM3NUwa@7OWSK5xlLwkWE2nvo0hIpKsOE0OHrc7Cm3WYlAZYHQNXvNFJy7TCmXW0kGAUNLQICdcRWlNkaOSoj6hPxsrc/0xCxigQJdu@xAKZosCT@eo2pRRuU@t2UZ/dpqQ0wLo1cJVu3GZlVuH8yy0q2zpe3dLicuPOuKWNy80MPAmeBE@Cxxse698BPAaPwePMJDPRMsoQLbPRFqtztIyUBthoBq6yTbS8zCuc/0XT7z/HM@neJXv3/n8//1sgOza56I8865jBYrAYLIYIA57E9v8HVgJWAlYCkQTwxP7GOeV4iNw@xBJsfoiclAbYhzBwZeDT8zc" rel="nofollow noreferrer" title="C (gcc) – Try It Online">Try it online!</a></p>
</div>
<div id="pu8" class="pu"><h1><a href="https://www.gnu.org/software/octave/" rel="nofollow noreferrer">Octave</a>, <s> 86</s> 81 bytes</h1>

<pre class="lang-matlab prettyprint-override"><code>f(f=@(g)@(M,v=length(M))rot90({@(){M(z,z)=g(g)(M(z=2:v-1,z)),M}{2},M}{1+~v}(),3))
</code></pre>
<p><a href="https://tio.run/##FY5BCoMwFET3PcUs/6ep@H@0akPAC@QEpYtS1C5KxSIuFHv1NN0Mw2MezPiY70sXJ59lWeyp9y0N3FIwi39172F@UmD@jHOT09YSb4FWs7If0opS93pZTpIIm7Bvuv9Tjt9lJzaWOQZ/FSgsCpTujAo1GkjuRCAKsZACUjo5QypIDWmgudPkKNRCC2h5O0zpRPwB" rel="nofollow noreferrer" title="Octave – Try It Online">Try it online!</a></p>
<p>I'm aware that recursive anonymous functions are not the shortest method to do things in Octave, but they're the most <em>fun</em> method by far. This is the shortest anonymous function I could come up with, but I'd love to be outgolfed.</p>
<h3>Explanation</h3>
<p>The recursive function is defined according to <a href="https://codegolf.stackexchange.com/a/164483/32352">this</a> <a href="/questions/tagged/tips" class="post-tag" title="show questions tagged &#39;tips&#39;" rel="tag">tips</a> answer by ceilingcat. <code>q=f(f=@(g)@(M) ... g(g)(M) ...</code> is the basic structure of such an anonymous function, with <code>g(g)(M)</code> the recursive call. Since this would recurse indefinitely, we wrap the recursive call in a conditional cell array: <code>{@()g(g)(M),M}{condition}()</code>. The anonymous function with empty argument list delays evaluation to after the condition has been selected (although later, we see that we can use that argument list to define <code>z</code>). So far it has just been basic bookkeeping.</p>
<p>Now for the actual work. We want the function to return <code>rot90(P,-1)</code> with P a matrix on which <code>g(g)</code> has been recursively called on the central part of M. We start by setting <code>z=2:end-1</code> which we can hide in the indexing of M. This way, <code>M(z,z)</code> selects the central part of the matrix that needs to be tornadoed further by a recursive call. The <code>,3</code> part ensures that the rotations are clockwise. If you live on the southern hemisphere, you may remove this bit for -2 bytes.</p>
<p>We then do <code>M(z,z)=g(g)M(z,z)</code>. However, the result value of this operation is only the modified central part rather than the entire <code>P</code> matrix. Hence, we do <code>{M(z,z)=g(g)M(z,z),M}{2}</code> which is basically stolen from <a href="https://codegolf.stackexchange.com/a/163110/32352">this</a> <a href="/questions/tagged/tips" class="post-tag" title="show questions tagged &#39;tips&#39;" rel="tag">tips</a> answer by Stewie Griffin.</p>
<p>Finally, the <code>condition</code> is just that the recursion stops when the input is empty.</p>
</div>
<div id="pu9" class="pu"><h1><a href="https://github.com/lmendo/MATL" rel="nofollow noreferrer">MATL</a>, <s> 25 24 23</s> 22</h1>

<pre><code>t"tX@Jyq-ht3$)3X!7Mt&amp;(
</code></pre>

<p><a href="https://tio.run/##DcuxCsJAEEXRX7mKSCyEvJndbMI2qQP2AbGwS5EUwjR@/erpz/GOvbU4xzov3899C7/cfD2VR1y71p7CcBK5DhRGJtRXCRlylFCuGlBBI5qwvtr/GOZYwvLrBw" rel="nofollow noreferrer" title="MATL – Try It Online">Try it online!</a></p>

<p>Indexing in MATL is never easy, but with some golfing it actually beats the current best Jelly answer...</p>

<pre><code>t                       % Take input implicitly, duplicate.  
 "                      % Loop over the columns of the input*
   X@                   % Push iteration index, starting with 0. Indicates the start of the indexing range.
     Jyq-               % Push 1i-k+1 with k the iteration index. Indicates the end of the indexing range
         t              % Duplicate for 2-dimensional indexing.
  t       3$)           % Index into a copy of the matrix. In each loop, the indexing range gets smaller
             3X!        % Rotate by 270 degrees anti-clockwise
                7Mt&amp;(   % Paste the result back into the original matrix. 
</code></pre>

<p>*For an <code>n x n</code> matrix, this program does <code>n</code> iterations, while you really only need <code>n/2</code> rotations. However, the indexing in MATL(AB) is sufficiently flexible that indexing impossible ranges is just a no-op. This way, there's no need to waste bytes on getting the number of iterations just right.</p>
</div>
<div id="pu10" class="pu"><h1><a href="https://www.haskell.org/" rel="nofollow noreferrer">Haskell</a>, 108 bytes</h1>



<pre class="lang-hs prettyprint-override"><code>e=[]:e
r=foldl(flip$zipWith(:))e
g!(h:t)=h:g(init t)++[last t]
f[x,y]=r[x,y]
f[x]=[x]
f x=r$(r.r.r.(f!).r)!x
</code></pre>

<p><a href="https://tio.run/##fY5LT8MwEITv/hWbKEg2KQUKtBDJB14thfIsUCDKIRA7MXWd4Dg08OeDW3quVqtv9jAzm8XllEnZNIyGUcCQpjyXicRcisL7FcVEmAwHhDCUOjgLDKFZkGKhhAFDfD@UcWlVhHhYt34iqpdYXBG1izjUVHtYtxeDuUPamjh1M4uFAgpJjgCKyoyNHinwoFJSKFZaxSF0j09Oz87dltsfXAwvLXc7e/sHlt3e4dGOpb@1vbnhRusjVgnLgG5v5Vtv82Ce66SE/wf6A7D1V6PrG7i9u38YPz7B8@Tl9S1@h4@E8TQT8DmVM5UX8KVLU33P3eYP" rel="nofollow noreferrer" title="Haskell – Try It Online">Try it online!</a></p>

<p>I used <a href="https://codegolf.stackexchange.com/a/111362/3852">Laikoni's transpose</a> and modified it a little, to rotate an array 90°:</p>

<pre class="lang-hs prettyprint-override"><code>  e=[]:e;foldr(zipWith(:))e.reverse
≡ e=[]:e;foldl(flip$zipWith(:))e
</code></pre>

<h1>Explanation</h1>

<p><code>r</code> rotates an array by 90°.</p>

<p><code>(!)</code> is a higher-level function: “apply to center”. <code>g![1,2,3,4,5]</code> is <code>[1] ++ g[2,3,4] ++ [5]</code>.</p>

<p><code>f</code> is the tornado function: the base cases are size 1 and 2 (somehow 0 doesn't work).</p>

<p>The last line is where the magic happens: we apply <code>r.r.r.(f!).r</code> on the middle rows of <code>x</code> and then rotate the result. Let's call those middle rows <strong>M</strong>. We want to recurse on the middle <em>columns</em> of <strong>M</strong>, and to get at those, we can rotate <strong>M</strong> and then use <code>(f!)</code>. Then we use <code>r.r.r</code> to rotate <strong>M</strong> back into its original orientation.</p>
</div>
<div id="pu11" class="pu"><h1>MATLAB, 93 bytes</h1>
<pre><code>function m=t(m),for i=0:nnz(m),m(1+i:end-i,1+i:end-i)=(rot90(m(1+i:end-i,1+i:end-i),3));end;end
</code></pre>
<p>I'm sure this can be golfed some more somehow.</p>
<p><strong>Explanation</strong></p>
<pre><code>function m=t(m),                                                                          end % Function definition
                for i=0:nnz(m),                                                       end;    % Loop from 0 to n^2 (too large a number but matlab indexing doesn't care)
                                                            m(1+i:end-i,1+i:end-i)            % Take the whole matrix to start, and then smaller matrices on each iteration
                                                      rot90(                      ,3)         % Rotate 90deg clockwise (anti-clockwise 3 times)
                               m(1+i:end-i,1+i:end-i)=                                        % Replace the old section of the matrix with the rotated one
</code></pre>
</div>
<div id="pu12" class="pu"><h1><a href="https://github.com/nxadm/rakudo-pkg" rel="nofollow noreferrer">Perl 6</a>, <s>78 73</s> 72 bytes</h1>
<p><em>Thanks to nwellnhof for -5 bytes!</em></p>

<pre class="lang-perl6 prettyprint-override"><code>$!={my@a;{(@a=[RZ] rotor @_: sqrt @_)[1..*-2;1..@a-2].=$!}if @_;@a[*;*]}
</code></pre>
<p><a href="https://tio.run/##Tc7JCsIwFAXQfb8ihUrSmMY2WqdQiPOwdGkpkoWCoKjVjUi/vYZLBTfn5XLD492P5aVf14Gffa5vY/WHGZvlu31BytvrVhJzGJPno3y5R5gnUvJIaTeMjVQhs8CvzidXaWNzrnlRuUUsEUqkIg4lNjAVyqu9My6f9h1qz8nccP/ohBJB6BTO4BwuqPAIIXSJtIJruIHbpk@QFOzCHkybvo80gEM4gnHTt5Ei2IEctujv9vT/9voL" rel="nofollow noreferrer" title="Perl 6 – Try It Online">Try it online!</a></p>
<p>Recursive code block that takes a flattened 2D array and returns a similarly flattened array.</p>
<h3>Explanation:</h3>
<pre class="lang-perl6 prettyprint-override"><code>$!={      # Assign code block to pre-declared variable $!
    my@a; # Create local array variable a
   {
     (@a=[RZ]  # Transpose:
             rotor @_: sqrt @_;  # The input array converted to a square matrix
     )[1..*-2;1..@a-2].=$!  # And recursively call the function on the inside of the array
   }if @_;    # But only do all this if the input matrix is not empty
   @a[*;*]  # Return the flattened array
}
</code></pre>
</div>
<div id="pu13" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 24 bytes</h1>

<pre><code>ṙ⁹ṙ€
ḊṖ$⁺€ßḷ""ç1$ç-ZUµḊ¡
</code></pre>

<p><a href="https://tio.run/##y0rNyan8///hzpmPGneCyKY1XA93dD3cOU3lUeMuIO/w/Ic7tispHV5uqHJ4uW5U6KGtQOlDC/8fbnf//z9a3dHJ2cVVXUdB3c3dw9MLxDA0MjYxBTHMzC0sDUAMbV19LVX1WAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<blockquote>
  <p>I think this could be far shorter.</p>
</blockquote>

<p><em>– <a href="https://codegolf.stackexchange.com/a/169682/41024">Lynn</a></em></p>
</div>
<div id="pu14" class="pu"><h1><a href="https://www.r-project.org/" rel="nofollow noreferrer">R</a>, 87 bytes</h1>



<pre class="lang-r prettyprint-override"><code>function(m,n=nrow(m)){for(i in seq(l=n%/%2))m[j,j]=t(apply(m[j&lt;-i:(n-i+1),j],2,rev));m}
</code></pre>

<p><a href="https://tio.run/##jdDLTsMwEAXQvb/CEoo8Qx3aBMo7C94F5Q@ARXCTypVjF9cEEOLbQzo8lOyYxZF8fW1Z9m2VtdWLVUE7C7W0mfXuFWrEj8p50Fxbvi6fwWQ2GkcpYn2/lMvHLECxWpl36JansT4GG@tRgt2OTKUvG8ST@rPd4r838@C4crYpfeBGrwN3FW9KFZxfb7bqInj9xhbZ30tynLsdVRgD/knbucyRMZZnm7OgQMxKY5xAZBUsui4yVQQQ8c88WIG9dsIlT1Ey/j0Kpl0w@edhcSa6tjgnL8hL8kr0rxTXFN6QM/KWvBvWEgpTcpfcI6fD2j6FB@QheUROhrURhTE5JrfJqP81LdvMFw" rel="nofollow noreferrer" title="R – Try It Online">Try it online!</a></p>

<ul>
<li>credits to this <a href="https://stackoverflow.com/a/16497058/316644">StackOverFlow answer</a> for the rotation code</li>
</ul>
</div>
<div id="pu15" class="pu"><h1>JavaScript (ES6), 99 bytes</h1>



<pre class="lang-javascript prettyprint-override"><code>f=(a,k=m=~-a.length/2)=&gt;~k?f(a.map((r,y)=&gt;r.map(v=&gt;y-m&gt;k|m-y&gt;k|--x*x&gt;k*k?v:a[m+x][y],x=m+1)),k-1):a
</code></pre>

<p><a href="https://tio.run/##ddHZboJAGAXge55ibsywzIiouDVg3NFXmHAxsWhbNqPGQNL46nhAbWhsJ/lIgHP4J8OXvMjT9vh5OPMkfQ@KYueokoVO7Fy5bEZBsj9/mG3Nca/heKfKZiwPqnpkOZ4cq5uL4@Y8dsPvmOe4cp7pmRvq4fgykiI2Ml/kPsuc2LA0jYXc0kay2KbJKY2CZpTu1Z2qECIE9YIoSqnvk9/LNOsvFU17U/5oW4y0fUZeFtp4axNGLJ8hSYTNSOtlyCNJRIuUH/p3DJ1QRqcwgzksaDW12qSBbq@cBEuYPCbSJYIr8GANm58SERzBIQygD9NnyUKwDR3ogl0rmQh2oVPuFmbPUg/BPgxgCK1aSUdwDR6sYP4sGQhyMEGHxv0nVKUGguWZlCe4gcX9bIob" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>

<h3>How?</h3>

<p>Given a square matrix of width \$W\$, we define:</p>

<p>$$m=\frac{W-1}{2}\\
t_{x,y}=\max(|y-m|,|x-m|)$$</p>

<p>Example output of \$t_{x,y}\$ for a 5x5 matrix (\$W=5\$, \$m=2\$):</p>

<p>$$\begin{pmatrix}
2 &amp; 2 &amp; 2 &amp; 2 &amp; 2 \\
2 &amp; 1 &amp; 1 &amp; 1 &amp; 2 \\
2 &amp; 1 &amp; 0 &amp; 1 &amp; 2 \\
2 &amp; 1 &amp; 1 &amp; 1 &amp; 2 \\
2 &amp; 2 &amp; 2 &amp; 2 &amp; 2
\end{pmatrix}$$</p>

<p>We start with \$k=m\$ and perform a 90° clockwise rotation of all cells \$(x,y)\$ satisfying:</p>

<p>$$t_{x,y}\le k$$</p>

<p>while the other ones are left unchanged.</p>

<p>This is equivalent to say that a cell is <strong><em>not</em></strong> rotated if we have:</p>

<p>$$(y-m&gt;k) \text{ OR } (m-y&gt;k) \text{ OR } (X^2&gt;k^2)\text{ with }X=m-x$$</p>

<p>which is the test used in the code:</p>

<pre class="lang-javascript prettyprint-override"><code>a.map((r, y) =&gt;
  r.map(v =&gt;
    y - m &gt; k | m - y &gt; k | --x * x &gt; k * k ?
      v
    :
      a[m + x][y],
    x = m + 1
  )
)
</code></pre>

<p>Then we decrement \$k\$ and start again, until \$k=-1\$ or \$k=-3/2\$ (depending on the parity of \$W\$). Either way, it triggers our halting condition:</p>

<pre class="lang-javascript prettyprint-override"><code>~k === 0
</code></pre>
</div>
<div id="pu16" class="pu"><h1><a href="https://gitlab.com/n9n/k" rel="nofollow noreferrer">K (ngn/k)</a>, <s>41</s> <s>39</s> 38 bytes</h1>

<pre><code>{s#(+,/'4(+|:)\x)@'4!1+i&amp;|i:&amp;/!s:2##x}
</code></pre>

<p><a href="https://tio.run/##PY/ZjoIwAEXf/YoKo4JooIgbvIwb4L7vY@KKIggKqBh1fp1RS@ap9@S2zT1a3NganqfwdxsnqBgd4QjqwZM/Lvkd4YKQUsMPlQ/TQZtncdx9eg5//5refi1eAa4wNzWBmCsLVRdc4SZY5OwZcKYElssXiiVRwgIAAEwuV6q1egNBs9XudHt9BIPhaDxZLBGs1htlu1MR7DX9YJhHBCfLds6XK0a@iMBO@9WgKedQZZnGQdfyCOxdd7JdFxA4i85YGRYRnHvt0aZVQnCp16qVsojgelSX/YaEkbPX8FgMkze6br6r//wuCAjY9/UkYD4jkgC@kQHs550vjH4UpZcwipBNcEkUU@lMlkGRitPRkC9DpaDoq8SzmbQvQnMJ1teIlmXJlwgxyUoJDYUQQIinBf@ceX8" rel="nofollow noreferrer" title="K (ngn/k) – Try It Online">Try it online!</a></p>

<p><code>{</code> <code>}</code> function with argument <code>x</code></p>

<p><code>#x</code> length of <code>x</code> - the height of the matrix</p>

<p><code>2##x</code> two copies - height and width (assumed to be the same)</p>

<p><code>s:</code> assign to <code>s</code> for "shape"</p>

<p><code>!s</code> all indices of a matrix with shape <code>s</code>, e.g. <code>!5 5</code> is</p>

<pre><code>(0 0 0 0 0 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4
 0 1 2 3 4 0 1 2 3 4 0 1 2 3 4 0 1 2 3 4 0 1 2 3 4)
</code></pre>

<p>This is a 2-row matrix (list of lists) and its columns correspond to the indices in a 5x5 matrix.</p>

<p><code>&amp;/</code> minimum over the two rows:</p>

<pre><code>0 0 0 0 0 0 1 1 1 1 0 1 2 2 2 0 1 2 3 3 0 1 2 3 4
</code></pre>

<p><code>i&amp;|i:</code> assign to <code>i</code>, reverse (<code>|</code>), and take minima (<code>&amp;</code>) with <code>i</code></p>

<pre><code>0 0 0 0 0 0 1 1 1 0 0 1 2 1 0 0 1 1 1 0 0 0 0 0 0
</code></pre>

<p>These are the flattened ring numbers of a 5x5 matrix:</p>

<p><code>4!1+</code> add 1 and take remainders modulo 4</p>

<p><code>(+|:)</code> is a function that rotates by reversing (<code>|</code> - we need the <code>:</code> to force it to be monadic) and then transposing (<code>+</code> - since it's not the rightmost verb in the "train", we don't need a <code>:</code>)</p>

<p><code>4(+|:)\x</code> apply it 4 times on <code>x</code>, preserving intermediate results</p>

<p><code>,/'</code> flatten each</p>

<p><code>+</code> transpose</p>

<p><code>(</code> <code>)@'</code> index each value on the left with each value on the right</p>

<p><code>s#</code> reshape to <code>s</code></p>
</div>
<div id="pu17" class="pu"><h1><a href="https://docs.python.org/2/" rel="nofollow noreferrer">Python 2</a>, 98 bytes</h1>



<pre class="lang-python prettyprint-override"><code>def f(a):
 if a:a=zip(*a[::-1]);b=zip(*a[1:-1]);b[-2:0:-1]=f(b[-2:0:-1]);a[1:-1]=zip(*b)
 return a
</code></pre>

<p><a href="https://tio.run/##hY/LTsMwEEX3/orZIMdpIpJAC3GVBe/SL6hkeeGKGFxFTmSFBfx84BZDqYTE5mjOzLU9Ht7Gl95X0/TUWrKJEZKRs2Skad7dkKRGSZmXWiy3315GV3klC9SNTQ4iljHxFd8KRqEdX4MnM9k@UEfOf76jFF@1XddzrYUcgvMjdYztC3YUKzOqdMZIzTMq/gvzK54RvwZugFvgju/P83vIA7ACHoF1nJWQCjgDzoF5nC0gF8AlUANFnM0gOXAKpMDJX39im0YpN9ulNWFjh42D8c9tUguNzu6o8/tbm5/Lpg8" rel="nofollow noreferrer" title="Python 2 – Try It Online">Try it online!</a></p>
</div>
<div id="pu18" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="noreferrer">Jelly</a>, 27 bytes</h1>

<pre><code>J«þ`UṚ«Ɗ‘ịZU$LÐ¡ŒĖḢŒHEƊƇṁµG
</code></pre>

<p><a href="https://tio.run/##y0rNyan8/9/r0OrD@xJCH@6cdWj1sa5HDTMe7u6OClXxOTzh0MKjk45Me7hj0dFJHq7Huo61P9zZeGir@////5UcnZxdXJV0lNzcPTy9gLShkbGJKZA2M7ewNADS2rr6WqpKAA" rel="noreferrer" title="Jelly – Try It Online">Try it online!</a></p>

<p>I think this could be far shorter.</p>

<pre><code>           Input: n×n matrix A.
J          Get [1..n].
 «þ`       Table of min(x, y).
    UṚ«Ɗ   min with its 180° rotation.

Now we have a matrix like: 1 1 1 1 1
                           1 2 2 2 1
                           1 2 3 2 1
                           1 2 2 2 1
                           1 1 1 1 1

‘ị          Increment all, and use as indices into...
     LÐ¡    List of [A, f(A), f(f(A)), …, f^n(A)]
  ZU$       where f = rotate 90°

Now we have a 4D array (a 2D array of 2D arrays).
We wish to extract the [i,j]th element from the [i,j]th array.

ŒĖ     Multidimensional enumerate

This gives us: [[[1,1,1,1],X],
                [[1,1,1,2],Y],
                ...,
                [[n,n,n,n],Z]]

ḢŒHEƊƇ     Keep elements whose Ḣead (the index) split into equal halves (ŒH)
           has the halves Equal to one another. i.e. indices of form [i,j,i,j]
           (Also, the head is POPPED from each pair, so now only [X] [Y] etc remain.)

ṁµG        Shape this like the input and format it in a grid.
</code></pre>
</div>
<div id="pu19" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="noreferrer">Charcoal</a>, 44 bytes</h1>

<pre><code>≔ＥθＳθＷθ«≔Ｅθ⮌⭆θ§§θνλθθＭ¹⁻¹Ｌθ≔Ｅ✂θ¹±¹¦¹✂κ¹±¹¦¹θ
</code></pre>

<p><a href="https://tio.run/##ZU/JbsIwED3jr/DRlsKBc08pa0pCgbDf3GRwXFxnsROQEN8eHBYJ1MNoRm/VRAkropTJuna1FlyRgGUkd7CnstKEphCKE0odnNMPdEyEBExyis@o9S6fQwWFBnJ3PEDXeCqGE3luCykbJSl9JramVm7I7QzSCkjHwYFQpW4OHxQ3iSVpQ7/0hVJE0KRZ0QQ4M9ZnA5u5U4f/1KPwYv/87Pb6gyEaeV9jP5ig7@lsHi6WaLXebHfsB0Ux7Hki0O9B/qk0Q3mhTVkd63Ylrw" rel="noreferrer" title="Charcoal – Try It Online">Try it online!</a> Link is to verbose version of code. Only works on character squares because Charcoal's default I/O doesn't do normal arrays justice. Explanation:</p>

<pre><code>≔ＥθＳθ
</code></pre>

<p>Read the character square.</p>

<pre><code>Ｗθ«
</code></pre>

<p>Loop until it's empty.</p>

<pre><code>≔Ｅθ⮌⭆θ§§θνλθ
</code></pre>

<p>Rotate it.</p>

<pre><code>θＭ¹⁻¹Ｌθ
</code></pre>

<p>Print it, but then move the cursor to one square diagonally in from the original corner.</p>

<pre><code>≔Ｅ✂θ¹±¹¦¹✂κ¹±¹¦¹θ
</code></pre>

<p>Trim the outside from the array.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/169677/">169677</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




