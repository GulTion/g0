<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::269682</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>253</td><td>Google Sheets</td><td>240202T194411Z</td><td><a href="https://codegolf.stackexchange.com/questions/269682/possible-moves-in-othello-reversi/269732#269732">doubleun</a></td></tr>
<tr d-ix="1"><td>115</td><td>JavaScript ES11</td><td>240202T110845Z</td><td><a href="https://codegolf.stackexchange.com/questions/269682/possible-moves-in-othello-reversi/269708#269708">Arnauld</a></td></tr>
<tr d-ix="2"><td>060</td><td>Perl p</td><td>240202T125525Z</td><td><a href="https://codegolf.stackexchange.com/questions/269682/possible-moves-in-othello-reversi/269711#269711">Nahuel F</a></td></tr>
<tr d-ix="3"><td>040</td><td>Charcoal</td><td>240202T084553Z</td><td><a href="https://codegolf.stackexchange.com/questions/269682/possible-moves-in-othello-reversi/269702#269702">Neil</a></td></tr>
<tr d-ix="4"><td>245</td><td>Python 3</td><td>240202T020741Z</td><td><a href="https://codegolf.stackexchange.com/questions/269682/possible-moves-in-othello-reversi/269688#269688">enzo</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Google Sheets, 253 bytes</h1>
<pre><code>=let(_,lambda(a,r,regexmatch(join(,a),r)),f,&quot;^L+D&quot;,b,&quot;DL+$&quot;,if((H8=&quot;.&quot;)*or(_(A8:G8,b),_(I8:O8,f),_(H1:H7,b),_(H9:H15,f),_({A1,B2,C3,D4,E5,F6,G7},b),_({A15,B14,C13,D12,E11,F10,G9},b),_({I7,J6,K5,L4,M3,N2,O1},f),_({I9,J10,K11,L12,M13,N14,O15},f)),&quot;*&quot;,H8))
</code></pre>
<p>Put the input in cells <code>H8:O15</code> and the formula in cell <code>X8</code>, and copy the formula cell to the range <code>X8:AE15</code>. The output is returned as a matrix in the latter cells, mimicking the format shown in the example in the question.</p>
<p><a href="https://docs.google.com/spreadsheets/d/1Tgq5MPXKCjMLl1kq6fqb8PZG9fJ8my6JyxYjIzn5zHU/edit" rel="nofollow noreferrer">Try it.</a></p>
<p>Generates strings by joining seven values to the left, right, up and down, and diagonally from a cell. Matches each string against a regex that looks at the start or at the end, depending on the string's direction from the origin.</p>
<p><img src="https://i.imgur.com/U6WlS2s.png" alt="othello.png" /></p>
<p>Ungolfed:</p>
<pre><code>=let( 
  isMatch_, lambda(a, x, 
    regexmatch(join(&quot;&quot;, a), x) 
  ), 
  left, A8:G8, 
  right, I8:O8, 
  up, H1:H7, 
  down, H9:H15, 
  leftup, { A1, B2, C3, D4, E5, F6, G7 }, 
  leftdown, { A15, B14, C13, D12, E11, F10, G9 }, 
  rightup, { I7, J6, K5, L4, M3, N2, O1 }, 
  rightdown, { I9, J10, K11, L12, M13, N14, O15 }, 
  forward, &quot;^L+D&quot;, 
  backward, &quot;DL+$&quot;, 
  if( 
    and( 
      (H8 = &quot;.&quot;),
      or( 
        isMatch_(left, backward), 
        isMatch_(right, forward), 
        isMatch_(up, backward), 
        isMatch_(down, forward), 
        isMatch_(leftup, backward), 
        isMatch_(leftdown, backward), 
        isMatch_(rightup, forward), 
        isMatch_(rightdown, forward) 
      ) 
    ), 
    &quot;*&quot;, 
    H8 
  ) 
)
</code></pre>
</div>
<div id="pu1" class="pu"><h1>JavaScript (ES11), 115 bytes</h1>
<p>Expects a matrix with <span class="math-container">\$0\$</span> for <em>empty</em>, <span class="math-container">\$1\$</span> for <em>light</em>, <span class="math-container">\$2\$</span> for <em>dark</em>. Returns another matrix in the same format, using <span class="math-container">\$3\$</span> for the possible moves for dark.</p>

<pre class="lang-javascript prettyprint-override"><code>m=&gt;m.map((r,y)=&gt;r.map((n,x)=&gt;[...35678+m].some(d=&gt;(g=X=&gt;(q=m[Y+=~-(d/3)]?.[X+=d%3-1])&amp;1&amp;&amp;g(X)|!n)(x,Y=y)*q&amp;2)?3:n))
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=dZBLTsMwEIb3PYWJRORpUkOJgIrK6SawssSim1ZpFlXihKDEaZ20asXjImwqBIfqJTgDzqtUCGZh_zP-5rfHbx8iC_juPaSfqyLsDfZ5Su2UpPMFxtLcArVlnQhzoxKXEGJdXl0PjNQjeZZyHFAbR3Si1iVN3alBX3s4OLPAGxF3YtDg1Or1PdD7uh7hCTyfCMAbc0q30F3qFzCybgRAc_WX5MtVLDnWwlwDIvk8uIsTPt4KH58DKbJxIWMRYSD5IokLrM3ETCgwzOTt3H_AOaI2euoglPACpYii_AdUWDlGhZRD5F6V-2WuEeZoJBYB39yH2AcAU5mUIblqQCFOYagqfibyLOEkySKsTioDWRrUX7Ruvbqau_aAPGaxwJoGrSofgQxU7cPOSzP1br8nTXSOhXMQTi0YY07LsF9wLf4oHQvmtI7sX-bYqLmE1bSjQpU6ysZxWCWY2itxsGYNzOr2esJv" rel="nofollow noreferrer">Attempt This Online!</a></p>
<h3>Commented</h3>
<pre class="lang-javascript prettyprint-override"><code>m =&gt;                         // m[] = input matrix
m.map((r, y) =&gt;              // for each row r[] at index y in m[]:
  r.map((n, x) =&gt;            //   for each value n at index x in r[]:
    [...35678 + m]           //     we coerce 35678 to a string and get the values
                             //     0, 1 and 2 from m[] (if the board does not
                             //     contain at least one empty, one light and one
                             //     dark square, then there's no possible move and
                             //     some() would fail anyway)
    .some(d =&gt;               //     for each direction d:
      (g = X =&gt;              //       g is a recursive function taking X
        ( q =                //         q is the value of the square on
          m[Y += ~-(d / 3)]  //         the updated row Y
          ?.[X += d % 3 - 1] //         and the updated column X
        ) &amp; 1 &amp;&amp;             //         if it's a light one:
          g(X)               //           do a recursive call
          | !n               //           and set the final result if n != 0
      )(x, Y = y)            //       initial call to g with the current position
      * q &amp; 2                //       test whether the last square is dark
    ) ?                      //     end of some(); if truthy:
      3                      //       set this square as a possible move
    :                        //     else:
      n                      //       leave it unchanged
  )                          //   end of inner map()
)                            // end of outer map()
</code></pre>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.perl.org" rel="nofollow noreferrer">Perl</a> (<code>-p</code>), 60 bytes</h1>
<pre class="lang-perl prettyprint-override"><code>for$i(0,7..9){s/D(.{$i}(L.{$i})+)\K\.|\.(?=(?1)D)/*/s&amp;&amp;redo}
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=m72kILUoZ0W0kq6BQYFS7IKlpSVpuhY3bdLyi1QyNQx0zPX0LDWri_VdNPSqVTJrNXzAlKa2Zox3jF5NjJ6Gva2GvaGmi6a-ln6xmlpRakp-LcQMqFELbt7SgwIuZIYLnOECYfj4-LjA1PigKYYwsAghM3xcYCb64FSDbBDUEh-IahcgAApxAY1xcfEBM3yANJgBN9oHqtgHqh3iRQA" rel="nofollow noreferrer">Attempt This Online!</a></p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 40 bytes</h1>
<pre><code>Ｅ⁸ＳＦ⁸Ｆ⁸«Ｊικ¿⊙Ｅ⁸⁺⪫ＫＤ⁸✳λω.D⁼⌕⁺..×⁶L…λ⌕λD¹*
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=RU_BSgMxED13vyLkNJE04EUWPElXxRJhwd7Ew5pmbWiarJusUsQv8dKDor9U_Bkn2RYHkvfy5s0j8_GjVk2vfGN3u68httNy_1v3xkW4bTooOblx3RDvIkpPwBg7L1rfEygZOeJbMZkPm27hwXCyRsPEtAQu3PaYUNshwNwbB7XW68r0WkXjXWr9PyxjnLzioaKiiV8-D40NcGXcEnICFYJysjAbHeAMfTLbZltl9WzlO7CcZDMiTRHYPMWbjNvQE4pfe_8MjyocFv2-p9MXSx_21yKVFKJIgIikwkKpEBKJzEQiZoJa9gh5MMtxfIz9Aw" rel="nofollow noreferrer">Attempt This Online!</a> (Only using ATO here because the version of Charcoal on TIO erroneously extends the canvas when you use <code>PeekDirection</code>.) Link is to verbose version of code. Outputs by drawing <code>*</code>s where the possible moves are. Explanation:</p>
<pre><code>Ｅ⁸Ｓ
</code></pre>
<p>Copy the input to the canvas.</p>
<pre><code>Ｆ⁸Ｆ⁸«Ｊικ
</code></pre>
<p>Jump to each square in turn.</p>
<pre><code>¿⊙Ｅ⁸⁺⪫ＫＤ⁸✳λω.D
</code></pre>
<p>For every direction, peek in that direction, appending <code>.D</code> to the peeked string...</p>
<pre><code>⁼⌕⁺..×⁶L…λ⌕λD¹
</code></pre>
<p>... if after truncating the string at the position of the first <code>D</code>, the result is not <code>.</code> but is a prefix of <code>.LLLLLL</code>...</p>
<pre><code>*
</code></pre>
<p>... overwrite the <code>.</code> with a <code>*</code>.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, 245 bytes</h1>

<pre class="lang-python prettyprint-override"><code>def f(T,R=[]):
 for m in range(64):
  for n in range(9*(T[m//8][m%8]=='D')):
   f=0
   for q in range(1,8):
    w,z=m//8+q*(n//3)-q,m%8+q*(n%3)-q;d=T[w][z]
    if'L'==d:f=1
    elif(d=='.')*f*(w&gt;=0&lt;=z):R+=[(z,w)];break
    else:break
 return{*R}
</code></pre>
<p><a href="https://tio.run/##fVLRboIwFH3nKxqThRY70Gg2huueeOyT8Q2JYVI2MigIJTiM385KQYku233puYdzzm24zb/FZ8YXbRuyCERwg9fE85GjgSgrQApiDoqAfzD4tOxIxfKRfTHgxksty/a99MH2CdFdHSkhiMhMHdJwGA1zbPefQY0b0jmnBwNyy1qgxwOWGap96LpVSDZe7XuNr/RxpFOdkNCJyFwRLIkjGMqRpo6MyID1G5m9kgY56ynxYINr5K/eCxZ8DeqSOUNbMFEV/GSsz@0@KFkJCDgp0WQy2WrmUDfAvQK3B5RS96Khd2JVMssBz1j7J/QKqHtJp39qxtAl1sbMYTbtja4sSWky0XWpAlSeClyn0EFMe7vKnNtYO2vdsmKeV2In2FFgwI452wsW7rJKSLZbo/phZixYWsJuk8FeVEFyERD5hMYAs8yTWEB9y3WE5avSQF7EXMAyK2QovLEiDBLGf3F3N0DtDw" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<p>A function that receives a list of strings and outputs a set containing sized-2 tuples.</p>
<ul>
<li><em>-21</em> bytes by removing <code>i</code>, <code>j</code>, <code>a</code> and <code>b</code>, and replacing the <code>if T[i][j]=='D':</code> with a multiplication inside the <code>range</code></li>
</ul>
<h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>270</s> 266 bytes</h1>
<p>Original version.</p>

<pre class="lang-python prettyprint-override"><code>def f(T):
 R=[]
 for m in range(64):
  i=m//8;j=m%8
  if T[i][j]=='D':
   for n in range(9):
    a=n//3;b=n%3;f=0
    for q in range(1,8):
     w,z=i+q*a-q,j+q*b-q;d=T[w][z]
     if'L'==d:f=1
     elif(d=='.')*f*(w&gt;=0&lt;=z):R+=[(z,w)];break
     else:break
 return{*R}
</code></pre>
<p><a href="https://tio.run/##fZJRT8IwFIXf@ytuSMw6rCDBKG5en/bYJ8LbWMxgrRahjK0ExfjbsesGCxi9Lz29@865y@7yT/O21sPDIRMSJJ34AYExxgkBuS5gBUpDkepXQe/vqkegcNXvj8IFrq5G1VXCJFZJvEgQvcirCGfUrfHR@QBS1P3@MJyhvhqGEm9ds2I3LTtgo4aGHdujut5005sNW9hzdrMJM5zEuyTeJzWipMc9xCyQOKg7Yqkkzeyr9Dy/K7t094y3T7j3g/E1xnTPdn4SzgqRvh/xUgTNvRBmW@iv7vj7ME9LUQLCl6M6nc6U9Jo6E9FJRLXgnEdHhl/ArmxWAA@M/BN6Ejw6pvM/mTb0jpE2s5nNa2Nky7aITYwi7gS3pxOnKbyBeW13mYMRI9@kWpHS@da8GPFhGIiPXMyNyF7WW2O71fLcB@spI1YlrfaXzs02XR4BtP9VG9Ar86Uy1Jtqz/cJ5IXShpbrwibSM5/PYCn0r97FeP/wAw" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>
<ul>
<li><em>-4 bytes</em> by using a set-literal instead of a set-function</li>
</ul>
<hr />
<p><strong>How does it work?</strong></p>
<p>The output variable here is <code>R</code>. Since the board is 8x8, we can iterate over it as a continuous range (<code>for m in range(64):</code>), storing the current row and column on <code>i</code> and <code>j</code>, respectively.</p>
<p>Every &quot;D&quot; piece has 8 possible directions to be validated: north, south, east, west, northwest, northeast, southwest and southeast. We also assume a &quot;D&quot; piece will be validated against itself: this case will be basically a no-op, and it's only considered here so that we can directly do <code>for n in range(9):</code> instead of iterating over a <code>range(8)</code> and making additional checks.</p>
<p>We then split <code>n</code> into two variables <code>a</code> and <code>b</code>, each containing values from 0 to 2. Basically, the following transformation is applied:</p>
<pre class="lang-none prettyprint-override"><code>n = 0  --&gt;  a = 0; b = 0  --(-1)-&gt;  a = -1; b = -1  (southwest)
n = 1  --&gt;  a = 0; b = 1  --(-1)-&gt;  a = -1; b =  0  (south)
n = 2  --&gt;  a = 0; b = 2  --(-1)-&gt;  a = -1; b = +1  (southeast)
n = 3  --&gt;  a = 1; b = 0  --(-1)-&gt;  a =  0; b = -1  (west)
n = 4  --&gt;  a = 1; b = 1  --(-1)-&gt;  a =  0; b =  0  (no-op)
n = 5  --&gt;  a = 1; b = 2  --(-1)-&gt;  a =  0; b = +1  (east)
n = 6  --&gt;  a = 2; b = 0  --(-1)-&gt;  a = +1; b = -1  (northwest)
n = 7  --&gt;  a = 2; b = 1  --(-1)-&gt;  a = +1; b =  0  (north)
n = 8  --&gt;  a = 2; b = 2  --(-1)-&gt;  a = +1; b = +1  (northeast)
</code></pre>
<p>Since a board has a limit of 8 pieces in each direction (8x8), we iterate over <code>range(1, 8)</code>. The variable <code>q</code> here describes how far we are going into the direction described by <code>n</code>: if <code>n</code> is north and <code>q</code> is 1, we are looking at the first slot on the top of <code>(i, j)</code>; if <code>n</code> is east and <code>q</code> is 2, we are looking at the second slot on the right of <code>(i, j)</code>. That slot has coordinates <code>(w, z)</code>, with value <code>d</code>.</p>
<p>If that slot contains a &quot;L&quot; piece, we can proceed with the validation; set <code>f</code>lag to true. That flag implements the requirement</p>
<blockquote>
<p>The possible moves are positions where there are one or more pieces of the opponent's color in a straight (horizontal, vertical, or diagonal) line <strong>between that position and a piece of the player's color</strong>.</p>
</blockquote>
<p>We can only add a possible move to <code>R</code> if the <code>f</code>lag has been set; that is, if there is an &quot;L&quot; piece between a &quot;D&quot; piece and an empty slot.</p>
<p>If the next slot on that direction is an empty spot, a &quot;L&quot; piece has already been visited (i.e. if <code>f</code> is true) and if <code>(w, z)</code> is a valid spot on the board, then add it to <code>R</code> and stop validating.</p>
<p>Continue for all &quot;D&quot; pieces, for all possible directions, for all possible offsets.</p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/269682/">269682</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




