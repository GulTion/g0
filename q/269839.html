<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::269839</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>525</td><td>Ruby</td><td>240211T234521Z</td><td><a href="https://codegolf.stackexchange.com/questions/269839/fastest-count-of-certain-hypercubes-with-labeled-vertices/270004#270004">Level Ri</a></td></tr>
<tr d-ix="1"><td>nan</td><td></td><td>240207T162425Z</td><td><a href="https://codegolf.stackexchange.com/questions/269839/fastest-count-of-certain-hypercubes-with-labeled-vertices/269865#269865">user1502</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, n=5 in 25 seconds on TIO</h1>

<pre class="lang-ruby prettyprint-override"><code>N=5
f=-&gt;n=1,a=[0]{return if n&gt;N
#generate rectangles
u=[]
(6**(n-1)).times{|i|
  j=i*6
  p=q=r=s=0
  t=0
  n.times{
    k=j%6
    p=p&lt;&lt;1|(k&amp;1); q=q&lt;&lt;1|(41&gt;&gt;k&amp;1); r=r&lt;&lt;1|(25&gt;&gt;k&amp;1); s=s&lt;&lt;1|(26&gt;&gt;k&amp;1)
    t=k if k&gt;3 
    j/=6
  }
  u&lt;&lt;[p,q,r,s] if t&gt;4
}
#check colourings
b=[]
[0,(1&lt;&lt;2**n/2)-1].product(a,a).each{|z|c,d,e=z
  e=(e^c)|d&lt;&lt;2**n/2
  h=false
  u.each{|w|p,q,r,s=w 
    g=e&gt;&gt;p&amp;1
    h = g!=e&gt;&gt;q&amp;1 &amp;&amp; g==e&gt;&gt;r&amp;1 &amp;&amp; g!=e&gt;&gt;s&amp;1 
    break if h
  }
  b&lt;&lt;e unless h
} 
p b.size*2
f[n+1,b]
}
f[]
</code></pre>
<p><a href="https://tio.run/##NZFNboMwEIX3PoWrqAioQ2OasCnDEXIBRCUgw09IHbBBURNydmoMWdie93lmPE@WQ/Y3TUc4kAK2kQDOUoh3yUNiP0hB64KK6Eg2JQqUaY9UYt6norygIgPECbED17XFljuO19e/qB5jPRJKz1C7gT5b6ECCgp2Oe7OLNU@HlDZwfg9M1EIbhny0G4s737SDzqg9j6KFSJCG@IcXUaAWEizEtOmhmWduoi9q9PkT5v5PvYYwjFvWMclUMuf00Z48ySavMG9ofr1cB1mLUpFsthXvmM3D0Hdd8ek7W554rbyehry3U5Y6HqZ59RjvY85ODOGuuyPY@JM74@lVpFkFRXpROL@9VtzGdQK4LfOVgFHUWtyIigIt32bSWZxalr6dhVyFuVFamORMYmq8Vqu/LAyRDkL/jNLsSUlLM0/Vd3R9UsTig7Ms0YaLOJmmfw" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
<h1><a href="https://www.ruby-lang.org/" rel="nofollow noreferrer">Ruby</a>, n=4 repeated 40 times in 1.3 seconds on TIO</h1>

<pre class="lang-ruby prettyprint-override"><code>N=4
printoutput=true
f=-&gt;n=1,a=[0]{return if n&gt;N
#generate rectangles
u=[]
(6**(n-1)).times{|i|
  j=i*6
  p=q=r=s=0
  t=0
  n.times{
    k=j%6
    p=p&lt;&lt;1|(k&amp;1); q=q&lt;&lt;1|(41&gt;&gt;k&amp;1); r=r&lt;&lt;1|(25&gt;&gt;k&amp;1); s=s&lt;&lt;1|(26&gt;&gt;k&amp;1)
    t=k if k&gt;3 
    j/=6
  }
  u&lt;&lt;[p,q,r,s] if t&gt;4
}
#check colourings
b=[]
[0,(1&lt;&lt;2**n/2)-1].product(a,a).each{|z|c,d,e=z
  e=(e^c)|d&lt;&lt;2**n/2
  h=false
  u.each{|w|p,q,r,s=w 
    g=e&gt;&gt;p&amp;1
    h = g!=e&gt;&gt;q&amp;1 &amp;&amp; g==e&gt;&gt;r&amp;1 &amp;&amp; g!=e&gt;&gt;s&amp;1 
    break if h
  }
  b&lt;&lt;e unless h
} 
p b.size*2 if printoutput
f[n+1,b]
}
40.times{f[];printoutput=false}
</code></pre>
<p><a href="https://tio.run/##TVLbboMwDH3PV2SahoClXdN1fRnmE/oDiElAzaV0achF1Vr67V1ImbSHJD7Hx44dR9ny537fwYZI1QlzskZaA0ZZJDUsUgGcFZCt8qtCY5WgXU1FuiPPDQpUhUGqsDKFaI6oiYUsJ@E2jkOx4FG0NN036uvYjYTSA3Tx1p0SBlCgYeVs43cx65xJaQ@Hl623JMgk4WPYBzz6pAMMHm14mj4YBcoz648/RoN@MNsH49MY6Kea@/Sdenx4gyn/zS2bJJlkA1NM55PGpBtyI89Vi1VPq9PxZN2LNJqUU1vZioU8SdZxLN7W0YLnS6lOe1uZsGBFtMSiaq/jZazYniFcXHaEEL@qaNz/BTmuhbo4apzuniPO41wBnB/1NYBpKgPuQUuBNk8TMwScBoHzTkDNwHu0A15cKix8r@3cX5kkSK1wk9GOu1EiabnU3QXj9ST7N29SZ@KVszJ3/W9W8zzqLP/8/yd86bf7/Rc" rel="nofollow noreferrer" title="Ruby – Try It Online">Try it online!</a></p>
<p>This is a recursive function which takes the solution for the previous <code>n</code> makes a cartesian product of two copies, calculates all rectangles that bridge between them, then checks the colourings of these bridging rectangles. Because the solution for the previous <code>n</code> is known to be free of illegal colourings, it is only necessary to check rectangles that span the new dimension. This approach means there are only <code>1882 x 1882 = 3541924</code> colourings to check for <code>n=5</code> instead of <code>2**32 =  4 billion.</code> Also we only calculate colourings where the most significant bit is <code>0</code> which halves the number of calculations. Precalculating the rectangles before checking colourings also helps.</p>
</div>
<div id="pu1" class="pu"><h1>Python + python-sat (about 1 second on my machine)</h1>
<pre><code>import itertools
from pysat.solvers import Glucose4

def count_cubes(n):
    clauses = []
    for (x, y, z) in itertools.combinations(range(1 &lt;&lt; n), 3):
        e0_p = y &amp; (~x)
        e0_n = x &amp; (~y)
        e0 = e0_p | e0_n
        e1_p = z &amp; (~x)
        e1_n = x &amp; (~z)
        e1 = e1_p | e1_n
        if e0 &amp; e1:
            continue
        w = x ^ (e0 | e1)
        x, y, z, w = x + 1, y + 1, z + 1, w + 1
        clauses.append([x, w, -y, -z])
        clauses.append([-x, -w, y, z])
    if not clauses:
        assert n == 1
        clauses.append([-1, 1, -2, 2])
    with Glucose4(bootstrap_with=clauses, incr=True) as m:
        count = 0
        while m.solve():
            count += 1
            model = m.get_model()
            m.add_clause([-v for v in model])
    return count

for t in range(40):
    for n in range(1, 5):
        r = count_cubes(n)
        if t == 0:
            print(n, r)
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/269839/">269839</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




