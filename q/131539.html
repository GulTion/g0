<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::131539</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>101</td><td>APLNARS</td><td>240405T212720Z</td><td><a href="https://codegolf.stackexchange.com/questions/131539/fastest-tweetable-integer-factorizer/272369#272369">Rosario</a></td></tr>
<tr d-ix="1"><td>081</td><td>Wolfram Language Mathematica</td><td>210406T174539Z</td><td><a href="https://codegolf.stackexchange.com/questions/131539/fastest-tweetable-integer-factorizer/222968#222968">ZaMoC</a></td></tr>
<tr d-ix="2"><td>nan</td><td></td><td>170708T220313Z</td><td><a href="https://codegolf.stackexchange.com/questions/131539/fastest-tweetable-integer-factorizer/131563#131563">SEJPM</a></td></tr>
<tr d-ix="3"><td>3910</td><td>Python 3</td><td>180529T215826Z</td><td><a href="https://codegolf.stackexchange.com/questions/131539/fastest-tweetable-integer-factorizer/165688#165688">ceilingc</a></td></tr>
<tr d-ix="4"><td>137</td><td>Pari/GP</td><td>171009T025732Z</td><td><a href="https://codegolf.stackexchange.com/questions/131539/fastest-tweetable-integer-factorizer/144698#144698">japh</a></td></tr>
<tr d-ix="5"><td>1031</td><td>Axiom</td><td>170929T071931Z</td><td><a href="https://codegolf.stackexchange.com/questions/131539/fastest-tweetable-integer-factorizer/144038#144038">user5898</a></td></tr>
<tr d-ix="6"><td>1379</td><td>Axiom</td><td>170807T054301Z</td><td><a href="https://codegolf.stackexchange.com/questions/131539/fastest-tweetable-integer-factorizer/137907#137907">user5898</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>APL(NARS), 140chars, 10+1 minutes</h1>
<pre><code>r←p m
r←j←1⋄a←2⋄s←m*.2
k←j←1πj
→4×⍳k≥s⋄k×←j⋄→3
→0×⍳(m≤k)∨1≥a←l a,k,m⋄→2×⍳1=r←m∨a-1

r←l w
(b e n)←w⋄r←1
→3×⍳0=2∣e⋄r←n∣r×b
b←n∣b×b⋄→2×⍳0&lt;e←⌊e÷2
</code></pre>
<p>6+17+8+16+35 + 6+14+18+20= 140
Both functions have not check for validate input and use global variables so are not a trust if run with other functions...
&quot;l&quot; is the function that some other could call &quot;ltor&quot; or &quot;powmod&quot;, &quot;p&quot; use what they call &quot;p-1&quot; factoring method.
&quot;p&quot; fail when return 1. I say &quot;p&quot; would fail in each prime number, 1 and some little number as 8 if all goes well.</p>
<pre><code>   p¨187,1679,14369648346682547857x,34747575467581863011x,52634041113150420921061348357x,82312263010898855308580978867x,205255454905325730631914319249x,1233457775854251160763811229216063007x
11 73 9576890767 9576890767 2860486313 311111111111113 2860486313 1111111999999 
</code></pre>
<p>this above takes 1 minute</p>
<pre><code>  p 513231721363284898797712130584280850383x
40206835204840513073 
</code></pre>
<p>this above 38 seconds. The problem is the number 1751952685614616185916001760791655006749x that has factors-1 so big that
function &quot;p&quot; would take too much time here. One little solution could be use at end of &quot;p&quot; function one algo &quot;baby step giant step&quot;
it seems they call it, that find here in 2 minutes the result, but they are many chars more than 140...</p>
<pre><code>r←p1 n;j;a;s;k;t;h;m;q;z
r←j←1⋄a←2⋄s←n*.2
k←j←1πj
→4×⍳k≥s⋄k×←j⋄→3
→0×⍳(n≤k)∨1≥a←l a,k,n⋄→5×⍳1=r←n∨a-1⋄→0
→2×⍳j≤4e5⋄h←30030⋄m←l a,h,n⋄z←l m,13,n⋄q←{l a,⍵,n}¨q/⍨1=h∨q←⍳h-1⋄h←0
t←n∨¨1⌈¨∣¯1+z×q⋄t←t/⍨(1&lt;t)∧t≠n⋄→7×⍳∼0≠≢t⋄r←↑t⋄→0
z←n∣z×m⋄→6×⍳2e4≥h+←1
</code></pre>
<p>This above function &quot;p1&quot; should factorize all examples in few minutes.</p>
<pre><code>  p1¨187,1679,14369648346682547857x,34747575467581863011x,52634041113150420921061348357x,82312263010898855308580978867x,205255454905325730631914319249x,1233457775854251160763811229216063007x,1751952685614616185916001760791655006749x
11 73 9576890767 9576890767 2860486313 311111111111113 2860486313 1111111999999 36413321723440003717 
</code></pre>
</div>
<div id="pu1" class="pu"><h1><a href="https://www.wolfram.com/wolframscript/" rel="nofollow noreferrer">Wolfram Language (Mathematica)</a>, 81 bytes, 22 sec +10min(penalty)</h1>
<p>uses Pollards ρ-algorithm x(0)=33, f(x)=x^8+1 and searches only x(2k)-x(k)</p>
<pre><code>(x@0=33;n=#;v=1;x@k_:=x@k=Mod[x[k-1]^8+1,n];While[(r=GCD[x[2v]-x@v,n])&lt;2,v++];r)&amp;
</code></pre>
<p><a href="https://tio.run/##DclNC4IwGADge38jCEWFfaC@tl5YGHQKunUYM0aJitNgyNi/X16ey7OYbewXs00fE1vbG3e1VgV9GDAmQRLkXKx4FB6pCHJ@n3EXH7@vCmouqO4go/mqxWucbK8Sh/f2thfzugjS75NeWO6zTAuXnuLTTesmBwmMU8YqTiiBBqAsOYESSFMDVHWMfw" rel="nofollow noreferrer" title="Wolfram Language (Mathematica) – Try It Online">Try it online!</a></p>
</div>
<div id="pu2" class="pu">
<h1>Haskell, <s>100</s> <s>97</s> <s>91</s> <s>89</s> <s>87</s> <s>72</s> 67 Bytes</h1>
<h2><a href="https://tio.run/##LU3BDoIwFLv7FU3gAComHAgGmYkHD579gsEGLLIH2RaDCf8@EemhTZum7bh9yb73XulxMA7Pj3VSn@70VmYgLclFrXQ309p4hwW7BjT30sFiYnoQ0bSfDnlMFx5UsyiTthZRlfCYjuKaMjHXZWJRMQseWNQsWzj7D2muiEEMqwP4coEywfa2paNR5MIGkZFcIET3k7VaFHiQk600sfc@Pedf" rel="nofollow noreferrer">Try It Online!</a></h2>
<p><em>-3 bytes thanks to @flawr</em><br>
<em>-6 bytes thanks to @flawr again</em><br>
<em>-2 bytes thanks to @flawr yet again</em><br>
<em>-2 bytes thanks to an optimized set of parameters</em><br>
<em>-1 byte thanks to @flawrs yet another time</em><br>
<em>-14 bytes thanks to requirement to only having to output one factor</em><br>
<em>-5 bytes thanks to @AndersKaseorg</em></p>
<pre class="lang-hs prettyprint-override"><code>f n|let s x=mod(x*x+7)n;a#b|d&lt;-gcd(b-a)n,d&gt;1=d|c&lt;-s b=s a#s c=5#s 5
</code></pre>
<p>This works for the first 5 test cases in unnoticable time.<br>
This will probably time-out on the largest test case.</p>
<p>In general this will usually return one non-trivial factor in time proportional to the square root of the smallest factor.<br>
It will not work on every input because it doesn't vary the polynomial and detection of the exceptional case is hard to do in 140 bytes.<br>
It will also not output the full factorization, but rather a non-trivial factor and the division of the input by this factor.<br>
It will also not sort the factors by size.</p>
<p>The method used is <a href="https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm" rel="nofollow noreferrer">Pollard-Rho-Factoring</a> with the standard starting value of 2 (with the standard <code>x^2+1</code> polynomial applied once) and the non-standard polynomial constant factor of 7 (because <code>1</code> didn't work with 1679) for all further evaluations.</p>
<p>Full program (<code>factor.hs</code>):</p>
<pre class="lang-hs prettyprint-override"><code>import System.Environment(getArgs)

f n|let s x=mod(x*x+7)n;a#b|d&lt;-gcd(b-a)n,d&gt;1=d|c&lt;-s b=s a#s c=5#s 5

main= do
      args &lt;- getArgs
      print$f (read $ head args :: Integer)
</code></pre>
<p>Compile as <code>$ ghc factor.hs</code> (needs <code>ghc</code> installed).<br>
Run as <code>$ ./factor &lt;number&gt;</code>.</p>
<p>Example run:</p>
<pre class="lang-hs prettyprint-override"><code>$ ./factor 187
11
</code></pre>
<hr />
<p>Ungolfed code:</p>
<pre class="lang-hs prettyprint-override"><code>f n=g 5 (s 5)
   where s x=mod(x*x+7)n
         g a b = if d&gt;1 then d else g(s a)(s(s b))
               where d=gcd(b-a)n
</code></pre>
<p>Computes the non-trivial factor by calling <code>g</code> with initial values. The polynomial is pre-applied on 2 here and re-applied on the result (5) so that the input to <code>g</code> (in a <a href="https://codegolf.stackexchange.com/a/127594/55329">&quot;where&quot; clause</a>) can always be readily used for the gcd-test. <code>g</code> (golfed version uses infix <code>#</code>) then tries to compute a non-trivial factor <code>d</code> (in the where clause in the un-golfed version, in-line in the golfed one) as the difference between the two inputs to <code>g</code>, if it succeeds returns said factor, else retries. Here it may generate <code>n</code> as the output if <code>a==b</code> and thus returns only a trivial factor, the proper approach to handle this would be to either vary the starting values upon this event or change the polynomial.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python 3</a>, <s>100</s> 99 bytes, <s>45 40</s> 39 seconds + 10 minute penalty</h1>



<pre class="lang-python prettyprint-override"><code>import math
def f(n):
 x=y=2;d=1
 while d&lt;2:y=y*y+1;x,y=1+x*x%n,y*y%n+1;d=math.gcd(x-y,n)
 return d
</code></pre>

<p><a href="https://tio.run/##VY7ZboJQEIbveQqSxgSqbWafOVoepilaTSoaQlN4enq4MXg3y79892k43zqe58v1fuuH8vo5nIv2eCpPVVfvi3JspoYObYNF@Xe@/BzL9oP2UzO9Tls8jLupwe34Om66Xb5sunxrmyXi/furrca3adfVRdkfh9@@K9v53l@6oTpVGF7XxWMzT@tV2JJJsJgFqXjoWs3i4uoq5hoYxoC4eisZCwgiMioIQSIEQ855TzFBjESLGyJFqDKEBiSPsLWOQElVVBIokzqDMabMiInkCZuYRd0zlQopooEbB@aWjGDZBrAEvzwMrpgybqihGBqGpqwD9OzMkyqA@dIx/wM" rel="nofollow noreferrer" title="Python 3 – Try It Online">Try it online!</a></p>

<p>Uses Pollard-Rho with initial value 2 and polynomial x^2+1.</p>
</div>
<div id="pu4" class="pu"><h1><a href="https://pari.math.u-bordeaux.fr/" rel="noreferrer">Pari/GP</a>, 137 bytes, ~5 seconds</h1>

<p>Using GP's built-in elliptic curve operations <sub>(and some underhanded parameter tuning)</sub>:</p>

<pre><code>ecm(n)=iferr(if(n%2==0,2,n%3==0,3,for(a=1,n,ellmul(ellinit(Mod([a,a^2-a-1],n)),[1,a],lcm([1..ceil(4^a^0.5)])))),e,gcd(n,lift(Vec(e)[3])))
</code></pre>

<p><code>ecm</code> is a function that (ought to) return a factor. <strong><a href="https://tio.run/##LVHLbuMwDLz7K7QFUkiAEpASqce2/oS97iVIACO2CwGu6nXcQ1Hst2fpZHUZihwOKc3cLWX/Nt9uw@VdV9OWcVgWXUZdd65twTpbd34LvB0/Ft21aKsdpun9c9ICpZZV//ro9bGz3dntuz2ebDXGHtF2JzuJ6BEPh8tQJk3n7gwHNicjxw727dLraqcyrvr3cNGDOfqtdPtu6lW16tgohSnaDULMdyQfcqDkKYTkmGLie91TpMiRKUROmIIHxC3PLngCQkSPDOQgO4SAXhQejcl5dG7jQ8opMXtInCDHlMKd4IAdMzFlYO84egges@yB2dFjJ@c9cYwymckxYoAYfELRlWlB@ACPR0TGLBslDkgBAybOUgeM0iERM0CIlIV6av42zTpcV3FEfuJbUkr1Ej1Mernfy6j0D42vvXp@Vv1r3aDuevHKWCUmilu9@c@dl1JFzKqnn@rJqt5sA7p5nr70NsaqejVN8@ezrLd/" rel="noreferrer" title="Pari/GP – Try It Online">Try it online!</a></strong></p>

<h2>Test:</h2>

<pre><code>ecm(n)=iferr(if(n%2==0,2,n%3==0,3,for(a=1,n,ellmul(ellinit(Mod([a,a^2-a-1],n)),[1,a],lcm([1..ceil(4^a^0.5)])))),e,gcd(n,lift(Vec(e)[3])))

{
ns = [
  187,
  1679,
  14369648346682547857,
  34747575467581863011,
  52634041113150420921061348357,
  82312263010898855308580978867,
  205255454905325730631914319249,
  1233457775854251160763811229216063007,
  1751952685614616185916001760791655006749
  ]
}

test(n) = {
    d = ecm(n);
    if (!(1&lt;d &amp;&amp; d&lt;n &amp;&amp; n%d==0), error(d));
    print(n, ": ", d)
}

apply(test, ns)

quit
</code></pre>

<h2>Ungolfed:</h2>

<pre><code>ecm(n) = {
  iferr(if(n%2 == 0, 2,
           n%3 == 0, 3,
           for(a = 1, n,
               /* x^3 + A*x + B = y^2 */
               E = ellinit(Mod([a, a^2-a-1], n)); /* [A, B] */
               x0 = [1, a]; /* [x, y] */
               B = ceil(4^a^0.5); /* ~ exp(sqrt(log(p))), p ~= exp(a) */
               print("a=", a, ", B=", B);
               ellmul(E, x0, lcm([1..B]))
              )
          ),
         ERR, gcd(n, lift(Vec(ERR)[3] /* = Mod(d, n) */)),
         errname(ERR)=="e_INV")
}
</code></pre>

<p>Sadly, handling the factors 2 and 3 uses many bytes. Bytes that could have been used to add a stage 2:</p>

<pre><code>ecm(n)=iferr(for(a=1,n,Y=X=ellmul(E=ellinit(Mod([a,1],n)),[0,1],(B=ceil(4^a^0.5))!);for(z=0,9*B,Y=elladd(E,Y,X))),e,gcd(n,lift(Vec(e)[3])))
</code></pre>
</div>
<div id="pu5" class="pu"><h1>Axiom, 10 minutes + 31 seconds</h1>
<pre><code>A(a)==&gt;a:=(a*a+7)rem n;z(n)==(p:=a:=b:=101;for i in 1..repeat(A(a);A(b);A(b);p:=mulmod(p,a-b,n);i rem 999&lt;9=&gt;(p:=gcd(p,n);p&gt;1=&gt;break));p)
</code></pre>
<p>z() is the function rho, one 137 bytes function; ungolfed z() and call it as rho(). It would suppose that gcd(0,n)=n so the loop stop and return for fail n.</p>
<pre><code>)time on    
rho(n)==
  p:=a:=b:=101
  for i in 1..repeat
          A(a);A(b);A(b)
          p:=mulmod(p,a-b,n)
          i rem 999&lt;9=&gt;(p:=gcd(p,n);p&gt;1=&gt;break)
  p

va1:=[187,1679,14369648346682547857,34747575467581863011,52634041113150420921061348357,82312263010898855308580978867,205255454905325730631914319249,1233457775854251160763811229216063007, 1751952685614616185916001760791655006749]
p1()==(for i in 1..#va1-1 repeat output [va1.i,z(va1.i)]) 
</code></pre>
<p>results (z() is ok to all but the last number 1751952685614616185916001760791655006749 remain not factored (10 minutes) )</p>
<pre><code>(6) -&gt; p1()
   [187,17]
   [1679,23]
   [14369648346682547857,1500450271]
   [34747575467581863011,3628273133]
   [52634041113150420921061348357,2860486313]
   [82312263010898855308580978867,264575131106459]
   [205255454905325730631914319249,2860486313]
   [1233457775854251160763811229216063007,1111111999999]
                                                               Type: Void
                                 Time: 30.38 (EV) + 1.38 (GC) = 31.77 sec

(8) -&gt; z(1679)
   (8)  23
                                                    Type: PositiveInteger
                                                              Time: 0 sec
</code></pre>
</div>
<div id="pu6" class="pu"><h1>Axiom, 137 bytes 9 minutes</h1>
<pre><code>p(n:PI):PI==(j:=1;a:=3;s:=n^.2;repeat(b:=j:=nextPrime(j);repeat(b&lt;s=&gt;(b:=b*j);break);a:=powmod(a,b,n);d:=gcd(a-1,n);d&gt;1 or j&gt;n=&gt;break);d)
</code></pre>
<p>above the function p() that would implement p-1 algo for factoring
below what to copy in a file for test on p() function</p>
<pre><code>-- one has to copy this below text in a file name for example file.input
-- in one window where there is Axiom one could write 
-- )read C:\absolutepathwherethereisthatfile\file
-- and call the function test()
-- test()
-- the first character of all function and array must be afther a new line &quot;\n&quot;
)cl all
)time on
vA:=[187,1679,14369648346682547857,34747575467581863011,52634041113150420921061348357,82312263010898855308580978867,205255454905325730631914319249,1233457775854251160763811229216063007, 1751952685614616185916001760791655006749]

p(n:PI):PI==(j:=1;a:=3;s:=n^.2;repeat(b:=j:=nextPrime(j);repeat(b&lt;s=&gt;(b:=b*j);break);a:=powmod(a,b,n);d:=gcd(a-1,n);d&gt;1 or j&gt;n=&gt;break);d)

-- this would try to factor n with p-1 Pollard method
pm1(n:PI):PI==
   j:=1;a:=3;s:=n^.2
   repeat
      b:=j:=nextPrime(j)
      repeat(b&lt;s=&gt;(b:=b*j);break)
      a:=powmod(a,b,n)
      d:=gcd(a-1,n);d&gt;1 or j&gt;n=&gt;break
   d

test()==(for i in 1..#vA repeat output [vA.i, p(vA.i)])
</code></pre>
<p>results here:</p>
<pre><code>(5) -&gt; test()
   [187,11]
   [1679,73]
   [14369648346682547857,9576890767]
   [34747575467581863011,9576890767]
   [52634041113150420921061348357,2860486313]
   [82312263010898855308580978867,311111111111113]
   [205255454905325730631914319249,2860486313]
   [1233457775854251160763811229216063007,1111111999999]
   [1751952685614616185916001760791655006749,36413321723440003717]
                                                               Type: Void
                              Time: 496.78 (EV) + 53.05 (GC) = 549.83 sec
</code></pre>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/131539/">131539</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




