<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::263837</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>066</td><td>K ngn/k</td><td>230809T111010Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263928#263928">ngn</a></td></tr>
<tr d-ix="1"><td>nan</td><td>K ngn/k</td><td>230808T151456Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263886#263886">doug</a></td></tr>
<tr d-ix="2"><td>183</td><td>Perl 5</td><td>230808T210913Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263898#263898">good old</a></td></tr>
<tr d-ix="3"><td>031</td><td>Pyth</td><td>230807T191610Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263846#263846">CursorCo</a></td></tr>
<tr d-ix="4"><td>029</td><td>05AB1E</td><td>230808T115543Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263882#263882">Kevin Cr</a></td></tr>
<tr d-ix="5"><td>107</td><td>JavaScript Node.js</td><td>230808T055332Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263863#263863">l4m2</a></td></tr>
<tr d-ix="6"><td>018</td><td>Jelly</td><td>230808T012415Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263857#263857">Jonathan</a></td></tr>
<tr d-ix="7"><td>168</td><td>JavaScript ES6</td><td>230807T211759Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263850#263850">Arnauld</a></td></tr>
<tr d-ix="8"><td>077</td><td>Charcoal</td><td>230807T221037Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263852#263852">Neil</a></td></tr>
<tr d-ix="9"><td>230</td><td>Python 3.8</td><td>230807T213420Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263851#263851">CursorCo</a></td></tr>
<tr d-ix="10"><td>772</td><td>Python3</td><td>230807T170826Z</td><td><a href="https://codegolf.stackexchange.com/questions/263837/reverse-engineer-colors-for-a-layout/263843#263843">Ajax1234</a></td></tr>
</table>
<div id="pu0" class="pu"><h1><a href="https://codeberg.org/ngn/k" rel="nofollow noreferrer">K (ngn/k)</a>, 66 bytes</h1>
<p>thanks @doug for drawing my attention to this interesting challenge</p>
<pre><code>{(,^x)(,/{@[y;z;:;]'(((x=1+/y=)')#y@-1 1+z;,1+|/y)1=x@:z}[x]')/&lt;x}
</code></pre>
<p><a href="https://ngn.codeberg.page/k#eJxdjuFOwyAUhf/3Ka6ZsZDSUNbFH8UlfY+mZnUB21iHUqawuT270HZukYTcez/OOVxZHBF5thgReiwrxw+84HWMELJrllC3xjFeuDJlwJIDJyz5oQ6ztS2Lw6mydYzpkz1FkSxSlsgS6FZpLbamUzuQSoOSMn1xqdoJ0GLY92YAZFoB27bpe7F7FeCr+h7AtI3BUWSK433lzrqQYPlGvUUQzgM9L2KkucOBATVaNCY4Qbx/mE4M0AwgPvfdV+NDzWRCG9l0PbfccY1rv6OpGCyBcZRB5ou/wHDtsYeQX5/GBz7XWTI6b9xhmCXLsWNTN4sf+V0WupVnuTdNE2GckOwSl8OKk+m/WZuPqbdsJP900yp5YON+1zx20f2x5YUF3S9whHoI" rel="nofollow noreferrer">Try it online!</a></p>
<p>The results are off by one compared to the examples (this is allowed).</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://codeberg.org/ngn/k" rel="nofollow noreferrer">K (ngn/k)</a>, <sup>184</sup>136 bytes</h1>
<pre><code>(),&amp;'*+(?,/{$[#*y:,/-1 1,/:'&amp;'&amp;/'(x:(x;y))=/:{|'y}\(0,/:-1_')'1|:'\(x+1;~y)
  {(@[;+/y;+;1]'x)_\:*|y}[x]'y
  &amp;/*|x;,x;()]}.')/,1(1=)\(),
</code></pre>
<p><a href="https://ngn.codeberg.page/k#eJxFjkEOgzAMBO+8IlIrbIdQ1w3qIRFq/wGIG29IROjbG6CUk3d215Ynh2RK0BW+DM/X7qKjM1yLEsMOSigZMDgMPhK17OYEcenxnsNaRiCQ5KDHUIn/RCqUmvHd+Yqjr7wMEGjsnU5x6cIAMccl6xS8CR5pWG5AbASlpT4/URQToKiHktxbh7IHbO4Jz3U0me3POTpWNXtkV1zlJnZ3P2LP7n8t+/QFQ+w0LQ==" rel="nofollow noreferrer">Try it online!</a></p>
<p>A beast! First, turn input into a single list of a list of singletons.  This forms the initial list of partitions.  Recursively search all such lists for indices which contain a singleton with value &gt; 1 and whose neighbor to the right or left has a maximum value 1 less than the value of the singleton and either have length &gt; 1 or have length 1 and a value equal to 1. Merge each such singleton with each such neighbor to form the next set of partitions.</p>
<p>[EDIT: same idea but only keep the length and the highest value of each sequence.  These are always the same except for singletons with value &gt; 1.  I.e. those values waiting to be merged.]</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://www.perl.org/" rel="nofollow noreferrer">Perl 5</a>, 183 bytes</h1>

<pre class="lang-perl prettyprint-override"><code>sub f{my@a;(join'',map chr,@_)=~m~^((.+)(?(?{$_=$2;$i=s/\x1/\0/;1while$c=chr++$i,s/\x00\Q$c\E|\Q$c\E\0/\0/;/[^\0]/||!(local@b=(@b,(1+$b[-1])x--$i))})(*F)))+\z(?{push@a,\@b})(*F)~s;@a}
</code></pre>
<p><a href="https://tio.run/##bU9Lc4IwEL7zK7ZOHJISChHtQUQ5tL33nCADKCMdUAZ0auvjr9MA0o7aHJJv93tsNl8W6aiqyl0I8SH7cgMbf2yStarSLMghWhXU9Ylzzs5zjJ80gmd4dkC@gwY2SpzSEHtmCNOw2ecqSZcocqRD01BCa8o0xTuKxOuxfaSulhp8LkzPOB4fcLqJgtQNHeyGFDMNhVxnHtnrOkoIORH8@EYI0cS3nJnvypUbUOGGbf9c2m5wqnblEl6CbTAev@yyHNSFvFVbyYtkvY2h19dHoxIcx5lCvxTrHgUF5EH@BdRyiKFe9QBlniZbUKlKpQBOYMwFx1wsqKcR4RlKvCkuml4TNZmA6sthnNEBZR7oU@DcpKbEFCRgEngKlxy1bhQt2aga2CqbnNusuvOnHHQFuxSN7bk1SDyUTasLqLkuqsu36PDqHw0xrD0y7I5o2v852q9av8TVDtbtrh1xt1pNeIqvKNUP" rel="nofollow noreferrer" title="Perl 5 – Try It Online">Try it online!</a></p>
<p>With newlines for readability:</p>
<pre class="lang-perl prettyprint-override"><code>sub f{
my@a;
(join'',map chr,@_)=~
m~^((.+)(?(?{
$_=$2;
$i=s/\x1/\0/;
1while$c=chr++$i,s/\x00\Q$c\E|\Q$c\E\0/\0/;
/[^\0]/||!(local@b=(@b,(1+$b[-1])x--$i))
})(*F)))+\z(?{
push@a,\@b
})(*F)~s;
@a
}
</code></pre>
<p>Regexen as solution to any problem, but this one turned out somewhat long, therefore just for sake of completeness. Kind of seed-fill problem in 1-D. Last minute improvement was to number rolls from 1, per recent comment to OP. Otherwise (to number from 0) it was plus a few bytes.</p>
</div>
<div id="pu3" class="pu"><h1><a href="https://github.com/isaacg1/pyth" rel="nofollow noreferrer">Pyth</a>, 31 bytes</h1>
<pre><code>ms.e.ekbdf.Am&amp;SI._M.+dqSldSdT./
</code></pre>
<p><a href="https://tio.run/##K6gsyfj/P7dYL1UvNTspJU3PMVct2FMv3ldPO6UwOCclOCVET////2gjHUMdYx0gGQsA" rel="nofollow noreferrer" title="Pyth – Try It Online">Try it online!</a></p>
<h3>Explanation</h3>
<pre><code>ms.e.ekbdf.Am&amp;SI._M.+dqSldSdT./Q    # implicitly add Q
                                    # implicitly assign Q=eval(input())
                             ./Q    # list all partitions of Q
         f                          # filter these partitions on lambda T
          .A                        #   check if all are truthy
            m               T       #   T mapped over lambda d
                   .+d              #     the deltas of d
                ._M                 #     mapped to their signs
              SI                    #     is invariant under sorting
             &amp;                      #     and
                          Sd        #     sorted(d)
                      q             #     equals
                       Sld          #     range(1,len(d)+1)
m                                   # map the remaining valid partitions over lambda d
 s                                  #   flatten
  .e.ekbd                           #   convert each element of each partition part to its index in the partition
</code></pre>
</div>
<div id="pu4" class="pu"><h1><a href="https://github.com/Adriandmen/05AB1E/wiki/Commands" rel="nofollow noreferrer">05AB1E</a>, 29 <a href="https://github.com/Adriandmen/05AB1E/wiki/Codepage" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>.œʒε1š1¡`R‚εD{Q}`y{āQP}P}εĀƶ˜
</code></pre>
<p>Port of <a href="https://codegolf.stackexchange.com/a/263846/52210"><em>@CursorCoercer</em>'s Pyth answer</a>.</p>
<p>1-based output.</p>
<p><a href="https://tio.run/##AT0Awv9vc2FiaWX//y7Fk8qSzrUxxaExwqFgUuKAms61RHtRfWB5e8SBUVB9UH3OtcSAxrbLnP//WzEsMiwxLDNd" rel="nofollow noreferrer">Try it online</a> or <a href="https://tio.run/##yy9OTMpM/V9Waa@k8KhtkoKSfeV/vaOTT006t9Xw6ELDQwsTgh41zDq31aU6sDahsvpIY2BAbUDtua1HGo5tOz3nf63O/@hoQx0jHcNYnWggqWMMZYPF4GwzIGkC5BlD@FB5Yx0TsLgxSCWQBabBYhDdxnB1MB0g82IB" rel="nofollow noreferrer">verify all test cases</a>.</p>
<p><strong>Explanation:</strong></p>

<pre class="lang-python prettyprint-override"><code>.œ              # Get all partitions of the (implicit) input-list
  ʒ             # Filter it by:
   ε            #  Map over each part of the current partition:
    1š          #   Prepend a 1 to the part
      1¡        #   Then split the part on 1s
        `       #   Pop and push all split-parts separated to the stack
         R      #   Reverse the top/last split-part
          ‚     #   Pair it back together with the list before it)
           ε    #   Map over this pair of lists:
            D{Q #    Check if the list is sorted from lowest to highest:
            D   #     Duplicate the list
             {  #     Sort the copy
              Q #     Pop both lists, and check if they're equal
           }`   #   After the map: pop and push the two checks to the stack again
    y           #   Push the current part-list again
     {          #   Sort it from lowest to highest
      ā         #   Push a list in the range [1,length] (without popping the list)
       Q        #   Check if the two lists are the same
             P  #   Get the product of all values on the stack to see if this part is
                #   truthy
   }P           #  After the inner map: check if all parts of this partition were truthy
  }ε            # After the filter: map over the remaining partitions:
    Ā           #  Convert each character to a 1 (with an !=0 check)
     ƶ          #  Convert each inner value by its 1-based list-index
      ˜         #  Flatten this partition of indices to a single list
                # (after which the list of lists of (1-based) indices is output
                # implicitly as result)
</code></pre>
</div>
<div id="pu5" class="pu"><h1><a href="https://nodejs.org" rel="nofollow noreferrer">JavaScript (Node.js)</a>, 107 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=([v,...a],L=[],k=0,G,h)=&gt;v?1&amp;(h&lt;v^G/2|G&gt;&gt;v)?'':f(a,L=[...L,k],k,G|=1&lt;&lt;v,v)+f(a,L,1+k,G&amp;G+2&amp;&amp;1):G?'':L+`
`
</code></pre>
<p><a href="https://tio.run/##dZFNboMwEIX3nMIrwGIKGFAX/GVVWZW4gUUVi4bSJoIoSb1penZqGxxE2rIav/c9z3j44IKfm9P78fLQD6@7cWwLlwnwfZ/XUBWshn0RAoUOF6XYENvtcvFCg@hKy1LgjeOkrcsVKBMV7CUO9FqQPBcgsKc9IJ4UbepFtk1wSlWo8rbWdsyYhRAjEAGpAekvCBBjIYRakQWRRa0oyUBsyBs1AZrUpaH1nb9oBUQLHZkDmQ9z9NEMM0W1mkggNmPeVLKQps3SP4ZkwedpZztRd@nuf9ra/D89PS5e2XdvX41qNrXYajF369Z2bfntcHriTedyVJToCzVDfx4OO/8wvLnOc3/8vKQOII6zlSP/M5bSN87GHw" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
</div>
<div id="pu6" class="pu"><h1><a href="https://github.com/DennisMitchell/jelly" rel="nofollow noreferrer">Jelly</a>, 18 <a href="https://github.com/DennisMitchell/jelly/wiki/Code-page" rel="nofollow noreferrer">bytes</a></h1>
<pre><code>ŒṖtL$ƬL&gt;LƲƇƑƇJxẈƊ€
</code></pre>
<p>A monadic Link that accepts a layout as a list of positive integers and yields all possible colourings using a prefix of the positive integers.</p>
<p><strong><a href="https://tio.run/##y0rNyan8///opIc7p5X4qBxb42Pnc2zTsfZjE4@1e1U83NVxrOtR05r/OofbQUpmANlZjxrmKNjaKTxqmKsZ@f9/dLShjpGOYawOl0I0kNYxhvPA4kg8MzBtAhQxhonB1RnrmEBljUF6wGwwCyoOMcsYST1CL8SGWAA" rel="nofollow noreferrer" title="Jelly – Try It Online">Try it online!</a></strong></p>
<h3>How?</h3>
<pre><code>ŒṖtL$ƬL&gt;LƲƇƑƇJxẈƊ€ - Link: list of positive integers, Layout
ŒṖ                 - all partitions of {Layout}
            Ƈ      - keep those {patitions} for which:
           Ƒ       -   {partition} is invariant under?:
          Ƈ        -     keep those {parts} for which:
         Ʋ         -       last four links as a monad:
     Ƭ             -         collect while distinct under:
    $              -           last two links as a monad:
   L               -             length
  t                -             trim all occurrences of {that} from both ends
      L            -         length of {that list of collected, trimmed parts}
        L          -         length {part}
       &gt;           -         {collected count} greater than? {part length}
                 € - for each {valid partition}:
                Ɗ  -   last three links as a monad:
             J     -     indices {partition}
               Ẉ   -     length of each {partition}
              x    -     {indices} times {lengths}
</code></pre>
</div>
<div id="pu7" class="pu"><h1>JavaScript (ES6), 168 bytes</h1>
<p>Returns a string, using commas and linefeeds as separators.</p>

<pre class="lang-javascript prettyprint-override"><code>f=([v,...a],p=[],c=p,b=[...p,c])=&gt;v?f(a,p,[...c,v])+(c+c&amp;&amp;f(a,b,[v])):b.some(c=&gt;c.some(d=m=p=v=&gt;m==(m|=1&lt;&lt;v)|d^p&lt;(d^=v&lt;2,p=v))|m+1&amp;m+2)?&quot;&quot;:b.map((c,i)=&gt;c.map(_=&gt;i))+`
`
</code></pre>
<p><a href="https://tio.run/##dZLPUsIwEMbvPEWGAyTTtZCW8QDdcvLgM2SKhhQUh9IMYC7is9ckbeiA2tPu9/32T3b6IY08qeNOnx8Odblpmi1SYSCOY1mARlGAQg1rFFbRoAqGuVluqQQNTlJgChZRFanRyKlrEFZg83V8qqsNVZirNiqxQo0G8wqRVhfkWWbYpVzpjJYrNFlihxnGLlXER1WUsOVwaJtUUlOqYMdcH5e8YL5jLHodvDYLMSBEcEiAF0D8N5kQIaYw9YoNuA0KR1kG0kBeqRbwpA8D7Xv@oh2Q9HQSEt4lXeljWKYt9erMAmlY86ryngxj@vkpzHq827azZ66Xn/6n7c3/q9vHpTf23dtvVg2X6m13mLtze7sYxNv6@CTVO5UEc/JFVH041ftNvK/f6Pj5oD/P8zEQyRY3jv1vmJW@2aL5AQ" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h2>Commented</h2>
<h3>Recursive part</h3>
<p>We build all partitions of the input array <code>a[]</code>.</p>
<pre class="lang-javascript prettyprint-override"><code>f = (                  // f is a recursive function taking:
  [ v,                 // v = next piece number
       ...a ],         // a[] = array of remaining values
  p = [],              // p[] = current partition
  c = p,               // c[] = current piece cluster
  b = [...p, c]        // b[] = copy of p[] with c[] added
) =&gt;                   //
v ?                    // if v is defined:
  f(a, p, [...c, v]) + //   do a recursive call with v added to c[]
  (                    //
    c + c &amp;&amp;           //   if c[] is not empty,
    f(a, b, [v])       //   do another recursive call with p[] = b[]
  )                    //   and c[] = [ v ]
:                      // else:
  ...                  //   final test (see below)
</code></pre>
<h3>Final test</h3>
<p>We test whether the partition <code>b[]</code> is valid.</p>
<pre class="lang-javascript prettyprint-override"><code>b.some(c =&gt;            // for each cluster c[] in b[]:
  c.some(d = m = p =   //   initialize d, m and p to NaN'ish values
  v =&gt;                 //   for each value v in c[]:
    m == (m |= 1 &lt;&lt; v) //     set the bit at index v in m and make sure
                       //     that m is modified by doing so
    | d ^ p &lt; (        //     make sure that p and v are in the expected
      d ^= v &lt; 2,      //     order, update p to v
      p = v            //     and update the direction if v = 1
    )                  //
  )                    //   end of inner some()
  | m + 1 &amp; m + 2      //   make sure that m consists of a sequence of
                       //   consecutive bits set to 1, followed by a
                       //   trailing 0
)                      // end of outer some()
?                      // if it failed:
  &quot;&quot;                   //   append nothing
:                      // else:
  b.map((c, i) =&gt;      //   turn each value in each cluster c[] in b[]
    c.map(_ =&gt; i)      //   into a roll number
  ) +                  //   implicit coercion to a string
  `\n`                 //   append a linefeed
</code></pre>
</div>
<div id="pu8" class="pu"><h1><a href="https://github.com/somebody1234/Charcoal" rel="nofollow noreferrer">Charcoal</a>, 77 bytes</h1>
<pre><code>⊞υ⟦…θ¹⟧ＦΦθκ«≔⟦⟧ηＦυ«⊞η⁺κ⟦⟦ι⟧⟧≔⊟κζ¿⁼№ζ¹›ι↨ζ⁰⊞η⁺κ⟦⁺ζ⟦ι⟧⟧»≔ηυ»ＥΦυ⬤ι⬤λ№λ⊕ξ⭆¹ΣＥιＥνξ
</code></pre>
<p><a href="https://ato.pxeger.com/run?1=ZVC9TsMwEBZj8hSnTrZ0lSgsSJ1KBAgkpEiMlgcTnMaKm7R2jKCoT8LSAQQLL8TTcHYoCx5857vv586vn1WjXNUru9-_h6Genn0f3ZTBNywgiOK5srpo-jXbIMy45PO87h2wS2MH7WKx5Rxe8mzhvVl2TEiEhkBZQoXUypJag1Da4FlLqsJIySPqQCvJoOUI21Q0NbCLTVDWs6IP3cC20RvhymkVXQ3CufI6lo85HfhnkBJqkxEfnXZ_IxIuUGWXl86Q9q1aH7ahhRfWRvkYLMLoTsl1Vzm90t2gH9hTtKRp7gbiLyN9Ro-wSkrEjaFDGGHzN39f-d-P_RCT6aOdyC8hTnCGp0i3lGPvBw" rel="nofollow noreferrer">Attempt This Online!</a> Link is to verbose version of code. Explanation:</p>
<pre><code>⊞υ⟦…θ¹⟧
</code></pre>
<p>Start with a partition of just the first piece in a roll.</p>
<pre><code>ＦΦθκ«
</code></pre>
<p>Loop over the remaining pieces.</p>
<pre><code>≔⟦⟧η
</code></pre>
<p>Collect new potential partitions.</p>
<pre><code>Ｆυ«
</code></pre>
<p>Loop over the current partitions.</p>
<pre><code>⊞η⁺κ⟦⟦ι⟧⟧
</code></pre>
<p>Maybe this piece starts a new roll.</p>
<pre><code>≔⊟κζ
</code></pre>
<p>Remove the last roll.</p>
<pre><code>¿⁼№ζ¹›ι↨ζ⁰
</code></pre>
<p>If this piece could be part of the last roll...</p>
<pre><code>⊞η⁺κ⟦⁺ζ⟦ι⟧⟧
</code></pre>
<p>... add that as an alternative.</p>
<pre><code>»≔ηυ
</code></pre>
<p>Save the potential partitions for the next pass.</p>
<pre><code>»ＥΦυ⬤ι⬤λ№λ⊕ξ⭆¹ΣＥιＥνξ
</code></pre>
<p>Output only those partitions whose rolls all contain all of the values from <code>1</code> up to their length, mapping each value to the roll index and flattening.</p>
</div>
<div id="pu9" class="pu"><h1><a href="https://docs.python.org/3.8/" rel="nofollow noreferrer">Python 3.8</a>, 230 bytes</h1>

<pre class="lang-python prettyprint-override"><code>r=range
p=lambda l:[[l]]+[q+[l[n:]]for n in r(1,len(l))for q in p(l[:n])]
f=lambda Q:[[k for k,g in enumerate(q)for h in g]for q in p(Q)if all(sorted(d:=[0&lt;s[i+1]-s[i]for i in r(len(s)-1)])==d and{*s}=={*r(1,len(s)+1)}for s in q)]
</code></pre>
<p><a href="https://tio.run/##bY5BbsMgEEX3PgVLJiZSKVZVWeEQWaNZUIEdFIJtcBdVlLO7xlGqxs5qNE/vf/3@Zzx1QXz2cZqijDq0tuil15cvo4mvlfKIpRpK5VWoEZsukkBcIJFy5m2gHiCzIbOeelUHBCyaR8NxbjiTbJxZmx0bvi826tHSYQmeMmzxX8cRXEO09zR1cbSGmlqqt0NSruS4n8/iuvuGvCDBngOClIboYK67dJPyunvsS1ByuOVIypEBcOqjCyNtqOLsnXEEKP7I/DOxoYv3gn48/dVsiLWz6RGsWqVE7n5iC1l59w1iw15trRZv@gU" rel="nofollow noreferrer" title="Python 3.8 (pre-release) – Try It Online">Try it online!</a></p>
<p>Essentially a port of my <a href="https://codegolf.stackexchange.com/a/263846/73054">Pyth answer</a>.</p>
</div>
<div id="pu10" class="pu"><h1>Python3, 772 bytes:</h1>
<pre class="lang-py prettyprint-override"><code>E=enumerate
def f(l,I=[],r=[]):
 if len(I)==len(l):yield r;return
 for i,a in E(l):
  if a==1 and i not in I:
   j,k,Q,W=i,i,[],[]
   while(j:=j-1)&gt;=0 and j not in I and l[j]!=1 and(Q==[]or Q[-1][0]&lt;l[j]):Q+=[(l[j],j)]
   while(k:=k+1)&lt;len(l)and k not in I and l[k]!=1 and(W==[]or W[-1][0]&lt;l[k]):W+=[(l[k],k)]
   R=range(max(len(Q),len(W)))
   for x in R:
    for y in R:
     u=[Q[:x+1],W[:y+1]]
     for o,V in E(u):
      if V and V[0][0]==2:
       M=V+u[not o]
       if len(S:=[X for X,_ in M])==len({*S}):
        yield from f(l,I+[j for _,j in M]+[i],r+[M+[(a,i)]])
   yield from f(l,I+[i],r+[[(1,i)]])
def F(l):
 R=[]
 B={str(sorted(j))for j in f(l)}
 for i in map(eval,B):
  v=[-1]*len(l)
  for P,j in E(i):
   for _,I in j:v[I]=P
  R+=[v]
 return{*map(tuple,R)}
</code></pre>
<p><a href="https://tio.run/##bVLBauMwEL3nK7Q3KZ5CHYdl8Xb2UEghh0CTQlwQohiibGU7dlDtbELot2c1kpttk4UQed68efOkme2hfW3q5MfWnk4T1HW30TZv9WCl12zNK5iiVGDdn0gHzKxZpWs@FYh0ViI9GF2tmP1pddvZesDWjWUGcmZqNqH8gFFRjhizvF4xw@qmpeSUMqyAEuaQoQEDro1UBP55NZXmRYrFTSx@4a0vLM6FPqxkob4FTT5H5861ncubWMlbdUdJkc4jlJw@oRCfdMsUyygWd8E/aZWX0uVZOuuls3/SpZPOgnSpoAzSC7R5/VvzTb7nJDwXQEcmhKA0PcqeOiz8rX18@BSzDuVcpvsoVpDJ9OBOFRLEbGAZnrMTPZ2edOnNLp0p90McfaTYDJdRJ@lKjfrA@rk9pSifveYzvJDmTPWTPA6f3s/qjIWprm2zCTsQycKXvUARyiJp3FZEchZJnoMRSvmLXtcFmuRxT6K1egiLsUCa9z0e31rL3xrb6hUvhKA@votTEO/9RlG8ybdc7/IK7r3THdJQhmGOg/BUj8HfhJtwmeB5SliR7uRU4aODF258O9c67OxxSMJtt600LMT7aWtN3fIHLmMYQazcBM@IiyG5Qj3vP@j3L/HYMZJLzpVOAuOLqoS0v2AeueAFD8kVdu2KjYCNgRH19Bc" rel="nofollow noreferrer">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/263837/">263837</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




