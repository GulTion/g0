<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::263827</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>219</td><td>JavaScript ES6</td><td>230808T112020Z</td><td><a href="https://codegolf.stackexchange.com/questions/263827/is-it-a-valid-go-type/263881#263881">Arnauld</a></td></tr>
<tr d-ix="1"><td>193</td><td>Raku</td><td>230807T151536Z</td><td><a href="https://codegolf.stackexchange.com/questions/263827/is-it-a-valid-go-type/263839#263839">Sean</a></td></tr>
<tr d-ix="2"><td>nan</td><td>BNFC + Haskell + Bash + coreutils</td><td>230807T161837Z</td><td><a href="https://codegolf.stackexchange.com/questions/263827/is-it-a-valid-go-type/263842#263842">matteo_c</a></td></tr>
<tr d-ix="3"><td>241</td><td>Regex PCRE</td><td>230807T135046Z</td><td><a href="https://codegolf.stackexchange.com/questions/263827/is-it-a-valid-go-type/263832#263832">mousetai</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>JavaScript (ES6), 219 bytes</h1>

<pre class="lang-javascript prettyprint-override"><code>f=s=&gt;s!=(s=s[R='replace'](/chan |\[\d*\]|map\[T\]/g,'*')[R](/ /,'')[R](/bool|u?int|float(32|64)|complex(64|128)|byte|rune|string|\*T|struct{(T(;T)*)?}|func\((T(,T)*)?\)(T|\((T(,T)*)?\)|(?=[,;})\]])|$)/,'T'))?f(s):s=='T'
</code></pre>
<p><a href="https://tio.run/##jVXNctowEL7zFFumM7Y8TmgSQtN6HE7tA3S4yToII4wSI7uWHMrUPDuVLAM2wTTM2Nq/7/NqVyte6BuVccFzdSOyBdvvl6EMn@Wn0JWhxL9Cp2B5SmPmEHcUr6iAKsLRwotItaZ5hGcRGSW@4zkI/9IRMPKdRpxnWVqVUy5UtUwzqtyH@2oyRlWcrfOU/XEn4@ru/glV861iVVEKVklVcJFUkTczYhmrv@7MDWbIQ9NdtSxFHLna4NeGCLmzqqNX7jTEfrBDESGo@ox0JjMHoenSlei7DEOt7eNMyCxlt2mWuA6eFaVabYmDggEeAAxNxkPfSDppKzTJ6kSt7h093uF3tGBiN3DQMDm54O4LEMBA8N39AwEP8OPka20A/PTN@DxTAhutC4s1tENnbFAzGgiBc9/hOeGIUc2WSN22g7MJMNXVYmBjAxO3s2yNE7qqiYW6j5NxAF7LWkPPopvFuII2gYdtMqey7rSxodWiSbLJ3i4NrWm@i1qyZvNL8zKP@QxqF6QnxLUxfmdpsx5wCOrXyYZJK7OzgIPaHJh6e32vY5ihs5uCzkIuGc8zRC7yreA3xbVaYJcdGg7I4HaZFT9ovHIlhM/QPvhmIJA@84PONEQC/6SpbI2DTpYlrBj60PMbjaAUryLbCMgLvuaKv7E6U9PPflg/kK9pwgUttn3gXqBQ3rUPGqAHG65WIDJQ25zZEb2KqVFrLqVuuimgolywRQtN5WKZrF5e08s0rWSPGEzspXDli3q4udQn5Y2mfAG6i0CLgm4hZSJRq5rl5u54N/SxCJZQUx1z5KRmYNcZ9a10O36ckGYU3/Fqxtr1f6rTuPuHue6ytYoq2ZrHWZoJmDO1YUzfUmw9Z0VdL9meZFSP84VNt1uUZvWa6xRFK5Ujx/m9egk8L/R/3Qncg911wVnOxBHsv@u6GX3T9Y@cs4L9Lnmhj9lmxRWTucnmA8O8/wc" rel="nofollow noreferrer" title="JavaScript (Node.js) – Try It Online">Try it online!</a></p>
<h3>How?</h3>
<p>At each iteration:</p>
<ul>
<li><p>we replace all occurrences of <code>&quot;chan &quot;</code>, <code>/\[\d*\]/</code> and <code>/map\[T\]/</code> with <code>&quot;*&quot;</code></p>
</li>
<li><p>if we find a space somewhere else, we remove it</p>
</li>
<li><p>we then look for the first valid type and replace it with <code>&quot;T&quot;</code>:</p>
<ul>
<li>primitive types: <code>bool|u?int|float(32|64)|complex(64|128)|byte|rune|string</code></li>
<li>a type preceded with <code>*</code>: <code>\*T</code></li>
<li>a <code>struct</code>: <code>struct{(T(;T)*)?}</code></li>
<li>a <code>func</code>: <code>func\((T(,T)*)?\)(T|\((T(,T)*)?\)|(?=[,;})\]])|$)</code></li>
</ul>
</li>
</ul>
<p>The <code>func</code> type is the trickiest one because we must not ignore a <em>return</em> statement that is not yet fully simplified. That's why we make sure that <code>func(...)</code> is followed by either a valid <em>return</em> statement or the end of the line or one of <code>,;}]</code>.</p>
<p>This process is repeated recursively until there's nothing more to replace. If the input string is valid, we should end up with a single <code>&quot;T&quot;</code>.</p>
</div>
<div id="pu1" class="pu"><h1><a href="https://raku.org/" rel="nofollow noreferrer">Raku</a>, <s>205</s> 193 bytes</h1>
<pre><code>*~~/^$(/:s \s*[bool|u?int|float[32|64]|complex[64|128]|byte|rune|string|\*&lt;~~&gt;|\[
\d* \]&lt;~~&gt;|map \[&lt;~~&gt;\]&lt;~~&gt;|chan\s+&lt;~~&gt;|struct \{ &lt;~~&gt;*%\; \}|func \(&lt;~~&gt;*%\,\)[&lt;~~&gt;|
\( &lt;~~&gt;*%\, \) ]?]\s*/)$/
</code></pre>
<p><a href="https://tio.run/##dVJtU@JADP7ur8g4eLRrlQOxp/ZOfshujqnYIh60TF9mjmHLX8fNvtBWhZnuJk@ehOTZbJNiHR43O/iRwp8jOxxGfwfe6KkEUTL@kudrWc9WWSXTdR5X/G4iwynKRb7ZrpP/PJzK8eQB5cuuSmRRZ4ksq2KVLaVgvw@HZyn4hXhlIFB7m3gLgpNpgcVbnInyWtsqsV5UIPZALrsSEYhGpnW2AOFZKBC@TpcXwnO0AIQPOEPV7sgfjI4RlPEOLvez1BvM/eYJBvNLSPMChjTMMIChmoYuO4PqnzxmUeZ@1udoJjI2RwfD@CcgcEA@ntwhMOD34S8NAH94pBgjPYirxuYqrVOIENC1iI7Qj7ivzUFyqX0kxcAFLUHJtldmZLgR8RqqZUPQdYgH@inDaQSsg@q0HtdeFIi66YybNloBGwXaosqk9mzf5tJF6SU9/2SpSkFNB330F34rwhmCZxhB72oruiwf9NFiHDsdfSI4Vy@EHurcYUlUyowCvQu/A@22Jcuk0G2SRBrbxMtVFhc7S2Bmu8wZl6/p8u39n95VzvG0cjfj7i6qtbud3odode@/ceBeoyunrzVtS1j6Kfx1Tw3jDKFxmlF/xw8" rel="nofollow noreferrer" title="Perl 6 – Try It Online">Try it online!</a></p>
<p>This is an anonymous function that matches its argument against the giant regex following the leftmost <code>~~</code>.  That regex is of the form</p>
<pre><code>/^$(/.../)$/
</code></pre>
<p>It interpolates the inner regex <code>$(/.../)</code> into the outer one.  The outer regex requires that the overall match be anchored at the beginning and end of the string.</p>
<p>The inner regex matches a Go type.  It is recursive, calling itself using the expression <code>&lt;~~&gt;</code>.</p>
</div>
<div id="pu2" class="pu"><h1><a href="https://bnfc.readthedocs.io/" rel="nofollow noreferrer">BNFC</a> + <a href="https://www.haskell.org" rel="nofollow noreferrer">Haskell</a> + <a href="https://www.gnu.org/software/bash/" rel="nofollow noreferrer">Bash</a> + coreutils, 175 + 96 = 271 bytes</h1>
<pre><code>bool&quot;
int&quot;
uint&quot;
float32&quot;
float64&quot;
complex64&quot;
complex128&quot;
byte&quot;
rune&quot;
string&quot;
*&quot;T
[&quot;&quot;]&quot;T
[&quot;Integer&quot;]&quot;T
map&quot;&quot;[&quot;T&quot;]&quot;T
chan &quot;T
struct&quot;&quot;{&quot;[T]&quot;}&quot;
Q
QT
Q&quot;(&quot;[T2]&quot;)&quot;Z2&quot;,&quot;Z&quot;;&quot;;_.T2::=T
</code></pre>
<p>Compile with</p>
<pre class="lang-bash prettyprint-override"><code>sed 's/Q/func&quot;&quot;(&quot;[T2]&quot;)&quot;/g;s/Z/;separator T/g'|awk '{print&quot;A&quot;NR&quot;.T::=\&quot;&quot;$0&quot;;&quot;}'&gt;g;bnfc -m g;make
</code></pre>
<p>Produces an executable named <code>TestG</code> which accepts input from <code>stdin</code> and exits with code <code>0</code> if the parse was successfull, <code>1</code> otherwise.</p>
<p>Possibly can be golfed more with a better use of sed and awk.</p>
<hr />
<p>Script to test it:</p>
<pre class="lang-bash prettyprint-override"><code>cat truthy falsy | sed &quot;s|//.*||&quot; | xargs -d &quot;\n&quot; -I {} sh -c 'echo &quot;{}&quot; | ./TestG &gt;/dev/null ; echo $? &quot;{}&quot;'
</code></pre>
</div>
<div id="pu3" class="pu"><h2>Regex (PCRE), 241 bytes</h2>
<pre><code>^(bool|u?int|float(32|64)|complex(64|128)|byte|rune|string|&amp;\s*(?1)|\*\s*(?1)|\[\s*\d*\s*\]\s*(?1)|map\s*\[\s*(?1)\s*\]\s*(?1)|chan (?1)|struct\s*\{\s*(|((?1);\s*)*\s*(?1)\s*;?\s*)\}|func\(\s*(|((?1),\s*)*(?1),?\s*)\)\s*(\s*(?1)|\((?6)\))?)$
</code></pre>
<p><a href="https://regex101.com/r/dK0FYL/1" rel="noreferrer">Try it on regex 101</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/263827/">263827</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




