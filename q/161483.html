<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6EBTM9J4LK"></script>
<script src="../g.js"></script>
    <title>cg::161483</title>
    <link rel="stylesheet" href="../c.css">
</head>
<body>
    <br><br>
    <div id = "content">
    <div id="container">
    <div id="mf">
        <a href="#" class="nonewtab" d-g="g">g</a> | 
        <a href="#" class="nonewtab" d-g="x">x</a> | 
        <a href="#" class="nonewtab" d-g="w">w</a> | 
        <a href="#" class="nonewtab" d-g="">all</a>
    </div>
    <input type="text" id="mi" placeholder="/">
    </div>

<table id="mt">
  <tr class="header">
    <th class="tbytes">Bytes</th>
    <th class="tlang">Lang</th>
    <th class="ttime">Time</th>
    <th class="tlink">Link</th>
  </tr>
<tr d-ix="0"><td>901</td><td>Python3</td><td>240125T235721Z</td><td><a href="https://codegolf.stackexchange.com/questions/161483/expand-sine-and-cosine/269556#269556">Ajax1234</a></td></tr>
<tr d-ix="1"><td>221</td><td>Bracmat</td><td>191103T181605Z</td><td><a href="https://codegolf.stackexchange.com/questions/161483/expand-sine-and-cosine/195251#195251">Bart Jon</a></td></tr>
</table>
<div id="pu0" class="pu"><h1>Python3, 901 bytes</h1>
<p>Longer than I hoped, but the logic is straightforward.</p>
<pre class="lang-py prettyprint-override"><code>E=enumerate
H=lambda f,p:[[1,-1][p%2],0][f=='sin']
Z=lambda d:' + '.join(str(b)+''.join(f'{j}{[&quot;^&quot;+str(l),&quot;&quot;][l==1]}({k})'for(j,k),l in eval(a))for a,b in d.items()if b)
def f(e):
 e=[[(a,b,[([1,-1][j&lt;0]*([1,j]['pi'==C]),C)for j,C in c for _ in range(1,abs(j)+1 if'pi'!=C else 2)],d)for a,b,c,d in i]for i in e]
 P=1
 while P:
  P=0
  for i,a in E(e):
   F=0
   for I,A in E(a):
    if len(A[2])&gt;1:q,*w=A[2];l=[[(A[0],'sin',[q],1),(1,'cos',w,1)],[(A[0],'sin',w,1),(1,'cos',[q],1)]]if'sin'==A[1]else[[(A[0],'cos',[q],1),(1,'cos',w,1)],[(-1*A[0],'sin',[q],1),(1,'sin',w,1)]];l=[u+a[:I]+a[I+1:]for u in l];e=e[:i]+e[i+1:]+l;F=1;break
   if F:P=1;break
 r={}
 for i in e:
  R,T={},1
  for a,b,[(C,V)],d in i:
   if C==-1 and'sin'==b:a*=-1
   if'pi'==V:
    if(L:=H(b,abs(C)))==0:R,T={},0;break
    else:T*=L*a
   else:R[(b,V)]=R.get((b,V),0)+d;T*=a
  r[M]=r.get(M:=str(sorted(R.items())),0)+T
 return Z(r)
</code></pre>
<p><a href="https://tio.run/##tVRdb9owFH3Pr/CoptjEVJhkjIV5UoVatVIrVajqQy13cohpQ9NAQxhMCGn/cD@J@SMJsFbVXvYS@d577rnnfsDsZ/E4zfzeLN9uT6nMFs8yF4V0zmkqnqNYgDGehYwR3CKczT52OG5zNqbUnSeZy527ChaHLvCAezyZJhmcFzmMkOeW5thdTzZr1rhveDqSItxocJZSSvgGrp82yB1PczjBTwinIMmA/CFSKBBSXiBwpF3xcVLI5zlEyRhEyInlGIyhRKEDJGUMKhRmsFQ5@drmTW1MOHNniUvpgCM8MHQTPNB0I6CN7/qZi@xBQoJFNIcT5BGQjHXSBzoAMp1L0EEcx5UUPMKxTkq4diRGLHfANSUOWD4mqQTXSpKy2@prIFho0KnVCsCZiZjQBT6xIWFDqjBIZQZPWIejbyR8wc0l1UY/1S2esDbHZuqYvXBMEFai3dF07uKlsjg@gCwPADaBc9WajlJFS7jurubdg73mbZHm29XrUtyIXHiChRdcfS88EpoRLXSLKe9LKlmYcE@yRIe8tH9GST/KpXhybOtn4fXOk9P1xgG7GesBDfGN8mJSTtaufIBv9X7MTsKSaUBpiwCRxWWzUSiaymOj9iBuq4nDy5Cew8hsf4AQorQdloXaO3nmEsKbJr1sCqcyh0zlqep0ePwgC2gM3EZe3FdADcvZFae5CV6FVF/@fJoXMobD6piRSbhR/cpikWfgDuZo65iLJhjY8QI1f18ZK1c1CuxC9oOkjvlqDeBI@VXCCnnqce/DFXJmeZIVUP9cEDjqVO6Wr5ErpDZ939Ewmxmo12sBwb4AfsgYVIyKSfMGO15T3jnSAeF1otbI83//2uM3V1b2IFyEAeyoV2ReLQMwT92@Wtvb5XVD6iekv5GRYL8j1NoFRmWXkZlK7dTCtbNlBNYYm@5ZZ4UpOTu1t65muRw7v5XX/Rz0ur0vva7q1LOuXs/vfuoF/mHzfy1Q9VmnHvRbYV7ja9735uO6/yIt@E/Sgvek1SBb2a/@YPbugdT3UJ6D/SPb56mSdzKqort7KsuDo@7@5vZZtn8A" rel="nofollow noreferrer">Try it online!</a></p>
</div>
<div id="pu1" class="pu"><h1><a href="https://github.com/BartJongejan/Bracmat" rel="nofollow noreferrer">Bracmat</a>, 221 bytes</h1>

<pre><code>(P=F v a b.!arg:((sin|cos):?F.?v)&amp;(!v:@&amp;(!F.!v)|!F$!v)|!arg:%?a_%?b&amp;(P$!a)_(P$!b)|!arg)&amp;(f=i a b n u.1+(!arg:e^(?n*((i|-i):?i)*?u+?b)&amp;(!i*(sin.!u)+(cos.!u))^!n*f$(e^!b)|!arg:%?a_%?b&amp;(f$!a)_(f$!b)|!arg)+-1)&amp;(Z=.f$(P$!arg))
</code></pre>

<p><a href="https://tio.run/##jY7NboMwEITvfQosEbK2haUESl0k5J4455wDkY0gtdRCxF858O7UBlKuvXhXszPzWTUy/5bdPMMlSZ3BkY5iSDb3GKDV1ZTXLY5FysSAPUBD/GHelKEBTyh1l2G9ByFvB6E8uLhI4psdaj2ZVJlo2@pUTs9OFJZAkYGoCICefG36NSaip0JZhiYWzFCPKRi6XXCGKlK6UGTP2p1YrsRyJ1L/ZHquCTMJ@x8j4fnn8@sI96I7xqIYH03RtrquvLrv3KuLdgXPC/xMRvyy0NfNan5gVrqsI86C/UwD8lTPmzX8y0t6Jsr8iOTG9tBb10ijt5BH/J1HVtxaKedB9MrD4P/OcHH@Ag" rel="nofollow noreferrer" title="Bracmat â€“ Try It Online">Try it online!</a></p>
</div>

<table id="st">
<!-- Popups content will be added here -->
</table>

<table id="at">
<!-- Popups content will be added here -->
</table>

</div>





  <div class="footer">
      <b><a class="nonewtab" href="../">GOLFSCORE/</a><a href="https://codegolf.stackexchange.com/questions/161483/">161483</a></b>
  </div>
<div class="footer-space">&nbsp;</div>



<script src="../c.js"> </script>
</body>
</html>




